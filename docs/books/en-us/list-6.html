<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 6. Mathematics for Algorithms – The Little Book of Algorithms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../books/en-us/list-7.html" rel="next">
<link href="../../books/en-us/list-5.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../books/en-us/list-6.html"><span class="chapter-title">Chapter 6. Mathematics for Algorithms</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">The Little Book of Algorithms</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Content</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/cheatsheet.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Cheatsheet</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/book.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/plan.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Plan</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 1. Foundations of Algorithms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 2. Sorting and searching</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 3. Data Structure in Action</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 4. Graph Algorithms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 5. Dynamic Programming</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-6.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Chapter 6. Mathematics for Algorithms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 7. Strings and Text Algorithms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 8. Geometry, Graphics and Spatial Algorithms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 9. Systems, Databases and Distributed Algorithms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/list-10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Chapter 10. AI, ML and Optimization</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section-51.-number-theory" id="toc-section-51.-number-theory" class="nav-link active" data-scroll-target="#section-51.-number-theory">Section 51. Number Theory</a>
  <ul class="collapse">
  <li><a href="#euclidean-algorithm" id="toc-euclidean-algorithm" class="nav-link" data-scroll-target="#euclidean-algorithm">501 Euclidean Algorithm</a></li>
  <li><a href="#extended-euclidean-algorithm" id="toc-extended-euclidean-algorithm" class="nav-link" data-scroll-target="#extended-euclidean-algorithm">502 Extended Euclidean Algorithm</a></li>
  <li><a href="#modular-addition" id="toc-modular-addition" class="nav-link" data-scroll-target="#modular-addition">503 Modular Addition</a></li>
  <li><a href="#modular-multiplication" id="toc-modular-multiplication" class="nav-link" data-scroll-target="#modular-multiplication">504 Modular Multiplication</a></li>
  <li><a href="#modular-exponentiation" id="toc-modular-exponentiation" class="nav-link" data-scroll-target="#modular-exponentiation">505 Modular Exponentiation</a></li>
  <li><a href="#modular-inverse" id="toc-modular-inverse" class="nav-link" data-scroll-target="#modular-inverse">506 Modular Inverse</a></li>
  <li><a href="#chinese-remainder-theorem" id="toc-chinese-remainder-theorem" class="nav-link" data-scroll-target="#chinese-remainder-theorem">507 Chinese Remainder Theorem</a></li>
  <li><a href="#binary-gcd-steins-algorithm" id="toc-binary-gcd-steins-algorithm" class="nav-link" data-scroll-target="#binary-gcd-steins-algorithm">508 Binary GCD (Stein’s Algorithm)</a></li>
  <li><a href="#modular-reduction" id="toc-modular-reduction" class="nav-link" data-scroll-target="#modular-reduction">509 Modular Reduction</a></li>
  <li><a href="#modular-linear-equation-solver" id="toc-modular-linear-equation-solver" class="nav-link" data-scroll-target="#modular-linear-equation-solver">510 Modular Linear Equation Solver</a></li>
  </ul></li>
  <li><a href="#section-52.-primality-and-factorization" id="toc-section-52.-primality-and-factorization" class="nav-link" data-scroll-target="#section-52.-primality-and-factorization">Section 52. Primality and Factorization</a>
  <ul class="collapse">
  <li><a href="#trial-division" id="toc-trial-division" class="nav-link" data-scroll-target="#trial-division">511 Trial Division</a></li>
  <li><a href="#sieve-of-eratosthenes" id="toc-sieve-of-eratosthenes" class="nav-link" data-scroll-target="#sieve-of-eratosthenes">512 Sieve of Eratosthenes</a></li>
  <li><a href="#sieve-of-atkin" id="toc-sieve-of-atkin" class="nav-link" data-scroll-target="#sieve-of-atkin">513 Sieve of Atkin</a></li>
  <li><a href="#millerrabin-primality-test" id="toc-millerrabin-primality-test" class="nav-link" data-scroll-target="#millerrabin-primality-test">514 Miller–Rabin Primality Test</a></li>
  <li><a href="#fermat-primality-test" id="toc-fermat-primality-test" class="nav-link" data-scroll-target="#fermat-primality-test">515 Fermat Primality Test</a></li>
  <li><a href="#pollards-rho-algorithm" id="toc-pollards-rho-algorithm" class="nav-link" data-scroll-target="#pollards-rho-algorithm">516 Pollard’s Rho Algorithm</a></li>
  <li><a href="#pollards-p1-method" id="toc-pollards-p1-method" class="nav-link" data-scroll-target="#pollards-p1-method">517 Pollard’s p−1 Method</a></li>
  <li><a href="#wheel-factorization" id="toc-wheel-factorization" class="nav-link" data-scroll-target="#wheel-factorization">518 Wheel Factorization</a></li>
  <li><a href="#aks-primality-test" id="toc-aks-primality-test" class="nav-link" data-scroll-target="#aks-primality-test">519 AKS Primality Test</a></li>
  <li><a href="#segmented-sieve" id="toc-segmented-sieve" class="nav-link" data-scroll-target="#segmented-sieve">520 Segmented Sieve</a></li>
  </ul></li>
  <li><a href="#section-53.-combinatorics" id="toc-section-53.-combinatorics" class="nav-link" data-scroll-target="#section-53.-combinatorics">Section 53. Combinatorics</a>
  <ul class="collapse">
  <li><a href="#factorial-precomputation" id="toc-factorial-precomputation" class="nav-link" data-scroll-target="#factorial-precomputation">521 Factorial Precomputation</a></li>
  <li><a href="#ncr-computation" id="toc-ncr-computation" class="nav-link" data-scroll-target="#ncr-computation">522 nCr Computation</a></li>
  <li><a href="#pascals-triangle" id="toc-pascals-triangle" class="nav-link" data-scroll-target="#pascals-triangle">523 Pascal’s Triangle</a></li>
  <li><a href="#multiset-combination" id="toc-multiset-combination" class="nav-link" data-scroll-target="#multiset-combination">524 Multiset Combination</a></li>
  <li><a href="#permutation-generation" id="toc-permutation-generation" class="nav-link" data-scroll-target="#permutation-generation">525 Permutation Generation</a></li>
  <li><a href="#next-permutation" id="toc-next-permutation" class="nav-link" data-scroll-target="#next-permutation">526 Next Permutation</a></li>
  <li><a href="#subset-generation" id="toc-subset-generation" class="nav-link" data-scroll-target="#subset-generation">527 Subset Generation</a></li>
  <li><a href="#gray-code-generation" id="toc-gray-code-generation" class="nav-link" data-scroll-target="#gray-code-generation">528 Gray Code Generation</a></li>
  <li><a href="#catalan-number-dp" id="toc-catalan-number-dp" class="nav-link" data-scroll-target="#catalan-number-dp">529 Catalan Number DP</a></li>
  <li><a href="#stirling-numbers" id="toc-stirling-numbers" class="nav-link" data-scroll-target="#stirling-numbers">530 Stirling Numbers</a></li>
  </ul></li>
  <li><a href="#section-54.-probability-and-randomized-algorithms" id="toc-section-54.-probability-and-randomized-algorithms" class="nav-link" data-scroll-target="#section-54.-probability-and-randomized-algorithms">Section 54. Probability and Randomized Algorithms</a>
  <ul class="collapse">
  <li><a href="#monte-carlo-simulation" id="toc-monte-carlo-simulation" class="nav-link" data-scroll-target="#monte-carlo-simulation">531 Monte Carlo Simulation</a></li>
  <li><a href="#las-vegas-algorithm" id="toc-las-vegas-algorithm" class="nav-link" data-scroll-target="#las-vegas-algorithm">532 Las Vegas Algorithm</a></li>
  <li><a href="#reservoir-sampling" id="toc-reservoir-sampling" class="nav-link" data-scroll-target="#reservoir-sampling">533 Reservoir Sampling</a></li>
  <li><a href="#randomized-quicksort" id="toc-randomized-quicksort" class="nav-link" data-scroll-target="#randomized-quicksort">534 Randomized QuickSort</a></li>
  <li><a href="#randomized-quickselect" id="toc-randomized-quickselect" class="nav-link" data-scroll-target="#randomized-quickselect">535 Randomized QuickSelect</a></li>
  <li><a href="#birthday-paradox-simulation" id="toc-birthday-paradox-simulation" class="nav-link" data-scroll-target="#birthday-paradox-simulation">536 Birthday Paradox Simulation</a></li>
  <li><a href="#random-hashing" id="toc-random-hashing" class="nav-link" data-scroll-target="#random-hashing">537 Random Hashing</a></li>
  <li><a href="#random-walk-simulation" id="toc-random-walk-simulation" class="nav-link" data-scroll-target="#random-walk-simulation">538 Random Walk Simulation</a></li>
  <li><a href="#coupon-collector-estimation" id="toc-coupon-collector-estimation" class="nav-link" data-scroll-target="#coupon-collector-estimation">539 Coupon Collector Estimation</a></li>
  <li><a href="#markov-chain-simulation" id="toc-markov-chain-simulation" class="nav-link" data-scroll-target="#markov-chain-simulation">540 Markov Chain Simulation</a></li>
  </ul></li>
  <li><a href="#section-55.-sieve-methods-and-modular-math" id="toc-section-55.-sieve-methods-and-modular-math" class="nav-link" data-scroll-target="#section-55.-sieve-methods-and-modular-math">Section 55. Sieve Methods and Modular Math</a>
  <ul class="collapse">
  <li><a href="#sieve-of-eratosthenes-1" id="toc-sieve-of-eratosthenes-1" class="nav-link" data-scroll-target="#sieve-of-eratosthenes-1">541 Sieve of Eratosthenes</a></li>
  <li><a href="#linear-sieve" id="toc-linear-sieve" class="nav-link" data-scroll-target="#linear-sieve">542 Linear Sieve</a></li>
  <li><a href="#segmented-sieve-1" id="toc-segmented-sieve-1" class="nav-link" data-scroll-target="#segmented-sieve-1">543 Segmented Sieve</a></li>
  <li><a href="#spf-smallest-prime-factor-table" id="toc-spf-smallest-prime-factor-table" class="nav-link" data-scroll-target="#spf-smallest-prime-factor-table">544 SPF (Smallest Prime Factor) Table</a></li>
  <li><a href="#möbius-function-sieve" id="toc-möbius-function-sieve" class="nav-link" data-scroll-target="#möbius-function-sieve">545 Möbius Function Sieve</a></li>
  <li><a href="#eulers-totient-sieve" id="toc-eulers-totient-sieve" class="nav-link" data-scroll-target="#eulers-totient-sieve">546 Euler’s Totient Sieve</a></li>
  <li><a href="#divisor-count-sieve" id="toc-divisor-count-sieve" class="nav-link" data-scroll-target="#divisor-count-sieve">547 Divisor Count Sieve</a></li>
  <li><a href="#modular-precomputation" id="toc-modular-precomputation" class="nav-link" data-scroll-target="#modular-precomputation">548 Modular Precomputation</a></li>
  <li><a href="#fermats-little-theorem" id="toc-fermats-little-theorem" class="nav-link" data-scroll-target="#fermats-little-theorem">549 Fermat’s Little Theorem</a></li>
  <li><a href="#wilsons-theorem" id="toc-wilsons-theorem" class="nav-link" data-scroll-target="#wilsons-theorem">550 Wilson’s Theorem</a></li>
  </ul></li>
  <li><a href="#section-56.-linear-algebra" id="toc-section-56.-linear-algebra" class="nav-link" data-scroll-target="#section-56.-linear-algebra">Section 56. Linear Algebra</a>
  <ul class="collapse">
  <li><a href="#gaussian-elimination" id="toc-gaussian-elimination" class="nav-link" data-scroll-target="#gaussian-elimination">551 Gaussian Elimination</a></li>
  <li><a href="#gaussjordan-elimination" id="toc-gaussjordan-elimination" class="nav-link" data-scroll-target="#gaussjordan-elimination">552 Gauss–Jordan Elimination</a></li>
  <li><a href="#lu-decomposition" id="toc-lu-decomposition" class="nav-link" data-scroll-target="#lu-decomposition">553 LU Decomposition</a></li>
  <li><a href="#cholesky-decomposition" id="toc-cholesky-decomposition" class="nav-link" data-scroll-target="#cholesky-decomposition">554 Cholesky Decomposition</a></li>
  <li><a href="#qr-decomposition" id="toc-qr-decomposition" class="nav-link" data-scroll-target="#qr-decomposition">555 QR Decomposition</a></li>
  <li><a href="#matrix-inversion-gaussjordan-method" id="toc-matrix-inversion-gaussjordan-method" class="nav-link" data-scroll-target="#matrix-inversion-gaussjordan-method">556 Matrix Inversion (Gauss–Jordan Method)</a></li>
  <li><a href="#determinant-by-elimination" id="toc-determinant-by-elimination" class="nav-link" data-scroll-target="#determinant-by-elimination">557 Determinant by Elimination</a></li>
  <li><a href="#rank-of-a-matrix" id="toc-rank-of-a-matrix" class="nav-link" data-scroll-target="#rank-of-a-matrix">558 Rank of a Matrix</a></li>
  <li><a href="#eigenvalue-power-method" id="toc-eigenvalue-power-method" class="nav-link" data-scroll-target="#eigenvalue-power-method">559 Eigenvalue Power Method</a></li>
  <li><a href="#singular-value-decomposition-svd" id="toc-singular-value-decomposition-svd" class="nav-link" data-scroll-target="#singular-value-decomposition-svd">560 Singular Value Decomposition (SVD)</a></li>
  </ul></li>
  <li><a href="#section-57.-fft-and-ntt-fast-transforms" id="toc-section-57.-fft-and-ntt-fast-transforms" class="nav-link" data-scroll-target="#section-57.-fft-and-ntt-fast-transforms">Section 57. FFT and NTT (Fast Transforms)</a>
  <ul class="collapse">
  <li><a href="#discrete-fourier-transform-dft" id="toc-discrete-fourier-transform-dft" class="nav-link" data-scroll-target="#discrete-fourier-transform-dft">561 Discrete Fourier Transform (DFT)</a></li>
  <li><a href="#fast-fourier-transform-fft" id="toc-fast-fourier-transform-fft" class="nav-link" data-scroll-target="#fast-fourier-transform-fft">562 Fast Fourier Transform (FFT)</a></li>
  <li><a href="#cooleytukey-fft" id="toc-cooleytukey-fft" class="nav-link" data-scroll-target="#cooleytukey-fft">563 Cooley–Tukey FFT</a></li>
  <li><a href="#iterative-fft" id="toc-iterative-fft" class="nav-link" data-scroll-target="#iterative-fft">564 Iterative FFT</a></li>
  <li><a href="#inverse-fft-ifft" id="toc-inverse-fft-ifft" class="nav-link" data-scroll-target="#inverse-fft-ifft">565 Inverse FFT (IFFT)</a></li>
  <li><a href="#convolution-via-fft" id="toc-convolution-via-fft" class="nav-link" data-scroll-target="#convolution-via-fft">566 Convolution via FFT</a></li>
  <li><a href="#number-theoretic-transform-ntt" id="toc-number-theoretic-transform-ntt" class="nav-link" data-scroll-target="#number-theoretic-transform-ntt">567 Number Theoretic Transform (NTT)</a></li>
  <li><a href="#inverse-ntt-intt" id="toc-inverse-ntt-intt" class="nav-link" data-scroll-target="#inverse-ntt-intt">568 Inverse NTT (INTT)</a></li>
  <li><a href="#bluesteins-algorithm" id="toc-bluesteins-algorithm" class="nav-link" data-scroll-target="#bluesteins-algorithm">569 Bluestein’s Algorithm</a></li>
  <li><a href="#fft-based-multiplication" id="toc-fft-based-multiplication" class="nav-link" data-scroll-target="#fft-based-multiplication">570 FFT-Based Multiplication</a></li>
  </ul></li>
  <li><a href="#section-58.-numerical-methods" id="toc-section-58.-numerical-methods" class="nav-link" data-scroll-target="#section-58.-numerical-methods">Section 58. Numerical Methods</a>
  <ul class="collapse">
  <li><a href="#newtonraphson" id="toc-newtonraphson" class="nav-link" data-scroll-target="#newtonraphson">571 Newton–Raphson</a></li>
  <li><a href="#bisection-method" id="toc-bisection-method" class="nav-link" data-scroll-target="#bisection-method">572 Bisection Method</a></li>
  <li><a href="#secant-method" id="toc-secant-method" class="nav-link" data-scroll-target="#secant-method">573 Secant Method</a></li>
  <li><a href="#fixed-point-iteration" id="toc-fixed-point-iteration" class="nav-link" data-scroll-target="#fixed-point-iteration">574 Fixed-Point Iteration</a></li>
  <li><a href="#gaussian-quadrature" id="toc-gaussian-quadrature" class="nav-link" data-scroll-target="#gaussian-quadrature">575 Gaussian Quadrature</a></li>
  <li><a href="#simpsons-rule" id="toc-simpsons-rule" class="nav-link" data-scroll-target="#simpsons-rule">576 Simpson’s Rule</a></li>
  <li><a href="#trapezoidal-rule" id="toc-trapezoidal-rule" class="nav-link" data-scroll-target="#trapezoidal-rule">577 Trapezoidal Rule</a></li>
  <li><a href="#rungekutta-rk4-method" id="toc-rungekutta-rk4-method" class="nav-link" data-scroll-target="#rungekutta-rk4-method">578 Runge–Kutta (RK4) Method</a></li>
  <li><a href="#eulers-method" id="toc-eulers-method" class="nav-link" data-scroll-target="#eulers-method">579 Euler’s Method</a></li>
  <li><a href="#gradient-descent-1d-numerical-optimization" id="toc-gradient-descent-1d-numerical-optimization" class="nav-link" data-scroll-target="#gradient-descent-1d-numerical-optimization">580 Gradient Descent (1D Numerical Optimization)</a></li>
  </ul></li>
  <li><a href="#section-59.-mathematicial-optimization" id="toc-section-59.-mathematicial-optimization" class="nav-link" data-scroll-target="#section-59.-mathematicial-optimization">Section 59. Mathematicial Optimization</a>
  <ul class="collapse">
  <li><a href="#simplex-method" id="toc-simplex-method" class="nav-link" data-scroll-target="#simplex-method">581 Simplex Method</a></li>
  <li><a href="#dual-simplex-method" id="toc-dual-simplex-method" class="nav-link" data-scroll-target="#dual-simplex-method">582 Dual Simplex Method</a></li>
  <li><a href="#interior-point-method" id="toc-interior-point-method" class="nav-link" data-scroll-target="#interior-point-method">583 Interior-Point Method</a></li>
  <li><a href="#gradient-descent-unconstrained-optimization" id="toc-gradient-descent-unconstrained-optimization" class="nav-link" data-scroll-target="#gradient-descent-unconstrained-optimization">584 Gradient Descent (Unconstrained Optimization)</a></li>
  <li><a href="#stochastic-gradient-descent-sgd" id="toc-stochastic-gradient-descent-sgd" class="nav-link" data-scroll-target="#stochastic-gradient-descent-sgd">585 Stochastic Gradient Descent (SGD)</a></li>
  <li><a href="#newtons-method-multivariate-optimization" id="toc-newtons-method-multivariate-optimization" class="nav-link" data-scroll-target="#newtons-method-multivariate-optimization">586 Newton’s Method (Multivariate Optimization)</a></li>
  <li><a href="#conjugate-gradient-method" id="toc-conjugate-gradient-method" class="nav-link" data-scroll-target="#conjugate-gradient-method">587 Conjugate Gradient Method</a></li>
  <li><a href="#lagrange-multipliers-constrained-optimization" id="toc-lagrange-multipliers-constrained-optimization" class="nav-link" data-scroll-target="#lagrange-multipliers-constrained-optimization">588 Lagrange Multipliers (Constrained Optimization)</a></li>
  <li><a href="#karushkuhntucker-kkt-conditions" id="toc-karushkuhntucker-kkt-conditions" class="nav-link" data-scroll-target="#karushkuhntucker-kkt-conditions">589 Karush–Kuhn–Tucker (KKT) Conditions</a></li>
  <li><a href="#coordinate-descent" id="toc-coordinate-descent" class="nav-link" data-scroll-target="#coordinate-descent">590 Coordinate Descent</a></li>
  </ul></li>
  <li><a href="#section-60.-algebraic-tricks-and-transform-techniques" id="toc-section-60.-algebraic-tricks-and-transform-techniques" class="nav-link" data-scroll-target="#section-60.-algebraic-tricks-and-transform-techniques">Section 60. Algebraic Tricks and Transform Techniques</a>
  <ul class="collapse">
  <li><a href="#polynomial-multiplication-fft" id="toc-polynomial-multiplication-fft" class="nav-link" data-scroll-target="#polynomial-multiplication-fft">591 Polynomial Multiplication (FFT)</a></li>
  <li><a href="#polynomial-inversion-newton-iteration" id="toc-polynomial-inversion-newton-iteration" class="nav-link" data-scroll-target="#polynomial-inversion-newton-iteration">592 Polynomial Inversion (Newton Iteration)</a></li>
  <li><a href="#polynomial-derivative" id="toc-polynomial-derivative" class="nav-link" data-scroll-target="#polynomial-derivative">593 Polynomial Derivative</a></li>
  <li><a href="#polynomial-integration" id="toc-polynomial-integration" class="nav-link" data-scroll-target="#polynomial-integration">594 Polynomial Integration</a></li>
  <li><a href="#formal-power-series-composition" id="toc-formal-power-series-composition" class="nav-link" data-scroll-target="#formal-power-series-composition">595 Formal Power Series Composition</a></li>
  <li><a href="#exponentiation-by-squaring" id="toc-exponentiation-by-squaring" class="nav-link" data-scroll-target="#exponentiation-by-squaring">596 Exponentiation by Squaring</a></li>
  <li><a href="#modular-exponentiation-1" id="toc-modular-exponentiation-1" class="nav-link" data-scroll-target="#modular-exponentiation-1">597 Modular Exponentiation</a></li>
  <li><a href="#fast-walshhadamard-transform-fwht" id="toc-fast-walshhadamard-transform-fwht" class="nav-link" data-scroll-target="#fast-walshhadamard-transform-fwht">598 Fast Walsh–Hadamard Transform (FWHT)</a></li>
  <li><a href="#fast-walshhadamard-transform-fwht-1" id="toc-fast-walshhadamard-transform-fwht-1" class="nav-link" data-scroll-target="#fast-walshhadamard-transform-fwht-1">598 Fast Walsh–Hadamard Transform (FWHT)</a></li>
  <li><a href="#zeta-transform" id="toc-zeta-transform" class="nav-link" data-scroll-target="#zeta-transform">599 Zeta Transform</a></li>
  <li><a href="#möbius-inversion" id="toc-möbius-inversion" class="nav-link" data-scroll-target="#möbius-inversion">600 Möbius Inversion</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Chapter 6. Mathematics for Algorithms</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="section-51.-number-theory" class="level1">
<h1>Section 51. Number Theory</h1>
<section id="euclidean-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="euclidean-algorithm">501 Euclidean Algorithm</h3>
<p>The Euclidean Algorithm is one of the oldest and most elegant algorithms in mathematics. It finds the greatest common divisor (gcd) of two integers, the largest number that divides both without leaving a remainder.</p>
<p>It’s fast, simple, and forms the basis of modern number theory and cryptography.</p>
<section id="what-problem-are-we-solving" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving">What Problem Are We Solving?</h4>
<p>We want to compute:</p>
<p><span class="math display">\[
\text{gcd}(a, b)
\]</span></p>
<p>That is, the largest integer<span class="math inline">\(d\)</span> such that<span class="math inline">\(d \mid a\)</span> and<span class="math inline">\(d \mid b\)</span>.</p>
<p>Instead of checking every possible divisor, Euclid discovered a beautiful shortcut:</p>
<p><span class="math display">\[
\gcd(a, b) = \gcd(b, a \bmod b)
\]</span></p>
<p>Keep replacing the larger number by its remainder until one becomes zero. The last non-zero number is the gcd.</p>
<p>Example:</p>
<p><span class="math display">\[
\gcd(48, 18) = \gcd(18, 48 \bmod 18) = \gcd(18, 12) = \gcd(12, 6) = \gcd(6, 0) = 6
\]</span></p>
<p>So <span class="math inline">\(gcd(48, 18) = 6\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language">How Does It Work (Plain Language)?</h4>
<p>Think of gcd like peeling layers of remainders. Each step removes a chunk until nothing’s left. The number that “survives” all remainders is the gcd.</p>
<p>Let’s see it step by step:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>a</th>
<th>b</th>
<th>a mod b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>48</td>
<td>18</td>
<td>12</td>
</tr>
<tr class="even">
<td>2</td>
<td>18</td>
<td>12</td>
<td>6</td>
</tr>
<tr class="odd">
<td>3</td>
<td>12</td>
<td>6</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>When remainder becomes 0, stop. The other number (6) is the gcd.</p>
<p>Every step reduces the numbers quickly, so it runs in O(log min(a, b)) time, much faster than trying all divisors.</p>
</section>
<section id="tiny-code-easy-versions" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> gcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> r <span class="op">=</span> a <span class="op">%</span> b<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> r<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">,</span> b<span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter a and b: "</span><span class="op">);</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">);</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"gcd(</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d</span><span class="st">) = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> gcd<span class="op">(</span>a<span class="op">,</span> b<span class="op">));</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gcd(a, b):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> b <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> b, a <span class="op">%</span> b</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter a and b: "</span>).split())</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"gcd("</span>, a, <span class="st">","</span>, b, <span class="st">") ="</span>, gcd(a, b))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters">Why It Matters</h4>
<ul>
<li>Core of modular arithmetic, number theory, and cryptography.</li>
<li>Foundation for Extended Euclidean Algorithm (solving ax + by = gcd).</li>
<li>Used in modular inverses and Chinese Remainder Theorem.</li>
<li>Demonstrates algorithmic thinking: divide problem into smaller remainders.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works">A Gentle Proof (Why It Works)</h4>
<p>If<span class="math inline">\(a = bq + r\)</span>, then any divisor of<span class="math inline">\(a\)</span> and<span class="math inline">\(b\)</span> must also divide<span class="math inline">\(r\)</span>. So the set of common divisors of<span class="math inline">\((a, b)\)</span> equals that of<span class="math inline">\((b, r)\)</span>. Thus:</p>
<p><span class="math display">\[
\gcd(a, b) = \gcd(b, r)
\]</span></p>
<p>Repeatedly applying this equality until<span class="math inline">\(r = 0\)</span> reveals the gcd.</p>
<p>Because remainders shrink each step, the algorithm halts in at most<span class="math inline">\(O(\log n)\)</span> steps.</p>
</section>
<section id="try-it-yourself" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself">Try It Yourself</h4>
<ol type="1">
<li>Compute gcd(84, 30) by hand.</li>
<li>Trace the steps of gcd(210, 45).</li>
<li>Modify code to count number of steps.</li>
<li>Try with large numbers (e.g.&nbsp;123456, 789012).</li>
<li>Compare runtime with a naive divisor-checking method.</li>
</ol>
</section>
<section id="test-cases" class="level4">
<h4 class="anchored" data-anchor-id="test-cases">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>Steps</th>
<th>gcd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>48</td>
<td>18</td>
<td>3</td>
<td>6</td>
</tr>
<tr class="even">
<td>84</td>
<td>30</td>
<td>3</td>
<td>6</td>
</tr>
<tr class="odd">
<td>210</td>
<td>45</td>
<td>3</td>
<td>15</td>
</tr>
<tr class="even">
<td>101</td>
<td>10</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td>270</td>
<td>192</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity" class="level4">
<h4 class="anchored" data-anchor-id="complexity">Complexity</h4>
<ul>
<li>Time: O(log min(a, b))</li>
<li>Space: O(1) (iterative) or O(log n) (recursive)</li>
</ul>
<p>The Euclidean Algorithm shows the power of simplicity: divide, reduce, and repeat, a timeless idea that still beats inside modern computation.</p>
</section>
</section>
<section id="extended-euclidean-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="extended-euclidean-algorithm">502 Extended Euclidean Algorithm</h3>
<p>The Extended Euclidean Algorithm goes one step beyond the classic gcd: it not only finds the gcd(a, b) but also gives you x and y such that</p>
<p><span class="math display">\[
a \cdot x + b \cdot y = \gcd(a, b)
\]</span></p>
<p>These coefficients (x, y) are the key to solving Diophantine equations and finding modular inverses, which are essential in cryptography, modular arithmetic, and algorithm design.</p>
<section id="what-problem-are-we-solving-1" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-1">What Problem Are We Solving?</h4>
<p>We want to solve the linear equation:</p>
<p><span class="math display">\[
a x + b y = \gcd(a, b)
\]</span></p>
<p>Given integers a and b, we need integers x and y that satisfy this equation. The Euclidean algorithm gives the gcd, but we can trace back its steps to express the gcd as a combination of a and b.</p>
<p>Example: Find x, y such that <span class="math display">\[
240x + 46y = \gcd(240, 46)
\]</span></p>
<p>We know gcd(240, 46) = 2. The Extended Euclidean Algorithm gives: <span class="math display">\[
2 = 240(-9) + 46(47)
\]</span> So (x = -9, y = 47).</p>
</section>
<section id="how-does-it-work-plain-language-1" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-1">How Does It Work (Plain Language)?</h4>
<p>Think of it as “remembering” how each remainder was made during the gcd process.</p>
<p>In each step: <span class="math display">\[
a = bq + r \quad \Rightarrow \quad r = a - bq
\]</span></p>
<p>We recursively compute gcd(b, r), and when unwinding, we rewrite each remainder in terms of a and b.</p>
<p>Step-by-step for (240, 46):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>a</th>
<th>b</th>
<th>a % b</th>
<th>Equation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>240</td>
<td>46</td>
<td>10</td>
<td>240 = 46×5 + 10</td>
</tr>
<tr class="even">
<td>2</td>
<td>46</td>
<td>10</td>
<td>6</td>
<td>46 = 10×4 + 6</td>
</tr>
<tr class="odd">
<td>3</td>
<td>10</td>
<td>6</td>
<td>4</td>
<td>10 = 6×1 + 4</td>
</tr>
<tr class="even">
<td>4</td>
<td>6</td>
<td>4</td>
<td>2</td>
<td>6 = 4×1 + 2</td>
</tr>
<tr class="odd">
<td>5</td>
<td>4</td>
<td>2</td>
<td>0</td>
<td>Stop, gcd = 2</td>
</tr>
</tbody>
</table>
<p>Now backtrack:</p>
<ul>
<li>2 = 6 − 4×1</li>
<li>4 = 10 − 6×1</li>
<li>6 = 46 − 10×4</li>
<li>10 = 240 − 46×5</li>
</ul>
<p>Substitute upward until gcd is in the form 240x + 46y.</p>
</section>
<section id="tiny-code-easy-versions-1" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-1">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> extended_gcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>x<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x1<span class="op">,</span> y1<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> g <span class="op">=</span> extended_gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">,</span> <span class="op">&amp;</span>x1<span class="op">,</span> <span class="op">&amp;</span>y1<span class="op">);</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>x <span class="op">=</span> y1<span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>y <span class="op">=</span> x1 <span class="op">-</span> <span class="op">(</span>a <span class="op">/</span> b<span class="op">)</span> <span class="op">*</span> y1<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">,</span> b<span class="op">,</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter a and b: "</span><span class="op">);</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">);</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> g <span class="op">=</span> extended_gcd<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"gcd(</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d</span><span class="st">) = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> g<span class="op">);</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Coefficients: x = </span><span class="sc">%d</span><span class="st">, y = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extended_gcd(a, b):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> b <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a, <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    g, x1, y1 <span class="op">=</span> extended_gcd(b, a <span class="op">%</span> b)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> y1</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> x1 <span class="op">-</span> (a <span class="op">//</span> b) <span class="op">*</span> y1</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g, x, y</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter a and b: "</span>).split())</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>g, x, y <span class="op">=</span> extended_gcd(a, b)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"gcd(</span><span class="sc">{</span>a<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>b<span class="sc">}</span><span class="ss">) = </span><span class="sc">{</span>g<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"x = </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">, y = </span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-1" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-1">Why It Matters</h4>
<ul>
<li>Builds the modular inverse:<span class="math inline">\(a^{-1} \equiv x \pmod{m}\)</span> if gcd(a, m) = 1</li>
<li>Solves linear Diophantine equations</li>
<li>Used in RSA cryptography, CRT, and modular arithmetic</li>
<li>Converts gcd into a linear combination of inputs</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-1" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-1">A Gentle Proof (Why It Works)</h4>
<p>At each step: <span class="math display">\[
\gcd(a, b) = \gcd(b, a \bmod b)
\]</span> If we know <span class="math inline">\(b x' + (a \bmod b) y' = \gcd(a, b)\)</span>, and since <span class="math inline">\(a \bmod b = a - b\lfloor a/b \rfloor\)</span>, we can write: <span class="math display">\[
\gcd(a, b) = a y' + b(x' - \lfloor a/b \rfloor y')
\]</span></p>
<p>Set <span class="math inline">\(x = y'\)</span>, <span class="math inline">\(y = x' - \lfloor a/b \rfloor y'\)</span>.</p>
<p>This gives the recurrence for coefficients (x, y).</p>
</section>
<section id="try-it-yourself-1" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-1">Try It Yourself</h4>
<ol type="1">
<li>Solve (240x + 46y = 2) by hand.</li>
<li>Verify gcd(99, 78) = 3 and find x, y.</li>
<li>Find modular inverse of 3 mod 11 using extended gcd.</li>
<li>Modify the code to return only modular inverse.</li>
<li>Trace recursive calls for (99, 78).</li>
</ol>
</section>
<section id="test-cases-1" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-1">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>gcd</th>
<th>x</th>
<th>y</th>
<th>Check</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>240</td>
<td>46</td>
<td>2</td>
<td>-9</td>
<td>47</td>
<td>240(-9)+46(47)=2</td>
</tr>
<tr class="even">
<td>99</td>
<td>78</td>
<td>3</td>
<td>-11</td>
<td>14</td>
<td>99(-11)+78(14)=3</td>
</tr>
<tr class="odd">
<td>35</td>
<td>15</td>
<td>5</td>
<td>1</td>
<td>-2</td>
<td>35(1)+15(-2)=5</td>
</tr>
<tr class="even">
<td>7</td>
<td>5</td>
<td>1</td>
<td>-2</td>
<td>3</td>
<td>7(-2)+5(3)=1</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-1" class="level4">
<h4 class="anchored" data-anchor-id="complexity-1">Complexity</h4>
<ul>
<li>Time: O(log min(a, b))</li>
<li>Space: O(log n) (recursion depth)</li>
</ul>
<p>The Extended Euclidean Algorithm is the “memory” of gcd, not just finding the divisor, but showing how it’s made.</p>
</section>
</section>
<section id="modular-addition" class="level3">
<h3 class="anchored" data-anchor-id="modular-addition">503 Modular Addition</h3>
<p>Modular addition is like wrapping numbers around a circle. Once you reach the end, you loop back to the start. This operation lies at the heart of modular arithmetic, the arithmetic of clocks, cryptography, and hashing.</p>
<p>When we add numbers under a modulus M, we always stay within the range [0, M−1].</p>
<section id="what-problem-are-we-solving-2" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-2">What Problem Are We Solving?</h4>
<p>We want to compute the sum of two numbers under modulo M:</p>
<p><span class="math display">\[
(a + b) \bmod M
\]</span></p>
<p>Example: Let<span class="math inline">\(a = 17, b = 12, M = 10\)</span></p>
<p><span class="math display">\[
(17 + 12) \bmod 10 = 29 \bmod 10 = 9
\]</span></p>
<p>So we “wrap around” after every 10.</p>
</section>
<section id="how-does-it-work-plain-language-2" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-2">How Does It Work (Plain Language)?</h4>
<p>Imagine a clock with M hours. If you move forward a hours, then b hours, where do you land?</p>
<p>You just add and take the remainder by M.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>M</th>
<th>a + b</th>
<th>(a + b) mod M</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>17</td>
<td>12</td>
<td>10</td>
<td>29</td>
<td>9</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>7</td>
<td>5</td>
<td>15</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>25</td>
<td>25</td>
<td>7</td>
<td>50</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>It’s addition with “wrap-around” when crossing multiples of M.</p>
</section>
<section id="tiny-code-easy-versions-2" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-2">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> mod_add<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> M<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> res <span class="op">=</span> <span class="op">(</span>a <span class="op">%</span> M <span class="op">+</span> b <span class="op">%</span> M<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>res <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> res <span class="op">+=</span> M<span class="op">;</span> <span class="co">// handle negative values</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">,</span> b<span class="op">,</span> M<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter a, b, M: "</span><span class="op">);</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">,</span> <span class="op">&amp;</span>M<span class="op">);</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"(a + b) mod M = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> mod_add<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> M<span class="op">));</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mod_add(a, b, M):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (a <span class="op">%</span> M <span class="op">+</span> b <span class="op">%</span> M) <span class="op">%</span> M</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>a, b, M <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter a, b, M: "</span>).split())</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"(a + b) mod M ="</span>, mod_add(a, b, M))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-2" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-2">Why It Matters</h4>
<ul>
<li>Forms the base operation in modular arithmetic</li>
<li>Used in cryptographic algorithms (RSA, Diffie-Hellman)</li>
<li>Ensures no overflow in fixed-size computations</li>
<li>Supports hashing, ring arithmetic, and checksum calculations</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-2" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-2">A Gentle Proof (Why It Works)</h4>
<p>Let<span class="math inline">\(a = Mq_1 + r_1\)</span> and<span class="math inline">\(b = Mq_2 + r_2\)</span>. Then: <span class="math display">\[
a + b = M(q_1 + q_2) + (r_1 + r_2)
\]</span> So, <span class="math display">\[
(a + b) \bmod M = (r_1 + r_2) \bmod M = (a \bmod M + b \bmod M) \bmod M
\]</span> This is the modular addition property.</p>
</section>
<section id="try-it-yourself-2" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-2">Try It Yourself</h4>
<ol type="1">
<li>Compute (25 + 37) mod 12.</li>
<li>Compute (−3 + 5) mod 7.</li>
<li>Modify code to handle 3 numbers: (a + b + c) mod M.</li>
<li>Write modular subtraction: (a − b) mod M.</li>
<li>Explore pattern table for M = 5.</li>
</ol>
</section>
<section id="test-cases-2" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-2">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>M</th>
<th>(a + b) mod M</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>17</td>
<td>12</td>
<td>10</td>
<td>9</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>25</td>
<td>25</td>
<td>7</td>
<td>1</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>-3</td>
<td>5</td>
<td>7</td>
<td>2</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>8</td>
<td>8</td>
<td>5</td>
<td>1</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>0</td>
<td>9</td>
<td>4</td>
<td>1</td>
<td>Ok</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-2" class="level4">
<h4 class="anchored" data-anchor-id="complexity-2">Complexity</h4>
<ul>
<li>Time: O(1)</li>
<li>Space: O(1)</li>
</ul>
<p>Modular addition is arithmetic on a loop, every sum bends back into a finite world, keeping numbers tidy and elegant.</p>
</section>
</section>
<section id="modular-multiplication" class="level3">
<h3 class="anchored" data-anchor-id="modular-multiplication">504 Modular Multiplication</h3>
<p>Modular multiplication is arithmetic in a wrapped world, just like modular addition, but with repeated addition. When you multiply two numbers under a modulus M, you keep only the remainder, ensuring the result stays in [0, M−1].</p>
<p>It’s the backbone of fast exponentiation, hashing, cryptography, and number-theoretic transforms.</p>
<section id="what-problem-are-we-solving-3" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-3">What Problem Are We Solving?</h4>
<p>We want to compute:</p>
<p><span class="math display">\[
(a \times b) \bmod M
\]</span></p>
<p>Example: Let<span class="math inline">\(a = 7, b = 8, M = 5\)</span></p>
<p><span class="math display">\[
(7 \times 8) \bmod 5 = 56 \bmod 5 = 1
\]</span></p>
<p>So 7×8 “wraps” around the circle of size 5 and lands at 1.</p>
</section>
<section id="how-does-it-work-plain-language-3" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-3">How Does It Work (Plain Language)?</h4>
<p>Think of modular multiplication as repeated modular addition:</p>
<p><span class="math display">\[
(a \times b) \bmod M = (a \bmod M + a \bmod M + \dots) \bmod M
\]</span> (repeat b times)</p>
<p>We can simplify it with this identity: <span class="math display">\[
(a \times b) \bmod M = ((a \bmod M) \times (b \bmod M)) \bmod M
\]</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>M</th>
<th>a×b</th>
<th>(a×b) mod M</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>5</td>
<td>56</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>25</td>
<td>4</td>
<td>7</td>
<td>100</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>12</td>
<td>13</td>
<td>10</td>
<td>156</td>
<td>6</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>For large values, we avoid overflow by applying modular reduction at each step.</p>
</section>
<section id="tiny-code-easy-versions-3" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-3">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> mod_mul<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> M<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> M<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    b <span class="op">%=</span> M<span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="op">(</span>a <span class="op">*</span> b<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>res <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> res <span class="op">+=</span> M<span class="op">;</span> <span class="co">// handle negatives</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> b<span class="op">,</span> M<span class="op">;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter a, b, M: "</span><span class="op">);</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">,</span> <span class="op">&amp;</span>M<span class="op">);</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"(a * b) mod M = </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> mod_mul<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> M<span class="op">));</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mod_mul(a, b, M):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (a <span class="op">%</span> M <span class="op">*</span> b <span class="op">%</span> M) <span class="op">%</span> M</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>a, b, M <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter a, b, M: "</span>).split())</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"(a * b) mod M ="</span>, mod_mul(a, b, M))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>For very large numbers, use modular multiplication by addition (to avoid overflow):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mod_mul_safe(a, b, M):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> M</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> b <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> b <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> (res <span class="op">+</span> a) <span class="op">%</span> M</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> a) <span class="op">%</span> M</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        b <span class="op">//=</span> <span class="dv">2</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-3" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-3">Why It Matters</h4>
<ul>
<li>Essential in modular exponentiation and cryptography (RSA, Diffie-Hellman)</li>
<li>Avoids overflow in arithmetic under modulus</li>
<li>Core operation for Number Theoretic Transform (NTT) and hash functions</li>
<li>Supports building modular inverses, power functions, and polynomial arithmetic</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-3" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-3">A Gentle Proof (Why It Works)</h4>
<p>Let<span class="math inline">\(a = q_1 M + r_1\)</span>,<span class="math inline">\(b = q_2 M + r_2\)</span>.</p>
<p>Then: <span class="math display">\[
a \times b = M(q_1 b + q_2 a - q_1 q_2 M) + r_1 r_2
\]</span> So modulo M, all multiples of M vanish: <span class="math display">\[
(a \times b) \bmod M = (r_1 \times r_2) \bmod M
\]</span> Hence, <span class="math display">\[
(a \times b) \bmod M = ((a \bmod M) \times (b \bmod M)) \bmod M
\]</span></p>
</section>
<section id="try-it-yourself-3" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-3">Try It Yourself</h4>
<ol type="1">
<li>Compute (25 × 13) mod 7.</li>
<li>Try (−3 × 8) mod 5.</li>
<li>Modify code to handle negative inputs.</li>
<li>Write modular multiplication using repeated doubling (like binary exponentiation).</li>
<li>Create a table of (a×b) mod 6 for a, b ∈ [0,5].</li>
</ol>
</section>
<section id="test-cases-3" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-3">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>M</th>
<th>(a×b) mod M</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>5</td>
<td>1</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>25</td>
<td>4</td>
<td>7</td>
<td>2</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>-3</td>
<td>8</td>
<td>5</td>
<td>1</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>12</td>
<td>13</td>
<td>10</td>
<td>6</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>1000000000</td>
<td>1000000000</td>
<td>1000000007</td>
<td>49</td>
<td>Ok</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-3" class="level4">
<h4 class="anchored" data-anchor-id="complexity-3">Complexity</h4>
<ul>
<li>Time: O(1) (with built-in multiplication), O(log b) (with safe doubling)</li>
<li>Space: O(1)</li>
</ul>
<p>Modular multiplication keeps arithmetic stable and predictable, no matter how large the numbers, everything folds back neatly into the modular ring.</p>
</section>
</section>
<section id="modular-exponentiation" class="level3">
<h3 class="anchored" data-anchor-id="modular-exponentiation">505 Modular Exponentiation</h3>
<p>Modular exponentiation is the art of raising a number to a power under a modulus, efficiently. Instead of multiplying (a) by itself (b) times (which would be far too slow), we square and reduce step by step. This technique powers cryptography, hashing, number theory, and fast algorithms for huge exponents.</p>
<section id="what-problem-are-we-solving-4" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-4">What Problem Are We Solving?</h4>
<p>We want to compute:</p>
<p><span class="math display">\[
a^b \bmod M
\]</span></p>
<p>directly, without overflow and without looping (b) times.</p>
<p>Example: Let<span class="math inline">\(a = 3, b = 13, M = 7\)</span></p>
<p>Naively: <span class="math display">\[
3^{13} = 1594323 \quad \Rightarrow \quad 1594323 \bmod 7 = 5
\]</span></p>
<p>Efficiently, we can do it with squaring: <span class="math display">\[
3^{13} \bmod 7 = ((3^8 \cdot 3^4 \cdot 3^1) \bmod 7) = 5
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-4" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-4">How Does It Work (Plain Language)?</h4>
<p>We use exponentiation by squaring. Break the exponent into binary. For each bit, either square or square and multiply.</p>
<p>If (b) is even: <span class="math display">\[
a^b = (a^{b/2})^2
\]</span> If (b) is odd: <span class="math display">\[
a^b = a \cdot a^{b-1}
\]</span></p>
<p>Always take modulo after every multiplication to keep numbers small.</p>
<p>Example: <span class="math inline">\((a=3,\ b=13,\ M=7)\)</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 17%">
<col style="width: 58%">
<col style="width: 3%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>b (binary)</th>
<th>a</th>
<th>b</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1101</td>
<td>3</td>
<td>13</td>
<td>res = 1</td>
</tr>
<tr class="even">
<td>2</td>
<td>odd</td>
<td>res = <span class="math inline">\((1\times3)\bmod7=3\)</span>, <span class="math inline">\(a=(3\times3)\bmod7=2\)</span>, <span class="math inline">\(b=6\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td>even</td>
<td>res = 3, <span class="math inline">\(a=(2\times2)\bmod7=4\)</span>, <span class="math inline">\(b=3\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td>odd</td>
<td>res = <span class="math inline">\((3\times4)\bmod7=5\)</span>, <span class="math inline">\(a=(4\times4)\bmod7=2\)</span>, <span class="math inline">\(b=1\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>5</td>
<td>odd</td>
<td>res = <span class="math inline">\((5\times2)\bmod7=3\)</span>, <span class="math inline">\(a=(2\times2)\bmod7=4\)</span>, <span class="math inline">\(b=0\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Result = 3, which is <span class="math inline">\(3^{13} \bmod 7\)</span>.</p>
</section>
<section id="tiny-code-easy-versions-4" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-4">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> mod_pow<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> M<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> M<span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>b <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> <span class="op">(</span>res <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="op">(</span>a <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        b <span class="op">/=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> b<span class="op">,</span> M<span class="op">;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter a, b, M: "</span><span class="op">);</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">,</span> <span class="op">&amp;</span>M<span class="op">);</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st">^</span><span class="sc">%lld</span><span class="st"> mod </span><span class="sc">%lld</span><span class="st"> = </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> M<span class="op">,</span> mod_pow<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> M<span class="op">));</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mod_pow(a, b, M):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> M</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> b <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> b <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> (res <span class="op">*</span> a) <span class="op">%</span> M</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (a <span class="op">*</span> a) <span class="op">%</span> M</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        b <span class="op">//=</span> <span class="dv">2</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>a, b, M <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter a, b, M: "</span>).split())</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>a<span class="sc">}</span><span class="ss">^</span><span class="sc">{</span>b<span class="sc">}</span><span class="ss"> mod </span><span class="sc">{</span>M<span class="sc">}</span><span class="ss"> ="</span>, mod_pow(a, b, M))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Or simply:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">pow</span>(a, b, M)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>(Python’s built-in pow handles this efficiently.)</p>
</section>
<section id="why-it-matters-4" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-4">Why It Matters</h4>
<ul>
<li>Core operation in RSA, Diffie-Hellman, and ElGamal</li>
<li>Needed for Fermat’s Little Theorem and modular inverses</li>
<li>Enables fast exponentiation without overflow</li>
<li>Turns exponentiation from O(b) to O(log b)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-4" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-4">A Gentle Proof (Why It Works)</h4>
<p>Every exponent can be written in binary: <span class="math display">\[
b = \sum_{i=0}^{k} b_i \cdot 2^i
\]</span></p>
<p>Then: <span class="math display">\[
a^b = \prod_{i=0}^{k} (a^{2^i})^{b_i}
\]</span></p>
<p>We precompute <span class="math inline">\(a^{2^i}\)</span> by squaring, and multiply only where (b_i = 1). Each squaring and multiplication is followed by modulo reduction, so numbers stay small.</p>
</section>
<section id="try-it-yourself-4" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-4">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(2^{10} \bmod 1000\)</span>.</li>
<li>Compute <span class="math inline">\(5^{117} \bmod 19\)</span>.</li>
<li>Modify the code to print each step (trace exponentiation).</li>
<li>Compare runtime with naive power.</li>
<li>Use pow(a, b, M) and verify same result.</li>
</ol>
</section>
<section id="test-cases-4" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-4">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>M</th>
<th>Result</th>
<th>Check</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>13</td>
<td>7</td>
<td>5</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>2</td>
<td>10</td>
<td>1000</td>
<td>24</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>5</td>
<td>117</td>
<td>19</td>
<td>1</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>10</td>
<td>9</td>
<td>6</td>
<td>4</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>7</td>
<td>222</td>
<td>13</td>
<td>9</td>
<td>Ok</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-4" class="level4">
<h4 class="anchored" data-anchor-id="complexity-4">Complexity</h4>
<ul>
<li>Time: O(log b)</li>
<li>Space: O(1) (iterative) or O(log b) (recursive)</li>
</ul>
<p>Modular exponentiation is how we tame huge powers, turning exponential growth into a fast, logarithmic dance under the modulus.</p>
</section>
</section>
<section id="modular-inverse" class="level3">
<h3 class="anchored" data-anchor-id="modular-inverse">506 Modular Inverse</h3>
<p>The modular inverse is the number that undoes multiplication under a modulus. If <span class="math inline">\(a \cdot x \equiv 1 \pmod{M}\)</span>, then (x) is called the modular inverse of (a) modulo (M).</p>
<p>It’s the key to dividing in modular arithmetic, since division isn’t directly defined, we multiply by an inverse instead.</p>
<section id="what-problem-are-we-solving-5" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-5">What Problem Are We Solving?</h4>
<p>We want to solve:</p>
<p><span class="math display">\[
a \cdot x \equiv 1 \pmod{M}
\]</span></p>
<p>That means find <span class="math inline">\(x\)</span> such that:</p>
<p><span class="math display">\[
(a \times x) \bmod M = 1
\]</span></p>
<p>This <span class="math inline">\(x\)</span> is called the modular multiplicative inverse of <span class="math inline">\(a\)</span> modulo <span class="math inline">\(M\)</span>.</p>
<p>Example:</p>
<p>Find the inverse of <span class="math inline">\(3 \pmod{11}\)</span>.</p>
<p>We need:</p>
<p><span class="math display">\[
3 \cdot x \equiv 1 \pmod{11}
\]</span></p>
<p>Try <span class="math inline">\(x = 4\)</span>:</p>
<p><span class="math display">\[
3 \cdot 4 = 12 \equiv 1 \pmod{11}
\]</span></p>
<p>Therefore:</p>
<p><span class="math display">\[
3^{-1} \equiv 4 \pmod{11}
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-5" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-5">How Does It Work (Plain Language)?</h4>
<p>There are two main ways to find the modular inverse:</p>
<ol type="1">
<li>Extended Euclidean Algorithm (works for all when gcd(a, M) = 1)</li>
<li>Fermat’s Little Theorem (works if M is prime)</li>
</ol>
<section id="extended-euclidean-method" class="level5">
<h5 class="anchored" data-anchor-id="extended-euclidean-method">1. Extended Euclidean Method</h5>
<p>We solve:</p>
<p><span class="math display">\[
a x + M y = 1
\]</span></p>
<p>The coefficient <span class="math inline">\(x \bmod M\)</span> is the modular inverse.</p>
<p>Example:</p>
<p>Find the inverse of <span class="math inline">\(3 \bmod 11\)</span>.</p>
<p>Use the extended Euclidean algorithm:</p>
<p><span class="math display">\[
\begin{aligned}
11 &amp;= 3 \times 3 + 2 \\
3  &amp;= 2 \times 1 + 1 \\
2  &amp;= 1 \times 2 + 0
\end{aligned}
\]</span></p>
<p>Backtrack:</p>
<p><span class="math display">\[
\begin{aligned}
1 &amp;= 3 - 2 \times 1 \\
  &amp;= 3 - (11 - 3 \times 3) \\
  &amp;= 4 \times 3 - 1 \times 11
\end{aligned}
\]</span></p>
<p>So <span class="math inline">\(x = 4\)</span>.</p>
<p>Hence,</p>
<p><span class="math display">\[
3^{-1} \equiv 4 \pmod{11}
\]</span></p>
</section>
<section id="fermats-little-theorem-prime-m" class="level5">
<h5 class="anchored" data-anchor-id="fermats-little-theorem-prime-m">2. Fermat’s Little Theorem (Prime M)</h5>
<p>If <span class="math inline">\(M\)</span> is prime and <span class="math inline">\(a \not\equiv 0 \pmod{M}\)</span>, then:</p>
<p><span class="math display">\[
a^{M-1} \equiv 1 \pmod{M}
\]</span></p>
<p>Multiply both sides by <span class="math inline">\(a^{-1}\)</span>:</p>
<p><span class="math display">\[
a^{M-2} \equiv a^{-1} \pmod{M}
\]</span></p>
<p>So the modular inverse is:</p>
<p><span class="math display">\[
a^{-1} = a^{M-2} \bmod M
\]</span></p>
<p>Example:</p>
<p><span class="math display">\[
3^{-1} \pmod{11} = 3^{9} \bmod 11 = 4
\]</span></p>
</section>
</section>
<section id="tiny-code-easy-versions-5" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-5">Tiny Code (Easy Versions)</h4>
<p>C Version (Extended GCD)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> extended_gcd<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> <span class="op">*</span>x<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> <span class="op">*</span>y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x1<span class="op">,</span> y1<span class="op">;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> g <span class="op">=</span> extended_gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">,</span> <span class="op">&amp;</span>x1<span class="op">,</span> <span class="op">&amp;</span>y1<span class="op">);</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>x <span class="op">=</span> y1<span class="op">;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>y <span class="op">=</span> x1 <span class="op">-</span> <span class="op">(</span>a <span class="op">/</span> b<span class="op">)</span> <span class="op">*</span> y1<span class="op">;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> mod_inverse<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> M<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> g <span class="op">=</span> extended_gcd<span class="op">(</span>a<span class="op">,</span> M<span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>g <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span> <span class="co">// no inverse if gcd ≠ 1</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="op">(</span>x <span class="op">%</span> M <span class="op">+</span> M<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> M<span class="op">;</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter a, M: "</span><span class="op">);</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>M<span class="op">);</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> inv <span class="op">=</span> mod_inverse<span class="op">(</span>a<span class="op">,</span> M<span class="op">);</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>inv <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"No inverse exists.</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"Inverse of </span><span class="sc">%lld</span><span class="st"> mod </span><span class="sc">%lld</span><span class="st"> = </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">,</span> M<span class="op">,</span> inv<span class="op">);</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mod_inverse(a, M):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extended_gcd(a, b):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> b <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> a, <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        g, x1, y1 <span class="op">=</span> extended_gcd(b, a <span class="op">%</span> b)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> y1</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> x1 <span class="op">-</span> (a <span class="op">//</span> b) <span class="op">*</span> y1</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> g, x, y</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    g, x, y <span class="op">=</span> extended_gcd(a, M)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> g <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">%</span> M</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>a, M <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter a, M: "</span>).split())</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>inv <span class="op">=</span> mod_inverse(a, M)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Inverse:"</span>, inv <span class="cf">if</span> inv <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">else</span> <span class="st">"None"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python (Prime Modulus with Fermat)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mod_inverse_prime(a, M):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">pow</span>(a, M <span class="op">-</span> <span class="dv">2</span>, M)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-5" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-5">Why It Matters</h4>
<ul>
<li>Enables division in modular arithmetic</li>
<li>Critical in RSA, CRT, Elliptic Curves, and hashing</li>
<li>Used to solve equations like <span class="math inline">\(a x \equiv b \pmod{M}\)</span></li>
<li>Basis for solving linear congruences and modular systems</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-5" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-5">A Gentle Proof (Why It Works)</h4>
<p>If <span class="math inline">\(\gcd(a, M) = 1\)</span>, By Bézout’s identity: <span class="math display">\[
a x + M y = 1
\]</span> Taking modulo M: <span class="math display">\[
a x \equiv 1 \pmod{M}
\]</span> Thus, (x) is the modular inverse of (a).</p>
</section>
<section id="try-it-yourself-5" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-5">Try It Yourself</h4>
<ol type="1">
<li>Find <span class="math inline">\(5^{-1} \pmod{7}\)</span>.</li>
<li>Find <span class="math inline">\(10^{-1} \pmod{17}\)</span>.</li>
<li>Check which numbers have no inverse mod <span class="math inline">\(8\)</span>.</li>
<li>Implement both Extended GCD and Fermat versions.</li>
<li>Solve <span class="math inline">\(7x \equiv 3 \pmod{13}\)</span> using an inverse.</li>
</ol>
</section>
<section id="test-cases-5" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-5">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>M</th>
<th>Inverse</th>
<th>Check</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>11</td>
<td>4</td>
<td><span class="math inline">\(3 \times 4 = 12 \equiv 1\)</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>7</td>
<td>3</td>
<td><span class="math inline">\(5 \times 3 = 15 \equiv 1\)</span></td>
</tr>
<tr class="odd">
<td>10</td>
<td>17</td>
<td>12</td>
<td><span class="math inline">\(10 \times 12 = 120 \equiv 1\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>None</td>
<td><span class="math inline">\(\gcd(2,4) \ne 1\)</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>13</td>
<td>2</td>
<td><span class="math inline">\(7 \times 2 = 14 \equiv 1\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-5" class="level4">
<h4 class="anchored" data-anchor-id="complexity-5">Complexity</h4>
<ul>
<li>Extended GCD: O(log M)</li>
<li>Fermat’s (prime M): O(log M) (via modular exponentiation)</li>
<li>Space: O(1) iterative</li>
</ul>
<p>The modular inverse is the key that unlocks division in the modular world, where every valid number has its own mirror multiplier that brings you back to 1.</p>
</section>
</section>
<section id="chinese-remainder-theorem" class="level3">
<h3 class="anchored" data-anchor-id="chinese-remainder-theorem">507 Chinese Remainder Theorem</h3>
<p>The Chinese Remainder Theorem (CRT) is a beautiful bridge between congruences. It lets you solve systems of modular equations, combining many modular worlds into one consistent solution. Originally described over two thousand years ago, it remains a cornerstone of modern number theory and cryptography.</p>
<section id="what-problem-are-we-solving-6" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-6">What Problem Are We Solving?</h4>
<p>We want an integer <span class="math inline">\(x\)</span> that satisfies a system of congruences:</p>
<p><span class="math display">\[
\begin{cases}
x \equiv a_1 \pmod{m_1} \\
x \equiv a_2 \pmod{m_2} \\
\vdots \\
x \equiv a_k \pmod{m_k}
\end{cases}
\]</span></p>
<p>If the moduli <span class="math inline">\(m_1,m_2,\dots,m_k\)</span> are pairwise coprime, there is a unique solution modulo <span class="math display">\[
M = m_1 m_2 \cdots m_k.
\]</span></p>
<p>Example</p>
<p>Find <span class="math inline">\(x\)</span> such that <span class="math display">\[
\begin{cases}
x \equiv 2 \pmod{3} \\
x \equiv 3 \pmod{4} \\
x \equiv 2 \pmod{5}
\end{cases}
\]</span></p>
<p>Compute <span class="math display">\[
M = 3 \cdot 4 \cdot 5 = 60,\quad
M_1 = \frac{M}{3}=20,\quad
M_2 = \frac{M}{4}=15,\quad
M_3 = \frac{M}{5}=12.
\]</span></p>
<p>Find inverses <span class="math display">\[
20^{-1} \pmod{3} = 2,\quad
15^{-1} \pmod{4} = 3,\quad
12^{-1} \pmod{5} = 3.
\]</span></p>
<p>Combine <span class="math display">\[
x = 2\cdot 20\cdot 2 \;+\; 3\cdot 15\cdot 3 \;+\; 2\cdot 12\cdot 3
  = 80 + 135 + 72 = 287.
\]</span></p>
<p>Reduce modulo <span class="math inline">\(60\)</span> <span class="math display">\[
x \equiv 287 \bmod 60 = 47.
\]</span></p>
<p>So the solution is <span class="math display">\[
x \equiv 47 \pmod{60}.
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-6" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-6">How Does It Work (Plain Language)?</h4>
<p>Each congruence gives a “lane” that repeats every <span class="math inline">\(m_i\)</span>.</p>
<p>CRT finds the intersection point, the smallest <span class="math inline">\(x\)</span> where all lanes line up.</p>
<p>Think of modular worlds like clocks with different tick lengths. CRT finds the time when all clocks show the specified hands simultaneously.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Modulus</th>
<th>Remainder</th>
<th>Period</th>
<th>Aligns At</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>3</td>
<td>2, 5, 8, 11, …</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>3, 7, 11, 15, …</td>
</tr>
<tr class="odd">
<td>5</td>
<td>2</td>
<td>5</td>
<td>2, 7, 12, 17, …</td>
</tr>
</tbody>
</table>
<p>They first align at 47, and then repeat every 60.</p>
</section>
<section id="tiny-code-easy-version" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-version">Tiny Code (Easy Version)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extended_gcd(a, b):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> b <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a, <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    g, x1, y1 <span class="op">=</span> extended_gcd(b, a <span class="op">%</span> b)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g, y1, x1 <span class="op">-</span> (a <span class="op">//</span> b) <span class="op">*</span> y1</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mod_inverse(a, m):</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    g, x, y <span class="op">=</span> extended_gcd(a, m)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> g <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">%</span> m</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> crt(a, m):</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mod <span class="kw">in</span> m:</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        M <span class="op">*=</span> mod</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ai, mi <span class="kw">in</span> <span class="bu">zip</span>(a, m):</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        Mi <span class="op">=</span> M <span class="op">//</span> mi</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        inv <span class="op">=</span> mod_inverse(Mi, mi)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> (x <span class="op">+</span> ai <span class="op">*</span> Mi <span class="op">*</span> inv) <span class="op">%</span> M</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"x ="</span>, crt(a, m))  <span class="co"># Output: 47</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (Simplified)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> extended_gcd<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> <span class="op">*</span>x<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> <span class="op">*</span>y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="op">*</span>x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">*</span>y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">return</span> a<span class="op">;</span> <span class="op">}</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x1<span class="op">,</span> y1<span class="op">;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> g <span class="op">=</span> extended_gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">,</span> <span class="op">&amp;</span>x1<span class="op">,</span> <span class="op">&amp;</span>y1<span class="op">);</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>x <span class="op">=</span> y1<span class="op">;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>y <span class="op">=</span> x1 <span class="op">-</span> <span class="op">(</span>a <span class="op">/</span> b<span class="op">)</span> <span class="op">*</span> y1<span class="op">;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> mod_inverse<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> g <span class="op">=</span> extended_gcd<span class="op">(</span>a<span class="op">,</span> m<span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>g <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>x <span class="op">%</span> m <span class="op">+</span> m<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> crt<span class="op">(</span><span class="dt">int</span> a<span class="op">[],</span> <span class="dt">int</span> m<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> M <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> M <span class="op">*=</span> m<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> Mi <span class="op">=</span> M <span class="op">/</span> m<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> inv <span class="op">=</span> mod_inverse<span class="op">(</span>Mi<span class="op">,</span> m<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="op">(</span>x <span class="op">+</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> Mi <span class="op">*</span> inv<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> m<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">};</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"x = </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> crt<span class="op">(</span>a<span class="op">,</span> m<span class="op">,</span> n<span class="op">));</span> <span class="co">// Output: 47</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-6" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-6">Why It Matters</h4>
<ul>
<li>Combines multiple modular systems into one unified solution</li>
<li>Essential in RSA (CRT optimization)</li>
<li>Used in Chinese calendar, hashing, polynomial moduli, FFTs</li>
<li>Foundation for multi-modular arithmetic in big integer math</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-6" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-6">A Gentle Proof (Why It Works)</h4>
<p>If the moduli <span class="math inline">\(m_i\)</span> are pairwise coprime, then <span class="math inline">\(M_i = M/m_i\)</span> is coprime with <span class="math inline">\(m_i\)</span>. So each <span class="math inline">\(M_i\)</span> has an inverse <span class="math inline">\(n_i\)</span> such that <span class="math display">\[
M_i \cdot n_i \equiv 1 \pmod{m_i}.
\]</span></p>
<p>The combination <span class="math display">\[
x = \sum_{i=1}^{k} a_i \, M_i \, n_i
\]</span> satisfies <span class="math inline">\(x \equiv a_i \pmod{m_i}\)</span> for all <span class="math inline">\(i\)</span>. Reducing <span class="math inline">\(x\)</span> modulo <span class="math inline">\(M\)</span> gives the smallest non-negative solution.</p>
</section>
<section id="try-it-yourself-6" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-6">Try It Yourself</h4>
<ol type="1">
<li>Solve <span class="math inline">\(x \equiv 1 \pmod{2}\)</span>, <span class="math inline">\(x \equiv 2 \pmod{3}\)</span>, <span class="math inline">\(x \equiv 3 \pmod{5}\)</span>.</li>
<li>Change one modulus to not be coprime (e.g., <span class="math inline">\(4, 6\)</span>) and observe what happens.</li>
<li>Implement CRT with non-coprime moduli using Garner’s algorithm.</li>
<li>Test large primes (use Python big integers).</li>
<li>Use CRT to reconstruct <span class="math inline">\(x\)</span> from residues modulo <span class="math inline">\(10^{9}+7\)</span> and <span class="math inline">\(998244353\)</span>.</li>
</ol>
</section>
<section id="test-cases-6" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-6">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>System</th>
<th>Solution</th>
<th>Modulus</th>
<th>Check</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(2 mod 3, 3 mod 4, 2 mod 5)</td>
<td>47</td>
<td>60</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>(1 mod 2, 2 mod 3, 3 mod 5)</td>
<td>23</td>
<td>30</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>(3 mod 5, 1 mod 7)</td>
<td>31</td>
<td>35</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>(0 mod 3, 1 mod 4)</td>
<td>4</td>
<td>12</td>
<td>Ok</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-6" class="level4">
<h4 class="anchored" data-anchor-id="complexity-6">Complexity</h4>
<ul>
<li>Time: O(k log M) (each step uses Extended GCD)</li>
<li>Space: O(k)</li>
</ul>
<p>CRT is the harmony of modular worlds, it unifies many congruences into one elegant answer, echoing ancient arithmetic and modern encryption alike.</p>
</section>
</section>
<section id="binary-gcd-steins-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="binary-gcd-steins-algorithm">508 Binary GCD (Stein’s Algorithm)</h3>
<p>The Binary GCD algorithm, also known as Stein’s algorithm, computes the greatest common divisor using bit operations instead of division. It’s often faster than the classical Euclidean algorithm, especially on binary hardware, perfect for low-level, performance-sensitive code.</p>
<section id="what-problem-are-we-solving-7" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-7">What Problem Are We Solving?</h4>
<p>We want to compute</p>
<p><span class="math display">\[
\gcd(a,b)
\]</span></p>
<p>without division, using only shifts, subtraction, and parity checks. This is the binary GCD (Stein’s) algorithm.</p>
<p>Algorithm</p>
<ol type="1">
<li>If <span class="math inline">\(a=0\)</span> return <span class="math inline">\(b\)</span>. If <span class="math inline">\(b=0\)</span> return <span class="math inline">\(a\)</span>.</li>
<li>Let <span class="math inline">\(k=\min(v_2(a),\,v_2(b))\)</span> where <span class="math inline">\(v_2(x)\)</span> is the number of trailing zero bits in <span class="math inline">\(x\)</span>.</li>
<li>Set <span class="math inline">\(a \gets a/2^{v_2(a)}\)</span> and <span class="math inline">\(b \gets b/2^{v_2(b)}\)</span> (both become odd).</li>
<li>While <span class="math inline">\(a \ne b\)</span>:
<ul>
<li>If <span class="math inline">\(a&gt;b\)</span>, set <span class="math inline">\(a \gets a-b\)</span>; then remove factors of two: <span class="math inline">\(a \gets a/2^{v_2(a)}\)</span>.</li>
<li>Else set <span class="math inline">\(b \gets b-a\)</span>; then <span class="math inline">\(b \gets b/2^{v_2(b)}\)</span>.</li>
</ul></li>
<li>Return <span class="math inline">\(a \cdot 2^{k}\)</span>.</li>
</ol>
<p>Worked example</p>
<p>Find <span class="math inline">\(\gcd(48,18)\)</span>.</p>
<ul>
<li>Trailing zeros: <span class="math inline">\(v_2(48)=4\)</span>, <span class="math inline">\(v_2(18)=1\)</span>, so <span class="math inline">\(k=\min(4,1)=1\)</span>.</li>
<li>Make odd:
<ul>
<li><span class="math inline">\(a \gets 48/2^{4}=3\)</span></li>
<li><span class="math inline">\(b \gets 18/2^{1}=9\)</span></li>
</ul></li>
<li>Loop:
<ul>
<li><span class="math inline">\(b \gets 9-3=6 \Rightarrow b \gets 6/2^{1}=3\)</span></li>
<li>Now <span class="math inline">\(a=b=3\)</span></li>
</ul></li>
<li>Answer: <span class="math inline">\(3 \cdot 2^{1}=6\)</span></li>
</ul>
<p>So <span class="math inline">\(\gcd(48,18)=6\)</span>.</p>
<p>Notes</p>
<ul>
<li>Only uses subtraction and bit shifts.</li>
<li>Complexity is <span class="math inline">\(O(\log(\max(a,b)))\)</span> with very simple operations.</li>
</ul>
</section>
<section id="how-does-it-work-plain-language-7" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-7">How Does It Work (Plain Language)?</h4>
<p>Stein’s insight:</p>
<ul>
<li>If both numbers are even → <span class="math inline">\(\gcd(a,b) = 2 \times \gcd(a/2,\, b/2)\)</span></li>
<li>If one is even → divide it by 2</li>
<li>If both are odd → replace the larger by (larger − smaller)</li>
<li>Repeat until they become equal</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 38%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>a</th>
<th>b</th>
<th>Operation</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>48</td>
<td>18</td>
<td>both even → divide by 2</td>
<td><span class="math inline">\(\gcd = 2 \times \gcd(24,9)\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>24</td>
<td>9</td>
<td>one even → divide a</td>
<td><span class="math inline">\(\gcd = 2 \times \gcd(12,9)\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>12</td>
<td>9</td>
<td>one even → divide a</td>
<td><span class="math inline">\(\gcd = 2 \times \gcd(6,9)\)</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>6</td>
<td>9</td>
<td>one even → divide a</td>
<td><span class="math inline">\(\gcd = 2 \times \gcd(3,9)\)</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>3</td>
<td>9</td>
<td>both odd → <span class="math inline">\(b-a=6\)</span></td>
<td><span class="math inline">\(\gcd = 2 \times \gcd(3,6)\)</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>3</td>
<td>6</td>
<td>one even → divide b</td>
<td><span class="math inline">\(\gcd = 2 \times \gcd(3,3)\)</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>3</td>
<td>3</td>
<td>equal → return 3</td>
<td><span class="math inline">\(\gcd = 2 \times 3 = 6\)</span></td>
</tr>
</tbody>
</table>
<p>Final result: <span class="math inline">\(\gcd(48,18)=6\)</span>.</p>
</section>
<section id="tiny-code-easy-versions-6" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-6">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> gcd_binary<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> b<span class="op">;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// find power of 2 factor</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> shift <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(((</span>a <span class="op">|</span> b<span class="op">)</span> <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        a <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        shift<span class="op">++;</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// make 'a' odd</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">((</span>a <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> a <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">((</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a <span class="op">&gt;</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> temp <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>            a <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>            b <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> b <span class="op">-</span> a<span class="op">;</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">&lt;&lt;</span> shift<span class="op">;</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">,</span> b<span class="op">;</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter a and b: "</span><span class="op">);</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">);</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"gcd(</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d</span><span class="st">) = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> gcd_binary<span class="op">(</span>a<span class="op">,</span> b<span class="op">));</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gcd_binary(a, b):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> a <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> b</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> b <span class="op">==</span> <span class="dv">0</span>: <span class="cf">return</span> a</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    shift <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> ((a <span class="op">|</span> b) <span class="op">&amp;</span> <span class="dv">1</span>) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        a <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        b <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        shift <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (a <span class="op">&amp;</span> <span class="dv">1</span>) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        a <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> b <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> (b <span class="op">&amp;</span> <span class="dv">1</span>) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            b <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a <span class="op">&gt;</span> b:</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>            a, b <span class="op">=</span> b, a</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        b <span class="op">-=</span> a</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">&lt;&lt;</span> shift</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter a, b: "</span>).split())</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"gcd("</span>, a, <span class="st">","</span>, b, <span class="st">") ="</span>, gcd_binary(a, b))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-7" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-7">Why It Matters</h4>
<ul>
<li>Avoids division, uses only shifts, subtraction, and comparisons</li>
<li>Fast on binary processors (hardware-friendly)</li>
<li>Works for unsigned integers, useful in embedded systems</li>
<li>Demonstrates the power of bitwise math for classic problems</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-7" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-7">A Gentle Proof (Why It Works)</h4>
<p>The gcd rules remain the same:</p>
<ul>
<li>gcd(2a, 2b) = 2 × gcd(a, b)</li>
<li>gcd(a, 2b) = gcd(a, b) if a is odd</li>
<li>gcd(a, b) = gcd(a, b − a) if both odd and a &lt; b</li>
</ul>
<p>Each step preserves gcd properties while removing factors of 2 efficiently.</p>
<p>By induction, when a = b, that value is the gcd.</p>
</section>
<section id="try-it-yourself-7" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-7">Try It Yourself</h4>
<ol type="1">
<li>Compute gcd(48, 18) step by step.</li>
<li>Try gcd(56, 98).</li>
<li>Modify code to count operations.</li>
<li>Compare runtime with Euclidean version.</li>
<li>Use on 64-bit integers and test large inputs.</li>
</ol>
</section>
<section id="test-cases-7" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-7">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>gcd(a, b)</th>
<th>Steps</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>48</td>
<td>18</td>
<td>6</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>56</td>
<td>98</td>
<td>14</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>101</td>
<td>10</td>
<td>1</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>270</td>
<td>192</td>
<td>6</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>0</td>
<td>8</td>
<td>8</td>
<td>Ok</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-7" class="level4">
<h4 class="anchored" data-anchor-id="complexity-7">Complexity</h4>
<ul>
<li>Time: O(log min(a, b))</li>
<li>Space: O(1)</li>
<li>Bitwise operations make it faster in practice than division-based GCD</li>
</ul>
<p>Binary GCD is Euclid’s spirit in binary form, subtraction, shifting, and symmetry in the dance of bits.</p>
</section>
</section>
<section id="modular-reduction" class="level3">
<h3 class="anchored" data-anchor-id="modular-reduction">509 Modular Reduction</h3>
<p>Modular reduction is the process of bringing a number back into range by taking its remainder modulo M. It’s a small but essential step in modular arithmetic, every modular algorithm uses it to keep numbers bounded and stable.</p>
<p>Think of it as folding an infinitely long number line into a circle of length M, and asking, “Where do we land?”</p>
<section id="what-problem-are-we-solving-8" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-8">What Problem Are We Solving?</h4>
<p>We want to compute:</p>
<p><span class="math display">\[
x \bmod M
\]</span></p>
<p>That is, the remainder when (x) is divided by (M), always mapped into the canonical range [0, M−1].</p>
<p>Example: If<span class="math inline">\(M = 10\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>x</th>
<th>x mod 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>23</td>
<td>3</td>
</tr>
<tr class="even">
<td>17</td>
<td>7</td>
</tr>
<tr class="odd">
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>-3</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Negative numbers wrap around to a positive residue.</p>
<p>So we want a normalized result, never negative.</p>
</section>
<section id="how-does-it-work-plain-language-8" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-8">How Does It Work (Plain Language)?</h4>
<p>The remainder operator <code>%</code> in most languages can produce negative results for negative inputs. To ensure a proper modular residue, we fix it by adding M back if needed.</p>
<p>Rule of thumb:</p>
<p><span class="math display">\[
\text{mod}(x, M) = ((x % M) + M) % M
\]</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>x</th>
<th>M</th>
<th>x % M</th>
<th>Normalized</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>23</td>
<td>10</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="even">
<td>-3</td>
<td>10</td>
<td>-3</td>
<td>7</td>
</tr>
<tr class="odd">
<td>15</td>
<td>6</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="even">
<td>-8</td>
<td>5</td>
<td>-3</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>This ensures x mod M ∈ [0, M−1].</p>
</section>
<section id="tiny-code-easy-versions-7" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-7">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> mod_reduce<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> M<span class="op">)</span> <span class="op">{</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> r <span class="op">=</span> x <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> r <span class="op">+=</span> M<span class="op">;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">,</span> M<span class="op">;</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter x and M: "</span><span class="op">);</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>M<span class="op">);</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> mod </span><span class="sc">%d</span><span class="st"> = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">,</span> M<span class="op">,</span> mod_reduce<span class="op">(</span>x<span class="op">,</span> M<span class="op">));</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mod_reduce(x, M):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">%</span> M <span class="op">+</span> M) <span class="op">%</span> M</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>x, M <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter x, M: "</span>).split())</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss"> mod </span><span class="sc">{</span>M<span class="sc">}</span><span class="ss"> ="</span>, mod_reduce(x, M))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-8" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-8">Why It Matters</h4>
<ul>
<li>Ensures correct residues even with negative numbers</li>
<li>Keeps arithmetic consistent:<span class="math inline">\((a + b) \bmod M = ((a \bmod M) + (b \bmod M)) \bmod M\)</span></li>
<li>Critical in cryptography, hashing, polynomial mod arithmetic</li>
<li>Prevents overflow and sign bugs in modular computations</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-8" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-8">A Gentle Proof (Why It Works)</h4>
<p>Every integer (x) can be written as:</p>
<p><span class="math display">\[
x = qM + r
\]</span></p>
<p>where (q) is the quotient and (r) is the remainder. We want (r ).</p>
<p>If <code>%</code> gives negative (r), then (r + M) is the positive residue: <span class="math display">\[
(x \bmod M) = (x % M + M) % M
\]</span></p>
<p>This satisfies modular congruence: <span class="math display">\[
x \equiv r \pmod{M}
\]</span></p>
</section>
<section id="try-it-yourself-8" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-8">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(-7 \bmod 5\)</span> by hand.</li>
<li>Test code with negative inputs.</li>
<li>Build <code>mod_add</code>, <code>mod_sub</code>, <code>mod_mul</code> using normalized reduction.</li>
<li>Use reduction inside loops to prevent overflow.</li>
<li>Compare <code>%</code> vs proper mod with negative numbers in C or Python.</li>
</ol>
</section>
<section id="test-cases-8" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-8">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>x</th>
<th>M</th>
<th>Expected</th>
<th>Check</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>23</td>
<td>10</td>
<td>3</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>-3</td>
<td>10</td>
<td>7</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>15</td>
<td>6</td>
<td>3</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>-8</td>
<td>5</td>
<td>2</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>0</td>
<td>9</td>
<td>0</td>
<td>Ok</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-8" class="level4">
<h4 class="anchored" data-anchor-id="complexity-8">Complexity</h4>
<ul>
<li>Time: O(1)</li>
<li>Space: O(1)</li>
</ul>
<p>Modular reduction is the heartbeat of modular arithmetic, every operation folds back into a circle, keeping numbers small, positive, and predictable.</p>
</section>
</section>
<section id="modular-linear-equation-solver" class="level3">
<h3 class="anchored" data-anchor-id="modular-linear-equation-solver">510 Modular Linear Equation Solver</h3>
<p>A modular linear equation is an equation of the form <span class="math display">\[
a x \equiv b \pmod{m}
\]</span> We want to find all integers <span class="math inline">\(x\)</span> that satisfy this congruence. This is the modular version of solving <span class="math inline">\(ax = b\)</span>, but in a world that wraps around at multiples of (m).</p>
<section id="what-problem-are-we-solving-9" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-9">What Problem Are We Solving?</h4>
<p>Given integers <span class="math inline">\(a,b,m\)</span>, solve the linear congruence <span class="math display">\[
a x \equiv b \pmod{m}.
\]</span></p>
<p>Key facts</p>
<ul>
<li>Let <span class="math inline">\(g=\gcd(a,m)\)</span>.<br>
</li>
<li>A solution exists iff <span class="math inline">\(g \mid b\)</span>.<br>
</li>
<li>If a solution exists, there are exactly <span class="math inline">\(g\)</span> solutions modulo <span class="math inline">\(m\)</span>, spaced by <span class="math inline">\(m/g\)</span>.</li>
</ul>
<p>Procedure</p>
<ol type="1">
<li>Compute <span class="math inline">\(g=\gcd(a,m)\)</span>. If <span class="math inline">\(g \nmid b\)</span>, no solution.<br>
</li>
<li>Reduce: <span class="math display">\[
a'=\frac{a}{g},\quad b'=\frac{b}{g},\quad m'=\frac{m}{g}.
\]</span> Then solve the coprime congruence <span class="math display">\[
a' x \equiv b' \pmod{m'}.
\]</span></li>
<li>Find the inverse <span class="math inline">\(a'^{-1} \pmod{m'}\)</span> and set <span class="math display">\[
x_0 \equiv a'^{-1} b' \pmod{m'}.
\]</span></li>
<li>All solutions modulo <span class="math inline">\(m\)</span> are <span class="math display">\[
x \equiv x_0 + t\cdot \frac{m}{g} \pmod{m},\quad t=0,1,\dots,g-1.
\]</span></li>
</ol>
<p>Worked example</p>
<p>Solve <span class="math inline">\(6x \equiv 8 \pmod{14}\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(g=\gcd(6,14)=2\)</span>, and <span class="math inline">\(2 \mid 8\)</span> so solutions exist.<br>
</li>
<li>Reduce: <span class="math inline">\(a'=6/2=3\)</span>, <span class="math inline">\(b'=8/2=4\)</span>, <span class="math inline">\(m'=14/2=7\)</span>. Solve <span class="math display">\[
3x \equiv 4 \pmod{7}.
\]</span></li>
<li>Inverse: <span class="math inline">\(3^{-1}\equiv 5 \pmod{7}\)</span>, so <span class="math display">\[
x_0 \equiv 5\cdot 4 \equiv 20 \equiv 6 \pmod{7}.
\]</span></li>
<li>Lift to modulo 14. Since <span class="math inline">\(m/g=7\)</span>, solutions are <span class="math display">\[
x \equiv 6 + t\cdot 7 \pmod{14},\quad t=0,1.
\]</span> Thus <span class="math inline">\(x \in \{6,\,13\} \pmod{14}\)</span>.</li>
</ol>
</section>
<section id="how-does-it-work-plain-language-9" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-9">How Does It Work (Plain Language)?</h4>
<ol type="1">
<li><p>Check solvability<br>
A solution exists iff <span class="math inline">\(g=\gcd(a,m)\)</span> divides <span class="math inline">\(b\)</span>.</p></li>
<li><p>Reduce the congruence by <span class="math inline">\(g\)</span> <span class="math display">\[
\frac{a}{g}\,x \equiv \frac{b}{g} \pmod{\frac{m}{g}}
\]</span></p></li>
<li><p>Find the modular inverse<br>
Compute <span class="math inline">\(\left(\frac{a}{g}\right)^{-1} \pmod{\frac{m}{g}}\)</span>.</p></li>
<li><p>Solve for one solution, then enumerate all <span class="math inline">\(g\)</span> solutions<br>
<span class="math display">\[
x_0 \equiv \left(\frac{a}{g}\right)^{-1}\!\left(\frac{b}{g}\right) \pmod{\frac{m}{g}}
\]</span> <span class="math display">\[
x \equiv x_0 + k\cdot\frac{m}{g} \pmod{m},\quad k=0,1,\ldots,g-1
\]</span></p></li>
</ol>
</section>
<section id="step-by-step-table-example" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-table-example">Step-by-Step Table (Example)</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 36%">
<col style="width: 31%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Equation</th>
<th>Action</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><span class="math inline">\(6x \equiv 8 \pmod{14}\)</span></td>
<td><span class="math inline">\(\gcd(6,14)=2 \mid 8\)</span></td>
<td>solvable</td>
</tr>
<tr class="even">
<td>2</td>
<td>divide by <span class="math inline">\(2\)</span></td>
<td><span class="math inline">\(3x \equiv 4 \pmod{7}\)</span></td>
<td>simplified</td>
</tr>
<tr class="odd">
<td>3</td>
<td>inverse of <span class="math inline">\(3 \bmod 7\)</span></td>
<td><span class="math inline">\(5\)</span></td>
<td>since <span class="math inline">\(3\cdot5\equiv1\)</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>multiply both sides</td>
<td><span class="math inline">\(x \equiv 4\cdot5 \equiv 20 \equiv 6 \pmod{7}\)</span></td>
<td>one solution</td>
</tr>
<tr class="odd">
<td>5</td>
<td>lift to <span class="math inline">\(\pmod{14}\)</span></td>
<td><span class="math inline">\(x \in \{6,\,13\}\)</span></td>
<td>ok</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-easy-versions-8" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-8">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extended_gcd(a, b):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> b <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a, <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    g, x1, y1 <span class="op">=</span> extended_gcd(b, a <span class="op">%</span> b)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g, y1, x1 <span class="op">-</span> (a <span class="op">//</span> b) <span class="op">*</span> y1</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve_modular_linear(a, b, m):</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    g, x, y <span class="op">=</span> extended_gcd(a, m)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> b <span class="op">%</span> g <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []  <span class="co"># No solution</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    a1, b1, m1 <span class="op">=</span> a <span class="op">//</span> g, b <span class="op">//</span> g, m <span class="op">//</span> g</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    x0 <span class="op">=</span> (x <span class="op">*</span> b1) <span class="op">%</span> m1</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [(x0 <span class="op">+</span> i <span class="op">*</span> m1) <span class="op">%</span> m <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(g)]</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>a, b, m <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter a, b, m: "</span>).split())</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>solutions <span class="op">=</span> solve_modular_linear(a, b, m)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> solutions:</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Solutions:"</span>, solutions)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"No solution"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (Simplified)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> extended_gcd<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> <span class="op">*</span>x<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> <span class="op">*</span>y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="op">*</span>x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">*</span>y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">return</span> a<span class="op">;</span> <span class="op">}</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x1<span class="op">,</span> y1<span class="op">;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> g <span class="op">=</span> extended_gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">,</span> <span class="op">&amp;</span>x1<span class="op">,</span> <span class="op">&amp;</span>y1<span class="op">);</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>x <span class="op">=</span> y1<span class="op">;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>y <span class="op">=</span> x1 <span class="op">-</span> <span class="op">(</span>a <span class="op">/</span> b<span class="op">)</span> <span class="op">*</span> y1<span class="op">;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> solve_modular<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> m<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> sol<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> g <span class="op">=</span> extended_gcd<span class="op">(</span>a<span class="op">,</span> m<span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">%</span> g <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    a <span class="op">/=</span> g<span class="op">;</span> b <span class="op">/=</span> g<span class="op">;</span> m <span class="op">/=</span> g<span class="op">;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x0 <span class="op">=</span> <span class="op">((</span>x <span class="op">*</span> b<span class="op">)</span> <span class="op">%</span> m <span class="op">+</span> m<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> g<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        sol<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>x0 <span class="op">+</span> i <span class="op">*</span> m<span class="op">)</span> <span class="op">%</span> <span class="op">(</span>m <span class="op">*</span> g<span class="op">);</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> b<span class="op">,</span> m<span class="op">,</span> sol<span class="op">[</span><span class="dv">10</span><span class="op">];</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter a, b, m: "</span><span class="op">);</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>b<span class="op">,</span> <span class="op">&amp;</span>m<span class="op">);</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> solve_modular<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> m<span class="op">,</span> sol<span class="op">);</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> printf<span class="op">(</span><span class="st">"No solution</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"Solutions:"</span><span class="op">);</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> printf<span class="op">(</span><span class="st">" </span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> sol<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-9" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-9">Why It Matters</h4>
<ul>
<li>Solves modular equations, the building block for CRT, RSA, and Diophantine systems</li>
<li>Generalizes modular inverses (when b=1)</li>
<li>Basis for solving linear congruence systems</li>
<li>Enables modular division in non-prime moduli</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-9" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-9">A Gentle Proof (Why It Works)</h4>
<p>If <span class="math inline">\(a x \equiv b \pmod{m}\)</span>, then <span class="math inline">\(m \mid (a x - b)\)</span>.</p>
<p>Let <span class="math inline">\(g=\gcd(a,m)\)</span>. Divide the congruence by <span class="math inline">\(g\)</span>: <span class="math display">\[
\frac{a}{g}\,x \equiv \frac{b}{g} \pmod{\frac{m}{g}}.
\]</span> Now <span class="math inline">\(\gcd\!\left(\frac{a}{g},\frac{m}{g}\right)=1\)</span>, so <span class="math inline">\(\left(\frac{a}{g}\right)^{-1} \pmod{\frac{m}{g}}\)</span> exists. Multiplying both sides by this inverse gives one solution modulo <span class="math inline">\(\frac{m}{g}\)</span>. Adding multiples of <span class="math inline">\(\frac{m}{g}\)</span> generates all <span class="math inline">\(g\)</span> solutions modulo <span class="math inline">\(m\)</span>: <span class="math display">\[
x \equiv x_0 + k\cdot \frac{m}{g} \pmod{m}, \quad k=0,1,\dots,g-1.
\]</span></p>
</section>
<section id="try-it-yourself-9" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-9">Try It Yourself</h4>
<ol type="1">
<li>Solve <span class="math inline">\(6x \equiv 8 \pmod{14}\)</span></li>
<li>Solve <span class="math inline">\(4x \equiv 2 \pmod{6}\)</span></li>
<li>Solve <span class="math inline">\(3x \equiv 2 \pmod{7}\)</span></li>
<li>Try an unsolvable case: <span class="math inline">\(4x \equiv 3 \pmod{6}\)</span></li>
<li>Modify code to print <span class="math inline">\(\gcd\)</span> and the inverse at each step</li>
</ol>
</section>
<section id="test-cases-9" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-9">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>m</th>
<th>Solutions</th>
<th>Check</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>8</td>
<td>14</td>
<td>6, 13</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>6</td>
<td>2, 5</td>
<td>Ok</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>7</td>
<td>3</td>
<td>Ok</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>6</td>
<td>None</td>
<td>Ok</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-9" class="level4">
<h4 class="anchored" data-anchor-id="complexity-9">Complexity</h4>
<ul>
<li>Time: O(log m)</li>
<li>Space: O(1)</li>
</ul>
<p>The modular linear solver turns arithmetic into algebra on a circle, finding where linear lines cross modular grids.</p>
</section>
</section>
</section>
<section id="section-52.-primality-and-factorization" class="level1">
<h1>Section 52. Primality and Factorization</h1>
<section id="trial-division" class="level3">
<h3 class="anchored" data-anchor-id="trial-division">511 Trial Division</h3>
<p>Trial Division is the simplest way to test if a number is prime, by checking whether any smaller number divides it evenly. It’s slow for large<span class="math inline">\(n\)</span>, but perfect for building intuition, small primes, and as a subroutine inside more advanced factorization or primality tests.</p>
<section id="what-problem-are-we-solving-10" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-10">What Problem Are We Solving?</h4>
<p>We want to decide if an integer<span class="math inline">\(n &gt; 1\)</span> is prime or composite.</p>
<p>A prime has exactly two divisors (1 and itself). A composite has additional divisors.</p>
<p>Trial division checks all possible divisors up to<span class="math inline">\(\sqrt{n}\)</span>.</p>
<p>Example Is<span class="math inline">\(n = 37\)</span> prime?</p>
<p>Check divisors: <span class="math display">\[
\begin{aligned}
37 \bmod 2 &amp;= 1 \
37 \bmod 3 &amp;= 1 \
37 \bmod 4 &amp;= 1 \
37 \bmod 5 &amp;= 2 \
37 \bmod 6 &amp;= 1
\end{aligned}
\]</span></p>
<p>No divisors found up to<span class="math inline">\(\sqrt{37}\)</span>. Therefore, prime.</p>
</section>
<section id="how-does-it-work-plain-language-10" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-10">How Does It Work (Plain Language)</h4>
<p>If<span class="math inline">\(n = a \times b\)</span>, then one of<span class="math inline">\(a\)</span> or<span class="math inline">\(b\)</span> must satisfy<span class="math inline">\(a, b \leq \sqrt{n}\)</span>. So if<span class="math inline">\(n\)</span> has a divisor, it will appear before<span class="math inline">\(\sqrt{n}\)</span>. We check each integer in that range.</p>
<p>To optimize:</p>
<ul>
<li>First check<span class="math inline">\(2\)</span></li>
<li>Then test only odd numbers</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>Divisor</th>
<th><span class="math inline">\(n \bmod \text{Divisor}\)</span></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>1</td>
<td>skip</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>1</td>
<td>skip</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>1</td>
<td>skip</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>2</td>
<td>skip</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>1</td>
<td>skip</td>
</tr>
<tr class="even">
<td>,</td>
<td>No divisor found</td>
<td>Prime</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-easy-versions-9" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-9">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> is_prime<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> limit <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>sqrt<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> i <span class="op">&lt;=</span> limit<span class="op">;</span> i <span class="op">+=</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> i <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter n: "</span><span class="op">);</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">);</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> is </span><span class="sc">%s\n</span><span class="st">"</span><span class="op">,</span> n<span class="op">,</span> is_prime<span class="op">(</span>n<span class="op">)</span> <span class="op">?</span> <span class="st">"prime"</span> <span class="op">:</span> <span class="st">"composite"</span><span class="op">);</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_prime(n):</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    limit <span class="op">=</span> <span class="bu">int</span>(math.sqrt(n)) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>, limit, <span class="dv">2</span>):</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="op">%</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">"Enter n: "</span>))</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n, <span class="st">"is"</span>, <span class="st">"prime"</span> <span class="cf">if</span> is_prime(n) <span class="cf">else</span> <span class="st">"composite"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-10" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-10">Why It Matters</h4>
<ul>
<li>Foundation for all primality tests</li>
<li>Used for small<span class="math inline">\(n\)</span> and initial sieving</li>
<li>Great for factorization of small numbers</li>
<li>Builds intuition for<span class="math inline">\(\sqrt{n}\)</span> boundary and divisor pairs</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-10" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-10">A Gentle Proof (Why It Works)</h4>
<p>If<span class="math inline">\(n = a \times b\)</span>, then one of<span class="math inline">\(a, b \leq \sqrt{n}\)</span>.</p>
<p>If both were greater than<span class="math inline">\(\sqrt{n}\)</span>, then: <span class="math display">\[
a \times b &gt; \sqrt{n} \times \sqrt{n} = n
\]</span> which is impossible. Thus, any factorization must include a number ≤<span class="math inline">\(\sqrt{n}\)</span>.</p>
<p>Therefore, checking up to<span class="math inline">\(\sqrt{n}\)</span> is sufficient to confirm primality.</p>
</section>
<section id="try-it-yourself-10" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-10">Try It Yourself</h4>
<ol type="1">
<li>Check if<span class="math inline">\(37, 49, 51\)</span> are prime.</li>
<li>Modify code to print the first divisor found.</li>
<li>Extend code to list all divisors of<span class="math inline">\(n\)</span>.</li>
<li>Compare runtime for<span class="math inline">\(n = 10^6\)</span> vs<span class="math inline">\(n = 10^9\)</span>.</li>
<li>Combine with a sieve to skip non-prime divisors.</li>
</ol>
</section>
<section id="test-cases-10" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-10">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Expected</th>
<th>First Divisor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>Prime</td>
<td>,</td>
</tr>
<tr class="even">
<td>3</td>
<td>Prime</td>
<td>,</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Composite</td>
<td>2</td>
</tr>
<tr class="even">
<td>9</td>
<td>Composite</td>
<td>3</td>
</tr>
<tr class="odd">
<td>37</td>
<td>Prime</td>
<td>,</td>
</tr>
<tr class="even">
<td>49</td>
<td>Composite</td>
<td>7</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-10" class="level4">
<h4 class="anchored" data-anchor-id="complexity-10">Complexity</h4>
<ul>
<li>Time:<span class="math inline">\(O(\sqrt{n})\)</span></li>
<li>Space:<span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Trial Division is the “hello world” of primality testing, simple, certain, and fundamental to number theory.</p>
</section>
</section>
<section id="sieve-of-eratosthenes" class="level3">
<h3 class="anchored" data-anchor-id="sieve-of-eratosthenes">512 Sieve of Eratosthenes</h3>
<p>The Sieve of Eratosthenes is a classic and efficient algorithm for finding all prime numbers up to a given limit <span class="math inline">\(n\)</span>. Instead of testing each number individually, it eliminates multiples of known primes, leaving only primes behind.</p>
<p>This sieve is one of the oldest known algorithms (over 2000 years old) and remains a cornerstone of computational number theory.</p>
<section id="what-problem-are-we-solving-11" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-11">What Problem Are We Solving?</h4>
<p>We want to generate all primes up to <span class="math inline">\(n\)</span>.</p>
<p>Example Find all primes <span class="math inline">\(\leq 30\)</span>:</p>
<p><span class="math display">\[
{2, 3, 5, 7, 11, 13, 17, 19, 23, 29}
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-11" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-11">How Does It Work (Plain Language)</h4>
<p>Think of a list of integers <span class="math inline">\(2, 3, \ldots, n\)</span>. We will repeatedly “cross out” multiples of each prime.</p>
<p>Steps:</p>
<ol type="1">
<li>Start with the first prime <span class="math inline">\(p = 2\)</span>.</li>
<li>Cross out all multiples of <span class="math inline">\(p\)</span> starting from <span class="math inline">\(p^2\)</span>.</li>
<li>Move to the next number not yet crossed out, that’s the next prime.</li>
<li>Repeat until <span class="math inline">\(p^2 &gt; n\)</span>.</li>
</ol>
<p>What remains unmarked are all the primes.</p>
<p>Example: <span class="math inline">\(n = 30\)</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 38%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Prime <span class="math inline">\(p\)</span></th>
<th>Remove Multiples</th>
<th>Remaining Primes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td><span class="math inline">\(4, 6, 8, 10, 12, \ldots\)</span></td>
<td><span class="math inline">\(2, 3, 5, 7, 9, 11, 13, 15, \ldots\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td><span class="math inline">\(9, 12, 15, 18, 21, 24, 27, 30\)</span></td>
<td><span class="math inline">\(2, 3, 5, 7, 11, 13, 17, 19, 23, 29\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td><span class="math inline">\(25, 30\)</span></td>
<td>no change</td>
</tr>
<tr class="even">
<td>4</td>
<td>Stop</td>
<td><span class="math inline">\(5^2 = 25 &gt; \sqrt{30}\)</span></td>
<td>Done</td>
</tr>
</tbody>
</table>
<p>Final primes up to 30:</p>
<p><span class="math display">\[
{2, 3, 5, 7, 11, 13, 17, 19, 23, 29}
\]</span></p>
</section>
<section id="tiny-code-easy-versions-10" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-10">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_prime<span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> is_prime<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    is_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> is_prime<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> p <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> p <span class="op">*</span> p <span class="op">&lt;=</span> n<span class="op">;</span> p<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>p<span class="op">])</span> <span class="op">{</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> multiple <span class="op">=</span> p <span class="op">*</span> p<span class="op">;</span> multiple <span class="op">&lt;=</span> n<span class="op">;</span> multiple <span class="op">+=</span> p<span class="op">)</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                is_prime<span class="op">[</span>multiple<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Primes up to </span><span class="sc">%d</span><span class="st">:</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> i<span class="op">);</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter n: "</span><span class="op">);</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">);</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    sieve<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sieve(n):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    is_prime <span class="op">=</span> [<span class="va">True</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    is_prime[<span class="dv">0</span>] <span class="op">=</span> is_prime[<span class="dv">1</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> p <span class="op">*</span> p <span class="op">&lt;=</span> n:</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_prime[p]:</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> multiple <span class="kw">in</span> <span class="bu">range</span>(p <span class="op">*</span> p, n <span class="op">+</span> <span class="dv">1</span>, p):</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                is_prime[multiple] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        p <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>) <span class="cf">if</span> is_prime[i]]</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">"Enter n: "</span>))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Primes:"</span>, sieve(n))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-11" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-11">Why It Matters</h4>
<ul>
<li>Efficiently generates all primes up to <span class="math inline">\(n\)</span></li>
<li>Used in number theory, cryptography, factorization, and prime sieving precomputation</li>
<li>Avoids repeated division</li>
<li>Foundation for advanced sieves (e.g.&nbsp;Linear Sieve, Segmented Sieve)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-11" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-11">A Gentle Proof (Why It Works)</h4>
<p>Every composite number <span class="math inline">\(n\)</span> has a smallest prime factor <span class="math inline">\(p\)</span>. That factor <span class="math inline">\(p\)</span> will mark the composite when the algorithm reaches <span class="math inline">\(p\)</span>.</p>
<p>Thus, by crossing out all multiples of each prime, all composites are removed, and only primes remain.</p>
<p>Because any composite <span class="math inline">\(n = a \times b\)</span> has at least one <span class="math inline">\(a \leq \sqrt{n}\)</span>, we can stop sieving when <span class="math inline">\(p^2 &gt; n\)</span>.</p>
</section>
<section id="try-it-yourself-11" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-11">Try It Yourself</h4>
<ol type="1">
<li>Generate primes <span class="math inline">\(\leq 50\)</span>.</li>
<li>Modify code to count how many primes are found.</li>
<li>Print primes in rows of 10.</li>
<li>Compare runtime for <span class="math inline">\(n = 10^4\)</span>, <span class="math inline">\(10^5\)</span>, <span class="math inline">\(10^6\)</span>.</li>
<li>Optimize memory: sieve only odd numbers.</li>
</ol>
</section>
<section id="test-cases-11" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-11">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Expected Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td><span class="math inline">\(2, 3, 5, 7\)</span></td>
</tr>
<tr class="even">
<td>20</td>
<td><span class="math inline">\(2, 3, 5, 7, 11, 13, 17, 19\)</span></td>
</tr>
<tr class="odd">
<td>30</td>
<td><span class="math inline">\(2, 3, 5, 7, 11, 13, 17, 19, 23, 29\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-11" class="level4">
<h4 class="anchored" data-anchor-id="complexity-11">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n \log \log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The Sieve of Eratosthenes blends clarity and efficiency, by striking out every composite, it leaves behind the primes that shape number theory.</p>
</section>
</section>
<section id="sieve-of-atkin" class="level3">
<h3 class="anchored" data-anchor-id="sieve-of-atkin">513 Sieve of Atkin</h3>
<p>The Sieve of Atkin is a modern improvement on the Sieve of Eratosthenes. Instead of crossing out multiples, it uses quadratic forms and modular arithmetic to determine prime candidates, then eliminates non-primes via square multiples. It’s asymptotically faster and beautifully mathematical, though more complex to implement.</p>
<section id="what-problem-are-we-solving-12" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-12">What Problem Are We Solving?</h4>
<p>We want to find all prime numbers up to a given limit <span class="math inline">\(n\)</span>, but faster than the classic sieve.</p>
<p>The Sieve of Atkin uses congruence conditions based on quadratic residues to detect potential primes.</p>
</section>
<section id="how-does-it-work-plain-language-12" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-12">How Does It Work (Plain Language)</h4>
<p>For a given integer <span class="math inline">\(n\)</span>, we determine whether it is a prime candidate by checking specific modular equations:</p>
<ol type="1">
<li><p>Initialize an array <code>is_prime[0..n]</code> to false.</p></li>
<li><p>For every integer pair <span class="math inline">\((x, y)\)</span> with <span class="math inline">\(x, y \ge 1\)</span>, compute:</p>
<ul>
<li><p><span class="math inline">\(n_1 = 4x^2 + y^2\)</span></p>
<ul>
<li>If <span class="math inline">\(n_1 \le N\)</span> and <span class="math inline">\(n_1 \bmod 12 \in {1, 5}\)</span>, flip <code>is_prime[n1]</code></li>
</ul></li>
<li><p><span class="math inline">\(n_2 = 3x^2 + y^2\)</span></p>
<ul>
<li>If <span class="math inline">\(n_2 \le N\)</span> and <span class="math inline">\(n_2 \bmod 12 = 7\)</span>, flip <code>is_prime[n2]</code></li>
</ul></li>
<li><p><span class="math inline">\(n_3 = 3x^2 - y^2\)</span></p>
<ul>
<li>If <span class="math inline">\(x &gt; y\)</span>, <span class="math inline">\(n_3 \le N\)</span>, and <span class="math inline">\(n_3 \bmod 12 = 11\)</span>, flip <code>is_prime[n3]</code></li>
</ul></li>
</ul></li>
<li><p>Eliminate multiples of squares:</p>
<ul>
<li>For each <span class="math inline">\(k\)</span> such that <span class="math inline">\(k^2 \le N\)</span>, mark all multiples of <span class="math inline">\(k^2\)</span> as composite.</li>
</ul></li>
<li><p>Finally, add 2 and 3 as primes.</p></li>
</ol>
<p>All remaining numbers marked true are primes.</p>
<p>Example (small N = 50):</p>
<p>Start with 2, 3, and 5. Apply modular conditions to detect others:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Condition</th>
<th>Formula</th>
<th>Mod Class</th>
<th>Candidates</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(4x^2 + y^2\)</span></td>
<td><span class="math inline">\(1, 5\)</span></td>
<td><span class="math inline">\(12\)</span></td>
<td><span class="math inline">\(5, 13, 17, 29, 37, 41, 49\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(3x^2 + y^2\)</span></td>
<td><span class="math inline">\(7\)</span></td>
<td><span class="math inline">\(12\)</span></td>
<td><span class="math inline">\(7, 19, 31, 43\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(3x^2 - y^2\)</span></td>
<td><span class="math inline">\(11\)</span></td>
<td><span class="math inline">\(12\)</span></td>
<td><span class="math inline">\(11, 23, 47\)</span></td>
</tr>
</tbody>
</table>
<p>Then remove multiples of squares (e.g.&nbsp;<span class="math inline">\(25, 49\)</span>). Remaining primes up to 50:</p>
<p><span class="math display">\[
{2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47}
\]</span></p>
</section>
<section id="tiny-code-easy-version-1" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-version-1">Tiny Code (Easy Version)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sieve_atkin(limit):</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    is_prime <span class="op">=</span> [<span class="va">False</span>] <span class="op">*</span> (limit <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    sqrt_limit <span class="op">=</span> <span class="bu">int</span>(math.sqrt(limit)) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sqrt_limit):</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sqrt_limit):</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>            n <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> x <span class="op">*</span> x <span class="op">+</span> y <span class="op">*</span> y</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> n <span class="op">&lt;=</span> limit <span class="kw">and</span> n <span class="op">%</span> <span class="dv">12</span> <span class="kw">in</span> (<span class="dv">1</span>, <span class="dv">5</span>):</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                is_prime[n] <span class="op">=</span> <span class="kw">not</span> is_prime[n]</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>            n <span class="op">=</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">*</span> x <span class="op">+</span> y <span class="op">*</span> y</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> n <span class="op">&lt;=</span> limit <span class="kw">and</span> n <span class="op">%</span> <span class="dv">12</span> <span class="op">==</span> <span class="dv">7</span>:</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                is_prime[n] <span class="op">=</span> <span class="kw">not</span> is_prime[n]</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>            n <span class="op">=</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">*</span> x <span class="op">-</span> y <span class="op">*</span> y</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> x <span class="op">&gt;</span> y <span class="kw">and</span> n <span class="op">&lt;=</span> limit <span class="kw">and</span> n <span class="op">%</span> <span class="dv">12</span> <span class="op">==</span> <span class="dv">11</span>:</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                is_prime[n] <span class="op">=</span> <span class="kw">not</span> is_prime[n]</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>, sqrt_limit):</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_prime[n]:</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">*</span> n, limit <span class="op">+</span> <span class="dv">1</span>, n <span class="op">*</span> n):</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                is_prime[k] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    primes <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    primes.extend([i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>, limit <span class="op">+</span> <span class="dv">1</span>) <span class="cf">if</span> is_prime[i]])</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> primes</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">"Enter n: "</span>))</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Primes:"</span>, sieve_atkin(n))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-12" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-12">Why It Matters</h4>
<ul>
<li>Faster than the Sieve of Eratosthenes for very large <span class="math inline">\(n\)</span></li>
<li>Demonstrates deep connections between number theory and computation</li>
<li>Uses modular patterns of quadratic residues to detect primes</li>
<li>Foundation for optimized sieving algorithms</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-12" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-12">A Gentle Proof (Why It Works)</h4>
<p>Every integer can be represented in quadratic forms. Primes occur in specific modular classes:</p>
<ul>
<li>Primes of form <span class="math inline">\(4x + 1\)</span> satisfy <span class="math inline">\(4x^2 + y^2\)</span></li>
<li>Primes of form <span class="math inline">\(6x + 1\)</span> or <span class="math inline">\(6x + 5\)</span> satisfy <span class="math inline">\(3x^2 + y^2\)</span> or <span class="math inline">\(3x^2 - y^2\)</span></li>
</ul>
<p>By counting solutions to these congruences mod 12, one can distinguish primes from composites. Flipping ensures each candidate is toggled odd number of times only if it meets prime conditions.</p>
<p>Multiples of squares are eliminated since no square factor can belong to a prime.</p>
</section>
<section id="try-it-yourself-12" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-12">Try It Yourself</h4>
<ol type="1">
<li>Generate all primes <span class="math inline">\(\le 100\)</span>.</li>
<li>Compare output with Eratosthenes.</li>
<li>Measure performance for <span class="math inline">\(n = 10^6\)</span>.</li>
<li>Modify code to count primes only.</li>
<li>Print candidate flips to see how toggling works.</li>
</ol>
</section>
<section id="test-cases-12" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-12">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Expected Output (Primes)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td><span class="math inline">\(2, 3, 5, 7\)</span></td>
</tr>
<tr class="even">
<td>30</td>
<td><span class="math inline">\(2, 3, 5, 7, 11, 13, 17, 19, 23, 29\)</span></td>
</tr>
<tr class="odd">
<td>50</td>
<td><span class="math inline">\(2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-12" class="level4">
<h4 class="anchored" data-anchor-id="complexity-12">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span> (with modular arithmetic precomputation)</li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The Sieve of Atkin turns number theory into code, using the elegance of quadratic forms to filter primes from the infinite sea of integers.</p>
</section>
</section>
<section id="millerrabin-primality-test" class="level3">
<h3 class="anchored" data-anchor-id="millerrabin-primality-test">514 Miller–Rabin Primality Test</h3>
<p>The Miller–Rabin test is a fast probabilistic primality test. Given an odd integer <span class="math inline">\(n &gt; 2\)</span>, it decides whether <span class="math inline">\(n\)</span> is composite or probably prime by checking whether <span class="math inline">\(a\)</span> behaves like a witness to compositeness modulo <span class="math inline">\(n\)</span>.</p>
<section id="what-problem-are-we-solving-13" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-13">What Problem Are We Solving?</h4>
<p>Decide primality of a large integer <span class="math inline">\(n\)</span> much faster than trial division or a full sieve, especially when <span class="math inline">\(n\)</span> can be hundreds or thousands of bits.</p>
<p>Input: odd <span class="math inline">\(n &gt; 2\)</span>, accuracy parameter <span class="math inline">\(k\)</span> (number of bases). Output: composite or probably prime.</p>
</section>
<section id="how-does-it-work-plain-language-13" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-13">How Does It Work (Plain Language)</h4>
<p>Write <span class="math display">\[
n - 1 = 2^s \cdot d \quad \text{with } d \text{ odd}.
\]</span></p>
<p>Repeat for <span class="math inline">\(k\)</span> random bases <span class="math inline">\(a \in {2, 3, \ldots, n-2}\)</span>:</p>
<ol type="1">
<li><p>Compute <span class="math display">\[
x \equiv a^{,d} \bmod n.
\]</span></p></li>
<li><p>If <span class="math inline">\(x = 1\)</span> or <span class="math inline">\(x = n-1\)</span>, this base passes.</p></li>
<li><p>Otherwise, square up to <span class="math inline">\(s-1\)</span> times: <span class="math display">\[
x \leftarrow x^2 \bmod n.
\]</span> If at any step <span class="math inline">\(x = n-1\)</span>, the base passes. If none hit <span class="math inline">\(n-1\)</span>, declare composite.</p></li>
</ol>
<p>If all <span class="math inline">\(k\)</span> bases pass, declare probably prime. For composite <span class="math inline">\(n\)</span>, a random base exposes compositeness with probability at least <span class="math inline">\(1/4\)</span>, so error is at most <span class="math inline">\((1/4)^k\)</span>.</p>
</section>
<section id="tiny-code-easy-versions-11" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-11">Tiny Code (Easy Versions)</h4>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">uint64_t</span> mul_mod<span class="op">(</span><span class="dt">uint64_t</span> a<span class="op">,</span> <span class="dt">uint64_t</span> b<span class="op">,</span> <span class="dt">uint64_t</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    __uint128_t z <span class="op">=</span>$__uint128_t$a <span class="op">*</span> b <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">uint64_t</span><span class="op">)</span>z<span class="op">;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">uint64_t</span> pow_mod<span class="op">(</span><span class="dt">uint64_t</span> a<span class="op">,</span> <span class="dt">uint64_t</span> e<span class="op">,</span> <span class="dt">uint64_t</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> r <span class="op">=</span> <span class="dv">1</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m<span class="op">;</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>e <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> r <span class="op">=</span> mul_mod<span class="op">(</span>r<span class="op">,</span> a<span class="op">,</span> m<span class="op">);</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> mul_mod<span class="op">(</span>a<span class="op">,</span> a<span class="op">,</span> m<span class="op">);</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">int</span> miller_rabin_base<span class="op">(</span><span class="dt">uint64_t</span> n<span class="op">,</span> <span class="dt">uint64_t</span> a<span class="op">,</span> <span class="dt">uint64_t</span> d<span class="op">,</span> <span class="dt">int</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> x <span class="op">=</span> pow_mod<span class="op">(</span>a<span class="op">,</span> d<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>x <span class="op">==</span> <span class="dv">1</span> <span class="op">||</span> x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> s<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> mul_mod<span class="op">(</span>x<span class="op">,</span> x<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// composite for this base</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_probable_prime<span class="op">(</span><span class="dt">uint64_t</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">uint64_t</span> p <span class="op">:</span> <span class="op">(</span><span class="dt">uint64_t</span><span class="op">[]){</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">17</span><span class="op">,</span><span class="dv">19</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">0</span><span class="op">})</span> <span class="op">{</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> n <span class="op">==</span> p<span class="op">;</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">// write n-1 = 2^s * d</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> d <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> s <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">((</span>d <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> d <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span> s<span class="op">++;</span> <span class="op">}</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Deterministic set for 64-bit integers</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> bases<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">17</span><span class="op">};</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> nb <span class="op">=</span> <span class="kw">sizeof</span><span class="op">(</span>bases<span class="op">)</span> <span class="op">/</span> <span class="kw">sizeof</span><span class="op">(</span>bases<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> nb<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint64_t</span> a <span class="op">=</span> bases<span class="op">[</span>i<span class="op">]</span> <span class="op">%</span> n<span class="op">;</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>miller_rabin_base<span class="op">(</span>n<span class="op">,</span> a<span class="op">,</span> d<span class="op">,</span> s<span class="op">))</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// probably prime</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint64_t</span> n<span class="op">;</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>scanf<span class="op">(</span><span class="st">"</span><span class="sc">%llu</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">)</span> <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%llu</span><span class="st"> is </span><span class="sc">%s\n</span><span class="st">"</span><span class="op">,</span> n<span class="op">,</span> is_probable_prime<span class="op">(</span>n<span class="op">)</span> <span class="op">?</span> <span class="st">"probably prime"</span> <span class="op">:</span> <span class="st">"composite"</span><span class="op">);</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pow_mod(a, e, m):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>            r <span class="op">=</span> (r <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (a <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> miller_rabin(n, bases<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    small_primes <span class="op">=</span> [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">23</span>]</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> small_primes:</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> n <span class="op">==</span> p</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write n-1 = 2^s * d</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> d <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        d <span class="op">//=</span> <span class="dv">2</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        s <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bases <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Deterministic for 64-bit range</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>        bases <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">17</span>]</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a <span class="kw">in</span> bases:</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>        a <span class="op">%=</span> n</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> pow_mod(a, d, n)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x <span class="op">==</span> <span class="dv">1</span> <span class="kw">or</span> x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(s <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> (x <span class="op">*</span> x) <span class="op">%</span> n</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>().strip())</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"probably prime"</span> <span class="cf">if</span> miller_rabin(n) <span class="cf">else</span> <span class="st">"composite"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-13" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-13">Why It Matters</h4>
<ul>
<li>Very fast screening test for large integers.</li>
<li>Standard in cryptographic key generation pipelines.</li>
<li>With a fixed base set, becomes deterministic for bounded ranges (for 64 bit integers, the given bases suffice).</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-13" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-13">A Gentle Proof (Why It Works)</h4>
<p>Fermat style motivation: if <span class="math inline">\(n\)</span> is prime and <span class="math inline">\(\gcd(a,n)=1\)</span>, then by Euler <span class="math display">\[
a^{n-1} \equiv 1 \pmod n.
\]</span> Stronger, by writing <span class="math inline">\(n-1 = 2^s d\)</span>, the sequence <span class="math display">\[
a^{d},\ a^{2d},\ a^{4d},\ \ldots,\ a^{2^{s-1}d} \pmod n
\]</span> must land at <span class="math inline">\(1\)</span> through a chain that can only introduce the value <span class="math inline">\(-1 \equiv n-1\)</span> immediately before <span class="math inline">\(1\)</span>. If the chain misses <span class="math inline">\(n-1\)</span>, <span class="math inline">\(a\)</span> certifies compositeness. For composite <span class="math inline">\(n\)</span>, at least three quarters of <span class="math inline">\(a\)</span> are witnesses, giving error at most <span class="math inline">\((1/4)^k\)</span> after <span class="math inline">\(k\)</span> independent bases.</p>
</section>
<section id="try-it-yourself-13" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-13">Try It Yourself</h4>
<ol type="1">
<li>Factor <span class="math inline">\(n-1\)</span> as <span class="math inline">\(2^s d\)</span> for <span class="math inline">\(n = 561\)</span> and test bases <span class="math inline">\(a = 2, 3, 5\)</span>.</li>
<li>Generate random 64 bit odd <span class="math inline">\(n\)</span> and compare Miller–Rabin against trial division up to <span class="math inline">\(10^6\)</span>.</li>
<li>Replace bases with random choices and measure error frequency on Carmichael numbers.</li>
<li>Extend to a deterministic set that covers your target range.</li>
</ol>
</section>
<section id="test-cases-13" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-13">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 39%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Result</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(37\)</span></td>
<td>probably prime</td>
<td>prime</td>
</tr>
<tr class="even">
<td><span class="math inline">\(221 = 13 \cdot 17\)</span></td>
<td>composite</td>
<td>small factor</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(561\)</span></td>
<td>composite</td>
<td>Carmichael number</td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{61}-1\)</span></td>
<td>probably prime</td>
<td>Mersenne candidate</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(10^{18}+3\)</span></td>
<td>composite or probably prime</td>
<td>depends on actual value</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-13" class="level4">
<h4 class="anchored" data-anchor-id="complexity-13">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(k \log^3 n)\)</span> with schoolbook modular multiplication, <span class="math inline">\(k\)</span> bases.</li>
<li>Space: <span class="math inline">\(O(1)\)</span> iterative state.</li>
</ul>
<p>Miller–Rabin gives a fast and reliable primality screen: decompose <span class="math inline">\(n-1\)</span>, test a few bases, and either certify compositeness or return a very strong probably prime.</p>
</section>
</section>
<section id="fermat-primality-test" class="level3">
<h3 class="anchored" data-anchor-id="fermat-primality-test">515 Fermat Primality Test</h3>
<p>The Fermat primality test is one of the simplest probabilistic tests for determining whether a number is likely prime. It’s based on Fermat’s Little Theorem, which states that if<span class="math inline">\(n\)</span> is prime and<span class="math inline">\(a\)</span> is not divisible by<span class="math inline">\(n\)</span>, then</p>
<p><span class="math display">\[
a^{n-1} \equiv 1 \pmod{n}.
\]</span></p>
<p>If this congruence fails for some base<span class="math inline">\(a\)</span>, then<span class="math inline">\(n\)</span> is definitely composite. If it holds for several randomly chosen bases,<span class="math inline">\(n\)</span> is probably prime.</p>
<section id="what-problem-are-we-solving-14" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-14">What Problem Are We Solving?</h4>
<p>We want a fast check for whether<span class="math inline">\(n\)</span> is prime, especially for large<span class="math inline">\(n\)</span>, where trial division or sieves are too slow.</p>
<p>We test whether numbers satisfy Fermat’s congruence condition:</p>
<p><span class="math display">\[
a^{n-1} \bmod n = 1
\]</span></p>
<p>for random bases<span class="math inline">\(a \in [2, n-2]\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-14" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-14">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Choose a random integer<span class="math inline">\(a\)</span>,<span class="math inline">\(2 \le a \le n-2\)</span>.</li>
<li>Compute<span class="math inline">\(x = a^{n-1} \bmod n\)</span>.</li>
<li>If<span class="math inline">\(x \ne 1\)</span>,<span class="math inline">\(n\)</span> is composite.</li>
<li>If<span class="math inline">\(x = 1\)</span>,<span class="math inline">\(n\)</span> might be prime.</li>
<li>Repeat several times with different<span class="math inline">\(a\)</span> for higher confidence.</li>
</ol>
<p>If<span class="math inline">\(n\)</span> passes for all chosen bases, we say probably prime. If it fails for any base, composite.</p>
<p>Example: Test<span class="math inline">\(n = 561\)</span> (a Carmichael number).</p>
<ul>
<li>Pick<span class="math inline">\(a = 2\)</span>:<span class="math inline">\(2^{560} \bmod 561 = 1\)</span></li>
<li>Pick<span class="math inline">\(a = 3\)</span>:<span class="math inline">\(3^{560} \bmod 561 = 1\)</span></li>
<li>Pick<span class="math inline">\(a = 5\)</span>:<span class="math inline">\(5^{560} \bmod 561 = 1\)</span></li>
</ul>
<p>All pass, but<span class="math inline">\(561 = 3 \cdot 11 \cdot 17\)</span> is composite. Hence, Fermat test can be fooled by Carmichael numbers.</p>
</section>
<section id="tiny-code-easy-versions-12" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-12">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pow_mod(a, e, m):</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            r <span class="op">=</span> (r <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (a <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fermat_test(n, k<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="kw">in</span> (<span class="dv">2</span>, <span class="dv">3</span>):</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(k):</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> random.randint(<span class="dv">2</span>, n <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pow_mod(a, n <span class="op">-</span> <span class="dv">1</span>, n) <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">"Enter n: "</span>))</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Probably prime"</span> <span class="cf">if</span> fermat_test(n) <span class="cf">else</span> <span class="st">"Composite"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> pow_mod<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> e<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> r <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m<span class="op">;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>e <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> r <span class="op">=</span> <span class="op">(</span>r <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="op">(</span>a <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fermat_test<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> n<span class="op">,</span> <span class="dt">int</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> n <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    srand<span class="op">(</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> k<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> a <span class="op">=</span> <span class="dv">2</span> <span class="op">+</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>pow_mod<span class="op">(</span>a<span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">)</span> <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> n<span class="op">;</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter n: "</span><span class="op">);</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">);</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st"> is </span><span class="sc">%s\n</span><span class="st">"</span><span class="op">,</span> n<span class="op">,</span> fermat_test<span class="op">(</span>n<span class="op">,</span> <span class="dv">5</span><span class="op">)</span> <span class="op">?</span> <span class="st">"probably prime"</span> <span class="op">:</span> <span class="st">"composite"</span><span class="op">);</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-14" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-14">Why It Matters</h4>
<ul>
<li>Extremely simple to implement</li>
<li>Useful as a first filter before stronger tests (e.g.&nbsp;Miller–Rabin)</li>
<li>Foundation for many probabilistic algorithms in number theory</li>
<li>Helps illustrate Fermat’s Little Theorem in computational form</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-14" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-14">A Gentle Proof (Why It Works)</h4>
<p>If<span class="math inline">\(n\)</span> is prime and<span class="math inline">\(\gcd(a, n) = 1\)</span>, Fermat’s Little Theorem guarantees:</p>
<p><span class="math display">\[
a^{n-1} \equiv 1 \pmod{n}.
\]</span></p>
<p>If this fails,<span class="math inline">\(n\)</span> cannot be prime. However, some composite numbers (Carmichael numbers) satisfy this condition for all<span class="math inline">\(a\)</span> coprime to<span class="math inline">\(n\)</span>. Thus, the test is probabilistic, not deterministic.</p>
</section>
<section id="try-it-yourself-14" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-14">Try It Yourself</h4>
<ol type="1">
<li>Test<span class="math inline">\(n = 37\)</span> with bases 2, 3, 5.</li>
<li>Try<span class="math inline">\(n = 561\)</span> and see the failure.</li>
<li>Increase<span class="math inline">\(k\)</span> (number of trials) to see stability.</li>
<li>Compare runtime with Miller–Rabin.</li>
<li>Build a composite that passes one base but fails another.</li>
</ol>
</section>
<section id="test-cases-14" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-14">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Bases</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>37</td>
<td>2, 3, 5</td>
<td>Pass → probably prime</td>
</tr>
<tr class="even">
<td>15</td>
<td>2</td>
<td>Fail → composite</td>
</tr>
<tr class="odd">
<td>561</td>
<td>2, 3, 5</td>
<td>Pass → false positive</td>
</tr>
<tr class="even">
<td>97</td>
<td>2, 3</td>
<td>Pass → probably prime</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-14" class="level4">
<h4 class="anchored" data-anchor-id="complexity-14">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(k \log^3 n)\)</span> (due to modular exponentiation)</li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>The Fermat test is primality at lightning speed, but with a trickster’s flaw: it can be fooled by clever composites called Carmichael numbers.</p>
</section>
</section>
<section id="pollards-rho-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="pollards-rho-algorithm">516 Pollard’s Rho Algorithm</h3>
<p>The Pollard’s Rho algorithm is a clever randomized method for integer factorization. It uses a simple iterative function and the birthday paradox to find nontrivial factors quickly, without trial division. Though probabilistic, it’s extremely effective for finding small factors of large numbers.</p>
<section id="what-problem-are-we-solving-15" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-15">What Problem Are We Solving?</h4>
<p>Given a composite number<span class="math inline">\(n\)</span>, find a nontrivial factor<span class="math inline">\(d\)</span> such that ( 1 &lt; d &lt; n$.</p>
<p>Instead of checking divisibility exhaustively, Pollard’s Rho uses a pseudorandom sequence modulo<span class="math inline">\(n\)</span> and detects when two values become congruent modulo a hidden factor.</p>
</section>
<section id="how-does-it-work-plain-language-15" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-15">How Does It Work (Plain Language)</h4>
<p>We define an iteration:</p>
<p><span class="math display">\[
x_{i+1} = f(x_i) \bmod n, \quad \text{commonly } f(x) = (x^2 + c) \bmod n
\]</span></p>
<p>Two sequences running at different speeds (like a “tortoise and hare”) eventually collide modulo a factor of<span class="math inline">\(n\)</span>. When they do, the gcd of their difference with<span class="math inline">\(n\)</span> gives a factor.</p>
<p>Algorithm Outline</p>
<ol type="1">
<li><p>Pick a random function<span class="math inline">\(f(x) = (x^2 + c) \bmod n\)</span> with random<span class="math inline">\(x_0\)</span> and<span class="math inline">\(c\)</span>.</p></li>
<li><p>Set<span class="math inline">\(x = y = x_0\)</span>,<span class="math inline">\(d = 1\)</span>.</p></li>
<li><p>While<span class="math inline">\(d = 1\)</span>:</p>
<p><em><span class="math inline">\(x = f(x)\)</span> </em><span class="math inline">\(y = f(f(y))\)</span> *<span class="math inline">\(d = \gcd(|x - y|, n)\)</span></p></li>
<li><p>If<span class="math inline">\(d = n\)</span>, restart with a new function.</p></li>
<li><p>If<span class="math inline">\(1 &lt; d &lt; n\)</span>, output<span class="math inline">\(d\)</span>.</p></li>
</ol>
<p>Example: Let<span class="math inline">\(n = 8051 = 83 \times 97\)</span>. Choose<span class="math inline">\(f(x) = (x^2 + 1) \bmod 8051\)</span>,<span class="math inline">\(x_0 = 2\)</span>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>(x)</th>
<th>(y)</th>
<th>(</th>
<th>x-y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>5</td>
<td>26</td>
<td>21</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>26</td>
<td>7474</td>
<td>7448</td>
<td>83</td>
</tr>
</tbody>
</table>
<p>Ok Found factor<span class="math inline">\(83\)</span></p>
</section>
<section id="tiny-code-easy-versions-13" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-13">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x, c, n):</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">*</span> x <span class="op">+</span> c) <span class="op">%</span> n</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pollard_rho(n):</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> random.randint(<span class="dv">2</span>, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> x</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> random.randint(<span class="dv">1</span>, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> d <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> f(x, c, n)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> f(f(y, c, n), c, n)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> math.gcd(<span class="bu">abs</span>(x <span class="op">-</span> y), n)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> d <span class="op">==</span> n:</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> pollard_rho(n)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">"Enter n: "</span>))</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>factor <span class="op">=</span> pollard_rho(n)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Nontrivial factor of </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>factor<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> gcd<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> t <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> a <span class="op">%</span> b<span class="op">;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> f<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> x<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> c<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>x <span class="op">*</span> x <span class="op">+</span> c<span class="op">)</span> <span class="op">%</span> n<span class="op">;</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> pollard_rho<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">2</span><span class="op">)</span> <span class="op">+</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> y <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> c <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> d <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> f<span class="op">(</span>x<span class="op">,</span> c<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> f<span class="op">(</span>f<span class="op">(</span>y<span class="op">,</span> c<span class="op">,</span> n<span class="op">),</span> c<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> diff <span class="op">=</span> x <span class="op">&gt;</span> y <span class="op">?</span> x <span class="op">-</span> y <span class="op">:</span> y <span class="op">-</span> x<span class="op">;</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> gcd<span class="op">(</span>diff<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> n<span class="op">)</span> <span class="cf">return</span> pollard_rho<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    srand<span class="op">(</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> n<span class="op">;</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter n: "</span><span class="op">);</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">);</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> factor <span class="op">=</span> pollard_rho<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Nontrivial factor: </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> factor<span class="op">);</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-15" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-15">Why It Matters</h4>
<ul>
<li>Finds factors much faster than trial division</li>
<li>Crucial in integer factorization, cryptanalysis, and RSA key testing</li>
<li>Basis for advanced algorithms (e.g.&nbsp;Pollard’s p–1, Brent’s Rho)</li>
<li>Probabilistic yet efficient for small factors</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-15" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-15">A Gentle Proof (Why It Works)</h4>
<p>If two values become congruent modulo a factor<span class="math inline">\(p\)</span> of<span class="math inline">\(n\)</span>: <span class="math display">\[
x_i \equiv x_j \pmod{p}, \quad i \ne j
\]</span> then<span class="math inline">\(p \mid (x_i - x_j)\)</span>, and thus <span class="math display">\[
\gcd(|x_i - x_j|, n) = p.
\]</span> Because<span class="math inline">\(p\)</span> divides<span class="math inline">\(n\)</span>, but not all of<span class="math inline">\(n\)</span>, it reveals a nontrivial factor.</p>
<p>The “Rho” shape refers to the cycle formed by repeated squaring modulo<span class="math inline">\(p\)</span>.</p>
</section>
<section id="try-it-yourself-15" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-15">Try It Yourself</h4>
<ol type="1">
<li>Factor<span class="math inline">\(n = 8051\)</span>.</li>
<li>Try different functions<span class="math inline">\(f(x) = x^2 + c\)</span>.</li>
<li>Test on <span class="math inline">\(n = 91, 187, 589\)</span>.</li>
<li>Compare runtime to trial division.</li>
<li>Combine with recursion to fully factor <span class="math inline">\(n\)</span>.</li>
</ol>
</section>
<section id="test-cases-15" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-15">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Factors</th>
<th>Found</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>91</td>
<td>7 × 13</td>
<td>7</td>
</tr>
<tr class="even">
<td>187</td>
<td>11 × 17</td>
<td>17</td>
</tr>
<tr class="odd">
<td>8051</td>
<td>83 × 97</td>
<td>83</td>
</tr>
<tr class="even">
<td>2047</td>
<td>23 × 89</td>
<td>23</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-15" class="level4">
<h4 class="anchored" data-anchor-id="complexity-15">Complexity</h4>
<ul>
<li>Expected Time: <span class="math inline">\(O(n^{1/4})\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Pollard’s Rho is like chasing your own tail, but eventually, the loop gives up a hidden factor.</p>
</section>
</section>
<section id="pollards-p1-method" class="level3">
<h3 class="anchored" data-anchor-id="pollards-p1-method">517 Pollard’s p−1 Method</h3>
<p>The Pollard’s p−1 algorithm is a specialized factorization method that works best when a prime factor<span class="math inline">\(p\)</span> of<span class="math inline">\(n\)</span> has a smooth value of<span class="math inline">\(p - 1\)</span> (that is,<span class="math inline">\(p-1\)</span> factors completely into small primes). It’s one of the earliest practical improvements over trial division, simple, elegant, and effective for numbers with smooth prime factors.</p>
<section id="what-problem-are-we-solving-16" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-16">What Problem Are We Solving?</h4>
<p>Given a composite number<span class="math inline">\(n\)</span>, we want to find a nontrivial factor<span class="math inline">\(d\)</span> such that<span class="math inline">\(1 &lt; d &lt; n\)</span>.</p>
<p>This method exploits Fermat’s Little Theorem:</p>
<p><span class="math display">\[
a^{p-1} \equiv 1 \pmod{p}
\]</span></p>
<p>If<span class="math inline">\(p \mid n\)</span>, then<span class="math inline">\(p\)</span> divides<span class="math inline">\(a^{p-1} - 1\)</span>, even if<span class="math inline">\(p\)</span> is unknown.</p>
<p>By computing<span class="math inline">\(\gcd(a^M - 1, n)\)</span> for a suitable<span class="math inline">\(M\)</span>, we may find such<span class="math inline">\(p\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-16" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-16">How Does It Work (Plain Language)</h4>
<p>If<span class="math inline">\(p\)</span> is a prime factor of<span class="math inline">\(n\)</span> and<span class="math inline">\(p-1\)</span> divides<span class="math inline">\(M\)</span>, then<span class="math inline">\(a^{M} \equiv 1 \pmod{p}\)</span>. So<span class="math inline">\(p\)</span> divides<span class="math inline">\(a^{M} - 1\)</span>. Taking the gcd with<span class="math inline">\(n\)</span> reveals<span class="math inline">\(p\)</span>.</p>
<p>Algorithm:</p>
<ol type="1">
<li>Choose a base<span class="math inline">\(a\)</span> (commonly 2).</li>
<li>Choose a smoothness bound<span class="math inline">\(B\)</span>.</li>
<li>Compute: <span class="math display">\[
M = \text{lcm}(1, 2, 3, \ldots, B)
\]</span> and <span class="math display">\[
g = \gcd(a^M - 1, n)
\]</span></li>
<li>If<span class="math inline">\(1 &lt; g &lt; n\)</span>, return<span class="math inline">\(g\)</span> (a nontrivial factor). If<span class="math inline">\(g = 1\)</span>, increase<span class="math inline">\(B\)</span>. If<span class="math inline">\(g = n\)</span>, choose a different<span class="math inline">\(a\)</span>.</li>
</ol>
<p>Example: Let<span class="math inline">\(n = 91 = 7 \times 13\)</span>.</p>
<p>Take<span class="math inline">\(a = 2\)</span>,<span class="math inline">\(B = 5\)</span>. Then<span class="math inline">\(M = \text{lcm}(1, 2, 3, 4, 5) = 60\)</span>.</p>
<p>Compute<span class="math inline">\(g = \gcd(2^{60} - 1, 91)\)</span>.</p>
<p><span class="math display">\[
2^{60} - 1 \bmod 91 = 0 \implies g = 7
\]</span></p>
<p>Ok Found factor<span class="math inline">\(7\)</span></p>
</section>
<section id="tiny-code-easy-versions-14" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-14">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> gcd</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pow_mod(a, e, n):</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> n</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>            r <span class="op">=</span> (r <span class="op">*</span> a) <span class="op">%</span> n</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (a <span class="op">*</span> a) <span class="op">%</span> n</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pollard_p_minus_1(n, B<span class="op">=</span><span class="dv">10</span>, a<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, B <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        M <span class="op">*=</span> i <span class="op">//</span> math.gcd(M, i)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> pow_mod(a, M, n)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> gcd(x <span class="op">-</span> <span class="dv">1</span>, n)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="dv">1</span> <span class="op">&lt;</span> g <span class="op">&lt;</span> n:</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> g</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">"Enter n: "</span>))</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>factor <span class="op">=</span> pollard_p_minus_1(n, B<span class="op">=</span><span class="dv">10</span>, a<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> factor:</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Nontrivial factor of </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>factor<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"No factor found, try larger B"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> gcd<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> t <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> a <span class="op">%</span> b<span class="op">;</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> pow_mod<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> e<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> r <span class="op">=</span> <span class="dv">1</span> <span class="op">%</span> n<span class="op">;</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> n<span class="op">;</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>e <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> r <span class="op">=</span> <span class="op">(</span>r <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> n<span class="op">;</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="op">(</span>a <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> n<span class="op">;</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> pollard_p_minus_1<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> n<span class="op">,</span> <span class="dt">int</span> B<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> M <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> B<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> g <span class="op">=</span> gcd<span class="op">(</span>M<span class="op">,</span> i<span class="op">);</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>        M <span class="op">=</span> M <span class="op">/</span> g <span class="op">*</span> i<span class="op">;</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> x <span class="op">=</span> pow_mod<span class="op">(</span>a<span class="op">,</span> M<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> g <span class="op">=</span> gcd<span class="op">(</span>x <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>g <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> g <span class="op">&lt;</span> n<span class="op">)</span> <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> n<span class="op">;</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter n: "</span><span class="op">);</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">);</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> factor <span class="op">=</span> pollard_p_minus_1<span class="op">(</span>n<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>factor<span class="op">)</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"Nontrivial factor: </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> factor<span class="op">);</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"No factor found. Try larger B.</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-16" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-16">Why It Matters</h4>
<ul>
<li>Excellent for factoring numbers with smooth prime factors</li>
<li>Simple to implement</li>
<li>Fast compared to trial division</li>
<li>Builds intuition for group order and Fermat’s Little Theorem</li>
</ul>
<p>Used in:</p>
<ul>
<li>RSA key validation</li>
<li>Elliptic curve methods (ECM) as conceptual base</li>
<li>Educational number theory and cryptography</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-16" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-16">A Gentle Proof (Why It Works)</h4>
<p>If<span class="math inline">\(p \mid n\)</span> and<span class="math inline">\(p - 1 \mid M\)</span>, then by Fermat’s Little Theorem: <span class="math display">\[
a^{p-1} \equiv 1 \pmod{p}
\]</span> so <span class="math display">\[
a^{M} \equiv 1 \pmod{p}.
\]</span></p>
<p>Hence<span class="math inline">\(p \mid a^M - 1\)</span>, so <span class="math display">\[
\gcd(a^M - 1, n) \ge p.
\]</span></p>
<p>If<span class="math inline">\(p \ne n\)</span>, this gcd gives a nontrivial factor.</p>
<p>If<span class="math inline">\(p-1\)</span> is not smooth,<span class="math inline">\(M\)</span> must be larger to capture its factors.</p>
</section>
<section id="try-it-yourself-16" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-16">Try It Yourself</h4>
<ol type="1">
<li>Factor<span class="math inline">\(91 = 7 \times 13\)</span> with<span class="math inline">\(B = 5\)</span>.</li>
<li>Try<span class="math inline">\(8051 = 83 \times 97\)</span>; increase<span class="math inline">\(B\)</span> gradually.</li>
<li>Experiment with different bases<span class="math inline">\(a\)</span>.</li>
<li>Compare runtime with Pollard’s Rho.</li>
<li>Observe failure when<span class="math inline">\(p-1\)</span> has large prime factors.</li>
</ol>
</section>
<section id="test-cases-16" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-16">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Factors</th>
<th>Bound <span class="math inline">\(B\)</span></th>
<th>Found</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>91</td>
<td>7 × 13</td>
<td>5</td>
<td>7</td>
</tr>
<tr class="even">
<td>187</td>
<td>11 × 17</td>
<td>10</td>
<td>11</td>
</tr>
<tr class="odd">
<td>589</td>
<td>19 × 31</td>
<td>15</td>
<td>19</td>
</tr>
<tr class="even">
<td>8051</td>
<td>83 × 97</td>
<td>20</td>
<td>83</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-16" class="level4">
<h4 class="anchored" data-anchor-id="complexity-16">Complexity</h4>
<ul>
<li>Time:<span class="math inline">\(O(B \log^2 n)\)</span>, depends on smoothness of<span class="math inline">\(p-1\)</span></li>
<li>Space:<span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Pollard’s p−1 method is a mathematical keyhole, it opens composite locks when one factor’s order is built from small primes.</p>
</section>
</section>
<section id="wheel-factorization" class="level3">
<h3 class="anchored" data-anchor-id="wheel-factorization">518 Wheel Factorization</h3>
<p>Wheel factorization is a deterministic optimization for trial division. It systematically skips obvious composites by constructing a repeating pattern (the “wheel”) of candidate offsets that are coprime to small primes. This reduces the number of divisibility checks, making basic primality and factorization tests much faster.</p>
<section id="what-problem-are-we-solving-17" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-17">What Problem Are We Solving?</h4>
<p>We want to test whether a number <span class="math inline">\(n\)</span> is prime or factor it, but without checking every integer up to <span class="math inline">\(\sqrt{n}\)</span>.</p>
<p>Instead of testing all numbers, we skip those clearly divisible by small primes such as <span class="math inline">\(2,3,5,7,\ldots\)</span>. The wheel pattern encodes these skips.</p>
</section>
<section id="how-does-it-work-plain-language-17" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-17">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Choose a set of small primes (the basis), for example <span class="math inline">\(\{2,3,5\}\)</span>.</li>
<li>Compute the wheel size as their product: <span class="math display">\[
W = 2 \times 3 \times 5 = 30
\]</span></li>
<li>Determine the residues modulo <span class="math inline">\(W\)</span> that are coprime to <span class="math inline">\(W\)</span>: <span class="math display">\[
\{1,7,11,13,17,19,23,29\}
\]</span></li>
<li>To test numbers up to <span class="math inline">\(n\)</span>, only check candidates of the form <span class="math display">\[
kW + r \quad \text{for } r \in \text{residues}.
\]</span></li>
<li>For each candidate <span class="math inline">\(m\)</span>, test divisibility up to <span class="math inline">\(\sqrt{m}\)</span>.</li>
</ol>
<p>This skips about 73% of integers when using the <span class="math inline">\(2\times3\times5\)</span> wheel.</p>
<p>Example</p>
<p>Find primes <span class="math inline">\(\le 50\)</span> using the wheel with <span class="math inline">\(\{2,3,5\}\)</span>.</p>
<p>Wheel residues mod 30: <span class="math display">\[
1, 7, 11, 13, 17, 19, 23, 29
\]</span></p>
<p>Candidates: <span class="math display">\[
1, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 49
\]</span></p>
<p>Filter by divisibility up to <span class="math inline">\(\sqrt{50}\)</span>:</p>
<p>Primes: <span class="math display">\[
7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47
\]</span></p>
</section>
<section id="tiny-code-easy-versions-15" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-15">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wheel_candidates(limit, base_primes<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>]):</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    W <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> base_primes:</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        W <span class="op">*=</span> p</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    residues <span class="op">=</span> [r <span class="cf">for</span> r <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, W) <span class="cf">if</span> <span class="bu">all</span>(r <span class="op">%</span> p <span class="op">!=</span> <span class="dv">0</span> <span class="cf">for</span> p <span class="kw">in</span> base_primes)]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    candidates <span class="op">=</span> []</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> k <span class="op">*</span> W <span class="op">&lt;=</span> limit:</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> r <span class="kw">in</span> residues:</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>            num <span class="op">=</span> k <span class="op">*</span> W <span class="op">+</span> r</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> num <span class="op">&lt;=</span> limit:</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                candidates.append(num)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        k <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> candidates</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_prime(n):</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>: <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="kw">in</span> (<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>): <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>]:</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> candidate <span class="kw">in</span> wheel_candidates(<span class="bu">int</span>(math.sqrt(n)) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="op">%</span> candidate <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">"Enter n: "</span>))</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n, <span class="st">"is"</span>, <span class="st">"prime"</span> <span class="cf">if</span> is_prime(n) <span class="cf">else</span> <span class="st">"composite"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> is_prime<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> n <span class="op">==</span> <span class="dv">3</span> <span class="op">||</span> n <span class="op">==</span> <span class="dv">5</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> n <span class="op">%</span> <span class="dv">3</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> n <span class="op">%</span> <span class="dv">5</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> residues<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">17</span><span class="op">,</span> <span class="dv">19</span><span class="op">,</span> <span class="dv">23</span><span class="op">,</span> <span class="dv">29</span><span class="op">};</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> wheel <span class="op">=</span> <span class="dv">30</span><span class="op">;</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> limit <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>sqrt<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">*</span> wheel <span class="op">&lt;=</span> limit<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">8</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> d <span class="op">=</span> k <span class="op">*</span> wheel <span class="op">+</span> residues<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>d <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">&lt;=</span> limit <span class="op">&amp;&amp;</span> n <span class="op">%</span> d <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter n: "</span><span class="op">);</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">);</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> is </span><span class="sc">%s\n</span><span class="st">"</span><span class="op">,</span> n<span class="op">,</span> is_prime<span class="op">(</span>n<span class="op">)</span> <span class="op">?</span> <span class="st">"prime"</span> <span class="op">:</span> <span class="st">"composite"</span><span class="op">);</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-17" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-17">Why It Matters</h4>
<ul>
<li>Reduces trial checks by skipping obvious composites</li>
<li>Speeds up trial division and sieve methods</li>
<li>Reusable in wheel sieves (e.g.&nbsp;2×3×5×7 wheel)</li>
<li>Conceptual link between modular arithmetic and primality testing</li>
</ul>
<p>Commonly used in:</p>
<ul>
<li>Optimized primality tests</li>
<li>Prime sieves (wheel sieve of Eratosthenes)</li>
<li>Hybrid factorization routines</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-17" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-17">A Gentle Proof (Why It Works)</h4>
<p>Any number (n) that shares a factor with any base prime (p) will appear in a non-coprime residue class modulo (W). By checking only residues coprime to (W), we remove all such composites.</p>
<p>Thus, every remaining candidate is coprime to all base primes, and we need only check divisibility by larger primes.</p>
</section>
<section id="try-it-yourself-17" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-17">Try It Yourself</h4>
<ol type="1">
<li>Build wheels for ({2, 3}), ({2, 3, 5}), and ({2, 3, 5, 7}).</li>
<li>Count how many integers each skips up to 100.</li>
<li>Compare runtime with plain trial division.</li>
<li>Use wheel to speed up a sieve implementation.</li>
<li>Print residues and visualize the pattern.</li>
</ol>
</section>
<section id="test-cases-17" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-17">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Base Primes</th>
<th>Wheel Size</th>
<th>Residues</th>
<th>Skip %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>{2, 3}</td>
<td>6</td>
<td>1, 5</td>
<td>66%</td>
</tr>
<tr class="even">
<td>{2, 3, 5}</td>
<td>30</td>
<td>1, 7, 11, 13, 17, 19, 23, 29</td>
<td>73%</td>
</tr>
<tr class="odd">
<td>{2, 3, 5, 7}</td>
<td>210</td>
<td>48 residues</td>
<td>77%</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7</td>
<td>prime</td>
</tr>
<tr class="even">
<td>49</td>
<td>composite</td>
</tr>
<tr class="odd">
<td>97</td>
<td>prime</td>
</tr>
<tr class="even">
<td>121</td>
<td>composite</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-17" class="level4">
<h4 class="anchored" data-anchor-id="complexity-17">Complexity</h4>
<ul>
<li>Time:<span class="math inline">\(O(\frac{\sqrt{n}}{\phi(W)})\)</span>, fewer checks than<span class="math inline">\(O(\sqrt{n})\)</span></li>
<li>Space:<span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Wheel factorization is like building a gear that only touches promising numbers, a simple modular pattern to roll through candidates efficiently.</p>
</section>
</section>
<section id="aks-primality-test" class="level3">
<h3 class="anchored" data-anchor-id="aks-primality-test">519 AKS Primality Test</h3>
<p>The AKS primality test is the first deterministic, polynomial-time algorithm for primality testing that does not rely on unproven hypotheses. It answers one of the oldest questions in computational number theory:</p>
<blockquote class="blockquote">
<p>Can we check if a number is prime in polynomial time, for sure?</p>
</blockquote>
<p>Unlike probabilistic tests (Fermat, Miller–Rabin), AKS gives a definite answer, no randomness, no false positives.</p>
<section id="what-problem-are-we-solving-18" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-18">What Problem Are We Solving?</h4>
<p>We want to deterministically decide whether a number<span class="math inline">\(n\)</span> is prime or composite in polynomial time, without relying on assumptions like the Riemann Hypothesis.</p>
</section>
<section id="the-core-idea" class="level4">
<h4 class="anchored" data-anchor-id="the-core-idea">The Core Idea</h4>
<p>A number <span class="math inline">\(n\)</span> is prime if and only if it satisfies</p>
<p><span class="math display">\[
(x + a)^n \equiv x^n + a \pmod{n}
\]</span></p>
<p>for all integers <span class="math inline">\(a\)</span>.</p>
<p>This congruence captures the binomial property of primes: in a prime modulus, all binomial coefficients <span class="math inline">\(\binom{n}{k}\)</span> with <span class="math inline">\(0 &lt; k &lt; n\)</span> vanish modulo <span class="math inline">\(n\)</span>.</p>
<p>The AKS algorithm refines this condition into a computable primality test.</p>
</section>
<section id="the-algorithm-simplified" class="level4">
<h4 class="anchored" data-anchor-id="the-algorithm-simplified">The Algorithm (Simplified)</h4>
<p>Step 1. Check if <span class="math inline">\(n\)</span> is a perfect power.<br>
If <span class="math inline">\(n = a^b\)</span> for some integers <span class="math inline">\(a, b &gt; 1\)</span>, then <span class="math inline">\(n\)</span> is composite.</p>
<p>Step 2. Find the smallest integer <span class="math inline">\(r\)</span> such that</p>
<p><span class="math display">\[
\text{ord}_r(n) &gt; (\log_2 n)^2
\]</span></p>
<p>where <span class="math inline">\(\text{ord}_r(n)\)</span> is the multiplicative order of <span class="math inline">\(n\)</span> modulo <span class="math inline">\(r\)</span>.</p>
<p>Step 3. For each <span class="math inline">\(a = 2, 3, \ldots, r\)</span>:<br>
If <span class="math inline">\(1 &lt; \gcd(a, n) &lt; n\)</span>, then <span class="math inline">\(n\)</span> is composite.</p>
<p>Step 4. If <span class="math inline">\(n \le r\)</span>, then <span class="math inline">\(n\)</span> is prime.</p>
<p>Step 5. For all integers <span class="math inline">\(a = 1, 2, \ldots, \lfloor \sqrt{\phi(r)} \log n \rfloor\)</span>, check whether</p>
<p><span class="math display">\[
(x + a)^n \equiv x^n + a \pmod{(x^r - 1, n)}.
\]</span></p>
<p>If any test fails, <span class="math inline">\(n\)</span> is composite.<br>
Otherwise, <span class="math inline">\(n\)</span> is prime.</p>
</section>
<section id="how-does-it-work-plain-language-18" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-18">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Perfect powers fail primality.</li>
<li>The order condition ensures<span class="math inline">\(r\)</span> is large enough to distinguish non-primes.</li>
<li>Small gcds catch trivial factors.</li>
<li>The polynomial congruence ensures that<span class="math inline">\(n\)</span> behaves like a prime under binomial expansion.</li>
</ol>
<p>Together, these steps eliminate all composites and confirm all primes.</p>
</section>
<section id="example-conceptual" class="level4">
<h4 class="anchored" data-anchor-id="example-conceptual">Example (Conceptual)</h4>
<p>Let <span class="math inline">\(n = 7\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(7\)</span> is not a perfect power.<br>
</li>
<li>The smallest <span class="math inline">\(r\)</span> such that <span class="math inline">\(\text{ord}_r(7) &gt; (\log 7)^2 \approx 5.3\)</span> is <span class="math inline">\(r = 5\)</span>.<br>
</li>
<li>No small <span class="math inline">\(\gcd\)</span> values found.<br>
</li>
<li><span class="math inline">\(n &gt; r\)</span>.<br>
</li>
<li>Check <span class="math display">\[
(x + a)^7 \bmod (x^5 - 1, 7) = x^7 + a.
\]</span> All tests pass, so <span class="math inline">\(n\)</span> is prime.</li>
</ol>
</section>
<section id="tiny-code-illustrative-only" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-illustrative-only">Tiny Code (Illustrative Only)</h4>
<p>The full AKS test is mathematically involved. Below is a simplified prototype that captures its structure, not optimized for large (n).</p>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> gcd</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_perfect_power(n):</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="bu">int</span>(math.log2(n)) <span class="op">+</span> <span class="dv">2</span>):</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="bu">round</span>(n  (<span class="dv">1</span> <span class="op">/</span> b))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> a  b <span class="op">==</span> n:</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiplicative_order(n, r):</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> gcd(n, r) <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    order <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> n <span class="op">%</span> r</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> value <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> (value <span class="op">*</span> n) <span class="op">%</span> r</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        order <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> order <span class="op">&gt;</span> r:</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> order</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> aks_is_prime(n):</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_perfect_power(n):</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    logn2 <span class="op">=</span> (math.log2(n))  <span class="dv">2</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gcd(n, r) <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> multiplicative_order(n, r) <span class="op">&gt;</span> logn2:</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>        r <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, r <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>        g <span class="op">=</span> gcd(a, n)</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="dv">1</span> <span class="op">&lt;</span> g <span class="op">&lt;</span> n:</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;=</span> r:</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>    limit <span class="op">=</span> <span class="bu">int</span>(math.sqrt(r) <span class="op">*</span> math.log2(n))</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, limit <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Simplified placeholder: full polynomial congruence omitted</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">pow</span>(a, n, n) <span class="op">!=</span> a <span class="op">%</span> n:</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">input</span>(<span class="st">"Enter n: "</span>))</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Prime"</span> <span class="cf">if</span> aks_is_prime(n) <span class="cf">else</span> <span class="st">"Composite"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-18" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-18">Why It Matters</h4>
<ul>
<li>First general, deterministic, polynomial-time test</li>
<li>Landmark in computational number theory (Agrawal–Kayal–Saxena, 2002)</li>
<li>Theoretical foundation for all modern primality testing</li>
<li>Shows primes can be recognized without randomness</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-18" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-18">A Gentle Proof (Why It Works)</h4>
<p>If<span class="math inline">\(n\)</span> is prime, then by the binomial theorem:</p>
<p><span class="math display">\[
(x + a)^n = \sum_{k=0}^{n} \binom{n}{k} x^k a^{n-k} \equiv x^n + a \pmod{n}
\]</span></p>
<p>because all middle binomial coefficients are divisible by<span class="math inline">\(n\)</span>. For composites, this identity fails for some<span class="math inline">\(a\)</span>, unless<span class="math inline">\(n\)</span> has special smooth structure (caught by earlier steps).</p>
<p>Hence, the polynomial test is both necessary and sufficient for primality.</p>
</section>
<section id="try-it-yourself-18" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-18">Try It Yourself</h4>
<ol type="1">
<li>Test <span class="math inline">\(n = 37\)</span>, <span class="math inline">\(n = 97\)</span>, <span class="math inline">\(n = 121\)</span>.<br>
</li>
<li>Compare runtime with Miller–Rabin.<br>
</li>
<li>Observe exponential slowdown for large <span class="math inline">\(n\)</span>.<br>
</li>
<li>Verify perfect power rejection.<br>
</li>
<li>Explore small <span class="math inline">\(r\)</span> and the order function.</li>
</ol>
</section>
<section id="test-cases-18" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-18">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Result</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>prime</td>
<td>base case</td>
</tr>
<tr class="even">
<td>7</td>
<td>prime</td>
<td>passes polynomial check</td>
</tr>
<tr class="odd">
<td>37</td>
<td>prime</td>
<td>correct</td>
</tr>
<tr class="even">
<td>121</td>
<td>composite</td>
<td>fails binomial identity</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-18" class="level4">
<h4 class="anchored" data-anchor-id="complexity-18">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O((\log n)^6)\)</span> (original), improved to <span class="math inline">\(O((\log n)^3)\)</span><br>
</li>
<li>Space: polynomial in <span class="math inline">\(\log n\)</span></li>
</ul>
<p>The AKS primality test transformed primality checking from an art of heuristics into a science of certainty, proving that primes are decidable in polynomial time.</p>
</section>
</section>
<section id="segmented-sieve" class="level3">
<h3 class="anchored" data-anchor-id="segmented-sieve">520 Segmented Sieve</h3>
<p>The segmented sieve is a memory-efficient variant of the Sieve of Eratosthenes, designed to generate primes within a large range <span class="math inline">\([L, R]\)</span> without storing all numbers up to <span class="math inline">\(R\)</span>.<br>
It is ideal when <span class="math inline">\(R\)</span> is very large (for example <span class="math inline">\(10^{12}\)</span>), but the segment width <span class="math inline">\(R-L\)</span> is small enough to fit in memory.</p>
<section id="what-problem-are-we-solving-19" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-19">What Problem Are We Solving?</h4>
<p>We want to find all prime numbers in a range <span class="math inline">\([L, R]\)</span>, where <span class="math inline">\(R\)</span> may be extremely large.</p>
<p>A standard sieve up to <span class="math inline">\(R\)</span> would require <span class="math inline">\(O(R)\)</span> space, which is infeasible for <span class="math inline">\(R \gg 10^8\)</span>.<br>
The segmented sieve solves this by dividing the range into smaller blocks and marking composites using base primes up to <span class="math inline">\(\sqrt{R}\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-19" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-19">How Does It Work (Plain Language)</h4>
<ol type="1">
<li><p>Precompute base primes up to <span class="math inline">\(\sqrt{R}\)</span> using a standard sieve.</p></li>
<li><p>For each segment <span class="math inline">\([L, R]\)</span>:</p>
<ul>
<li><p>Mark all numbers as potentially prime.</p></li>
<li><p>For each base prime <span class="math inline">\(p\)</span>:</p>
<ul>
<li>Find the first multiple of <span class="math inline">\(p\)</span> in <span class="math inline">\([L, R]\)</span>: <span class="math display">\[
\text{start} = \max\left(p^2,\; \left\lceil \frac{L}{p} \right\rceil \cdot p \right)
\]</span></li>
<li>Mark all multiples of <span class="math inline">\(p\)</span> as composite.</li>
</ul></li>
</ul></li>
<li><p>Remaining unmarked numbers are primes.</p></li>
</ol>
<p>Repeat for each segment if the full range is too large to fit in memory.</p>
<p>Example: Find primes in [100, 120]</p>
<ol type="1">
<li><p>Compute base primes up to <span class="math inline">\(\sqrt{120} = 10.9\)</span>:<br>
<span class="math inline">\(\{2, 3, 5, 7\}\)</span></p></li>
<li><p>Start marking:</p>
<ul>
<li>For <span class="math inline">\(p = 2\)</span>: mark 100, 102, 104, …</li>
<li>For <span class="math inline">\(p = 3\)</span>: mark 102, 105, 108, …</li>
<li>For <span class="math inline">\(p = 5\)</span>: mark 100, 105, 110, 115, 120</li>
<li>For <span class="math inline">\(p = 7\)</span>: mark 105, 112, 119</li>
</ul></li>
</ol>
<p>Unmarked numbers: <span class="math display">\[
\boxed{101, 103, 107, 109, 113}
\]</span> (these are the primes in [100, 120])</p>
</section>
<section id="tiny-code-easy-versions-16" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-16">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simple_sieve(limit):</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    mark <span class="op">=</span> [<span class="va">True</span>] <span class="op">*</span> (limit <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    mark[<span class="dv">0</span>] <span class="op">=</span> mark[<span class="dv">1</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="bu">int</span>(math.sqrt(limit)) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mark[i]:</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">*</span> i, limit <span class="op">+</span> <span class="dv">1</span>, i):</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                mark[j] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [i <span class="cf">for</span> i, is_prime <span class="kw">in</span> <span class="bu">enumerate</span>(mark) <span class="cf">if</span> is_prime]</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> segmented_sieve(L, R):</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    base_primes <span class="op">=</span> simple_sieve(<span class="bu">int</span>(math.sqrt(R)) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    mark <span class="op">=</span> [<span class="va">True</span>] <span class="op">*</span> (R <span class="op">-</span> L <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> base_primes:</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>        start <span class="op">=</span> <span class="bu">max</span>(p <span class="op">*</span> p, ((L <span class="op">+</span> p <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> p) <span class="op">*</span> p)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(start, R <span class="op">+</span> <span class="dv">1</span>, p):</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>            mark[j <span class="op">-</span> L] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> L <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>        mark[<span class="dv">0</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [L <span class="op">+</span> i <span class="cf">for</span> i, is_prime <span class="kw">in</span> <span class="bu">enumerate</span>(mark) <span class="cf">if</span> is_prime]</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>L, R <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, <span class="bu">input</span>(<span class="st">"Enter L R: "</span>).split())</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Primes:"</span>, segmented_sieve(L, R))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> simple_sieve<span class="op">(</span><span class="dt">int</span> limit<span class="op">,</span> <span class="dt">int</span> primes<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>count<span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="op">*</span>mark <span class="op">=</span> calloc<span class="op">(</span>limit <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">bool</span><span class="op">));</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> limit<span class="op">;</span> i<span class="op">++)</span> mark<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">*</span> i <span class="op">&lt;=</span> limit<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mark<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">*</span> i<span class="op">;</span> j <span class="op">&lt;=</span> limit<span class="op">;</span> j <span class="op">+=</span> i<span class="op">)</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                mark<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> limit<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mark<span class="op">[</span>i<span class="op">])</span> <span class="op">(*</span>count<span class="op">)++;</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>primes <span class="op">=</span> malloc<span class="op">(*</span>count <span class="op">*</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">int</span><span class="op">));</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> limit<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mark<span class="op">[</span>i<span class="op">])</span> <span class="op">(*</span>primes<span class="op">)[</span>idx<span class="op">++]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    free<span class="op">(</span>mark<span class="op">);</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> segmented_sieve<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> L<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> limit <span class="op">=</span> sqrt<span class="op">(</span>R<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>primes<span class="op">,</span> count<span class="op">;</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>    simple_sieve<span class="op">(</span>limit<span class="op">,</span> <span class="op">&amp;</span>primes<span class="op">,</span> <span class="op">&amp;</span>count<span class="op">);</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> <span class="op">*</span>mark <span class="op">=</span> calloc<span class="op">(</span>R <span class="op">-</span> L <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">bool</span><span class="op">));</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> R <span class="op">-</span> L<span class="op">;</span> i<span class="op">++)</span> mark<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> count<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> p <span class="op">=</span> primes<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> start <span class="op">=</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>p <span class="op">*</span> p<span class="op">;</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>start <span class="op">&lt;</span> L<span class="op">)</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>            start <span class="op">=</span> <span class="op">((</span>L <span class="op">+</span> p <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> p<span class="op">)</span> <span class="op">*</span> p<span class="op">;</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> j <span class="op">=</span> start<span class="op">;</span> j <span class="op">&lt;=</span> R<span class="op">;</span> j <span class="op">+=</span> p<span class="op">)</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>            mark<span class="op">[</span>j <span class="op">-</span> L<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>L <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> mark<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> R <span class="op">-</span> L<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mark<span class="op">[</span>i<span class="op">])</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st"> "</span><span class="op">,</span> L <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>    free<span class="op">(</span>primes<span class="op">);</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>    free<span class="op">(</span>mark<span class="op">);</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> L<span class="op">,</span> R<span class="op">;</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Enter L R: "</span><span class="op">);</span></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st"> </span><span class="sc">%lld</span><span class="st">"</span><span class="op">,</span> <span class="op">&amp;</span>L<span class="op">,</span> <span class="op">&amp;</span>R<span class="op">);</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>    segmented_sieve<span class="op">(</span>L<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-19" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-19">Why It Matters</h4>
<ul>
<li>Memory-efficient: handles large ranges without full sieve storage</li>
<li>Essential for prime generation in big intervals (competitive programming, cryptography)</li>
<li>Used in factorization and probabilistic primality tests</li>
<li>Demonstrates divide-and-conquer sieving</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-19" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-19">A Gentle Proof (Why It Works)</h4>
<p>Every composite number in <span class="math inline">\([L, R]\)</span> must have a prime factor <span class="math inline">\(\le \sqrt{R}\)</span>. By marking multiples of all such base primes, all composites are removed, leaving only primes. Each segment repeats the same logic, correctness holds per block.</p>
</section>
<section id="try-it-yourself-19" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-19">Try It Yourself</h4>
<ol type="1">
<li>Generate primes in <span class="math inline">\([100, 200]\)</span>.<br>
</li>
<li>Test <span class="math inline">\([10^{12}, 10^{12} + 1000]\)</span>.<br>
</li>
<li>Compare memory use with a full sieve.<br>
</li>
<li>Implement dynamic segmenting for very large ranges.<br>
</li>
<li>Print each segment as it is processed.</li>
</ol>
</section>
<section id="test-cases-19" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-19">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Range <span class="math inline">\([L, R]\)</span></th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[10, 30]</td>
<td>11, 13, 17, 19, 23, 29</td>
</tr>
<tr class="even">
<td>[100, 120]</td>
<td>101, 103, 107, 109, 113</td>
</tr>
<tr class="odd">
<td>[1, 10]</td>
<td>2, 3, 5, 7</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-19" class="level4">
<h4 class="anchored" data-anchor-id="complexity-19">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O((R - L + 1)\log \log R)\)</span><br>
</li>
<li>Space: <span class="math inline">\(O(\sqrt{R})\)</span> for base primes and <span class="math inline">\(O(R - L)\)</span> for the segment</li>
</ul>
<p>The segmented sieve works like panning for gold — processing one tray (segment) at a time to uncover primes hidden in vast numerical ranges.</p>
</section>
</section>
</section>
<section id="section-53.-combinatorics" class="level1">
<h1>Section 53. Combinatorics</h1>
<section id="factorial-precomputation" class="level3">
<h3 class="anchored" data-anchor-id="factorial-precomputation">521 Factorial Precomputation</h3>
<p>Factorial precomputation is one of the most useful techniques in combinatorics and modular arithmetic. It allows you to quickly compute values like<span class="math inline">\(n!\)</span>, binomial coefficients<span class="math inline">\(\binom{n}{k}\)</span>, or permutations, especially under a modulus<span class="math inline">\(M\)</span>, without recomputing from scratch each time.</p>
<section id="what-problem-are-we-solving-20" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-20">What Problem Are We Solving?</h4>
<p>We often need<span class="math inline">\(n!\)</span> (factorial) or combinations like:</p>
<p><span class="math display">\[
\binom{n}{k} = \frac{n!}{k!(n-k)!}
\]</span></p>
<p>Directly computing factorials every time costs<span class="math inline">\(O(n)\)</span>, which is too slow when<span class="math inline">\(n\)</span> is large or when we need many queries. By precomputing all factorials once up to<span class="math inline">\(n\)</span>, we can answer queries in O(1) time.</p>
<p>This is especially important when working modulo<span class="math inline">\(M\)</span>, where division requires modular inverses.</p>
</section>
<section id="how-does-it-work-plain-language-20" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-20">How Does It Work (Plain Language)</h4>
<p>We build an array <code>fact[]</code> such that:</p>
<p><span class="math display">\[
\text{fact}[i] = (i!) \bmod M
\]</span></p>
<p>using the recurrence:</p>
<p><span class="math display">\[
\text{fact}[0] = 1, \quad \text{fact}[i] = (i \times \text{fact}[i - 1]) \bmod M
\]</span></p>
<p>If we also need inverse factorials:</p>
<p><span class="math display">\[
\text{invfact}[n] = (\text{fact}[n])^{-1} \bmod M
\]</span></p>
<p>then we can compute all inverses in reverse:</p>
<p><span class="math display">\[
\text{invfact}[i - 1] = (i \times \text{invfact}[i]) \bmod M
\]</span></p>
<p>This lets us compute binomial coefficients fast:</p>
<p><span class="math display">\[
\binom{n}{k} = \text{fact}[n] \times \text{invfact}[k] \times \text{invfact}[n - k] \bmod M
\]</span></p>
</section>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
<p>Let<span class="math inline">\(M = 10^9 + 7\)</span>,<span class="math inline">\(n = 5\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(i\)</span></th>
<th><span class="math inline">\(i!\)</span></th>
<th><span class="math inline">\(i! \bmod M\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td>6</td>
<td>6</td>
</tr>
<tr class="odd">
<td>4</td>
<td>24</td>
<td>24</td>
</tr>
<tr class="even">
<td>5</td>
<td>120</td>
<td>120</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\binom{5}{2} = \frac{5!}{2! \cdot 3!} = \frac{120}{2 \cdot 6} = 10
\]</span></p>
<p>With modular inverses, the same holds under<span class="math inline">\(M\)</span>.</p>
</section>
<section id="tiny-code-easy-versions-17" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-17">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="dv">109</span> <span class="op">+</span> <span class="dv">7</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> precompute_factorials(n):</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    fact <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        fact[i] <span class="op">=</span> (fact[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">*</span> i) <span class="op">%</span> M</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modinv(a, m<span class="op">=</span>M):</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">pow</span>(a, m <span class="op">-</span> <span class="dv">2</span>, m)  <span class="co"># Fermat's Little Theorem</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> precompute_inverses(fact):</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(fact) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    invfact <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    invfact[n] <span class="op">=</span> modinv(fact[n])</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        invfact[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> (invfact[i] <span class="op">*</span> i) <span class="op">%</span> M</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> invfact</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>fact <span class="op">=</span> precompute_factorials(n)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>invfact <span class="op">=</span> precompute_inverses(fact)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nCr(n, r):</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> r <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> r <span class="op">&gt;</span> n: <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact[n] <span class="op">*</span> invfact[r] <span class="op">%</span> M <span class="op">*</span> invfact[n <span class="op">-</span> r] <span class="op">%</span> M</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"5C2 ="</span>, nCr(<span class="dv">5</span>, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define M </span><span class="dv">1000000007</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAXN </span><span class="dv">1000000</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> fact<span class="op">[</span>MAXN <span class="op">+</span> <span class="dv">1</span><span class="op">],</span> invfact<span class="op">[</span>MAXN <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> modpow<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> r <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>e <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> r <span class="op">=</span> r <span class="op">*</span> a <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">*</span> a <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> precompute_factorials<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    fact<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>        fact<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> fact<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> i <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    invfact<span class="op">[</span>n<span class="op">]</span> <span class="op">=</span> modpow<span class="op">(</span>fact<span class="op">[</span>n<span class="op">],</span> M <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">--)</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>        invfact<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> invfact<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> i <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> nCr<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">||</span> r <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact<span class="op">[</span>n<span class="op">]</span> <span class="op">*</span> invfact<span class="op">[</span>r<span class="op">]</span> <span class="op">%</span> M <span class="op">*</span> invfact<span class="op">[</span>n <span class="op">-</span> r<span class="op">]</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    precompute_factorials<span class="op">(</span><span class="dv">1000000</span><span class="op">);</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"5C2 = </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> nCr<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">));</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-20" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-20">Why It Matters</h4>
<ul>
<li><p>Converts<span class="math inline">\(O(n)\)</span> recomputation into O(1) queries</p></li>
<li><p>Fundamental for combinatorics, DP, and modular counting</p></li>
<li><p>Enables quick computation of:</p>
<ul>
<li>Binomial coefficients</li>
<li>Multiset combinations</li>
<li>Probability computations</li>
<li>Catalan numbers</li>
</ul></li>
</ul>
<p>Used in:</p>
<ul>
<li>Combinatorial DP</li>
<li>Probability and expectation problems</li>
<li>Modular combinatorics</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-20" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-20">A Gentle Proof (Why It Works)</h4>
<p>Factorials grow recursively: <span class="math display">\[
n! = n \cdot (n-1)!
\]</span> So precomputing stores each step once. Modulo arithmetic preserves multiplication structure: <span class="math display">\[
(ab) \bmod M = ((a \bmod M) \cdot (b \bmod M)) \bmod M
\]</span> and modular inverses exist when<span class="math inline">\(M\)</span> is prime, by Fermat’s Little Theorem: <span class="math display">\[
a^{M-1} \equiv 1 \pmod{M} \implies a^{-1} \equiv a^{M-2} \pmod{M}
\]</span></p>
</section>
<section id="try-it-yourself-20" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-20">Try It Yourself</h4>
<ol type="1">
<li>Precompute up to<span class="math inline">\(n = 10^6\)</span> and print factorials.</li>
<li>Compute<span class="math inline">\(1000! \bmod 10^9+7\)</span>.</li>
<li>Verify<span class="math inline">\(\binom{n}{k} = \binom{n}{n-k}\)</span>.</li>
<li>Add memoization for varying<span class="math inline">\(M\)</span>.</li>
<li>Extend to double factorials or multinomial coefficients.</li>
</ol>
</section>
<section id="test-cases-20" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-20">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(k\)</span></th>
<th><span class="math inline">\(n! \bmod M\)</span></th>
<th><span class="math inline">\(\binom{n}{k} \bmod M\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5</td>
<td>2</td>
<td>120</td>
<td>10</td>
</tr>
<tr class="even">
<td>10</td>
<td>3</td>
<td>3628800</td>
<td>120</td>
</tr>
<tr class="odd">
<td>100</td>
<td>50</td>
<td>,</td>
<td>538992043</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-20" class="level4">
<h4 class="anchored" data-anchor-id="complexity-20">Complexity</h4>
<ul>
<li>Precomputation:<span class="math inline">\(O(n)\)</span></li>
<li><a href="Query:$O(1)$" class="uri">Query:$O(1)$</a></li>
<li>Space:<span class="math inline">\(O(n)\)</span></li>
</ul>
<p>Factorial precomputation is your lookup table for combinatorics, prepare once, compute instantly.</p>
</section>
</section>
<section id="ncr-computation" class="level3">
<h3 class="anchored" data-anchor-id="ncr-computation">522 nCr Computation</h3>
<p>nCr computation (binomial coefficient calculation) is the backbone of combinatorics, it counts the number of ways to choose<span class="math inline">\(r\)</span> elements from a set of<span class="math inline">\(n\)</span> elements, without regard to order. It shows up in counting, probability, DP, and combinatorial identities.</p>
<section id="what-problem-are-we-solving-21" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-21">What Problem Are We Solving?</h4>
<p>We want to compute:</p>
<p><span class="math display">\[
\binom{n}{r} = \frac{n!}{r!(n-r)!}
\]</span></p>
<p>directly or modulo a large prime<span class="math inline">\(M\)</span>, efficiently.</p>
<p>For small<span class="math inline">\(n\)</span>, this can be done by direct multiplication and division. For large<span class="math inline">\(n\)</span>, we must use modular arithmetic and modular inverses, since division is not defined under modulo.</p>
</section>
<section id="how-does-it-work-plain-language-21" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-21">How Does It Work (Plain Language)</h4>
<p>We can compute<span class="math inline">\(\binom{n}{r}\)</span> in several ways:</p>
<ol type="1">
<li><p>Multiplicative formula (direct):</p>
<p><span class="math display">\[
\binom{n}{r} = \prod_{i=1}^{r} \frac{n - r + i}{i}
\]</span></p>
<p>Works well when<span class="math inline">\(n\)</span> and<span class="math inline">\(r\)</span> are moderate ((&lt; 10^6)).</p></li>
<li><p>Dynamic Programming (Pascal’s Triangle):</p>
<p><span class="math display">\[
\binom{n}{r} = \binom{n-1}{r-1} + \binom{n-1}{r}
\]</span></p>
<p>with base cases<span class="math inline">\(\binom{n}{0} = 1\)</span>,<span class="math inline">\(\binom{n}{n} = 1\)</span>.</p></li>
<li><p>Factorial precomputation (for modulo):</p>
<p>Using precomputed arrays: <span class="math display">\[
\binom{n}{r} = \text{fact}[n] \cdot \text{invfact}[r] \cdot \text{invfact}[n-r] \bmod M
\]</span></p></li>
</ol>
</section>
<section id="example-1" class="level4">
<h4 class="anchored" data-anchor-id="example-1">Example</h4>
<p>Compute<span class="math inline">\(\binom{5}{2}\)</span>:</p>
<p><span class="math display">\[
\binom{5}{2} = \frac{5!}{2! \cdot 3!} = \frac{120}{12} = 10
\]</span></p>
<p>Check with Pascal’s identity:</p>
<p><span class="math display">\[
\binom{5}{2} = \binom{4}{1} + \binom{4}{2} = 4 + 6 = 10
\]</span></p>
</section>
<section id="tiny-code-easy-versions-18" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-18">Tiny Code (Easy Versions)</h4>
<ol type="1">
<li>Multiplicative Formula (No Modulo)</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nCr(n, r):</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> r <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> r <span class="op">&gt;</span> n:</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="bu">min</span>(r, n <span class="op">-</span> r)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, r <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> res <span class="op">*</span> (n <span class="op">-</span> r <span class="op">+</span> i) <span class="op">//</span> i</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nCr(<span class="dv">5</span>, <span class="dv">2</span>))  <span class="co"># 10</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="2" type="1">
<li>Factorial + Modular Inverse</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="dv">109</span> <span class="op">+</span> <span class="dv">7</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modpow(a, e, m<span class="op">=</span>M):</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>            r <span class="op">=</span> (r <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (a <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nCr_mod(n, r):</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> r <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> r <span class="op">&gt;</span> n:</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    fact <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        fact[i] <span class="op">=</span> (fact[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">*</span> i) <span class="op">%</span> M</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    invfact <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    invfact[n] <span class="op">=</span> modpow(fact[n], M <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>        invfact[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> (invfact[i] <span class="op">*</span> i) <span class="op">%</span> M</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact[n] <span class="op">*</span> invfact[r] <span class="op">%</span> M <span class="op">*</span> invfact[n <span class="op">-</span> r] <span class="op">%</span> M</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nCr_mod(<span class="dv">5</span>, <span class="dv">2</span>))  <span class="co"># 10</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="3" type="1">
<li>Pascal’s Triangle (Dynamic Programming)</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_pascal(n):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [[<span class="dv">0</span>]<span class="op">*</span>(n<span class="op">+</span><span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        C[i][<span class="dv">0</span>] <span class="op">=</span> C[i][i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, i):</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>            C[i][j] <span class="op">=</span> C[i<span class="op">-</span><span class="dv">1</span>][j<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> C[i<span class="op">-</span><span class="dv">1</span>][j]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>pascal <span class="op">=</span> build_pascal(<span class="dv">10</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pascal[<span class="dv">5</span>][<span class="dv">2</span>])  <span class="co"># 10</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-21" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-21">Why It Matters</h4>
<ul>
<li><p>Fundamental to combinatorics</p></li>
<li><p>Used in:</p>
<ul>
<li>Binomial expansions</li>
<li>Probability (e.g., hypergeometric distributions)</li>
<li>Dynamic programming (e.g., counting paths)</li>
<li>Number theory (Lucas theorem)</li>
<li>Modular arithmetic combinatorics</li>
</ul></li>
<li><p>The backbone of:</p>
<ul>
<li>Catalan numbers</li>
<li>Pascal’s triangle</li>
<li>Inclusion–exclusion principles</li>
</ul></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-21" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-21">A Gentle Proof (Why It Works)</h4>
<p>Combinatorially:</p>
<ul>
<li>To choose<span class="math inline">\(r\)</span> items from<span class="math inline">\(n\)</span>, either include a specific item or exclude it.</li>
</ul>
<p>So: <span class="math display">\[
\binom{n}{r} = \binom{n-1}{r-1} + \binom{n-1}{r}
\]</span> with boundaries: <span class="math display">\[
\binom{n}{0} = \binom{n}{n} = 1
\]</span></p>
<p>Multiplicatively: <span class="math display">\[
\frac{n!}{r!(n-r)!} = \frac{n}{1} \times \frac{n-1}{2} \times \cdots \times \frac{n-r+1}{r}
\]</span></p>
</section>
<section id="try-it-yourself-21" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-21">Try It Yourself</h4>
<ol type="1">
<li>Compute<span class="math inline">\(\binom{10}{3}\)</span> manually and using code.</li>
<li>Generate the 6th row of Pascal’s triangle.</li>
<li>Verify symmetry<span class="math inline">\(\binom{n}{r} = \binom{n}{n-r}\)</span>.</li>
<li>Implement modulo version for<span class="math inline">\(n = 10^6\)</span>.</li>
<li>Use nCr to compute Catalan numbers: <span class="math display">\[
C_n = \frac{1}{n+1}\binom{2n}{n}
\]</span></li>
</ol>
</section>
<section id="test-cases-21" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-21">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>(n)</th>
<th>(r)</th>
<th>Result</th>
<th>Method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5</td>
<td>2</td>
<td>10</td>
<td>factorial</td>
</tr>
<tr class="even">
<td>10</td>
<td>3</td>
<td>120</td>
<td>DP</td>
</tr>
<tr class="odd">
<td>100</td>
<td>50</td>
<td>538992043</td>
<td>modulo</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-21" class="level4">
<h4 class="anchored" data-anchor-id="complexity-21">Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Time</th>
<th>Space</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Multiplicative</td>
<td>(O(r))</td>
<td>(O(1))</td>
</tr>
<tr class="even">
<td>DP (Pascal)</td>
<td>(O(n^2))</td>
<td>(O(n^2))</td>
</tr>
<tr class="odd">
<td>Precomputed factorial</td>
<td>(O(1)) per query</td>
<td>(O(n))</td>
</tr>
</tbody>
</table>
<p>nCr is the counting lens of algorithms, every subset, combination, and selection passes through it.</p>
</section>
</section>
<section id="pascals-triangle" class="level3">
<h3 class="anchored" data-anchor-id="pascals-triangle">523 Pascal’s Triangle</h3>
<p>Pascal’s Triangle is the geometric arrangement of binomial coefficients. Each entry represents <span class="math inline">\(\binom{n}{r}\)</span>, and every row builds upon the previous one. It’s not just a pretty triangle, it’s the living structure of combinatorics, binomial expansions, and dynamic programming.</p>
<section id="what-problem-are-we-solving-22" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-22">What Problem Are We Solving?</h4>
<p>We want to compute binomial coefficients efficiently and recurrently, without factorials or modular inverses.</p>
<p>We use the recursive identity:</p>
<p><span class="math display">\[
\binom{n}{r}=\binom{n-1}{r-1}+\binom{n-1}{r}
\]</span></p>
<p>with base cases:</p>
<p><span class="math display">\[
\binom{n}{0}=\binom{n}{n}=1
\]</span></p>
<p>This recurrence builds all combinations in a simple triangle, each number is the sum of the two above it.</p>
</section>
<section id="how-does-it-work-plain-language-22" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-22">How Does It Work (Plain Language)</h4>
<p>Start with row 0: <code>[1]</code> Each new row begins and ends with 1, and every middle element is the sum of two neighbors above.</p>
<p>Example:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Row</th>
<th>Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>1 1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1 2 1</td>
</tr>
<tr class="even">
<td>3</td>
<td>1 3 3 1</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1 4 6 4 1</td>
</tr>
<tr class="even">
<td>5</td>
<td>1 5 10 10 5 1</td>
</tr>
</tbody>
</table>
<p>The value at row <span class="math inline">\(n\)</span>, column <span class="math inline">\(r\)</span> equals <span class="math inline">\(\binom{n}{r}\)</span>.</p>
</section>
<section id="example-2" class="level4">
<h4 class="anchored" data-anchor-id="example-2">Example</h4>
<p>Compute <span class="math inline">\(\binom{5}{2}\)</span> from Pascal’s triangle:</p>
<p>Row 5: 1 5 10 10 5 1 → <span class="math inline">\(\binom{5}{2}=10\)</span></p>
<p>Check recurrence:</p>
<p><span class="math display">\[
\binom{5}{2}=\binom{4}{1}+\binom{4}{2}=4+6=10
\]</span></p>
</section>
<section id="tiny-code-easy-versions-19" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-19">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pascal_triangle(n):</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        C[i][<span class="dv">0</span>] <span class="op">=</span> C[i][i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, i):</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>            C[i][j] <span class="op">=</span> C[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> C[i <span class="op">-</span> <span class="dv">1</span>][j]</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> pascal_triangle(<span class="dv">6</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>):</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(C[i][:i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"C(5,2) ="</span>, C[<span class="dv">5</span>][<span class="dv">2</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> pascal_triangle<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> C<span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">][</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> i<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>j <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> j <span class="op">==</span> i<span class="op">)</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                C<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                C<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> C<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> C<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">][</span>j<span class="op">];</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> C<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    pascal_triangle<span class="op">(</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-22" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-22">Why It Matters</h4>
<ul>
<li><p>Efficient <span class="math inline">\(O(n^2)\)</span> construction of all <span class="math inline">\(\binom{n}{r}\)</span></p></li>
<li><p>No factorials, no large-number overflows for small <span class="math inline">\(n\)</span></p></li>
<li><p>Foundation for:</p>
<ul>
<li>Binomial expansions: <span class="math inline">\((a+b)^n=\sum_{r=0}^n\binom{n}{r}a^{n-r}b^r\)</span></li>
<li>Combinatorial DP: counting subsets, paths, partitions</li>
<li>Probability computations</li>
</ul></li>
</ul>
<p>Also connects to:</p>
<ul>
<li>Fibonacci (diagonal sums)</li>
<li>Powers of 2 (row sums)</li>
<li>Sierpinski triangles (mod 2 pattern)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-22" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-22">A Gentle Proof (Why It Works)</h4>
<p>Each term counts ways to choose <span class="math inline">\(r\)</span> items from <span class="math inline">\(n\)</span>: either include a particular element or exclude it.</p>
<p>So:</p>
<p><span class="math display">\[
\binom{n}{r}=\binom{n-1}{r-1}+\binom{n-1}{r}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\binom{n-1}{r-1}\)</span>: choose <span class="math inline">\(r-1\)</span> from remaining after including</li>
<li><span class="math inline">\(\binom{n-1}{r}\)</span>: choose <span class="math inline">\(r\)</span> from remaining after excluding</li>
</ul>
<p>This recurrence relation constructs the entire triangle layer by layer.</p>
</section>
<section id="try-it-yourself-22" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-22">Try It Yourself</h4>
<ol type="1">
<li>Print the first 10 rows of Pascal’s triangle.</li>
<li>Verify that the sum of row <span class="math inline">\(n\)</span> equals <span class="math inline">\(2^n\)</span>.</li>
<li>Use triangle values to expand <span class="math inline">\((a+b)^5\)</span>.</li>
<li>Visualize pattern mod 2, get the Sierpinski triangle.</li>
<li>Use diagonals to build Fibonacci sequence.</li>
</ol>
</section>
<section id="test-cases-22" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-22">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(r\)</span></th>
<th><span class="math inline">\(\binom{n}{r}\)</span></th>
<th>Triangle Row</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5</td>
<td>2</td>
<td>10</td>
<td>[1, 5, 10, 10, 5, 1]</td>
</tr>
<tr class="even">
<td>6</td>
<td>3</td>
<td>20</td>
<td>[1, 6, 15, 20, 15, 6, 1]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-22" class="level4">
<h4 class="anchored" data-anchor-id="complexity-22">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^2)\)</span></li>
<li>Space: <span class="math inline">\(O(n^2)\)</span>, or <span class="math inline">\(O(n)\)</span> with row compression</li>
</ul>
<p>Pascal’s Triangle is combinatorics in motion, a growing, recursive landscape where every number remembers its ancestors.</p>
</section>
</section>
<section id="multiset-combination" class="level3">
<h3 class="anchored" data-anchor-id="multiset-combination">524 Multiset Combination</h3>
<p>Multiset combination counts selections with repetition allowed, choosing <span class="math inline">\(r\)</span> elements from <span class="math inline">\(n\)</span> types, where each type can appear multiple times. It’s the combinatorial backbone for problems like compositions, integer partitions, stars and bars, and bag combinations.</p>
<section id="what-problem-are-we-solving-23" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-23">What Problem Are We Solving?</h4>
<p>We want to count the number of ways to choose <span class="math inline">\(r\)</span> items from <span class="math inline">\(n\)</span> types when duplicates are allowed.</p>
<p>For example, with types <span class="math inline">\({A,B,C}\)</span> and <span class="math inline">\(r=2\)</span>, valid selections are: <span class="math display">\[
{AA,AB,AC,BB,BC,CC}
\]</span> That’s 6 combinations, not <span class="math inline">\(\binom{3}{2}=3\)</span>.</p>
<p>So the formula is:</p>
<p><span class="math display">\[
\text{MultisetCombination}(n,r)=\binom{n+r-1}{r}
\]</span></p>
<p>This is the “stars and bars” formula.</p>
</section>
<section id="how-does-it-work-plain-language-23" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-23">How Does It Work (Plain Language)</h4>
<p>Think of <span class="math inline">\(r\)</span> identical stars (items) separated into <span class="math inline">\(n\)</span> groups by <span class="math inline">\((n-1)\)</span> dividers (bars).</p>
<p>Example: <span class="math inline">\(n=3\)</span>, <span class="math inline">\(r=4\)</span></p>
<p>We need to arrange 4 stars and 2 bars:</p>
<pre><code>- * | * | *</code></pre>
<p>Each arrangement corresponds to one combination.</p>
<p>Total arrangements:</p>
<p><span class="math display">\[
\binom{n+r-1}{r}=\binom{6}{4}=15
\]</span></p>
<p>So there are 15 ways to pick 4 items from 3 types with repetition.</p>
</section>
<section id="example-3" class="level4">
<h4 class="anchored" data-anchor-id="example-3">Example</h4>
<p>Let <span class="math inline">\(n=3\)</span> (types A, B, C), <span class="math inline">\(r=2\)</span>. Formula:</p>
<p><span class="math display">\[
\binom{3+2-1}{2}=\binom{4}{2}=6
\]</span></p>
<p>List all: AA, AB, AC, BB, BC, CC</p>
<p>Ok Matches formula.</p>
</section>
<section id="tiny-code-easy-versions-20" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-20">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> comb</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiset_combination(n, r):</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> comb(n <span class="op">+</span> r <span class="op">-</span> <span class="dv">1</span>, r)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Combinations (n=3, r=2):"</span>, multiset_combination(<span class="dv">3</span>, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Modulo Version (using factorial precomputation)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="dv">109</span> <span class="op">+</span> <span class="dv">7</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modpow(a, e, m<span class="op">=</span>M):</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>            r <span class="op">=</span> (r <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (a <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modinv(a):</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modpow(a, M <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nCr_mod(n, r):</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> r <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> r <span class="op">&gt;</span> n:</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    fact <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>        fact[i] <span class="op">=</span> fact[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">*</span> i <span class="op">%</span> M</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact[n] <span class="op">*</span> modinv(fact[r]) <span class="op">%</span> M <span class="op">*</span> modinv(fact[n <span class="op">-</span> r]) <span class="op">%</span> M</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiset_combination_mod(n, r):</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nCr_mod(n <span class="op">+</span> r <span class="op">-</span> <span class="dv">1</span>, r)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Multiset Combination (n=3, r=2):"</span>, multiset_combination_mod(<span class="dv">3</span>, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-23" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-23">Why It Matters</h4>
<ul>
<li><p>Models combinations with replacement</p></li>
<li><p>Appears in:</p>
<ul>
<li>Counting multisets / bags</li>
<li>Integer partitioning</li>
<li>Polynomial coefficient enumeration</li>
<li>Distributing identical balls into boxes</li>
</ul></li>
<li><p>Key in DP over multisets, generating functions, and probability spaces</p></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-23" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-23">A Gentle Proof (Why It Works)</h4>
<p>Represent <span class="math inline">\(r\)</span> identical items as stars <code>*</code> and <span class="math inline">\(n-1\)</span> dividers as bars <code>|</code>.</p>
<p>Example: <span class="math inline">\(n=4\)</span>, <span class="math inline">\(r=3\)</span> We have <span class="math inline">\(r+(n-1)=6\)</span> symbols. Choosing positions of <span class="math inline">\(r\)</span> stars:</p>
<p><span class="math display">\[
\binom{r+n-1}{r}
\]</span></p>
<p>Each unique arrangement corresponds to a multiset.</p>
<p>Hence, total combinations = <span class="math inline">\(\binom{n+r-1}{r}\)</span>.</p>
</section>
<section id="try-it-yourself-23" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-23">Try It Yourself</h4>
<ol type="1">
<li>Count ways to choose 3 fruits from {apple, banana, cherry}.</li>
<li>Compute <span class="math inline">\(\text{MultisetCombination}(5,2)\)</span> and list a few examples.</li>
<li>Build a DP table using Pascal’s triangle recurrence: <span class="math display">\[
f(n,r)=f(n,r-1)+f(n-1,r)
\]</span></li>
<li>Use modulo arithmetic for large <span class="math inline">\(n\)</span>.</li>
<li>Visualize “stars and bars” layouts for <span class="math inline">\(n=4, r=3\)</span>.</li>
</ol>
</section>
<section id="test-cases-23" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-23">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(r\)</span></th>
<th><span class="math inline">\(\binom{n+r-1}{r}\)</span></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>2</td>
<td><span class="math inline">\(\binom{4}{2}=6\)</span></td>
<td>6</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td><span class="math inline">\(\binom{6}{3}=20\)</span></td>
<td>20</td>
</tr>
<tr class="odd">
<td>2</td>
<td>5</td>
<td><span class="math inline">\(\binom{6}{5}=6\)</span></td>
<td>6</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-23" class="level4">
<h4 class="anchored" data-anchor-id="complexity-23">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(1)\)</span> (with precomputed factorials)</li>
<li>Space: <span class="math inline">\(O(n+r)\)</span> (for factorial storage)</li>
</ul>
<p>Multiset combinations open up counting beyond uniqueness, when repetition is a feature, not a flaw.</p>
</section>
</section>
<section id="permutation-generation" class="level3">
<h3 class="anchored" data-anchor-id="permutation-generation">525 Permutation Generation</h3>
<p>Permutation generation is the process of listing all possible arrangements of a set of elements, the order now matters. It’s one of the most fundamental operations in combinatorics, recursion, and search algorithms, powering brute-force solvers, lexicographic enumeration, and backtracking frameworks.</p>
<section id="what-problem-are-we-solving-24" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-24">What Problem Are We Solving?</h4>
<p>We want to generate all permutations of a collection of size <span class="math inline">\(n\)</span>, that is, every possible ordering.</p>
<p>For example, for <span class="math inline">\({1, 2, 3}\)</span>, the permutations are:</p>
<p><span class="math display">\[
{1,2,3},{1,3,2},{2,1,3},{2,3,1},{3,1,2},{3,2,1}
\]</span></p>
<p>There are <span class="math inline">\(n!\)</span> total permutations.</p>
</section>
<section id="how-does-it-work-plain-language-24" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-24">How Does It Work (Plain Language)</h4>
<p>There are multiple strategies:</p>
<ol type="1">
<li><p>Recursive Backtracking</p>
<ul>
<li>Choose an element</li>
<li>Permute the remaining</li>
<li>Combine</li>
</ul></li>
<li><p>Lexicographic (Next Permutation)</p>
<ul>
<li>Generate in sorted order by finding next lexicographic successor</li>
</ul></li>
<li><p>Heap’s Algorithm</p>
<ul>
<li>Swap-based iterative generation in <span class="math inline">\(O(n!)\)</span> time, <span class="math inline">\(O(n)\)</span> space</li>
</ul></li>
</ol>
<p>Recursive Approach Example</p>
<p>To generate all permutations of <span class="math inline">\({1,2,3}\)</span>:</p>
<ul>
<li>Fix 1 → permute <span class="math inline">\({2,3}\)</span> → <span class="math inline">\({1,2,3},{1,3,2}\)</span></li>
<li>Fix 2 → permute <span class="math inline">\({1,3}\)</span> → <span class="math inline">\({2,1,3},{2,3,1}\)</span></li>
<li>Fix 3 → permute <span class="math inline">\({1,2}\)</span> → <span class="math inline">\({3,1,2},{3,2,1}\)</span></li>
</ul>
</section>
<section id="tiny-code-easy-versions-21" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-21">Tiny Code (Easy Versions)</h4>
<p>Python Version (Recursive Backtracking)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> permute(arr, path<span class="op">=</span>[]):</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> arr:</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(path)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(arr)):</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        permute(arr[:i] <span class="op">+</span> arr[i<span class="op">+</span><span class="dv">1</span>:], path <span class="op">+</span> [arr[i]])</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>permute([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version (Using Built-in)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> permutations</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> permutations([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]):</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(p)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (Backtracking)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> swap<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t <span class="op">=</span> <span class="op">*</span>a<span class="op">;</span> <span class="op">*</span>a <span class="op">=</span> <span class="op">*</span>b<span class="op">;</span> <span class="op">*</span>b <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> permute<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>arr<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> r<span class="op">;</span> i<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> arr<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> l<span class="op">;</span> i <span class="op">&lt;=</span> r<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>        swap<span class="op">(&amp;</span>arr<span class="op">[</span>l<span class="op">],</span> <span class="op">&amp;</span>arr<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>        permute<span class="op">(</span>arr<span class="op">,</span> l <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">);</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        swap<span class="op">(&amp;</span>arr<span class="op">[</span>l<span class="op">],</span> <span class="op">&amp;</span>arr<span class="op">[</span>i<span class="op">]);</span> <span class="co">// backtrack</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    permute<span class="op">(</span>arr<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-24" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-24">Why It Matters</h4>
<ul>
<li><p>Foundation for brute-force search, backtracking, and enumeration</p></li>
<li><p>Powers:</p>
<ul>
<li>Traveling Salesman Problem (TSP) brute-force</li>
<li>Permutation testing in statistics</li>
<li>Order-based search in AI / combinatorial optimization</li>
</ul></li>
<li><p>Useful in:</p>
<ul>
<li>Combinatorics</li>
<li>String generation</li>
<li>Constraint solving</li>
</ul></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-24" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-24">A Gentle Proof (Why It Works)</h4>
<p>Each position in the permutation can hold one of the remaining unused elements.</p>
<p>The recurrence:</p>
<p><span class="math display">\[
P(n)=n\cdot P(n-1)
\]</span></p>
<p>Base case <span class="math inline">\(P(1)=1\)</span>, so <span class="math inline">\(P(n)=n!\)</span>.</p>
<p>Every branch in recursion represents one arrangement, total branches = <span class="math inline">\(n!\)</span>.</p>
</section>
<section id="try-it-yourself-24" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-24">Try It Yourself</h4>
<ol type="1">
<li>Generate all permutations of <code>[1,2,3]</code>.</li>
<li>Print count for <code>n=4</code> (should be <span class="math inline">\(24\)</span>).</li>
<li>Modify code to store, not print, permutations.</li>
<li>Implement lexicographic next-permutation method.</li>
<li>Use permutations to test all possible password orders.</li>
</ol>
</section>
<section id="test-cases-24" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-24">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 78%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Input</th>
<th>Output (Permutations)</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2]</td>
<td>[1,2], [2,1]</td>
<td>2</td>
</tr>
<tr class="even">
<td>[1,2,3]</td>
<td>[1,2,3], [1,3,2], [2,1,3], [2,3,1], [3,1,2], [3,2,1]</td>
<td>6</td>
</tr>
<tr class="odd">
<td>[‘A’,‘B’]</td>
<td>AB, BA</td>
<td>2</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-24" class="level4">
<h4 class="anchored" data-anchor-id="complexity-24">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n!)\)</span>, total permutations</li>
<li>Space: <span class="math inline">\(O(n)\)</span> recursion depth</li>
</ul>
<p>Permutation generation is exhaustive creativity, exploring every possible order, every possible path.</p>
</section>
</section>
<section id="next-permutation" class="level3">
<h3 class="anchored" data-anchor-id="next-permutation">526 Next Permutation</h3>
<p>The Next Permutation algorithm finds the next lexicographically greater permutation of a given sequence. It’s a building block for lexicographic enumeration, letting you step through permutations in sorted order without generating all at once.</p>
<p>If no larger permutation exists (the sequence is in descending order), it resets to the smallest (ascending order).</p>
<section id="what-problem-are-we-solving-25" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-25">What Problem Are We Solving?</h4>
<p>Given a permutation (arranged sequence), find the next lexicographically larger one.</p>
<p>Example: From <code>[1, 2, 3]</code>, the next permutation is <code>[1, 3, 2]</code>. From <code>[3, 2, 1]</code>, there’s no larger one, so we reset to <code>[1, 2, 3]</code>.</p>
<p>We want a method that transforms a sequence in-place, in O(n) time.</p>
</section>
<section id="how-does-it-work-plain-language-25" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-25">How Does It Work (Plain Language)</h4>
<p>Imagine your sequence as a number, e.g.&nbsp;<code>[1, 2, 3]</code> represents 123. You want the next bigger number made from the same digits.</p>
<p>Algorithm steps:</p>
<ol type="1">
<li><p>Find pivot, scan from right to left to find the first index <code>i</code> where <span class="math inline">\(a[i] &lt; a[i+1]\)</span> (This is the point where the next permutation can be increased.)</p></li>
<li><p>Find successor, from the right, find the smallest <span class="math inline">\(a[j] &gt; a[i]\)</span>.</p></li>
<li><p>Swap <span class="math inline">\(a[i]\)</span> and <span class="math inline">\(a[j]\)</span>.</p></li>
<li><p>Reverse the suffix starting at <span class="math inline">\(i+1\)</span> (turn descending tail into ascending).</p></li>
</ol>
<p>If no pivot is found, reverse the whole array (last permutation → first).</p>
<p>Example</p>
<p>From <code>[1, 2, 3]</code>:</p>
<ol type="1">
<li>Pivot at <code>2</code> (<code>a[1]</code>), since <code>2 &lt; 3</code>.</li>
<li>Successor = <code>3</code>.</li>
<li>Swap → <code>[1, 3, 2]</code>.</li>
<li>Reverse suffix <code>[2]</code> → unchanged. Ok Next permutation = <code>[1, 3, 2]</code>.</li>
</ol>
<p>From <code>[3, 2, 1]</code>: No pivot (entirely descending) → reverse to <code>[1, 2, 3]</code>.</p>
</section>
<section id="tiny-code-easy-versions-22" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-22">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> next_permutation(arr):</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(arr)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> n <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> arr[i] <span class="op">&gt;=</span> arr[i <span class="op">+</span> <span class="dv">1</span>]:</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        arr.reverse()</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span>  <span class="co"># last permutation</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> arr[j] <span class="op">&lt;=</span> arr[i]:</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    arr[i], arr[j] <span class="op">=</span> arr[j], arr[i]</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    arr[i <span class="op">+</span> <span class="dv">1</span>:] <span class="op">=</span> <span class="bu">reversed</span>(arr[i <span class="op">+</span> <span class="dv">1</span>:])</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>next_permutation(arr)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr)  <span class="co"># [1, 3, 2]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> reverse<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>l <span class="op">&lt;</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> t <span class="op">=</span> a<span class="op">[</span>l<span class="op">];</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        a<span class="op">[</span>l<span class="op">++]</span> <span class="op">=</span> a<span class="op">[</span>r<span class="op">];</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>        a<span class="op">[</span>r<span class="op">--]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> next_permutation<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> n <span class="op">-</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>i <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;=</span> a<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">])</span> i<span class="op">--;</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>i <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>        reverse<span class="op">(</span>a<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>a<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;=</span> a<span class="op">[</span>i<span class="op">])</span> j<span class="op">--;</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t <span class="op">=</span> a<span class="op">[</span>i<span class="op">];</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> a<span class="op">[</span>j<span class="op">];</span> a<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    reverse<span class="op">(</span>a<span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    next_permutation<span class="op">(</span>a<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> a<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-25" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-25">Why It Matters</h4>
<ul>
<li><p>Core tool for lexicographic enumeration</p></li>
<li><p>Powers:</p>
<ul>
<li>Combinatorial iteration</li>
<li>Search problems (e.g.&nbsp;TSP brute-force)</li>
<li>String/sequence next-step generation</li>
</ul></li>
<li><p>Used in C++ STL (<code>std::next_permutation</code>)</p></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-25" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-25">A Gentle Proof (Why It Works)</h4>
<p>The suffix after pivot <span class="math inline">\(a[i]\)</span> is strictly decreasing, meaning it’s the largest arrangement of that suffix. To get the next larger permutation:</p>
<ul>
<li>Increase <span class="math inline">\(a[i]\)</span> minimally (swap with next larger element <span class="math inline">\(a[j]\)</span>)</li>
<li>Then reorder the suffix to the smallest possible arrangement (ascending)</li>
</ul>
<p>Thus ensuring the next lexicographic order.</p>
</section>
<section id="try-it-yourself-25" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-25">Try It Yourself</h4>
<ol type="1">
<li>Step through <code>[1, 2, 3]</code> → <code>[1, 3, 2]</code> → <code>[2, 1, 3]</code> → …</li>
<li>Write loop to print all permutations in order.</li>
<li>Try on characters: <code>['A', 'B', 'C']</code>.</li>
<li>Test <code>[3, 2, 1]</code>, should reset to <code>[1, 2, 3]</code>.</li>
<li>Modify to generate previous permutation.</li>
</ol>
</section>
<section id="test-cases-25" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-25">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input</th>
<th>Output (Next)</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2,3]</td>
<td>[1,3,2]</td>
<td>simple</td>
</tr>
<tr class="even">
<td>[1,3,2]</td>
<td>[2,1,3]</td>
<td>middle</td>
</tr>
<tr class="odd">
<td>[3,2,1]</td>
<td>[1,2,3]</td>
<td>wrap-around</td>
</tr>
<tr class="even">
<td>[1,1,5]</td>
<td>[1,5,1]</td>
<td>duplicates</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-25" class="level4">
<h4 class="anchored" data-anchor-id="complexity-25">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Next Permutation is your lexicographic stepper, one small swap, one tidy reverse, one giant leap in order.</p>
</section>
</section>
<section id="subset-generation" class="level3">
<h3 class="anchored" data-anchor-id="subset-generation">527 Subset Generation</h3>
<p>Subset generation is the process of listing every possible subset of a given set, including the empty set and the full set. It’s a cornerstone of combinatorial enumeration, power set construction, and many backtracking and bitmask algorithms.</p>
<section id="what-problem-are-we-solving-26" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-26">What Problem Are We Solving?</h4>
<p>Given a set of <span class="math inline">\(n\)</span> elements, generate all its subsets.</p>
<p>For example, for <span class="math inline">\({1,2,3}\)</span>, the subsets (the power set) are:</p>
<p><span class="math display">\[
\varnothing,{1},{2},{3},{1,2},{1,3},{2,3},{1,2,3}
\]</span></p>
<p>Total number of subsets = <span class="math inline">\(2^n\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-26" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-26">How Does It Work (Plain Language)</h4>
<p>There are two classic methods:</p>
<ol type="1">
<li><p>Recursive / Backtracking Choose whether to include or exclude each element. Build subsets depth-first.</p></li>
<li><p>Bitmask Enumeration Represent subsets using a binary mask of length <span class="math inline">\(n\)</span>, where bit <span class="math inline">\(i\)</span> indicates whether the <span class="math inline">\(i\)</span>-th element is included.</p></li>
</ol>
<p>Example for <span class="math inline">\({1,2,3}\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Mask</th>
<th>Binary</th>
<th>Subset</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>000</td>
<td><span class="math inline">\(\varnothing\)</span></td>
</tr>
<tr class="even">
<td>1</td>
<td>001</td>
<td><span class="math inline">\({3}\)</span></td>
</tr>
<tr class="odd">
<td>2</td>
<td>010</td>
<td><span class="math inline">\({2}\)</span></td>
</tr>
<tr class="even">
<td>3</td>
<td>011</td>
<td><span class="math inline">\({2,3}\)</span></td>
</tr>
<tr class="odd">
<td>4</td>
<td>100</td>
<td><span class="math inline">\({1}\)</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>101</td>
<td><span class="math inline">\({1,3}\)</span></td>
</tr>
<tr class="odd">
<td>6</td>
<td>110</td>
<td><span class="math inline">\({1,2}\)</span></td>
</tr>
<tr class="even">
<td>7</td>
<td>111</td>
<td><span class="math inline">\({1,2,3}\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-easy-versions-23" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-23">Tiny Code (Easy Versions)</h4>
<p>Python Version (Recursive)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> subsets(arr, path<span class="op">=</span>[], i<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="bu">len</span>(arr):</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(path)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exclude current</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    subsets(arr, path, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Include current</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    subsets(arr, path <span class="op">+</span> [arr[i]], i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>subsets([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version (Bitmask)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> subsets_bitmask(arr):</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(arr)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mask <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span> <span class="op">&lt;&lt;</span> n):</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> [arr[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n) <span class="cf">if</span> mask <span class="op">&amp;</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> i)]</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(subset)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>subsets_bitmask([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (Bitmask)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> subsets<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>arr<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> total <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> n<span class="op">;</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> mask <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> mask <span class="op">&lt;</span> total<span class="op">;</span> mask<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"{ "</span><span class="op">);</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">))</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> arr<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"}</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    subsets<span class="op">(</span>arr<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-26" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-26">Why It Matters</h4>
<ul>
<li><p>Powers:</p>
<ul>
<li>Enumerating possibilities in combinatorial problems</li>
<li>Subset sum, knapsack, bitmask DP</li>
<li>Search and optimization</li>
</ul></li>
<li><p>Basis for:</p>
<ul>
<li>Power sets</li>
<li>Inclusion–exclusion principle</li>
<li>State-space exploration</li>
</ul></li>
</ul>
<p>Every subset represents one state, one choice pattern, one branch in the combinatorial tree.</p>
</section>
<section id="a-gentle-proof-why-it-works-26" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-26">A Gentle Proof (Why It Works)</h4>
<p>Each element can be included or excluded independently. That gives <span class="math inline">\(2\)</span> choices per element, so:</p>
<p><span class="math display">\[
\text{Total subsets} = 2 \times 2 \times \cdots \times 2 = 2^n
\]</span></p>
<p>Each binary mask uniquely encodes a subset. Thus both recursive and bitmask methods visit all <span class="math inline">\(2^n\)</span> subsets exactly once.</p>
</section>
<section id="try-it-yourself-26" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-26">Try It Yourself</h4>
<ol type="1">
<li>Generate all subsets of <code>[1,2,3,4]</code>.</li>
<li>Count subsets of size 2 only.</li>
<li>Print subsets in lexicographic order.</li>
<li>Filter subsets summing to 5.</li>
<li>Combine with DP for subset sum.</li>
</ol>
</section>
<section id="test-cases-26" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-26">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input</th>
<th>Output (Subsets)</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2]</td>
<td>[], [1], [2], [1,2]</td>
<td>4</td>
</tr>
<tr class="even">
<td>[1,2,3]</td>
<td>8 subsets</td>
<td>8</td>
</tr>
<tr class="odd">
<td>[]</td>
<td>[]</td>
<td>1</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-26" class="level4">
<h4 class="anchored" data-anchor-id="complexity-26">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(2^n \cdot n)\)</span> (each subset generation takes <span class="math inline">\(O(n)\)</span>)</li>
<li>Space: <span class="math inline">\(O(n)\)</span> recursion stack or temporary list</li>
</ul>
<p>Subset generation is the combinatorial chorus, every yes/no choice joins the melody of all possibilities.</p>
</section>
</section>
<section id="gray-code-generation" class="level3">
<h3 class="anchored" data-anchor-id="gray-code-generation">528 Gray Code Generation</h3>
<p>Gray codes list all <span class="math inline">\(2^n\)</span> binary strings of length <span class="math inline">\(n\)</span> so that consecutive codes differ in exactly one bit (Hamming distance <span class="math inline">\(1\)</span>). They are ideal for enumerations where small step changes reduce errors or avoid expensive recomputation.</p>
<section id="what-problem-are-we-solving-27" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-27">What Problem Are We Solving?</h4>
<p>Generate an ordering of all <span class="math inline">\(n\)</span>-bit strings <span class="math display">\[
g_0,g_1,\dots,g_{2^n-1}
\]</span> such that for each <span class="math inline">\(k\ge 1\)</span>, the Hamming distance <span class="math inline">\(\mathrm{dist}(g_{k-1},g_k)=1\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-27" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-27">How Does It Work (Plain Language)</h4>
<p>There are two classic constructions:</p>
<ol type="1">
<li>Reflect and prefix (recursive)</li>
</ol>
<ul>
<li><p>Base: <span class="math inline">\(G_1=[0,1]\)</span></p></li>
<li><p>To build <span class="math inline">\(G_{n}\)</span> from <span class="math inline">\(G_{n-1}\)</span>:</p>
<ul>
<li>Take <span class="math inline">\(G_{n-1}\)</span> and prefix each code with <span class="math inline">\(0\)</span></li>
<li>Take the reverse of <span class="math inline">\(G_{n-1}\)</span> and prefix each code with <span class="math inline">\(1\)</span></li>
</ul></li>
<li><p>Concatenate the two lists</p></li>
</ul>
<ol start="2" type="1">
<li>Bit trick (iterative, index to Gray)</li>
</ol>
<ul>
<li>The <span class="math inline">\(k\)</span>-th Gray code is <span class="math display">\[
g(k)=k\oplus (k!!\gg!1)
\]</span> where <span class="math inline">\(\oplus\)</span> is bitwise XOR and <span class="math inline">\(\gg\)</span> is right shift</li>
</ul>
<p>Both yield the same sequence up to renaming.</p>
</section>
<section id="example-4" class="level4">
<h4 class="anchored" data-anchor-id="example-4">Example</h4>
<p>For <span class="math inline">\(n=3\)</span>, the reflect-and-prefix method gives:</p>
<ul>
<li>Start with <span class="math inline">\(G_1\)</span>: <span class="math inline">\(0,1\)</span></li>
<li><span class="math inline">\(G_2\)</span>: prefix <span class="math inline">\(0\)</span> to get <span class="math inline">\(00,01\)</span>, prefix <span class="math inline">\(1\)</span> to reversed <span class="math inline">\(G_1\)</span> to get <span class="math inline">\(11,10\)</span></li>
<li><span class="math inline">\(G_2=[00,01,11,10]\)</span></li>
<li><span class="math inline">\(G_3\)</span>: prefix <span class="math inline">\(0\)</span> to <span class="math inline">\(G_2\)</span> <span class="math inline">\(\to\)</span> <span class="math inline">\(000,001,011,010\)</span> prefix <span class="math inline">\(1\)</span> to reversed <span class="math inline">\(G_2\)</span> <span class="math inline">\(\to\)</span> <span class="math inline">\(110,111,101,100\)</span></li>
</ul>
<p>Final <span class="math inline">\(G_3\)</span>: <span class="math display">\[
000,001,011,010,110,111,101,100
\]</span> Each consecutive pair differs in exactly one bit.</p>
</section>
<section id="tiny-code-easy-versions-24" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-24">Tiny Code (Easy Versions)</h4>
<p>Python Version: reflect and prefix</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gray_reflect(n):</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    codes <span class="op">=</span> [<span class="st">"0"</span>, <span class="st">"1"</span>]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> codes</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>        left <span class="op">=</span> [<span class="st">"0"</span> <span class="op">+</span> c <span class="cf">for</span> c <span class="kw">in</span> codes]</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>        right <span class="op">=</span> [<span class="st">"1"</span> <span class="op">+</span> c <span class="cf">for</span> c <span class="kw">in</span> <span class="bu">reversed</span>(codes)]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>        codes <span class="op">=</span> left <span class="op">+</span> right</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> codes</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gray_reflect(<span class="dv">3</span>))  <span class="co"># ['000','001','011','010','110','111','101','100']</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version: bit trick <span class="math inline">\(g(k)=k\oplus(k&gt;&gt;1)\)</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gray_bit(n):</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [k <span class="op">^</span> (k <span class="op">&gt;&gt;</span> <span class="dv">1</span>) <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span> <span class="op">&lt;&lt;</span> n)]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> to_bits(x, n):</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">format</span>(x, <span class="ss">f"0</span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">b"</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>codes <span class="op">=</span> [to_bits(v, n) <span class="cf">for</span> v <span class="kw">in</span> gray_bit(n)]</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(codes)  <span class="co"># ['000','001','011','010','110','111','101','100']</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version: bit trick</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="dt">unsigned</span> gray<span class="op">(</span><span class="dt">unsigned</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> k <span class="op">^</span> <span class="op">(</span>k <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> print_binary<span class="op">(</span><span class="dt">unsigned</span> x<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>        putchar<span class="op">((</span>x <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span><span class="bu">u</span> <span class="op">&lt;&lt;</span> i<span class="op">))</span> <span class="op">?</span> <span class="ch">'1'</span> <span class="op">:</span> <span class="ch">'0'</span><span class="op">);</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> total <span class="op">=</span> <span class="dv">1</span><span class="bu">u</span> <span class="op">&lt;&lt;</span> n<span class="op">;</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">unsigned</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> total<span class="op">;</span> <span class="op">++</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">unsigned</span> g <span class="op">=</span> gray<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>        print_binary<span class="op">(</span>g<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>        putchar<span class="op">(</span><span class="ch">'</span><span class="sc">\n</span><span class="ch">'</span><span class="op">);</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-27" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-27">Why It Matters</h4>
<ul>
<li>Consecutive states differ by one bit, reducing switching errors and glitches in hardware encoders and ADCs</li>
<li>Useful in gray-code counters, Hamiltonian paths on hypercubes, and search over subsets where incremental updates are cheap</li>
<li>Common in combinatorial generation to minimize change between outputs</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-27" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-27">A Gentle Proof (Why It Works)</h4>
<p>For the reflect-and-prefix method:</p>
<ul>
<li>The first half is <span class="math inline">\(0\cdot G_{n-1}\)</span> where neighbors already differ in one bit</li>
<li>The second half is <span class="math inline">\(1\cdot \mathrm{rev}(G_{n-1})\)</span> where neighbors still differ in one bit</li>
<li>The boundary pair differs only in the first bit because we go from <span class="math inline">\(0\cdot g_0\)</span> to <span class="math inline">\(1\cdot g_0\)</span> By induction on <span class="math inline">\(n\)</span>, consecutive codes differ in exactly one bit.</li>
</ul>
<p>For the bit trick:</p>
<ul>
<li>Write <span class="math inline">\(g(k)=k\oplus(k&gt;&gt;1)\)</span> and <span class="math inline">\(g(k+1)=(k+1)\oplus((k+1)&gt;&gt;1)\)</span></li>
<li>One can check that <span class="math inline">\(g(k)\)</span> and <span class="math inline">\(g(k+1)\)</span> differ only in the lowest bit that changes when incrementing <span class="math inline">\(k\)</span> Hence Hamming distance is <span class="math inline">\(1\)</span>.</li>
</ul>
</section>
<section id="try-it-yourself-27" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-27">Try It Yourself</h4>
<ol type="1">
<li>Generate Gray codes for <span class="math inline">\(n=1\ldots 5\)</span> using both methods and compare.</li>
<li>Map Gray codes back to binary: inverse is <span class="math inline">\(b_0=g_0\)</span>, and <span class="math inline">\(b_i=b_{i-1}\oplus g_i\)</span> for <span class="math inline">\(i\ge 1\)</span>.</li>
<li>Iterate all subsets of <span class="math inline">\({0,\dots,n-1}\)</span> in Gray order and maintain an incremental sum by flipping one element each step.</li>
<li>Use Gray order to traverse vertices of the <span class="math inline">\(n\)</span>-cube.</li>
</ol>
</section>
<section id="test-cases-27" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-27">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Expected prefix of sequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><span class="math inline">\(0,1\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(00,01,11,10\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td><span class="math inline">\(000,001,011,010,110,111,101,100\)</span></td>
</tr>
</tbody>
</table>
<p>Also verify that every adjacent pair differs in exactly one bit.</p>
</section>
<section id="complexity-27" class="level4">
<h4 class="anchored" data-anchor-id="complexity-27">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(2^n)\)</span> to output all codes</li>
<li>Space: <span class="math inline">\(O(n)\)</span> per code (or <span class="math inline">\(O(1)\)</span> extra using bit trick)</li>
</ul>
<p>Gray codes give a one-bit-at-a-time tour of the hypercube, perfect for smooth transitions in algorithms and hardware.</p>
</section>
</section>
<section id="catalan-number-dp" class="level3">
<h3 class="anchored" data-anchor-id="catalan-number-dp">529 Catalan Number DP</h3>
<p>Catalan numbers count a wide variety of recursive structures, from valid parentheses strings to binary trees, polygon triangulations, and non-crossing paths. They are the backbone of combinatorial recursion, dynamic programming, and context-free grammars.</p>
<section id="what-problem-are-we-solving-28" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-28">What Problem Are We Solving?</h4>
<p>We want to compute the <span class="math inline">\(n\)</span>-th Catalan number, <span class="math inline">\(C_n\)</span>, which counts:</p>
<ul>
<li>Valid parentheses sequences of length <span class="math inline">\(2n\)</span></li>
<li>Binary search trees with <span class="math inline">\(n\)</span> nodes</li>
<li>Triangulations of an <span class="math inline">\((n+2)\)</span>-gon</li>
<li>Non-crossing partitions, Dyck paths, etc.</li>
</ul>
<p>The recursive formula is:</p>
<p><span class="math display">\[
C_0 = 1
\]</span></p>
<p><span class="math display">\[
C_n = \sum_{i=0}^{n-1} C_i \cdot C_{n-1-i}
\]</span></p>
<p>Alternatively, the closed-form expression using binomial coefficients is:</p>
<p><span class="math display">\[
C_n = \frac{1}{n+1}\binom{2n}{n}
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-28" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-28">How Does It Work (Plain Language)</h4>
<p>Think of <span class="math inline">\(C_n\)</span> as counting ways to split a structure into two balanced parts.</p>
<p>Example (valid parentheses): Every sequence starts with <code>(</code> and pairs with a matching <code>)</code> that divides the sequence into two smaller valid parts. If the left part has <span class="math inline">\(C_i\)</span> ways and the right part has <span class="math inline">\(C_{n-1-i}\)</span> ways, the total is their product. Summing across all possible splits gives the full <span class="math inline">\(C_n\)</span>.</p>
</section>
<section id="example-5" class="level4">
<h4 class="anchored" data-anchor-id="example-5">Example</h4>
<p>Let’s compute the first few:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(C_n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td>5</td>
</tr>
<tr class="odd">
<td>4</td>
<td>14</td>
</tr>
<tr class="even">
<td>5</td>
<td>42</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-easy-versions-25" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-25">Tiny Code (Easy Versions)</h4>
<p>Python (DP approach)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> catalan(n):</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    C[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i):</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>            C[i] <span class="op">+=</span> C[j] <span class="op">*</span> C[i <span class="op">-</span> <span class="dv">1</span> <span class="op">-</span> j]</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C[n]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>):</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"C(</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">) = </span><span class="sc">{</span>catalan(i)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python (Binomial formula)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> comb</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> catalan_binom(n):</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> comb(<span class="dv">2</span> <span class="op">*</span> n, n) <span class="op">//</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>([catalan_binom(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (DP approach)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="dt">unsigned</span> <span class="dt">long</span> catalan<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">long</span> C<span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    C<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>        C<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>            C<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> C<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> C<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span> <span class="op">-</span> j<span class="op">];</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"C(</span><span class="sc">%d</span><span class="st">) = </span><span class="sc">%lu\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> catalan<span class="op">(</span>i<span class="op">));</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-28" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-28">Why It Matters</h4>
<p>Catalan numbers appear in many fundamental combinatorial and algorithmic contexts:</p>
<ul>
<li>Combinatorics: Dyck paths, lattice paths, stack-sortable permutations</li>
<li>Dynamic programming: counting tree structures</li>
<li>Parsing theory: number of valid parse trees</li>
<li>Geometry: triangulations of convex polygons</li>
</ul>
<p>They are a universal count for balanced recursive structures.</p>
</section>
<section id="a-gentle-proof-why-it-works-28" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-28">A Gentle Proof (Why It Works)</h4>
<p>Each Catalan object splits into two smaller ones around a root:</p>
<p><span class="math display">\[
C_n = \sum_{i=0}^{n-1} C_i \cdot C_{n-1-i}
\]</span></p>
<p>This recurrence mirrors binary tree formation, left subtree size <span class="math inline">\(i\)</span>, right subtree <span class="math inline">\(n-1-i\)</span>.</p>
<p>The closed form follows from the binomial identity:</p>
<p><span class="math display">\[
C_n = \frac{1}{n+1}\binom{2n}{n}
\]</span></p>
<p>which arises from solving the recurrence using generating functions.</p>
</section>
<section id="try-it-yourself-28" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-28">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(C_3\)</span> manually using the recurrence.</li>
<li>Verify <span class="math inline">\(C_4 = 14\)</span>.</li>
<li>Print all valid parentheses for <span class="math inline">\(n=3\)</span> (should be 5).</li>
<li>Compare DP and binomial implementations.</li>
<li>Use Catalan DP to count binary search trees of size <span class="math inline">\(n\)</span>.</li>
</ol>
</section>
<section id="test-cases-28" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-28">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Expected <span class="math inline">\(C_n\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td>5</td>
</tr>
<tr class="odd">
<td>4</td>
<td>14</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-28" class="level4">
<h4 class="anchored" data-anchor-id="complexity-28">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^2)\)</span> (DP), <span class="math inline">\(O(n)\)</span> (binomial)</li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>Catalan numbers are the backbone of many recursive counting problems, capturing the essence of balance, structure, and symmetry.</p>
</section>
</section>
<section id="stirling-numbers" class="level3">
<h3 class="anchored" data-anchor-id="stirling-numbers">530 Stirling Numbers</h3>
<p>Stirling numbers count ways to partition or arrange elements under specific constraints. They connect combinatorics, recurrence relations, and generating functions, bridging counting, algebra, and probability.</p>
<p>There are two families:</p>
<ol type="1">
<li>Stirling numbers of the first kind <span class="math inline">\(c(n, k)\)</span>, count permutations of <span class="math inline">\(n\)</span> elements with exactly <span class="math inline">\(k\)</span> cycles.</li>
<li>Stirling numbers of the second kind <span class="math inline">\(S(n, k)\)</span>, count ways to partition <span class="math inline">\(n\)</span> elements into <span class="math inline">\(k\)</span> non-empty unlabeled subsets.</li>
</ol>
<section id="what-problem-are-we-solving-29" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-29">What Problem Are We Solving?</h4>
<p>We want to compute either:</p>
<ol type="1">
<li>First kind (signed or unsigned):</li>
</ol>
<p><span class="math display">\[
c(n,k) = c(n-1,k-1) + (n-1),c(n-1,k)
\]</span></p>
<ol start="2" type="1">
<li>Second kind:</li>
</ol>
<p><span class="math display">\[
S(n,k) = S(n-1,k-1) + k,S(n-1,k)
\]</span></p>
<p>Base cases:</p>
<p><span class="math display">\[
c(0,0)=1,\quad S(0,0)=1
\]</span></p>
<p><span class="math display">\[
c(n,0)=S(n,0)=0 \text{ for } n&gt;0
\]</span></p>
<p><span class="math display">\[
c(0,k)=S(0,k)=0 \text{ for } k&gt;0
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-29" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-29">How Does It Work (Plain Language)</h4>
<ul>
<li><p>First kind: building permutations</p>
<ul>
<li>Place element <span class="math inline">\(n\)</span> alone as a new cycle (<span class="math inline">\(c(n-1,k-1)\)</span> ways)</li>
<li>Or insert <span class="math inline">\(n\)</span> into one of <span class="math inline">\((n-1)\)</span> existing cycles ($ (n-1),c(n-1,k)$ ways)</li>
</ul></li>
<li><p>Second kind: building partitions</p>
<ul>
<li>Place element <span class="math inline">\(n\)</span> alone (new subset) → <span class="math inline">\(S(n-1,k-1)\)</span></li>
<li>Or place <span class="math inline">\(n\)</span> into one of <span class="math inline">\(k\)</span> existing subsets → <span class="math inline">\(k,S(n-1,k)\)</span></li>
</ul></li>
</ul>
<p>Each recurrence reflects a “new item added” logic, creating new groups or joining old ones.</p>
</section>
<section id="example-6" class="level4">
<h4 class="anchored" data-anchor-id="example-6">Example</h4>
<p>For second kind <span class="math inline">\(S(3,k)\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(k\)</span></th>
<th><span class="math inline">\(S(n,k)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>3</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>So <span class="math inline">\(S(3,2)=3\)</span> means 3 ways to split {1,2,3} into 2 non-empty sets:</p>
<ul>
<li>{1,2},{3}</li>
<li>{1,3},{2}</li>
<li>{2,3},{1}</li>
</ul>
</section>
<section id="tiny-code-easy-versions-26" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-26">Tiny Code (Easy Versions)</h4>
<p>Python (Stirling numbers of the second kind)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stirling2(n, k):</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> k <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="kw">or</span> k <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[<span class="dv">0</span>]<span class="op">*</span>(k<span class="op">+</span><span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    dp[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, k<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>            dp[i][j] <span class="op">=</span> dp[i<span class="op">-</span><span class="dv">1</span>][j<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> j <span class="op">*</span> dp[i<span class="op">-</span><span class="dv">1</span>][j]</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[n][k]</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">4</span>):</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"S(3,</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">) ="</span>, stirling2(<span class="dv">3</span>,k))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python (Stirling numbers of the first kind)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stirling1(n, k):</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> k <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span> <span class="kw">or</span> k <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    dp <span class="op">=</span> [[<span class="dv">0</span>]<span class="op">*</span>(k<span class="op">+</span><span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    dp[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, k<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>            dp[i][j] <span class="op">=</span> dp[i<span class="op">-</span><span class="dv">1</span>][j<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> (i<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> dp[i<span class="op">-</span><span class="dv">1</span>][j]</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp[n][k]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-29" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-29">Why It Matters</h4>
<p>Stirling numbers unify combinatorics, algebra, and analysis:</p>
<ul>
<li><p><span class="math inline">\(S(n,k)\)</span>: count of set partitions</p></li>
<li><p><span class="math inline">\(c(n,k)\)</span>: count of permutation cycles</p></li>
<li><p>Appear in:</p>
<ul>
<li>Bell numbers: <span class="math inline">\(B_n = \sum_{k=0}^n S(n,k)\)</span></li>
<li>Factorial expansions</li>
<li>Moments in probability and statistics</li>
<li>Polynomial bases (falling/rising factorials)</li>
</ul></li>
</ul>
<p>They’re the coefficients when expressing factorials or powers in different bases: <span class="math display">\[
x^n = \sum_k S(n,k),(x)_k, \quad (x)_n = \sum_k c(n,k),x^k
\]</span></p>
</section>
<section id="a-gentle-proof-why-it-works-29" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-29">A Gentle Proof (Why It Works)</h4>
<p>For <span class="math inline">\(S(n,k)\)</span>, consider adding one element to a partition of size <span class="math inline">\(n-1\)</span>:</p>
<ul>
<li>Create new subset (choose none → <span class="math inline">\(S(n-1,k-1)\)</span>)</li>
<li>Join existing subset (choose one of <span class="math inline">\(k\)</span> → <span class="math inline">\(kS(n-1,k)\)</span>)</li>
</ul>
<p>Add them → recurrence proven.</p>
<p>For <span class="math inline">\(c(n,k)\)</span>, each new element:</p>
<ul>
<li>Starts a new cycle (<span class="math inline">\(c(n-1,k-1)\)</span>)</li>
<li>Joins one of existing cycles (<span class="math inline">\((n-1)c(n-1,k)\)</span>)</li>
</ul>
</section>
<section id="try-it-yourself-29" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-29">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(S(4,2)\)</span> manually.</li>
<li>Verify <span class="math inline">\(S(4,2)=7\)</span> and <span class="math inline">\(S(4,3)=6\)</span>.</li>
<li>Print full Stirling triangle.</li>
<li>Compare <span class="math inline">\(S(n,k)\)</span> vs binomial coefficients.</li>
<li>Derive Bell numbers: <span class="math inline">\(B_n=\sum_k S(n,k)\)</span>.</li>
</ol>
</section>
<section id="test-cases-29" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-29">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(k\)</span></th>
<th><span class="math inline">\(S(n,k)\)</span></th>
<th><span class="math inline">\(c(n,k)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>7</td>
<td>11</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-29" class="level4">
<h4 class="anchored" data-anchor-id="complexity-29">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(nk)\)</span></li>
<li>Space: <span class="math inline">\(O(nk)\)</span></li>
</ul>
<p>Stirling numbers form the grammar of combinatorial counting, expressing partitions, cycles, and transformations between polynomial worlds.</p>
</section>
</section>
</section>
<section id="section-54.-probability-and-randomized-algorithms" class="level1">
<h1>Section 54. Probability and Randomized Algorithms</h1>
<section id="monte-carlo-simulation" class="level3">
<h3 class="anchored" data-anchor-id="monte-carlo-simulation">531 Monte Carlo Simulation</h3>
<p>Monte Carlo simulation is a numerical method that uses random sampling to approximate solutions to deterministic or probabilistic problems. When exact formulas are hard or impossible to compute, Monte Carlo methods estimate results by simulating many random experiments and averaging the outcomes.</p>
<section id="what-problem-are-we-solving-30" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-30">What Problem Are We Solving?</h4>
<p>We want to estimate a quantity (like an area, integral, or probability) by random sampling.</p>
<p>The core principle:</p>
<p><span class="math display">\[
\text{Expected Value} \approx \frac{1}{N}\sum_{i=1}^{N} f(X_i)
\]</span></p>
<p>where <span class="math inline">\(X_i\)</span> are random samples and <span class="math inline">\(f(X_i)\)</span> measures the contribution from each trial.</p>
<p>As <span class="math inline">\(N \to \infty\)</span>, the average converges to the true value by the Law of Large Numbers.</p>
</section>
<section id="example-estimating-π" class="level4">
<h4 class="anchored" data-anchor-id="example-estimating-π">Example: Estimating π</h4>
<p>Imagine a unit square enclosing a quarter-circle of radius 1. The ratio of points falling inside the circle to total points approximates <span class="math inline">\(\pi/4\)</span>.</p>
<p><span class="math display">\[
\frac{\text{points inside}}{\text{total points}} \approx \frac{\pi}{4}
\]</span></p>
<p>So:</p>
<p><span class="math display">\[
\pi \approx 4 \times \frac{\text{inside}}{\text{total}}
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-30" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-30">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Define a random experiment (e.g., sample <span class="math inline">\((x,y)\)</span> in <span class="math inline">\([0,1]\times[0,1]\)</span>)</li>
<li>Check if the sample satisfies a condition (e.g., <span class="math inline">\(x^2 + y^2 \le 1\)</span>)</li>
<li>Repeat many times</li>
<li>Use the ratio (hits / total) to estimate the desired probability or value</li>
</ol>
<p>More samples → lower error (variance <span class="math inline">\(\propto 1/\sqrt{N}\)</span>)</p>
</section>
<section id="tiny-code-easy-versions-27" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-27">Tiny Code (Easy Versions)</h4>
<p>Python Version (Estimate π)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monte_carlo_pi(samples<span class="op">=</span><span class="dv">1000000</span>):</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    inside <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(samples):</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>        x, y <span class="op">=</span> random.random(), random.random()</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x<span class="op">*</span>x <span class="op">+</span> y<span class="op">*</span>y <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>            inside <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> inside <span class="op">/</span> samples</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated π ="</span>, monte_carlo_pi())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> samples <span class="op">=</span> <span class="dv">1000000</span><span class="op">,</span> inside <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> samples<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> x <span class="op">=</span> <span class="op">(</span><span class="dt">double</span><span class="op">)</span>rand<span class="op">()</span> <span class="op">/</span> RAND_MAX<span class="op">;</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> y <span class="op">=</span> <span class="op">(</span><span class="dt">double</span><span class="op">)</span>rand<span class="op">()</span> <span class="op">/</span> RAND_MAX<span class="op">;</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>x<span class="op">*</span>x <span class="op">+</span> y<span class="op">*</span>y <span class="op">&lt;=</span> <span class="fl">1.0</span><span class="op">)</span> inside<span class="op">++;</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> pi <span class="op">=</span> <span class="fl">4.0</span> <span class="op">*</span> inside <span class="op">/</span> samples<span class="op">;</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Estimated π = </span><span class="sc">%f\n</span><span class="st">"</span><span class="op">,</span> pi<span class="op">);</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-30" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-30">Why It Matters</h4>
<p>Monte Carlo methods are essential for:</p>
<ul>
<li>Integration in high dimensions</li>
<li>Probabilistic modeling</li>
<li>Optimization and simulation</li>
<li>Financial modeling (e.g., option pricing)</li>
<li>Physics and engineering (e.g., particle transport, statistical mechanics)</li>
</ul>
<p>They trade accuracy for generality, thriving when deterministic methods fail.</p>
</section>
<section id="a-gentle-proof-why-it-works-30" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-30">A Gentle Proof (Why It Works)</h4>
<p>Let <span class="math inline">\(X_1, X_2, \dots, X_N\)</span> be i.i.d. random variables representing outcomes. By the Law of Large Numbers:</p>
<p><span class="math display">\[
\frac{1}{N}\sum_{i=1}^{N} X_i \to \mathbb{E}[X]
\]</span></p>
<p>So the sample mean converges to the expected value, giving a consistent estimator. The Central Limit Theorem ensures that error decreases as <span class="math inline">\(1/\sqrt{N}\)</span>.</p>
</section>
<section id="try-it-yourself-30" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-30">Try It Yourself</h4>
<ol type="1">
<li>Estimate <span class="math inline">\(\pi\)</span> with different sample sizes.</li>
<li>Use Monte Carlo to compute <span class="math inline">\(\int_0^1 x^2,dx\)</span>.</li>
<li>Estimate the probability that sum of two dice is ≥ 10.</li>
<li>Model coin flips and compare to exact probabilities.</li>
<li>Measure convergence as <span class="math inline">\(N\)</span> grows (error vs samples).</li>
</ol>
</section>
<section id="test-cases-30" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-30">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Samples</th>
<th>Estimated π</th>
<th>Expected Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1000</td>
<td>~3.1</td>
<td>±0.05</td>
</tr>
<tr class="even">
<td>10,000</td>
<td>~3.14</td>
<td>±0.02</td>
</tr>
<tr class="odd">
<td>1,000,000</td>
<td>~3.1415</td>
<td>±0.001</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-30" class="level4">
<h4 class="anchored" data-anchor-id="complexity-30">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(N)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Monte Carlo simulation is statistics as computation, randomness revealing structure through repetition and averages.</p>
</section>
</section>
<section id="las-vegas-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="las-vegas-algorithm">532 Las Vegas Algorithm</h3>
<p>A Las Vegas algorithm always returns a correct answer, but its runtime is random, it may take longer or shorter depending on luck. Unlike Monte Carlo methods (which trade accuracy for speed), Las Vegas algorithms never compromise correctness, only time.</p>
<section id="what-problem-are-we-solving-31" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-31">What Problem Are We Solving?</h4>
<p>We need randomized algorithms that remain guaranteed correct, but whose execution time depends on random events.</p>
<p>In other words:</p>
<ul>
<li>Output: always correct</li>
<li>Time: random variable</li>
</ul>
<p>We want to design algorithms where randomness helps avoid worst-case behavior or simplify logic, without breaking correctness.</p>
</section>
<section id="how-does-it-work-plain-language-31" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-31">How Does It Work (Plain Language)</h4>
<p>A Las Vegas algorithm uses randomness to guide the search, pick pivots, or sample data, but verifies correctness before returning.</p>
<p>If the random choice is poor, it tries again.</p>
<p>Example: Randomized QuickSort</p>
<p>QuickSort chooses a random pivot, splits data around it, and recursively sorts. Random pivot selection ensures expected <span class="math inline">\(O(n \log n)\)</span> time, even though worst-case <span class="math inline">\(O(n^2)\)</span> still exists.</p>
<p>But the output is always sorted, correctness never depends on chance.</p>
<p>Another example: Randomized QuickSelect</p>
<p>Finds the <span class="math inline">\(k\)</span>-th smallest element using a random pivot. If pivot is bad, runtime worsens, but result is still correct.</p>
</section>
<section id="tiny-code-easy-versions-28" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-28">Tiny Code (Easy Versions)</h4>
<p>Python (Randomized QuickSort)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quicksort(arr):</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(arr) <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> arr</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    pivot <span class="op">=</span> random.choice(arr)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    left <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">&lt;</span> pivot]</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    mid <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">==</span> pivot]</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    right <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">&gt;</span> pivot]</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> quicksort(left) <span class="op">+</span> mid <span class="op">+</span> quicksort(right)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(quicksort([<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">6</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python (QuickSelect)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quickselect(arr, k):</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    pivot <span class="op">=</span> random.choice(arr)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    left <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">&lt;</span> pivot]</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    mid <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">==</span> pivot]</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    right <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">&gt;</span> pivot]</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">&lt;</span> <span class="bu">len</span>(left):</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> quickselect(left, k)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> k <span class="op">&lt;</span> <span class="bu">len</span>(left) <span class="op">+</span> <span class="bu">len</span>(mid):</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pivot</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> quickselect(right, k <span class="op">-</span> <span class="bu">len</span>(left) <span class="op">-</span> <span class="bu">len</span>(mid))</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(quickselect([<span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">20</span>, <span class="dv">15</span>], <span class="dv">2</span>))  <span class="co"># 3rd smallest element</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-31" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-31">Why It Matters</h4>
<p>Las Vegas algorithms combine certainty of correctness with expected efficiency:</p>
<ul>
<li>Sorting and selection (QuickSort, QuickSelect)</li>
<li>Computational geometry (Randomized incremental algorithms)</li>
<li>Graph algorithms (Randomized MSTs, planar separations)</li>
<li>Data structures (Skip lists, hash tables)</li>
</ul>
<p>They often simplify design and avoid adversarial inputs.</p>
</section>
<section id="a-gentle-proof-why-it-works-31" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-31">A Gentle Proof (Why It Works)</h4>
<p>Let <span class="math inline">\(T\)</span> be runtime random variable. Expected time:</p>
<p><span class="math display">\[
\mathbb{E}[T] = \sum_{t} t \cdot P(T = t)
\]</span></p>
<p>The algorithm terminates when a “good” random event occurs (e.g.&nbsp;balanced pivot). By bounding expected cost at each step, we can show <span class="math inline">\(\mathbb{E}[T] = O(f(n))\)</span>.</p>
<p>Correctness is ensured by deterministic verification after random choices.</p>
</section>
<section id="try-it-yourself-31" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-31">Try It Yourself</h4>
<ol type="1">
<li>Compare QuickSort with and without random pivot.</li>
<li>Measure runtime across many runs, observe variation.</li>
<li>Count recursive calls distribution for small arrays.</li>
<li>Use randomization in skip list insertion.</li>
<li>Write a retry-based algorithm (e.g., random hash probing).</li>
</ol>
</section>
<section id="test-cases-31" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-31">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 18%">
<col style="width: 21%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Input</th>
<th>Algorithm</th>
<th>Output</th>
<th>Correct?</th>
<th>Runtime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[3,1,4,1,5,9]</td>
<td>QuickSort</td>
<td>[1,1,3,4,5,9]</td>
<td>Yes</td>
<td>varies</td>
</tr>
<tr class="even">
<td>[7,10,4,3,20,15], k=2</td>
<td>QuickSelect</td>
<td>7</td>
<td>Yes</td>
<td>varies</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-31" class="level4">
<h4 class="anchored" data-anchor-id="complexity-31">Complexity</h4>
<ul>
<li>Expected Time: <span class="math inline">\(O(f(n))\)</span> (often <span class="math inline">\(O(n)\)</span> or <span class="math inline">\(O(n\log n)\)</span>)</li>
<li>Worst Time: still possible, but rare</li>
<li>Space: depends on recursion or retries</li>
</ul>
<p>Las Vegas algorithms gamble with time, never with truth, they always find the right answer, only the path differs each run.</p>
</section>
</section>
<section id="reservoir-sampling" class="level3">
<h3 class="anchored" data-anchor-id="reservoir-sampling">533 Reservoir Sampling</h3>
<p>Reservoir sampling is a clever algorithm for selecting a uniform random sample from a data stream of unknown or very large size, using only O(k) space. It’s a cornerstone of streaming algorithms, where you cannot store all the data but still want fair random selection.</p>
<section id="what-problem-are-we-solving-32" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-32">What Problem Are We Solving?</h4>
<p>Given a stream of <span class="math inline">\(n\)</span> items (possibly very large or unbounded), select <span class="math inline">\(k\)</span> items uniformly at random, that is, each item has equal probability <span class="math inline">\(\frac{k}{n}\)</span> of being chosen, without knowing <span class="math inline">\(n\)</span> in advance.</p>
<p>We want to process items one by one, keeping only a reservoir of <span class="math inline">\(k\)</span> samples.</p>
</section>
<section id="how-does-it-work-plain-language-32" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-32">How Does It Work (Plain Language)</h4>
<p>The key idea is incremental fairness:</p>
<ol type="1">
<li><p>Initialize: fill the reservoir with the first <span class="math inline">\(k\)</span> elements.</p></li>
<li><p>Process stream: for each item <span class="math inline">\(i\)</span> (1-indexed) after the <span class="math inline">\(k\)</span>-th,</p>
<ul>
<li>generate a random integer <span class="math inline">\(j \in [1, i]\)</span></li>
<li>if <span class="math inline">\(j \le k\)</span>, replace reservoir[<span class="math inline">\(j\)</span>] with item <span class="math inline">\(i\)</span></li>
</ul></li>
</ol>
<p>This ensures each element’s chance = <span class="math inline">\(\frac{k}{i}\)</span> at the <span class="math inline">\(i\)</span>-th step, and finally <span class="math inline">\(\frac{k}{n}\)</span> overall.</p>
</section>
<section id="example-k-2" class="level4">
<h4 class="anchored" data-anchor-id="example-k-2">Example (k = 2)</h4>
<p>Stream: [A, B, C, D]</p>
<ol type="1">
<li>Reservoir = [A, B]</li>
<li><span class="math inline">\(i=3\)</span> → random <span class="math inline">\(j\in[1,3]\)</span> → say <span class="math inline">\(j=2\)</span> → replace B → [A, C]</li>
<li><span class="math inline">\(i=4\)</span> → <span class="math inline">\(j\in[1,4]\)</span> → say <span class="math inline">\(j=4\)</span> → skip (since &gt;2) → [A, C]</li>
</ol>
<p>After full stream, every pair has equal probability.</p>
</section>
<section id="proof-of-uniformity" class="level4">
<h4 class="anchored" data-anchor-id="proof-of-uniformity">Proof of Uniformity</h4>
<p>At step <span class="math inline">\(i\)</span>:</p>
<ul>
<li>Probability of being selected: <span class="math inline">\(\frac{k}{i}\)</span></li>
<li>Probability of surviving future replacements: <span class="math display">\[
\prod_{t=i+1}^{n}\left(1 - \frac{1}{t}\right)=\frac{i}{n}
\]</span> Thus final probability = <span class="math inline">\(\frac{k}{i} \cdot \frac{i}{n} = \frac{k}{n}\)</span>, equal for all.</li>
</ul>
</section>
<section id="tiny-code-easy-versions-29" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-29">Tiny Code (Easy Versions)</h4>
<p>Python Version (k = 1)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reservoir_sample(stream):</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="va">None</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, item <span class="kw">in</span> <span class="bu">enumerate</span>(stream, start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> random.randint(<span class="dv">1</span>, i) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> item</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>]</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Random pick:"</span>, reservoir_sample(data))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python Version (k = 3)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reservoir_sample_k(stream, k):</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    reservoir <span class="op">=</span> []</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, item <span class="kw">in</span> <span class="bu">enumerate</span>(stream, start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&lt;=</span> k:</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>            reservoir.append(item)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>            j <span class="op">=</span> random.randint(<span class="dv">1</span>, i)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&lt;=</span> k:</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                reservoir[j <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> item</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reservoir</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reservoir_sample_k(data, <span class="dv">3</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (k = 1)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> stream<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">50</span><span class="op">};</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> stream<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>j <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> stream<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Random pick: </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> result<span class="op">);</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-32" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-32">Why It Matters</h4>
<p>Reservoir sampling is crucial for:</p>
<ul>
<li>Big data: when <span class="math inline">\(n\)</span> is too large for memory</li>
<li>Streaming APIs, logs, telemetry</li>
<li>Random sampling in databases and distributed systems</li>
<li>Machine learning: random mini-batches, unbiased selection</li>
</ul>
<p>It gives exact uniform probability without prior knowledge of <span class="math inline">\(n\)</span>.</p>
</section>
<section id="a-gentle-proof-why-it-works-32" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-32">A Gentle Proof (Why It Works)</h4>
<p>For any element <span class="math inline">\(x_i\)</span>:</p>
<ul>
<li>Chance selected when seen = <span class="math inline">\(\frac{k}{i}\)</span></li>
<li>Chance not replaced later = <span class="math inline">\(\frac{i}{i+1}\cdot \frac{i+1}{i+2}\cdots\frac{n-1}{n}=\frac{i}{n}\)</span></li>
<li>Combined: <span class="math inline">\(\frac{k}{i} \cdot \frac{i}{n} = \frac{k}{n}\)</span> Uniform for all <span class="math inline">\(i\)</span>.</li>
</ul>
</section>
<section id="try-it-yourself-32" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-32">Try It Yourself</h4>
<ol type="1">
<li>Run with increasing <span class="math inline">\(n\)</span> and track frequencies.</li>
<li>Verify approximate uniformity over 10,000 trials.</li>
<li>Test with <span class="math inline">\(k&gt;1\)</span>.</li>
<li>Apply to data streams from a file or API.</li>
<li>Modify for weighted sampling.</li>
</ol>
</section>
<section id="test-cases-32" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-32">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Stream</th>
<th>k</th>
<th>Possible Reservoir</th>
<th>Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[A, B, C]</td>
<td>1</td>
<td>A, B, or C</td>
<td>1/3 each</td>
</tr>
<tr class="even">
<td>[1, 2, 3, 4]</td>
<td>2</td>
<td>Any 2-combo</td>
<td>Equal</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-32" class="level4">
<h4 class="anchored" data-anchor-id="complexity-32">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span> (one pass)</li>
<li>Space: <span class="math inline">\(O(k)\)</span></li>
</ul>
<p>Reservoir sampling is randomness under constraint, fair selection from endless flow, one element at a time.</p>
</section>
</section>
<section id="randomized-quicksort" class="level3">
<h3 class="anchored" data-anchor-id="randomized-quicksort">534 Randomized QuickSort</h3>
<p>Randomized QuickSort is the classic divide-and-conquer sorting algorithm, with a twist of randomness. Instead of choosing a fixed pivot (like the first or last element), it picks a random pivot, ensuring that the expected runtime stays <span class="math inline">\(O(n \log n)\)</span>, regardless of input order.</p>
<p>This simple randomization elegantly neutralizes worst-case scenarios.</p>
<section id="what-problem-are-we-solving-33" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-33">What Problem Are We Solving?</h4>
<p>We need a fast, in-place sorting algorithm that avoids pathological inputs. Standard QuickSort can degrade to <span class="math inline">\(O(n^2)\)</span> on sorted data if the pivot is chosen poorly. By picking pivots uniformly at random, we guarantee expected balance and expected <span class="math inline">\(O(n \log n)\)</span> behavior.</p>
</section>
<section id="how-does-it-work-plain-language-33" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-33">How Does It Work (Plain Language)</h4>
<p>QuickSort partitions the array around a pivot — elements smaller go left, greater go right — then recursively sorts the two sides.</p>
<p>Randomization ensures the pivot is, on average, near the median, keeping the recursion tree balanced.</p>
<p>Steps:</p>
<ol type="1">
<li><p>Choose a random pivot index <code>p</code>.</p></li>
<li><p>Partition array so that:</p>
<ul>
<li>Left: elements &lt; pivot</li>
<li>Right: elements &gt; pivot</li>
</ul></li>
<li><p>Recursively sort both partitions.</p></li>
</ol>
<p>When randomization is fair, each pivot splits roughly evenly, giving height <span class="math inline">\(\approx \log n\)</span> and total work <span class="math inline">\(O(n \log n)\)</span>.</p>
</section>
<section id="example-7" class="level4">
<h4 class="anchored" data-anchor-id="example-7">Example</h4>
<p>Sort <code>[3, 6, 2, 1, 4]</code></p>
<ol type="1">
<li>Pick random pivot → say <code>3</code></li>
<li>Partition → <code>[2,1] [3] [6,4]</code></li>
<li>Recurse on <code>[2,1]</code> and <code>[6,4]</code></li>
<li>Continue until sorted: <code>[1,2,3,4,6]</code></li>
</ol>
<p>Different random seeds → different recursion paths, same final result.</p>
</section>
<section id="tiny-code-easy-versions-30" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-30">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quicksort(arr):</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(arr) <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> arr</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    pivot <span class="op">=</span> random.choice(arr)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    left <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">&lt;</span> pivot]</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    mid <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">==</span> pivot]</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    right <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">&gt;</span> pivot]</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> quicksort(left) <span class="op">+</span> mid <span class="op">+</span> quicksort(right)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>]</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(quicksort(arr))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb76"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> swap<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> t <span class="op">=</span> <span class="op">*</span>a<span class="op">;</span> <span class="op">*</span>a <span class="op">=</span> <span class="op">*</span>b<span class="op">;</span> <span class="op">*</span>b <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> partition<span class="op">(</span><span class="dt">int</span> a<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot_idx <span class="op">=</span> low <span class="op">+</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>high <span class="op">-</span> low <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(&amp;</span>a<span class="op">[</span>pivot_idx<span class="op">],</span> <span class="op">&amp;</span>a<span class="op">[</span>high<span class="op">]);</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot <span class="op">=</span> a<span class="op">[</span>high<span class="op">];</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> low <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> low<span class="op">;</span> j <span class="op">&lt;</span> high<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> pivot<span class="op">)</span> swap<span class="op">(&amp;</span>a<span class="op">[++</span>i<span class="op">],</span> <span class="op">&amp;</span>a<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(&amp;</span>a<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">],</span> <span class="op">&amp;</span>a<span class="op">[</span>high<span class="op">]);</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> quicksort<span class="op">(</span><span class="dt">int</span> a<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>low <span class="op">&lt;</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> pi <span class="op">=</span> partition<span class="op">(</span>a<span class="op">,</span> low<span class="op">,</span> high<span class="op">);</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>        quicksort<span class="op">(</span>a<span class="op">,</span> low<span class="op">,</span> pi <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>        quicksort<span class="op">(</span>a<span class="op">,</span> pi <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> high<span class="op">);</span></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">4</span><span class="op">};</span></span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>    quicksort<span class="op">(</span>a<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> a<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-33" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-33">Why It Matters</h4>
<p>Randomized QuickSort is:</p>
<ul>
<li>Fast in practice (low constants, cache-friendly)</li>
<li>In-place (no extra arrays)</li>
<li>Expected <span class="math inline">\(O(n \log n)\)</span> independent of input</li>
<li>Immune to adversarial inputs and pre-sorted traps</li>
</ul>
<p>Used widely in:</p>
<ul>
<li>Standard libraries (e.g.&nbsp;Python’s <code>sort()</code> uses hybrid with randomized pivot)</li>
<li>Database systems and data processing pipelines</li>
<li>Teaching divide-and-conquer and randomized algorithms</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-33" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-33">A Gentle Proof (Why It Works)</h4>
<p>Let <span class="math inline">\(T(n)\)</span> be expected cost. Each partition step costs <span class="math inline">\(O(n)\)</span> comparisons. Pivot splits array into sizes <span class="math inline">\(i\)</span> and <span class="math inline">\(n-i-1\)</span> with equal probability for each <span class="math inline">\(i\)</span>.</p>
<p><span class="math display">\[
\mathbb{E}[T(n)] = \frac{1}{n}\sum_{i=0}^{n-1} (\mathbb{E}[T(i)] + \mathbb{E}[T(n-i-1)]) + O(n)
\]</span></p>
<p>Solving gives <span class="math inline">\(\mathbb{E}[T(n)] = O(n \log n)\)</span>.</p>
<p>Variance decreases as random choices average out.</p>
</section>
<section id="try-it-yourself-33" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-33">Try It Yourself</h4>
<ol type="1">
<li>Run algorithm multiple times, note pivot sequence.</li>
<li>Sort already sorted list, no slowdown expected.</li>
<li>Compare runtime vs MergeSort.</li>
<li>Visualize recursion tree depth.</li>
<li>Implement a 3-way partition version for duplicates.</li>
</ol>
</section>
<section id="test-cases-33" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-33">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input</th>
<th>Output</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[3,6,2,1,4]</td>
<td>[1,2,3,4,6]</td>
<td>Basic case</td>
</tr>
<tr class="even">
<td>[1,2,3,4,5]</td>
<td>[1,2,3,4,5]</td>
<td>Pre-sorted</td>
</tr>
<tr class="odd">
<td>[5,4,3,2,1]</td>
<td>[1,2,3,4,5]</td>
<td>Reverse</td>
</tr>
<tr class="even">
<td>[2,2,2,2]</td>
<td>[2,2,2,2]</td>
<td>Duplicates</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-33" class="level4">
<h4 class="anchored" data-anchor-id="complexity-33">Complexity</h4>
<ul>
<li>Expected Time: <span class="math inline">\(O(n \log n)\)</span></li>
<li>Worst Case: <span class="math inline">\(O(n^2)\)</span> (rare)</li>
<li>Space: <span class="math inline">\(O(\log n)\)</span> recursion stack</li>
</ul>
<p>Randomized QuickSort transforms luck into balance, each shuffle a safeguard, each pivot a chance for harmony.</p>
</section>
</section>
<section id="randomized-quickselect" class="level3">
<h3 class="anchored" data-anchor-id="randomized-quickselect">535 Randomized QuickSelect</h3>
<p>Randomized QuickSelect is a divide-and-conquer algorithm for finding the k-th smallest element in an unsorted array in expected linear time. It’s the selection twin of QuickSort, using the same partition idea, but exploring only one side of the array at each step.</p>
<section id="what-problem-are-we-solving-34" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-34">What Problem Are We Solving?</h4>
<p>Given an unsorted array <code>arr</code> and a rank <code>k</code> (1-indexed), we want the element that would appear at position <code>k</code> if the array were sorted — without fully sorting it.</p>
<p>Example: In <code>[7, 10, 4, 3, 20, 15]</code>, the 3rd smallest element is <code>7</code>.</p>
<p>We want to find it in expected O(n), faster than sorting (<span class="math inline">\(O(n \log n)\)</span>).</p>
</section>
<section id="how-does-it-work-plain-language-34" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-34">How Does It Work (Plain Language)</h4>
<ol type="1">
<li><p>Choose a random pivot from the array.</p></li>
<li><p>Partition elements into three groups:</p>
<ul>
<li>Left: smaller than pivot</li>
<li>Middle: equal to pivot</li>
<li>Right: greater than pivot</li>
</ul></li>
<li><p>Compare <code>k</code> to the sizes:</p>
<ul>
<li>If <code>k</code> ≤ len(left): recurse on left</li>
<li>Else if <code>k</code> ≤ len(left) + len(mid): pivot is the answer</li>
<li>Else: recurse on right with adjusted rank</li>
</ul></li>
</ol>
<p>By following only the side containing the k-th element, we cut the problem roughly in half each time.</p>
</section>
<section id="example-8" class="level4">
<h4 class="anchored" data-anchor-id="example-8">Example</h4>
<p>Find the 3rd smallest in <code>[7, 10, 4, 3, 20, 15]</code></p>
<ol type="1">
<li><p>Random pivot = <code>10</code></p>
<ul>
<li>Left = <code>[7, 4, 3]</code>, Mid = <code>[10]</code>, Right = <code>[20, 15]</code></li>
</ul></li>
<li><p>len(left) = 3 Since <code>k=3</code> ≤ 3, recurse into <code>[7, 4, 3]</code></p></li>
<li><p>Random pivot = <code>4</code></p>
<ul>
<li>Left = <code>[3]</code>, Mid = <code>[4]</code>, Right = <code>[7]</code></li>
</ul></li>
<li><p>len(left)=1, len(mid)=1 <code>k=3</code> &gt; 1+1 → recurse into <code>[7]</code> with <code>k=1</code> → Answer = <code>7</code></p></li>
</ol>
</section>
<section id="tiny-code-easy-versions-31" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-31">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quickselect(arr, k):</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    pivot <span class="op">=</span> random.choice(arr)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    left <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">&lt;</span> pivot]</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    mid <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">==</span> pivot]</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    right <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> arr <span class="cf">if</span> x <span class="op">&gt;</span> pivot]</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">&lt;=</span> <span class="bu">len</span>(left):</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> quickselect(left, k)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> k <span class="op">&lt;=</span> <span class="bu">len</span>(left) <span class="op">+</span> <span class="bu">len</span>(mid):</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pivot</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> quickselect(right, k <span class="op">-</span> <span class="bu">len</span>(left) <span class="op">-</span> <span class="bu">len</span>(mid))</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">20</span>, <span class="dv">15</span>]</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(quickselect(data, <span class="dv">3</span>))  <span class="co"># 3rd smallest → 7</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (In-Place Partition)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb78"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> swap<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>b<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> t <span class="op">=</span> <span class="op">*</span>a<span class="op">;</span> <span class="op">*</span>a <span class="op">=</span> <span class="op">*</span>b<span class="op">;</span> <span class="op">*</span>b <span class="op">=</span> t<span class="op">;</span> <span class="op">}</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> partition<span class="op">(</span><span class="dt">int</span> a<span class="op">[],</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> pivot_idx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot <span class="op">=</span> a<span class="op">[</span>pivot_idx<span class="op">];</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(&amp;</span>a<span class="op">[</span>pivot_idx<span class="op">],</span> <span class="op">&amp;</span>a<span class="op">[</span>r<span class="op">]);</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> store <span class="op">=</span> l<span class="op">;</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> l<span class="op">;</span> i <span class="op">&lt;</span> r<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;</span> pivot<span class="op">)</span> swap<span class="op">(&amp;</span>a<span class="op">[</span>i<span class="op">],</span> <span class="op">&amp;</span>a<span class="op">[</span>store<span class="op">++]);</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(&amp;</span>a<span class="op">[</span>store<span class="op">],</span> <span class="op">&amp;</span>a<span class="op">[</span>r<span class="op">]);</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> store<span class="op">;</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> quickselect<span class="op">(</span><span class="dt">int</span> a<span class="op">[],</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> r<span class="op">)</span> <span class="cf">return</span> a<span class="op">[</span>l<span class="op">];</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot_idx <span class="op">=</span> l <span class="op">+</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>r <span class="op">-</span> l <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx <span class="op">=</span> partition<span class="op">(</span>a<span class="op">,</span> l<span class="op">,</span> r<span class="op">,</span> pivot_idx<span class="op">);</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rank <span class="op">=</span> idx <span class="op">-</span> l <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">==</span> rank<span class="op">)</span> <span class="cf">return</span> a<span class="op">[</span>idx<span class="op">];</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">&lt;</span> rank<span class="op">)</span> <span class="cf">return</span> quickselect<span class="op">(</span>a<span class="op">,</span> l<span class="op">,</span> idx <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">);</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> quickselect<span class="op">(</span>a<span class="op">,</span> idx <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">,</span> k <span class="op">-</span> rank<span class="op">);</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">7</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">15</span><span class="op">};</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">6</span><span class="op">,</span> k <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> quickselect<span class="op">(</span>arr<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">));</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-34" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-34">Why It Matters</h4>
<ul>
<li><p>Expected O(n) time, O(1) space</p></li>
<li><p>Foundation for median selection and order statistics</p></li>
<li><p>Used in:</p>
<ul>
<li>Median-of-medians</li>
<li>Randomized algorithms</li>
<li>QuickSort optimization</li>
<li>Data summarization and sampling</li>
</ul></li>
</ul>
<p>In practical terms, QuickSelect is how many libraries (like <code>numpy.partition</code>) find medians and percentiles efficiently.</p>
</section>
<section id="a-gentle-proof-why-it-works-34" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-34">A Gentle Proof (Why It Works)</h4>
<p>Each step partitions the array in <span class="math inline">\(O(n)\)</span> and recurses on one side. Expected split ratio ≈ 1:2 → recurrence:</p>
<p><span class="math display">\[
T(n) = T\left(\frac{n}{2}\right) + O(n)
\]</span></p>
<p>Solving gives <span class="math inline">\(T(n) = O(n)\)</span>. Worst case (<span class="math inline">\(O(n^2)\)</span>) happens only if pivot is repeatedly extreme, probability exponentially small.</p>
</section>
<section id="try-it-yourself-34" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-34">Try It Yourself</h4>
<ol type="1">
<li>Find the median (<code>k = n//2</code>) of a large random array.</li>
<li>Compare QuickSelect vs sorting time.</li>
<li>Run multiple trials; note variation in recursion depth.</li>
<li>Modify to find k-th largest.</li>
<li>Implement deterministic pivot (median-of-medians).</li>
</ol>
</section>
<section id="test-cases-34" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-34">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input</th>
<th>k</th>
<th>Output</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[7,10,4,3,20,15]</td>
<td>3</td>
<td>7</td>
<td>3rd smallest</td>
</tr>
<tr class="even">
<td>[5,4,3,2,1]</td>
<td>1</td>
<td>1</td>
<td>smallest</td>
</tr>
<tr class="odd">
<td>[2,2,2,2]</td>
<td>2</td>
<td>2</td>
<td>duplicates</td>
</tr>
<tr class="even">
<td>[10]</td>
<td>1</td>
<td>10</td>
<td>single element</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-34" class="level4">
<h4 class="anchored" data-anchor-id="complexity-34">Complexity</h4>
<ul>
<li>Expected Time: <span class="math inline">\(O(n)\)</span></li>
<li>Worst Case: <span class="math inline">\(O(n^2)\)</span> (rare)</li>
<li>Space: <span class="math inline">\(O(1)\)</span> (in-place)</li>
</ul>
<p>Randomized QuickSelect is precision through chance, a direct, elegant route to the k-th element, powered by probability.</p>
</section>
</section>
<section id="birthday-paradox-simulation" class="level3">
<h3 class="anchored" data-anchor-id="birthday-paradox-simulation">536 Birthday Paradox Simulation</h3>
<p>The Birthday Paradox is a famous probability puzzle showing how quickly collisions occur in random samples. Surprisingly, with just 23 people, there’s a &gt;50% chance two share the same birthday, even though there are 365 possible days.</p>
<p>A simulation helps reveal why intuition often fails.</p>
<section id="what-problem-are-we-solving-35" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-35">What Problem Are We Solving?</h4>
<p>We want to estimate the probability that at least two people share the same birthday in a group of size <span class="math inline">\(n\)</span>.</p>
<p>There are two approaches:</p>
<ol type="1">
<li>Analytical formula (exact)</li>
<li>Monte Carlo simulation (empirical)</li>
</ol>
</section>
<section id="analytical-probability" class="level4">
<h4 class="anchored" data-anchor-id="analytical-probability">Analytical Probability</h4>
<p>Let’s compute <span class="math inline">\(P(\text{no collision})\)</span> first:</p>
<ul>
<li>1st person: 365 choices</li>
<li>2nd person: 364</li>
<li>3rd person: 363</li>
<li>…</li>
<li><span class="math inline">\(n\)</span>-th person: <span class="math inline">\((365 - n + 1)\)</span> choices</li>
</ul>
<p>So:</p>
<p><span class="math display">\[
P(\text{no match}) = \frac{365}{365} \times \frac{364}{365} \times \cdots \times \frac{365-n+1}{365}
\]</span></p>
<p>Then:</p>
<p><span class="math display">\[
P(\text{collision}) = 1 - P(\text{no match})
\]</span></p>
<p>For <span class="math inline">\(n=23\)</span>, <span class="math inline">\(P(\text{collision}) \approx 0.507\)</span></p>
</section>
<section id="how-does-it-work-plain-language-35" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-35">How Does It Work (Plain Language)</h4>
<p>Each new person you add increases the chance of a match, not with everyone, but with any of the previous people. The number of pairs grows fast:</p>
<p><span class="math display">\[
\text{\# pairs} = \binom{n}{2}
\]</span></p>
<p>That quadratic growth in comparisons explains why collisions happen quickly.</p>
<p>A Monte Carlo simulation simply runs the experiment many times and counts how often duplicates appear.</p>
</section>
<section id="example-9" class="level4">
<h4 class="anchored" data-anchor-id="example-9">Example</h4>
<p>Try <span class="math inline">\(n = 23\)</span> people, 10,000 trials:</p>
<ul>
<li>~50% of trials have at least one shared birthday</li>
<li>~50% do not</li>
</ul>
<p>The randomness converges to the analytical result.</p>
</section>
<section id="tiny-code-easy-versions-32" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-32">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> birthday_collision_prob(n, trials<span class="op">=</span><span class="dv">10000</span>):</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(trials):</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>        birthdays <span class="op">=</span> [random.randint(<span class="dv">1</span>, <span class="dv">365</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(birthdays) <span class="op">!=</span> <span class="bu">len</span>(<span class="bu">set</span>(birthdays)):</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count <span class="op">/</span> trials</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">30</span>, <span class="dv">40</span>]:</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"n=</span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">, P(collision)≈</span><span class="sc">{</span>birthday_collision_prob(n)<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb80"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> has_collision<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> seen<span class="op">[</span><span class="dv">366</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="kw">false</span><span class="op">};</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> b <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="dv">365</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>seen<span class="op">[</span>b<span class="op">])</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>        seen<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> birthday_collision_prob<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> trials<span class="op">)</span> <span class="op">{</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> trials<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>has_collision<span class="op">(</span>n<span class="op">))</span> count<span class="op">++;</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">double</span><span class="op">)</span>count <span class="op">/</span> trials<span class="op">;</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>    srand<span class="op">(</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ns<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">23</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">40</span><span class="op">};</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> n <span class="op">=</span> ns<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"n=</span><span class="sc">%d</span><span class="st">, P≈</span><span class="sc">%.3f\n</span><span class="st">"</span><span class="op">,</span> n<span class="op">,</span> birthday_collision_prob<span class="op">(</span>n<span class="op">,</span> <span class="dv">10000</span><span class="op">));</span></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-35" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-35">Why It Matters</h4>
<p>The Birthday Paradox illustrates collision probability, crucial for:</p>
<ul>
<li>Hash functions (collision analysis)</li>
<li>Cryptography (birthday attacks)</li>
<li>Random ID generation (UUIDs, fingerprints)</li>
<li>Simulation and probability reasoning</li>
</ul>
<p>It shows that intuition about randomness often underestimates collisions.</p>
</section>
<section id="a-gentle-proof-why-it-works-35" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-35">A Gentle Proof (Why It Works)</h4>
<p>For small <span class="math inline">\(n\)</span>:</p>
<p><span class="math display">\[
P(\text{no match}) = \prod_{i=0}^{n-1} \frac{365 - i}{365}
\]</span></p>
<p>Expand for <span class="math inline">\(n=23\)</span>:</p>
<p><span class="math display">\[
P(\text{no match}) \approx 0.493 \
P(\text{match}) = 1 - 0.493 = 0.507
\]</span></p>
<p>Thus, with only 23 people, more likely than not that two share a birthday.</p>
</section>
<section id="try-it-yourself-35" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-35">Try It Yourself</h4>
<ol type="1">
<li>Plot <span class="math inline">\(P(\text{collision})\)</span> vs <span class="math inline">\(n\)</span>.</li>
<li>Find smallest <span class="math inline">\(n\)</span> where probability &gt; 0.9.</li>
<li>Try different “year lengths” (e.g.&nbsp;500 or 1000).</li>
<li>Test for non-uniform birthdays.</li>
<li>Simulate for hash buckets (<span class="math inline">\(m=2^{16}\)</span>, <span class="math inline">\(n=500\)</span>).</li>
</ol>
</section>
<section id="test-cases-35" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-35">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>n</th>
<th>Expected P(collision)</th>
<th>Simulation (approx)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>0.117</td>
<td>0.12</td>
</tr>
<tr class="even">
<td>20</td>
<td>0.411</td>
<td>0.41</td>
</tr>
<tr class="odd">
<td>23</td>
<td>0.507</td>
<td>0.50</td>
</tr>
<tr class="even">
<td>30</td>
<td>0.706</td>
<td>0.71</td>
</tr>
<tr class="odd">
<td>40</td>
<td>0.891</td>
<td>0.89</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-35" class="level4">
<h4 class="anchored" data-anchor-id="complexity-35">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n \cdot \text{trials})\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The Birthday Paradox is a collision lens, a window into how randomness piles up faster than intuition expects.</p>
</section>
</section>
<section id="random-hashing" class="level3">
<h3 class="anchored" data-anchor-id="random-hashing">537 Random Hashing</h3>
<p>Random hashing uses randomness to minimize collisions and distribute keys uniformly across buckets. It’s a core idea in hash tables, Bloom filters, and probabilistic data structures, where fairness and independence matter more than determinism.</p>
<section id="what-problem-are-we-solving-36" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-36">What Problem Are We Solving?</h4>
<p>We need to map arbitrary keys to buckets (like slots in a hash table) in a way that spreads them evenly, even when input keys follow non-uniform or adversarial patterns.</p>
<p>Deterministic hash functions may cluster keys or leak structure. Adding randomness to the hash function ensures each key behaves like a random variable, so collisions become rare and predictable only in expectation.</p>
</section>
<section id="how-does-it-work-plain-language-36" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-36">How Does It Work (Plain Language)</h4>
<p>A random hash function is drawn from a <em>family</em> of functions <span class="math inline">\(H = {h_1, h_2, \ldots, h_m}\)</span> before use, we fix one randomly at runtime.</p>
<p>Formally, a hash family is universal if for all <span class="math inline">\(x \ne y\)</span>:</p>
<p><span class="math display">\[
P(h(x) = h(y)) \le \frac{1}{M}
\]</span></p>
<p>where <span class="math inline">\(M\)</span> is the number of buckets. This guarantees expected <span class="math inline">\(O(1)\)</span> lookups.</p>
<p>Key idea: each new program run uses a different random hash seed, so attackers or pathological datasets can’t force collisions.</p>
</section>
<section id="example-universal-hashing" class="level4">
<h4 class="anchored" data-anchor-id="example-universal-hashing">Example (Universal Hashing)</h4>
<p>Let <span class="math inline">\(U = {0, 1, \dots, p-1}\)</span> with prime <span class="math inline">\(p\)</span>. For parameters <span class="math inline">\(a, b\)</span> chosen uniformly from <span class="math inline">\(1, \dots, p-1\)</span>, define:</p>
<p><span class="math display">\[
h_{a,b}(x) = ((a \cdot x + b) \bmod p) \bmod M
\]</span></p>
<p>This gives a universal hash family, low collision probability and simple computation.</p>
</section>
<section id="example-in-action" class="level4">
<h4 class="anchored" data-anchor-id="example-in-action">Example in Action</h4>
<p>Say <span class="math inline">\(p = 17\)</span>, <span class="math inline">\(M = 10\)</span>, <span class="math inline">\(a = 5\)</span>, <span class="math inline">\(b = 3\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>x</th>
<th>h(x) = (5x+3) mod 17 mod 10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>8</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>8</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>Each key gets a pseudo-random bucket. Collisions still possible, but not predictable, controlled by probability, not structure.</p>
</section>
<section id="tiny-code-easy-versions-33" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-33">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_hash(a, b, p, M, x):</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ((a <span class="op">*</span> x <span class="op">+</span> b) <span class="op">%</span> p) <span class="op">%</span> M</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_hash(p, M):</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> random.randint(<span class="dv">1</span>, p <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> random.randint(<span class="dv">0</span>, p <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">lambda</span> x: ((a <span class="op">*</span> x <span class="op">+</span> b) <span class="op">%</span> p) <span class="op">%</span> M</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>p, M <span class="op">=</span> <span class="dv">17</span>, <span class="dv">10</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> make_hash(p, M)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>([h(x) <span class="cf">for</span> x <span class="kw">in</span> data])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb82"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> random_hash<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> p<span class="op">,</span> <span class="dt">int</span> M<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">((</span>a <span class="op">*</span> x <span class="op">+</span> b<span class="op">)</span> <span class="op">%</span> p<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> p <span class="op">=</span> <span class="dv">17</span><span class="op">,</span> M <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>p <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> p<span class="op">;</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> data<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">};</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"x=</span><span class="sc">%d</span><span class="st"> -&gt; h=</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> data<span class="op">[</span>i<span class="op">],</span> random_hash<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> p<span class="op">,</span> M<span class="op">,</span> data<span class="op">[</span>i<span class="op">]));</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-36" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-36">Why It Matters</h4>
<ul>
<li><p>Fairness: keys are spread evenly, lowering collision risk.</p></li>
<li><p>Security: prevents adversarial key selection (important in hash-flooding attacks).</p></li>
<li><p>Performance: ensures expected <span class="math inline">\(O(1)\)</span> lookup even in worst input cases.</p></li>
<li><p>Applications:</p>
<ul>
<li>Hash tables</li>
<li>Cuckoo hashing</li>
<li>Bloom filters</li>
<li>Consistent hashing</li>
<li>Cryptographic schemes (non-cryptographic randomness)</li>
</ul></li>
</ul>
<p>Languages like Python, Java, and Go randomize hash seeds to defend against input-based attacks.</p>
</section>
<section id="a-gentle-proof-why-it-works-36" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-36">A Gentle Proof (Why It Works)</h4>
<p>For a universal hash family <span class="math inline">\(H\)</span> over <span class="math inline">\(U\)</span> with <span class="math inline">\(|H| = m\)</span>:</p>
<p><span class="math display">\[
P(h(x) = h(y)) = \frac{1}{M}, \quad x \ne y
\]</span></p>
<p>Thus, the expected number of collisions for <span class="math inline">\(n\)</span> keys is:</p>
<p><span class="math display">\[
E[\text{collisions}] = \binom{n}{2} \cdot \frac{1}{M}
\]</span></p>
<p>If <span class="math inline">\(M \approx n\)</span>, expected collisions ≈ constant.</p>
<p>Hence, average lookup and insertion time = <span class="math inline">\(O(1)\)</span>.</p>
</section>
<section id="try-it-yourself-36" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-36">Try It Yourself</h4>
<ol type="1">
<li>Compare random hash vs naive <span class="math inline">\((x \bmod M)\)</span>.</li>
<li>Plot bucket frequencies over random runs.</li>
<li>Test collision count for random seeds.</li>
<li>Implement 2-choice hashing (<span class="math inline">\(h_1\)</span>, <span class="math inline">\(h_2\)</span> choose less loaded).</li>
<li>Build small universal hash table.</li>
</ol>
</section>
<section id="test-cases-36" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-36">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Keys</th>
<th>M</th>
<th>Hash Type</th>
<th>Expected Collisions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0–99</td>
<td>10</td>
<td>naive <span class="math inline">\(x \bmod M\)</span></td>
<td>clustered</td>
</tr>
<tr class="even">
<td>0–99</td>
<td>10</td>
<td>random <span class="math inline">\(ax+b\)</span></td>
<td>balanced</td>
</tr>
<tr class="odd">
<td>adversarial keys</td>
<td>10</td>
<td>random seed</td>
<td>unpredictable</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-36" class="level4">
<h4 class="anchored" data-anchor-id="complexity-36">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(1)\)</span> per hash</li>
<li>Space: <span class="math inline">\(O(1)\)</span> for parameters</li>
</ul>
<p>Random hashing is structured unpredictability, deterministic in code, but probabilistically fair in behavior.</p>
</section>
</section>
<section id="random-walk-simulation" class="level3">
<h3 class="anchored" data-anchor-id="random-walk-simulation">538 Random Walk Simulation</h3>
<p>A random walk is a path defined by a sequence of random steps. It models countless natural and computational processes, from molecules drifting in liquid to stock prices fluctuating, and from diffusion in physics to exploration in AI.</p>
<p>By simulating random walks, we capture how randomness unfolds over time.</p>
<section id="what-problem-are-we-solving-37" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-37">What Problem Are We Solving?</h4>
<p>We want to study how a process evolves when each next step depends on random choice, not deterministic rules.</p>
<p>Random walks appear in:</p>
<ul>
<li>Physics: Brownian motion</li>
<li>Finance: stock movement models</li>
<li>Graph theory: Markov chains, PageRank</li>
<li>Algorithms: randomized search and sampling</li>
</ul>
<p>A simulation lets us see expected displacement, return probability, and spatial spread.</p>
</section>
<section id="how-does-it-work-plain-language-37" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-37">How Does It Work (Plain Language)</h4>
<p>A random walk starts at an origin (e.g., <span class="math inline">\((0,0)\)</span>). At each step, choose a direction randomly and move one unit.</p>
<p>Examples:</p>
<ul>
<li>1D walk: step +1 or −1</li>
<li>2D walk: move north, south, east, or west</li>
<li>3D walk: move along x, y, or z axes randomly</li>
</ul>
<p>Repeat for <span class="math inline">\(n\)</span> steps, track the position, and analyze results.</p>
</section>
<section id="example-1d" class="level4">
<h4 class="anchored" data-anchor-id="example-1d">Example (1D)</h4>
<p>Start at <span class="math inline">\(x=0\)</span>. For each step:</p>
<ul>
<li>With probability <span class="math inline">\(1/2\)</span>: <span class="math inline">\(x \gets x+1\)</span></li>
<li>With probability <span class="math inline">\(1/2\)</span>: <span class="math inline">\(x \gets x-1\)</span></li>
</ul>
<p>After <span class="math inline">\(n\)</span> steps, position is random variable <span class="math inline">\(X_n\)</span>. Expected value: <span class="math inline">\(E[X_n] = 0\)</span> Variance: <span class="math inline">\(Var[X_n] = n\)</span> Expected distance from origin ≈ <span class="math inline">\(\sqrt{n}\)</span></p>
</section>
<section id="example-2d" class="level4">
<h4 class="anchored" data-anchor-id="example-2d">Example (2D)</h4>
<p>Start at <span class="math inline">\((0,0)\)</span> Each step: randomly move up, down, left, or right. Plotting the path produces a meandering trajectory, a picture of diffusion.</p>
</section>
<section id="tiny-code-easy-versions-34" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-34">Tiny Code (Easy Versions)</h4>
<p>Python (1D Random Walk)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_walk_1d(steps):</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> [x]</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(steps):</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> random.choice([<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>        path.append(x)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>walk <span class="op">=</span> random_walk_1d(<span class="dv">100</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Final position:"</span>, walk[<span class="op">-</span><span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python (2D Random Walk)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_walk_2d(steps):</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> [(x, y)]</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(steps):</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>        dx, dy <span class="op">=</span> random.choice([(<span class="dv">1</span>,<span class="dv">0</span>), (<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>), (<span class="dv">0</span>,<span class="dv">1</span>), (<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>)])</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>        x, y <span class="op">=</span> x <span class="op">+</span> dx, y <span class="op">+</span> dy</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        path.append((x, y))</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>walk <span class="op">=</span> random_walk_2d(<span class="dv">50</span>)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Final position:"</span>, walk[<span class="op">-</span><span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (1D)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb85"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    srand<span class="op">(</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> steps <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> steps<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> <span class="op">(</span>rand<span class="op">()</span> <span class="op">%</span> <span class="dv">2</span><span class="op">)</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Final position: </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-37" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-37">Why It Matters</h4>
<p>Random walks form the mathematical backbone of many systems:</p>
<ul>
<li>Physics: diffusion, Brownian motion</li>
<li>Finance: random price fluctuations</li>
<li>AI &amp; RL: exploration strategies</li>
<li>Graph algorithms: PageRank, cover time</li>
<li>Statistics: Monte Carlo methods</li>
</ul>
<p>They show how order emerges from randomness and why many natural processes diffuse over time.</p>
</section>
<section id="a-gentle-proof-why-it-works-37" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-37">A Gentle Proof (Why It Works)</h4>
<p>Each step <span class="math inline">\(S_i\)</span> is independent with <span class="math inline">\(E[S_i]=0\)</span>, <span class="math inline">\(Var[S_i]=1\)</span>. After <span class="math inline">\(n\)</span> steps:</p>
<p><span class="math display">\[
X_n = \sum_{i=1}^n S_i, \quad E[X_n]=0, \quad Var[X_n]=n
\]</span></p>
<p>Expected squared distance: <span class="math inline">\(E[X_n^2] = n\)</span> Expected absolute displacement: <span class="math inline">\(\sqrt{n}\)</span> This scaling explains diffusion’s <span class="math inline">\(\sqrt{t}\)</span> behavior.</p>
<p>In 2D or 3D, similar logic extends: <span class="math display">\[
E[|X_n|^2] = n \cdot \text{step size}^2
\]</span></p>
</section>
<section id="try-it-yourself-37" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-37">Try It Yourself</h4>
<ol type="1">
<li>Plot the path for <span class="math inline">\(n=1000\)</span> in 1D and 2D.</li>
<li>Compare multiple runs, note variability.</li>
<li>Track average distance from origin over trials.</li>
<li>Change step probabilities (biased walk).</li>
<li>Add absorbing barriers (e.g.&nbsp;stop at <span class="math inline">\(x=10\)</span>).</li>
</ol>
</section>
<section id="test-cases-37" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-37">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Steps</th>
<th>Dimension</th>
<th>Expected <span class="math inline">\(E[X_n]\)</span></th>
<th>Expected Distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>1D</td>
<td>0</td>
<td>~3.16</td>
</tr>
<tr class="even">
<td>100</td>
<td>1D</td>
<td>0</td>
<td>~10</td>
</tr>
<tr class="odd">
<td>100</td>
<td>2D</td>
<td>(0,0)</td>
<td>~10</td>
</tr>
<tr class="even">
<td>1000</td>
<td>1D</td>
<td>0</td>
<td>~31.6</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-37" class="level4">
<h4 class="anchored" data-anchor-id="complexity-37">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span> if storing path; <span class="math inline">\(O(1)\)</span> if tracking position only</li>
</ul>
<p>A random walk is motion without plan, step by step, direction by chance, pattern emerging only in the long run.</p>
</section>
</section>
<section id="coupon-collector-estimation" class="level3">
<h3 class="anchored" data-anchor-id="coupon-collector-estimation">539 Coupon Collector Estimation</h3>
<p>The Coupon Collector Problem asks: How many random draws (with replacement) are needed to collect all distinct items from a set of size <span class="math inline">\(n\)</span>?</p>
<p>It’s a cornerstone of probabilistic analysis, used to model everything from collecting trading cards to testing coverage in randomized algorithms.</p>
<section id="what-problem-are-we-solving-38" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-38">What Problem Are We Solving?</h4>
<p>Suppose there are <span class="math inline">\(n\)</span> different coupons (or Pokémon, or test cases). Each time, you draw one uniformly at random.</p>
<p>Question: How many draws <span class="math inline">\(T\)</span> do you need on average to collect all <span class="math inline">\(n\)</span>?</p>
</section>
<section id="the-big-idea" class="level4">
<h4 class="anchored" data-anchor-id="the-big-idea">The Big Idea</h4>
<p>Each new draw has a smaller chance of revealing something <em>new</em>. At the beginning, new coupons are easy to find; toward the end, you’re mostly drawing duplicates.</p>
<p>The expected number of trials is:</p>
<p><span class="math display">\[
E[T] = n \cdot H_n = n \left(1 + \frac{1}{2} + \frac{1}{3} + \cdots + \frac{1}{n}\right)
\]</span></p>
<p>Asymptotically:</p>
<p><span class="math display">\[
E[T] \approx n \ln n + \gamma n + \frac{1}{2}
\]</span></p>
<p>where <span class="math inline">\(\gamma \approx 0.57721\)</span> is the Euler–Mascheroni constant.</p>
</section>
<section id="how-does-it-work-plain-language-38" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-38">How Does It Work (Plain Language)</h4>
<p>You can think of the collection process as phases:</p>
<ul>
<li>Phase 1: get the 1st new coupon → expected 1 draw</li>
<li>Phase 2: get the 2nd new coupon → expected <span class="math inline">\(\frac{n}{n-1}\)</span> draws</li>
<li>Phase 3: get the 3rd new coupon → expected <span class="math inline">\(\frac{n}{n-2}\)</span> draws</li>
<li>…</li>
<li>Phase <span class="math inline">\(n\)</span>: last coupon → expected <span class="math inline">\(\frac{n}{1}\)</span> draws</li>
</ul>
<p>Summing them up gives <span class="math inline">\(E[T] = n H_n\)</span>.</p>
</section>
<section id="example-10" class="level4">
<h4 class="anchored" data-anchor-id="example-10">Example</h4>
<p>For <span class="math inline">\(n = 5\)</span>:</p>
<p><span class="math display">\[
E[T] = 5 \cdot (1 + \frac{1}{2} + \frac{1}{3} + \frac{1}{4} + \frac{1}{5}) = 5 \times 2.283 = 11.415
\]</span></p>
<p>So you’ll need about 11–12 draws on average to get all 5.</p>
</section>
<section id="tiny-code-easy-versions-35" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-35">Tiny Code (Easy Versions)</h4>
<p>Python (Simulation)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> coupon_collector(n, trials<span class="op">=</span><span class="dv">10000</span>):</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(trials):</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>        collected <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="bu">len</span>(collected) <span class="op">&lt;</span> n:</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>            coupon <span class="op">=</span> random.randint(<span class="dv">1</span>, n)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>            collected.add(coupon)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> count</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total <span class="op">/</span> trials</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>]:</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"n=</span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">, Expected≈</span><span class="sc">{</span>coupon_collector(n)<span class="sc">:.2f}</span><span class="ss">, Theory≈</span><span class="sc">{</span>n <span class="op">*</span> <span class="bu">sum</span>(<span class="dv">1</span><span class="op">/</span>i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n<span class="op">+</span><span class="dv">1</span>))<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (Simple Simulation)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb87"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> coupon_collector<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> trials<span class="op">)</span> <span class="op">{</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> total <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> seen<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">&lt;</span> trials<span class="op">;</span> t<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> seen<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> collected <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>collected <span class="op">&lt;</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> c <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>            count<span class="op">++;</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>seen<span class="op">[</span>c<span class="op">])</span> <span class="op">{</span> seen<span class="op">[</span>c<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> collected<span class="op">++;</span> <span class="op">}</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> count<span class="op">;</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">double</span><span class="op">)</span>total <span class="op">/</span> trials<span class="op">;</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    srand<span class="op">(</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ns<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">5</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">};</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> n <span class="op">=</span> ns<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"n=</span><span class="sc">%d</span><span class="st">, E≈</span><span class="sc">%.2f\n</span><span class="st">"</span><span class="op">,</span> n<span class="op">,</span> coupon_collector<span class="op">(</span>n<span class="op">,</span> <span class="dv">10000</span><span class="op">));</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-38" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-38">Why It Matters</h4>
<p>The Coupon Collector model shows up everywhere:</p>
<ul>
<li>Algorithm coverage (e.g., hashing all buckets)</li>
<li>Testing &amp; sampling (ensuring all cases appear)</li>
<li>Networking (packet collection)</li>
<li>Distributed systems (gossip protocols)</li>
<li>Collectible games (expected cost to finish a set)</li>
</ul>
<p>It captures the diminishing returns of randomness, the last few items always take longest.</p>
</section>
<section id="a-gentle-proof-why-it-works-38" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-38">A Gentle Proof (Why It Works)</h4>
<p>Let <span class="math inline">\(T_i\)</span> = draws to get a new coupon when you already have <span class="math inline">\(i-1\)</span>.</p>
<p>Probability of success = <span class="math inline">\(\frac{n - i + 1}{n}\)</span></p>
<p>So expected draws for phase <span class="math inline">\(i\)</span> = <span class="math inline">\(\frac{1}{p_i} = \frac{n}{n - i + 1}\)</span></p>
<p>Sum over all phases:</p>
<p><span class="math display">\[
E[T] = \sum_{i=1}^n \frac{n}{n - i + 1} = n \sum_{k=1}^n \frac{1}{k} = n H_n
\]</span></p>
</section>
<section id="try-it-yourself-38" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-38">Try It Yourself</h4>
<ol type="1">
<li>Simulate for different <span class="math inline">\(n\)</span> values; compare with theory.</li>
<li>Plot <span class="math inline">\(E[T]/n\)</span>, should grow like <span class="math inline">\(\ln n\)</span>.</li>
<li>Modify for biased probabilities (non-uniform draws).</li>
<li>Estimate probability all coupons collected by step <span class="math inline">\(t\)</span>.</li>
<li>Apply to randomized load balancing (balls into bins).</li>
</ol>
</section>
<section id="test-cases-38" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-38">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>n</th>
<th>Theoretical <span class="math inline">\(E[T]\)</span></th>
<th>Simulation (approx)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5</td>
<td>11.42</td>
<td>11.40</td>
</tr>
<tr class="even">
<td>10</td>
<td>29.29</td>
<td>29.20</td>
</tr>
<tr class="odd">
<td>20</td>
<td>71.94</td>
<td>72.10</td>
</tr>
<tr class="even">
<td>50</td>
<td>224.96</td>
<td>225.10</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-38" class="level4">
<h4 class="anchored" data-anchor-id="complexity-38">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n \cdot \text{trials})\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The Coupon Collector problem is a mathematical metaphor for patience, the closer you are to completion, the rarer progress becomes.</p>
</section>
</section>
<section id="markov-chain-simulation" class="level3">
<h3 class="anchored" data-anchor-id="markov-chain-simulation">540 Markov Chain Simulation</h3>
<p>A Markov chain models a system that jumps between states with fixed transition probabilities. The future depends only on the current state, not on the full past. Simulation lets us estimate long-run behavior, hitting times, and steady-state distributions when analysis is hard.</p>
<section id="what-problem-are-we-solving-39" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-39">What Problem Are We Solving?</h4>
<p>Given a finite state space <span class="math inline">\(\mathcal{S}={1,\dots,m}\)</span> and a row-stochastic transition matrix <span class="math inline">\(P\in\mathbb{R}^{m\times m}\)</span> with <span class="math display">\[
P_{ij}=P(X_{t+1}=j \mid X_t=i),\quad \sum_{j=1}^m P_{ij}=1,
\]</span> we want to generate a trajectory <span class="math inline">\(X_0,X_1,\dots,X_T\)</span> and estimate quantities like</p>
<ul>
<li>stationary distribution <span class="math inline">\(\pi\)</span> such that <span class="math inline">\(\pi P=\pi\)</span></li>
<li>expected reward <span class="math inline">\(\mathbb{E}[f(X_t)]\)</span></li>
<li>hitting or return times</li>
</ul>
</section>
<section id="how-does-it-work-plain-language-39" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-39">How Does It Work (Plain Language)</h4>
<ol type="1">
<li><p>Choose an initial state <span class="math inline">\(X_0\)</span> (or an initial distribution <span class="math inline">\(\mu\)</span>).</p></li>
<li><p>For <span class="math inline">\(t=0,1,\dots,T-1\)</span></p>
<ul>
<li>From the current state <span class="math inline">\(i=X_t\)</span>, draw the next state <span class="math inline">\(j\)</span> according to row <span class="math inline">\(i\)</span> of <span class="math inline">\(P\)</span>.</li>
<li>Set <span class="math inline">\(X_{t+1}=j\)</span>.</li>
</ul></li>
<li><p>Optionally discard a burn-in prefix, then average statistics over the rest.</p></li>
</ol>
<p>If the chain is irreducible and aperiodic, empirical frequencies converge to the stationary distribution.</p>
</section>
<section id="example-11" class="level4">
<h4 class="anchored" data-anchor-id="example-11">Example</h4>
<p>Two-state weather model, states <span class="math inline">\({S,R}\)</span> for Sunny, Rainy: <span class="math display">\[
P=\begin{pmatrix}
0.8 &amp; 0.2\
0.4 &amp; 0.6
\end{pmatrix}.
\]</span> Start at Sunny, simulate 10,000 steps, estimate fraction of sunny days. Theory: solve <span class="math inline">\(\pi=\pi P\)</span>, <span class="math inline">\(\pi_S=\tfrac{2}{3}\)</span>, <span class="math inline">\(\pi_R=\tfrac{1}{3}\)</span>.</p>
</section>
<section id="tiny-code-easy-versions-36" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-36">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_markov(P, start, steps):</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># P: list of lists, each row sums to 1</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># start: integer state index</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> start</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    traj <span class="op">=</span> [x]</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(steps):</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> random.random()</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>        cdf, nxt <span class="op">=</span> <span class="fl">0.0</span>, <span class="dv">0</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, p <span class="kw">in</span> <span class="bu">enumerate</span>(P[x]):</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>            cdf <span class="op">+=</span> p</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> r <span class="op">&lt;=</span> cdf:</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>                nxt <span class="op">=</span> j</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> nxt</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>        traj.append(x)</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> traj</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Sunny=0, Rainy=1</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> [[<span class="fl">0.8</span>, <span class="fl">0.2</span>],</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>     [<span class="fl">0.4</span>, <span class="fl">0.6</span>]]</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>traj <span class="op">=</span> simulate_markov(P, start<span class="op">=</span><span class="dv">0</span>, steps<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>burn <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>pi_hat_S <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> s <span class="kw">in</span> traj[burn:] <span class="cf">if</span> s <span class="op">==</span> <span class="dv">0</span>) <span class="op">/</span> (<span class="bu">len</span>(traj) <span class="op">-</span> burn)</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated pi(Sunny) ="</span>, pi_hat_S)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb89"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> next_state<span class="op">(</span><span class="dt">double</span> <span class="op">*</span>row<span class="op">,</span> <span class="dt">int</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> r <span class="op">=</span> <span class="op">(</span><span class="dt">double</span><span class="op">)</span>rand<span class="op">()</span> <span class="op">/</span> RAND_MAX<span class="op">,</span> cdf <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> m<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>        cdf <span class="op">+=</span> row<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;=</span> cdf<span class="op">)</span> <span class="cf">return</span> j<span class="op">;</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> m <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    srand<span class="op">((</span><span class="dt">unsigned</span><span class="op">)</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> m <span class="op">=</span> <span class="dv">2</span><span class="op">,</span> steps <span class="op">=</span> <span class="dv">10000</span><span class="op">,</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> P<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="fl">0.8</span><span class="op">,</span> <span class="fl">0.2</span><span class="op">},</span> <span class="op">{</span><span class="fl">0.4</span><span class="op">,</span> <span class="fl">0.6</span><span class="op">}};</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sunny <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> burn <span class="op">=</span> <span class="dv">1000</span><span class="op">;</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">&lt;</span> steps<span class="op">;</span> t<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>t <span class="op">&gt;=</span> burn <span class="op">&amp;&amp;</span> x <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> sunny<span class="op">++;</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> next_state<span class="op">(</span>P<span class="op">[</span>x<span class="op">],</span> m<span class="op">);</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> pi_hat <span class="op">=</span> <span class="op">(</span><span class="dt">double</span><span class="op">)</span>sunny <span class="op">/</span> <span class="op">(</span>steps <span class="op">-</span> burn<span class="op">);</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Estimated pi(Sunny) = </span><span class="sc">%.4f\n</span><span class="st">"</span><span class="op">,</span> pi_hat<span class="op">);</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-39" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-39">Why It Matters</h4>
<ul>
<li>Statistics and MCMC: estimate integrals by sampling from complex distributions</li>
<li>Operations research: queueing systems, reliability, inventory</li>
<li>Reinforcement learning: modeling environment dynamics and returns</li>
<li>Networks and graphs: PageRank, random walks, mixing time</li>
</ul>
<p>Simulation provides estimates when closed forms are unavailable or too costly.</p>
</section>
<section id="a-gentle-proof-why-it-works-39" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-39">A Gentle Proof (Why It Works)</h4>
<p>If the chain is irreducible and aperiodic with stationary distribution <span class="math inline">\(\pi\)</span>, then by the ergodic theorem <span class="math display">\[
\frac{1}{T}\sum_{t=1}^T f(X_t)\xrightarrow[]{a.s.}\sum_{i\in\mathcal{S}} \pi_i f(i).
\]</span> In particular, empirical state frequencies converge to <span class="math inline">\(\pi\)</span>. Burn-in reduces bias from the initial distribution.</p>
</section>
<section id="try-it-yourself-39" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-39">Try It Yourself</h4>
<ol type="1">
<li>Verify the two-state example, compare <span class="math inline">\(\pi_{\text{Sunny}}\)</span> estimate to <span class="math inline">\(2/3\)</span>.</li>
<li>Build a 5-state chain with a known <span class="math inline">\(\pi\)</span> and confirm convergence.</li>
<li>Add a reward function <span class="math inline">\(r(i)\)</span>, estimate long-run average reward.</li>
<li>Explore the effect of burn-in and sample size on variance.</li>
<li>Simulate a random walk on a graph, estimate visit frequencies.</li>
</ol>
</section>
<section id="test-cases-39" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-39">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 36%">
<col style="width: 31%">
<col style="width: 11%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>Chain</th>
<th>Property</th>
<th>Theory</th>
<th>Simulation (approx)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2-state weather</td>
<td><span class="math inline">\(\pi_S\)</span></td>
<td><span class="math inline">\(2/3\)</span></td>
<td><span class="math inline">\(0.66\)</span> to <span class="math inline">\(0.67\)</span></td>
</tr>
<tr class="even">
<td>3-state cyclic with damping</td>
<td>ergodic</td>
<td>unique <span class="math inline">\(\pi\)</span></td>
<td>frequencies match <span class="math inline">\(\pi\)</span></td>
</tr>
<tr class="odd">
<td>Random walk on line with reflecting ends</td>
<td>stationary mass higher near middle</td>
<td>qualitative</td>
<td>matches histogram</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-39" class="level4">
<h4 class="anchored" data-anchor-id="complexity-39">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(T \cdot \deg)\)</span> where <span class="math inline">\(\deg\)</span> is average nonzero entries per row of <span class="math inline">\(P\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span> for online statistics, <span class="math inline">\(O(T)\)</span> if storing the full trajectory</li>
</ul>
<p>Markov chain simulation turns matrix probabilities into empirical behavior, one step at a time, then averages reveal the long-run truth.</p>
</section>
</section>
</section>
<section id="section-55.-sieve-methods-and-modular-math" class="level1">
<h1>Section 55. Sieve Methods and Modular Math</h1>
<section id="sieve-of-eratosthenes-1" class="level3">
<h3 class="anchored" data-anchor-id="sieve-of-eratosthenes-1">541 Sieve of Eratosthenes</h3>
<p>The Sieve of Eratosthenes is one of the oldest and most elegant algorithms in mathematics, designed to generate all prime numbers up to a given limit <span class="math inline">\(n\)</span>. It systematically marks out multiples of primes, leaving only the primes unmarked.</p>
<section id="what-problem-are-we-solving-40" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-40">What Problem Are We Solving?</h4>
<p>We want an efficient way to find all primes <span class="math inline">\(\le n\)</span>. A naive method tests divisibility for every number, <span class="math inline">\(O(n\sqrt{n})\)</span>. The sieve reduces this dramatically to <span class="math inline">\(O(n \log\log n)\)</span> by marking composites in bulk.</p>
</section>
<section id="how-does-it-work-plain-language-40" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-40">How Does It Work (Plain Language)</h4>
<p>Imagine writing all numbers from <span class="math inline">\(2\)</span> to <span class="math inline">\(n\)</span>. Starting from the first unmarked number <span class="math inline">\(2\)</span>, you:</p>
<ol type="1">
<li>Declare it prime.</li>
<li>Mark all multiples of <span class="math inline">\(2\)</span> as composite.</li>
<li>Move to the next unmarked number (which must be prime).</li>
<li>Repeat until <span class="math inline">\(p^2 &gt; n\)</span>.</li>
</ol>
<p>The remaining unmarked numbers are primes.</p>
</section>
<section id="example-12" class="level4">
<h4 class="anchored" data-anchor-id="example-12">Example</h4>
<p>Let <span class="math inline">\(n = 30\)</span> Start with <span class="math inline">\(2\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>Prime</th>
<th>Marked Multiples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>6, 9, 12, 15, 18, 21, 24, 27, 30</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>10, 15, 20, 25, 30</td>
</tr>
<tr class="even">
<td>4</td>
<td>7</td>
<td><span class="math inline">\(7^2 = 49 &gt; 30\)</span> → stop</td>
</tr>
</tbody>
</table>
<p>Primes left: 2, 3, 5, 7, 11, 13, 17, 19, 23, 29</p>
</section>
<section id="tiny-code-easy-versions-37" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-37">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sieve(n):</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    is_prime <span class="op">=</span> [<span class="va">True</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    is_prime[<span class="dv">0</span>] <span class="op">=</span> is_prime[<span class="dv">1</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> p <span class="op">*</span> p <span class="op">&lt;=</span> n:</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_prime[p]:</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(p <span class="op">*</span> p, n <span class="op">+</span> <span class="dv">1</span>, p):</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>                is_prime[i] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>        p <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>) <span class="cf">if</span> is_prime[i]]</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sieve(<span class="dv">30</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb91"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_prime<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> is_prime<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    is_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> is_prime<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> p <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> p <span class="op">*</span> p <span class="op">&lt;=</span> n<span class="op">;</span> p<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>p<span class="op">])</span> <span class="op">{</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> p <span class="op">*</span> p<span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">+=</span> p<span class="op">)</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>                is_prime<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> i<span class="op">);</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    sieve<span class="op">(</span><span class="dv">30</span><span class="op">);</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-40" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-40">Why It Matters</h4>
<ul>
<li><p>Efficient prime generation, fundamental for number theory, cryptography, and factorization.</p></li>
<li><p>Core building block for:</p>
<ul>
<li>Prime tables in modular arithmetic</li>
<li>Totient computation</li>
<li>Sieve-based factorization</li>
<li>Precomputation in combinatorics (nCr mod p)</li>
</ul></li>
<li><p>Intuitive, a beautiful demonstration of elimination by pattern.</p></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-40" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-40">A Gentle Proof (Why It Works)</h4>
<p>Every composite number <span class="math inline">\(n\)</span> has a smallest prime factor <span class="math inline">\(p \le \sqrt{n}\)</span>. When the sieve marks multiples of each prime up to <span class="math inline">\(\sqrt{n}\)</span>, every composite is marked exactly once by its smallest prime factor. Thus, all unmarked numbers are prime.</p>
</section>
<section id="try-it-yourself-40" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-40">Try It Yourself</h4>
<ol type="1">
<li>Run the sieve for <span class="math inline">\(n=50\)</span>, count primes (should be 15).</li>
<li>Modify to return count instead of list.</li>
<li>Plot prime density vs <span class="math inline">\(n\)</span>.</li>
<li>Extend to segmented sieve for large <span class="math inline">\(n\)</span>.</li>
<li>Compare runtime vs naive primality testing.</li>
</ol>
</section>
<section id="test-cases-40" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-40">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>n</th>
<th>Primes Found</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>2, 3, 5, 7</td>
<td>4</td>
</tr>
<tr class="even">
<td>20</td>
<td>2, 3, 5, 7, 11, 13, 17, 19</td>
<td>8</td>
</tr>
<tr class="odd">
<td>30</td>
<td>2, 3, 5, 7, 11, 13, 17, 19, 23, 29</td>
<td>10</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-40" class="level4">
<h4 class="anchored" data-anchor-id="complexity-40">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n \log\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The Sieve of Eratosthenes is simplicity sharpened by insight, mark the multiples, reveal the primes.</p>
</section>
</section>
<section id="linear-sieve" class="level3">
<h3 class="anchored" data-anchor-id="linear-sieve">542 Linear Sieve</h3>
<p>The Linear Sieve, also known as the Euler Sieve, is an optimized version of the Sieve of Eratosthenes that computes all primes up to <span class="math inline">\(n\)</span> in <span class="math inline">\(O(n)\)</span> time, marking each composite exactly once.</p>
<p>It avoids redundant markings by combining primes with their smallest prime factors.</p>
<section id="what-problem-are-we-solving-41" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-41">What Problem Are We Solving?</h4>
<p>The classical sieve marks each composite multiple times, once for every prime divisor. In the linear sieve, each composite is generated only by its smallest prime factor (SPF), ensuring total work proportional to <span class="math inline">\(n\)</span>.</p>
<p>We want:</p>
<ul>
<li>All primes <span class="math inline">\(\le n\)</span></li>
<li>Optionally, the smallest prime factor <code>spf[x]</code> for each <span class="math inline">\(x\)</span></li>
</ul>
</section>
<section id="how-does-it-work-plain-language-41" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-41">How Does It Work (Plain Language)</h4>
<p>Maintain:</p>
<ul>
<li>A boolean array <code>is_prime[]</code></li>
<li>A list <code>primes[]</code></li>
</ul>
<p>Algorithm:</p>
<ol type="1">
<li><p>Initialize all numbers as prime (<code>True</code>).</p></li>
<li><p>For each integer <span class="math inline">\(i\)</span> from 2 to <span class="math inline">\(n\)</span>:</p>
<ul>
<li><p>If <code>is_prime[i]</code> is <code>True</code>, add <span class="math inline">\(i\)</span> to the list of primes.</p></li>
<li><p>For every prime <span class="math inline">\(p\)</span> in <code>primes</code>:</p>
<ul>
<li>If <span class="math inline">\(i \cdot p &gt; n\)</span>, break.</li>
<li>Mark <code>is_prime[i*p] = False</code>.</li>
<li>If <span class="math inline">\(p\)</span> divides <span class="math inline">\(i\)</span>, stop (to ensure each composite is marked only once).</li>
</ul></li>
</ul></li>
</ol>
<p>This ensures each composite is marked exactly once by its smallest prime factor.</p>
</section>
<section id="example-13" class="level4">
<h4 class="anchored" data-anchor-id="example-13">Example</h4>
<p>Let <span class="math inline">\(n=10\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th>primes</th>
<th>marked composites</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>[2]</td>
<td>4, 6, 8, 10</td>
</tr>
<tr class="even">
<td>3</td>
<td>[2,3]</td>
<td>6, 9</td>
</tr>
<tr class="odd">
<td>4</td>
<td>skip (not prime)</td>
<td></td>
</tr>
<tr class="even">
<td>5</td>
<td>[2,3,5]</td>
<td>10</td>
</tr>
<tr class="odd">
<td>6</td>
<td>skip</td>
<td></td>
</tr>
<tr class="even">
<td>7</td>
<td>[2,3,5,7]</td>
<td></td>
</tr>
<tr class="odd">
<td>8</td>
<td>skip</td>
<td></td>
</tr>
<tr class="even">
<td>9</td>
<td>skip</td>
<td></td>
</tr>
<tr class="odd">
<td>10</td>
<td>skip</td>
<td></td>
</tr>
</tbody>
</table>
<p>Primes: 2, 3, 5, 7</p>
</section>
<section id="tiny-code-easy-versions-38" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-38">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> linear_sieve(n):</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    is_prime <span class="op">=</span> [<span class="va">True</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    primes <span class="op">=</span> []</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    spf <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)  <span class="co"># smallest prime factor</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    is_prime[<span class="dv">0</span>] <span class="op">=</span> is_prime[<span class="dv">1</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_prime[i]:</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>            primes.append(i)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>            spf[i] <span class="op">=</span> i</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p <span class="kw">in</span> primes:</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">*</span> p <span class="op">&gt;</span> n:</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>            is_prime[i <span class="op">*</span> p] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>            spf[i <span class="op">*</span> p] <span class="op">=</span> p</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> primes, spf</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>pr, spf <span class="op">=</span> linear_sieve(<span class="dv">30</span>)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Primes:"</span>, pr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb93"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> linear_sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_prime<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> primes<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">],</span> spf<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> is_prime<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    is_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> is_prime<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>            primes<span class="op">[</span>count<span class="op">++]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>            spf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> count<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> p <span class="op">=</span> primes<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">*</span> p <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>            is_prime<span class="op">[</span>i <span class="op">*</span> p<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>            spf<span class="op">[</span>i <span class="op">*</span> p<span class="op">]</span> <span class="op">=</span> p<span class="op">;</span></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Primes: "</span><span class="op">);</span></span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> count<span class="op">;</span> i<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> primes<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>    linear_sieve<span class="op">(</span><span class="dv">30</span><span class="op">);</span></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-41" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-41">Why It Matters</h4>
<p>The linear sieve is a powerful improvement:</p>
<ul>
<li><p>Each number processed once</p></li>
<li><p>Fastest possible prime sieve (tight asymptotic bound)</p></li>
<li><p>Useful byproducts:</p>
<ul>
<li>Smallest prime factor (SPF) table for factorization</li>
<li>Prime list for arithmetic functions (e.g.&nbsp;Euler’s Totient)</li>
</ul></li>
</ul>
<p>Used widely in:</p>
<ul>
<li>Competitive programming</li>
<li>Precomputation for modular arithmetic</li>
<li>Factorization and divisor enumeration</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-41" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-41">A Gentle Proof (Why It Works)</h4>
<p>Each composite <span class="math inline">\(n = p \cdot m\)</span> is marked exactly once, by its smallest prime factor <span class="math inline">\(p\)</span>. When <span class="math inline">\(i = m\)</span>, the algorithm pairs <span class="math inline">\(i\)</span> with <span class="math inline">\(p\)</span>:</p>
<ul>
<li>If <span class="math inline">\(p\)</span> divides <span class="math inline">\(i\)</span>, break to prevent further markings.</li>
</ul>
<p>Thus total operations ≈ <span class="math inline">\(O(n)\)</span>.</p>
</section>
<section id="try-it-yourself-41" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-41">Try It Yourself</h4>
<ol type="1">
<li>Compare with classical sieve timings for <span class="math inline">\(n=10^6\)</span>.</li>
<li>Print <code>spf[x]</code> for <span class="math inline">\(x=2\)</span> to <span class="math inline">\(20\)</span>.</li>
<li>Write a function to factorize <span class="math inline">\(x\)</span> using <code>spf</code>.</li>
<li>Modify to count number of prime factors.</li>
<li>Extend to compute totient in <span class="math inline">\(O(n)\)</span>.</li>
</ol>
</section>
<section id="test-cases-41" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-41">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>n</th>
<th>Primes Found</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>2, 3, 5, 7</td>
<td>4</td>
</tr>
<tr class="even">
<td>30</td>
<td>2, 3, 5, 7, 11, 13, 17, 19, 23, 29</td>
<td>10</td>
</tr>
<tr class="odd">
<td>100</td>
<td>25 primes</td>
<td>25</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-41" class="level4">
<h4 class="anchored" data-anchor-id="complexity-41">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The Linear Sieve refines Eratosthenes’ brilliance, marking each composite once, no more, no less.</p>
</section>
</section>
<section id="segmented-sieve-1" class="level3">
<h3 class="anchored" data-anchor-id="segmented-sieve-1">543 Segmented Sieve</h3>
<p>The Segmented Sieve extends the classic sieve to handle large ranges efficiently, such as generating primes between <span class="math inline">\(L\)</span> and <span class="math inline">\(R\)</span> where <span class="math inline">\(R\)</span> may be very large (e.g.&nbsp;<span class="math inline">\(10^{12}\)</span>), without storing all numbers up to <span class="math inline">\(R\)</span> in memory.</p>
<p>It divides the range into segments small enough to fit in memory, sieving each one using precomputed small primes.</p>
<section id="what-problem-are-we-solving-42" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-42">What Problem Are We Solving?</h4>
<p>The normal sieve of Eratosthenes needs memory proportional to <span class="math inline">\(n\)</span>, making it infeasible for large upper bounds (like <span class="math inline">\(10^{12}\)</span>). The segmented sieve solves this by using a two-phase process:</p>
<ol type="1">
<li>Precompute small primes up to <span class="math inline">\(\sqrt{R}\)</span> using a standard sieve.</li>
<li>Sieve each segment <span class="math inline">\([L, R]\)</span> using those primes.</li>
</ol>
<p>This way, memory usage stays <span class="math inline">\(O(\sqrt{R}) + O(R-L+1)\)</span>, even for very large <span class="math inline">\(R\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-42" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-42">How Does It Work (Plain Language)</h4>
<p>To generate primes in <span class="math inline">\([L, R]\)</span>:</p>
<ol type="1">
<li><p>Pre-sieve small primes: <span class="math display">\[ \text{small\_primes} = \text{sieve}(\sqrt{R}) \]</span></p></li>
<li><p>Initialize a boolean segment array of size <span class="math inline">\(R-L+1\)</span> (all True).</p></li>
<li><p>For each small prime <span class="math inline">\(p\)</span>:</p>
<ul>
<li>Find the first multiple of <span class="math inline">\(p\)</span> in <span class="math inline">\([L, R]\)</span>: <span class="math display">\[
\text{start} = \max(p^2, \lceil \frac{L}{p} \rceil \cdot p)
\]</span></li>
<li>Mark all multiples of <span class="math inline">\(p\)</span> as composite.</li>
</ul></li>
<li><p>Remaining unmarked numbers are primes in <span class="math inline">\([L, R]\)</span>.</p></li>
</ol>
</section>
<section id="example-14" class="level4">
<h4 class="anchored" data-anchor-id="example-14">Example</h4>
<p>Find primes in <span class="math inline">\([10, 30]\)</span></p>
<ol type="1">
<li><p>Compute primes up to <span class="math inline">\(\sqrt{30} = 5\)</span>: <span class="math inline">\({2, 3, 5}\)</span></p></li>
<li><p>Segment = <code>[10..30]</code>, mark multiples:</p>
<ul>
<li><span class="math inline">\(2\)</span>: mark 10,12,14,…,30</li>
<li><span class="math inline">\(3\)</span>: mark 12,15,18,21,24,27,30</li>
<li><span class="math inline">\(5\)</span>: mark 10,15,20,25,30</li>
</ul></li>
<li><p>Unmarked → 11, 13, 17, 19, 23, 29</p></li>
</ol>
</section>
<section id="tiny-code-easy-versions-39" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-39">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simple_sieve(limit):</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    is_prime <span class="op">=</span> [<span class="va">True</span>] <span class="op">*</span> (limit <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    is_prime[<span class="dv">0</span>] <span class="op">=</span> is_prime[<span class="dv">1</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="bu">int</span>(math.sqrt(limit)) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_prime[p]:</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(p <span class="op">*</span> p, limit <span class="op">+</span> <span class="dv">1</span>, p):</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>                is_prime[i] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [p <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, limit <span class="op">+</span> <span class="dv">1</span>) <span class="cf">if</span> is_prime[p]]</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> segmented_sieve(L, R):</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    limit <span class="op">=</span> <span class="bu">int</span>(math.sqrt(R)) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>    primes <span class="op">=</span> simple_sieve(limit)</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>    is_prime <span class="op">=</span> [<span class="va">True</span>] <span class="op">*</span> (R <span class="op">-</span> L <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> primes:</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>        start <span class="op">=</span> <span class="bu">max</span>(p <span class="op">*</span> p, ((L <span class="op">+</span> p <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> p) <span class="op">*</span> p)</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start, R <span class="op">+</span> <span class="dv">1</span>, p):</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>            is_prime[i <span class="op">-</span> L] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> L <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>        is_prime[<span class="dv">0</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [L <span class="op">+</span> i <span class="cf">for</span> i, prime <span class="kw">in</span> <span class="bu">enumerate</span>(is_prime) <span class="cf">if</span> prime]</span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(segmented_sieve(<span class="dv">10</span>, <span class="dv">30</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb95"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> simple_sieve<span class="op">(</span><span class="dt">int</span> limit<span class="op">,</span> <span class="dt">int</span> primes<span class="op">[],</span> <span class="dt">int</span> <span class="op">*</span>count<span class="op">)</span> <span class="op">{</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> mark<span class="op">[</span>limit<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> limit<span class="op">;</span> i<span class="op">++)</span> mark<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    mark<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> mark<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> p <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> p <span class="op">*</span> p <span class="op">&lt;=</span> limit<span class="op">;</span> p<span class="op">++)</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mark<span class="op">[</span>p<span class="op">])</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> p <span class="op">*</span> p<span class="op">;</span> i <span class="op">&lt;=</span> limit<span class="op">;</span> i <span class="op">+=</span> p<span class="op">)</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>                mark<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> limit<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mark<span class="op">[</span>i<span class="op">])</span> primes<span class="op">[(*</span>count<span class="op">)++]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> segmented_sieve<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> L<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> primes<span class="op">[</span><span class="dv">100000</span><span class="op">],</span> count<span class="op">;</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> limit <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>sqrt<span class="op">(</span>R<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>    simple_sieve<span class="op">(</span>limit<span class="op">,</span> primes<span class="op">,</span> <span class="op">&amp;</span>count<span class="op">);</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> size <span class="op">=</span> R <span class="op">-</span> L <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_prime<span class="op">[</span>size<span class="op">];</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> size<span class="op">;</span> i<span class="op">++)</span> is_prime<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> count<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> p <span class="op">=</span> primes<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> start <span class="op">=</span> p <span class="op">*</span> p<span class="op">;</span></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>start <span class="op">&lt;</span> L<span class="op">)</span> start <span class="op">=</span> <span class="op">((</span>L <span class="op">+</span> p <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> p<span class="op">)</span> <span class="op">*</span> p<span class="op">;</span></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> j <span class="op">=</span> start<span class="op">;</span> j <span class="op">&lt;=</span> R<span class="op">;</span> j <span class="op">+=</span> p<span class="op">)</span></span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>            is_prime<span class="op">[</span>j <span class="op">-</span> L<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>L <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> is_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> size<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld</span><span class="st"> "</span><span class="op">,</span> L <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a>    segmented_sieve<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">30</span><span class="op">);</span></span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-42" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-42">Why It Matters</h4>
<p>The segmented sieve is essential when:</p>
<ul>
<li><span class="math inline">\(R\)</span> is too large for a full array</li>
<li>You need prime generation in ranges, e.g.&nbsp;[10⁹, 10⁹ + 10⁶]</li>
<li>Building prime lists for big-number algorithms (RSA, primality tests)</li>
</ul>
<p>It combines space efficiency with speed, leveraging precomputed small primes.</p>
</section>
<section id="a-gentle-proof-why-it-works-42" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-42">A Gentle Proof (Why It Works)</h4>
<p>Every composite number in <span class="math inline">\([L,R]\)</span> has a smallest prime factor <span class="math inline">\(p \le \sqrt{R}\)</span>. Thus, by marking all multiples of primes <span class="math inline">\(\le \sqrt{R}\)</span>, we eliminate all composites. Numbers left unmarked must be prime.</p>
<p>No need to store all numbers ≤ <span class="math inline">\(R\)</span>, only the current segment.</p>
</section>
<section id="try-it-yourself-42" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-42">Try It Yourself</h4>
<ol type="1">
<li>Generate primes between <span class="math inline">\(10^6\)</span> and <span class="math inline">\(10^6+1000\)</span>.</li>
<li>Measure memory vs full sieve.</li>
<li>Try non-square segment sizes.</li>
<li>Compare performance with classical sieve.</li>
<li>Combine with wheel factorization for extra speed.</li>
</ol>
</section>
<section id="test-cases-42" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-42">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Range</th>
<th>Output Primes</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[10, 30]</td>
<td>11,13,17,19,23,29</td>
<td>6</td>
</tr>
<tr class="even">
<td>[1, 10]</td>
<td>2,3,5,7</td>
<td>4</td>
</tr>
<tr class="odd">
<td>[100, 120]</td>
<td>101,103,107,109,113</td>
<td>5</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-42" class="level4">
<h4 class="anchored" data-anchor-id="complexity-42">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O((R-L+1)\log\log R)\)</span></li>
<li>Space: <span class="math inline">\(O(\sqrt{R}) + O(R-L+1)\)</span></li>
</ul>
<p>The Segmented Sieve scales Eratosthenes’ idea to infinity, sieving range by range, memory never a barrier.</p>
</section>
</section>
<section id="spf-smallest-prime-factor-table" class="level3">
<h3 class="anchored" data-anchor-id="spf-smallest-prime-factor-table">544 SPF (Smallest Prime Factor) Table</h3>
<p>The Smallest Prime Factor (SPF) Table precomputes, for every integer <span class="math inline">\(1 \le n \le N\)</span>, the smallest prime that divides it. It’s a powerful foundation for fast factorization, divisor functions, and multiplicative arithmetic functions, all in <span class="math inline">\(O(N)\)</span> time.</p>
<section id="what-problem-are-we-solving-43" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-43">What Problem Are We Solving?</h4>
<p>We often need to:</p>
<ul>
<li>Factorize many numbers quickly</li>
<li>Compute arithmetic functions (e.g.&nbsp;<span class="math inline">\(\varphi(n)\)</span>, <span class="math inline">\(\tau(n)\)</span>, <span class="math inline">\(\sigma(n)\)</span>)</li>
<li>Check primality efficiently</li>
</ul>
<p>Trial division is <span class="math inline">\(O(\sqrt{n})\)</span> per query, too slow for many queries. With SPF precomputation, any number can be factorized in <span class="math inline">\(O(\log n)\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-43" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-43">How Does It Work (Plain Language)</h4>
<p>We build a table <code>spf[i]</code> such that:</p>
<ul>
<li>If <span class="math inline">\(i\)</span> is prime → <code>spf[i] = i</code></li>
<li>If <span class="math inline">\(i\)</span> is composite → <code>spf[i]</code> = smallest prime dividing <span class="math inline">\(i\)</span></li>
</ul>
<p>We fill it using a linear sieve:</p>
<ol type="1">
<li>Start with <code>spf[i] = 0</code> (unset).</li>
<li>When visiting a prime <span class="math inline">\(p\)</span>, set <code>spf[p] = p</code>.</li>
<li>For each <span class="math inline">\(p\)</span>, mark <span class="math inline">\(i \cdot p\)</span> with <code>spf[i*p] = p</code> if unset.</li>
</ol>
<p>Each composite is processed once, by its smallest prime.</p>
</section>
<section id="example-15" class="level4">
<h4 class="anchored" data-anchor-id="example-15">Example</h4>
<p>Compute <code>spf</code> for <span class="math inline">\(1 \le i \le 10\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th>spf[i]</th>
<th>Factorization</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>,</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>2×2</td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td>5</td>
</tr>
<tr class="even">
<td>6</td>
<td>2</td>
<td>2×3</td>
</tr>
<tr class="odd">
<td>7</td>
<td>7</td>
<td>7</td>
</tr>
<tr class="even">
<td>8</td>
<td>2</td>
<td>2×2×2</td>
</tr>
<tr class="odd">
<td>9</td>
<td>3</td>
<td>3×3</td>
</tr>
<tr class="even">
<td>10</td>
<td>2</td>
<td>2×5</td>
</tr>
</tbody>
</table>
<p>Factorization becomes trivial:</p>
<pre><code>n = 84
spf[84] = 2 → 42
spf[42] = 2 → 21
spf[21] = 3 → 7
spf[7] = 7 → 1
→ 2 × 2 × 3 × 7</code></pre>
</section>
<section id="tiny-code-easy-versions-40" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-40">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spf_sieve(n):</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    spf <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    spf[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> spf[i] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>            spf[i] <span class="op">=</span> i</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">*</span> i, n <span class="op">+</span> <span class="dv">1</span>, i):</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> spf[j] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>                    spf[j] <span class="op">=</span> i</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spf</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> factorize(n, spf):</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>    factors <span class="op">=</span> []</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> n <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>        factors.append(spf[n])</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>        n <span class="op">//=</span> spf[n]</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> factors</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>spf <span class="op">=</span> spf_sieve(<span class="dv">100</span>)</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(factorize(<span class="dv">84</span>, spf))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb98"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> spf_sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> spf<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> spf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    spf<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>spf<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>            spf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> j <span class="op">=</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>i <span class="op">*</span> i<span class="op">;</span> j <span class="op">&lt;=</span> n<span class="op">;</span> j <span class="op">+=</span> i<span class="op">)</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>spf<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> spf<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> factorize<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> spf<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> spf<span class="op">[</span>n<span class="op">]);</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>        n <span class="op">/=</span> spf<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">100</span><span class="op">,</span> spf<span class="op">[</span><span class="dv">101</span><span class="op">];</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>    spf_sieve<span class="op">(</span>n<span class="op">,</span> spf<span class="op">);</span></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>    factorize<span class="op">(</span><span class="dv">84</span><span class="op">,</span> spf<span class="op">);</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-43" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-43">Why It Matters</h4>
<p>The SPF table is a Swiss-army knife for number-theoretic algorithms:</p>
<ul>
<li>Prime factorization in <span class="math inline">\(O(\log n)\)</span></li>
<li>Counting divisors: use exponents from SPF</li>
<li>Computing totient: <span class="math inline">\(\varphi(n)\)</span> via prime factors</li>
<li>Detecting square-free numbers</li>
</ul>
<p>Used in:</p>
<ul>
<li>Modular arithmetic systems</li>
<li>Factorization-heavy algorithms</li>
<li>Competitive programming precomputations</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-43" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-43">A Gentle Proof (Why It Works)</h4>
<p>Each composite <span class="math inline">\(n = p \cdot m\)</span> has smallest prime <span class="math inline">\(p\)</span>. When sieve reaches <span class="math inline">\(p\)</span>, it sets <code>spf[n] = p</code>. If a smaller prime existed, it would’ve marked <span class="math inline">\(n\)</span> earlier. Thus <code>spf[n]</code> is indeed the smallest prime dividing <span class="math inline">\(n\)</span>.</p>
<p>Each number is marked once → total time <span class="math inline">\(O(n)\)</span>.</p>
</section>
<section id="try-it-yourself-43" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-43">Try It Yourself</h4>
<ol type="1">
<li>Build <code>spf[]</code> for <span class="math inline">\(n=50\)</span> and print all factorizations.</li>
<li>Write <code>is_prime(i)</code> = <code>(spf[i]==i)</code>.</li>
<li>Modify to count distinct prime factors.</li>
<li>Compute <span class="math inline">\(\varphi(i)\)</span> using SPF factors.</li>
<li>Visualize prime factor frequencies.</li>
</ol>
</section>
<section id="test-cases-43" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-43">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>n</th>
<th>Factorization via SPF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>2 × 5</td>
</tr>
<tr class="even">
<td>12</td>
<td>2 × 2 × 3</td>
</tr>
<tr class="odd">
<td>36</td>
<td>2 × 2 × 3 × 3</td>
</tr>
<tr class="even">
<td>84</td>
<td>2 × 2 × 3 × 7</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-43" class="level4">
<h4 class="anchored" data-anchor-id="complexity-43">Complexity</h4>
<ul>
<li>Precompute: <span class="math inline">\(O(n)\)</span></li>
<li>Factorization per query: <span class="math inline">\(O(\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The SPF table turns factorization from division into lookup, precalculate once, reuse forever.</p>
</section>
</section>
<section id="möbius-function-sieve" class="level3">
<h3 class="anchored" data-anchor-id="möbius-function-sieve">545 Möbius Function Sieve</h3>
<p>The Möbius function <span class="math inline">\(\mu(n)\)</span> is a multiplicative arithmetic function central to inversion formulas and detecting square factors. Values:</p>
<ul>
<li><span class="math inline">\(\mu(1)=1\)</span></li>
<li><span class="math inline">\(\mu(n)=0\)</span> if <span class="math inline">\(n\)</span> has any squared prime factor</li>
<li><span class="math inline">\(\mu(n)=(-1)^k\)</span> if <span class="math inline">\(n\)</span> is a product of <span class="math inline">\(k\)</span> distinct primes</li>
</ul>
<p>A Möbius sieve computes <span class="math inline">\(\mu(1),\dots,\mu(N)\)</span> efficiently for large <span class="math inline">\(N\)</span>.</p>
<section id="what-problem-are-we-solving-44" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-44">What Problem Are We Solving?</h4>
<p>We want to compute <span class="math inline">\(\mu(n)\)</span> for all <span class="math inline">\(1 \le n \le N\)</span> faster than factoring each <span class="math inline">\(n\)</span> separately.</p>
<p>Target:</p>
<ul>
<li>All values of <span class="math inline">\(\mu\)</span> up to <span class="math inline">\(N\)</span> in near linear time</li>
<li>Often together with a prime list and the smallest prime factor</li>
</ul>
</section>
<section id="how-does-it-work-plain-language-44" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-44">How Does It Work (Plain Language)</h4>
<p>Use a linear sieve with these invariants:</p>
<ul>
<li><p>Maintain a dynamic list of primes <code>primes</code></p></li>
<li><p>Store <code>mu[i]</code> as we go</p></li>
<li><p>For each <span class="math inline">\(i\)</span> from <span class="math inline">\(2\)</span> to <span class="math inline">\(N\)</span>:</p>
<ul>
<li><p>If <span class="math inline">\(i\)</span> is prime, set <code>mu[i] = -1</code> and push to <code>primes</code></p></li>
<li><p>For each prime <span class="math inline">\(p\)</span> in <code>primes</code>:</p>
<ul>
<li><p>If $i p &gt; N`, stop</p></li>
<li><p>If <span class="math inline">\(p \mid i\)</span>, then:</p>
<ul>
<li><code>mu[i*p] = 0</code> because <span class="math inline">\(p^2 \mid i p\)</span></li>
<li>break to keep linear complexity</li>
</ul></li>
<li><p>Else:</p>
<ul>
<li><code>mu[i*p] = -mu[i]</code> because we add a new distinct prime factor</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Initialize with <code>mu[1] = 1</code>.</p>
<p>This marks each composite exactly once with its smallest prime factor relation.</p>
</section>
<section id="example-16" class="level4">
<h4 class="anchored" data-anchor-id="example-16">Example</h4>
<p>Compute <span class="math inline">\(\mu(n)\)</span> for <span class="math inline">\(1 \le n \le 12\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>prime factors</th>
<th>squarefree</th>
<th><span class="math inline">\(\mu(n)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>,</td>
<td>yes</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(2\)</span></td>
<td>yes</td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td><span class="math inline">\(3\)</span></td>
<td>yes</td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>4</td>
<td><span class="math inline">\(2^2\)</span></td>
<td>no</td>
<td>0</td>
</tr>
<tr class="odd">
<td>5</td>
<td><span class="math inline">\(5\)</span></td>
<td>yes</td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>6</td>
<td><span class="math inline">\(2\cdot 3\)</span></td>
<td>yes</td>
<td><span class="math inline">\(+1\)</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td><span class="math inline">\(7\)</span></td>
<td>yes</td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>8</td>
<td><span class="math inline">\(2^3\)</span></td>
<td>no</td>
<td>0</td>
</tr>
<tr class="odd">
<td>9</td>
<td><span class="math inline">\(3^2\)</span></td>
<td>no</td>
<td>0</td>
</tr>
<tr class="even">
<td>10</td>
<td><span class="math inline">\(2\cdot 5\)</span></td>
<td>yes</td>
<td><span class="math inline">\(+1\)</span></td>
</tr>
<tr class="odd">
<td>11</td>
<td><span class="math inline">\(11\)</span></td>
<td>yes</td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>12</td>
<td><span class="math inline">\(2^2\cdot 3\)</span></td>
<td>no</td>
<td>0</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-easy-versions-41" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-41">Tiny Code (Easy Versions)</h4>
<p>Python Version (Linear Sieve for <span class="math inline">\(\mu\)</span>)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mobius_sieve(n):</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    mu[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    primes <span class="op">=</span> []</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    is_comp <span class="op">=</span> [<span class="va">False</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> is_comp[i]:</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>            primes.append(i)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>            mu[i] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p <span class="kw">in</span> primes:</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>            ip <span class="op">=</span> i <span class="op">*</span> p</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ip <span class="op">&gt;</span> n:</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>            is_comp[ip] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>                mu[ip] <span class="op">=</span> <span class="dv">0</span>           <span class="co"># p^2 divides ip</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>                mu[ip] <span class="op">=</span> <span class="op">-</span>mu[i]      <span class="co"># add new distinct prime</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mu</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> mobius_sieve(<span class="dv">50</span>)</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>([ (i, mu[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">13</span>) ])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb100"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> mobius_sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> mu<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> comp<span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span> comp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> mu<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    mu<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> primes<span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">],</span> pc <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>comp<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>            primes<span class="op">[</span>pc<span class="op">++]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>            mu<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> pc<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>            <span class="dt">long</span> <span class="dt">long</span> ip <span class="op">=</span> <span class="dv">1</span><span class="bu">LL</span> <span class="op">*</span> i <span class="op">*</span> primes<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>ip <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>            comp<span class="op">[</span>ip<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">%</span> primes<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>                mu<span class="op">[</span>ip<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>              <span class="co">// squared factor</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>                mu<span class="op">[</span>ip<span class="op">]</span> <span class="op">=</span> <span class="op">-</span>mu<span class="op">[</span>i<span class="op">];</span>         <span class="co">// add a new distinct prime</span></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mu<span class="op">[</span><span class="dv">51</span><span class="op">];</span></span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>    mobius_sieve<span class="op">(</span>N<span class="op">,</span> mu<span class="op">);</span></span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">12</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"mu(</span><span class="sc">%d</span><span class="st">) = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> mu<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-44" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-44">Why It Matters</h4>
<ul>
<li><p>Möbius inversion in number theory: <span class="math display">\[
f(n)=\sum_{d\mid n} g(d)
\quad \Longleftrightarrow \quad
g(n)=\sum_{d\mid n} \mu(d) f!\left(\frac{n}{d}\right)
\]</span></p></li>
<li><p>Detects squarefree numbers: <span class="math inline">\(\mu(n)\ne 0\)</span> iff <span class="math inline">\(n\)</span> is squarefree</p></li>
<li><p>Central to:</p>
<ul>
<li>Dirichlet convolutions and multiplicative functions</li>
<li>Inclusion exclusion over divisors</li>
<li>Evaluating sums like <span class="math inline">\(\sum_{n\le N}\mu(n)\)</span></li>
<li>Counting problems with gcd or coprimality constraints</li>
</ul></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-44" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-44">A Gentle Proof (Why It Works)</h4>
<p>Induct on increasing integers while maintaining:</p>
<ul>
<li><p>If <span class="math inline">\(i\)</span> is prime then <span class="math inline">\(\mu(i)=-1\)</span></p></li>
<li><p>For any prime <span class="math inline">\(p\)</span>:</p>
<ul>
<li>If <span class="math inline">\(p \mid i\)</span> then <span class="math inline">\(\mu(i p)=0\)</span> because <span class="math inline">\(p^2 \mid i p\)</span></li>
<li>If <span class="math inline">\(p \nmid i\)</span> then <span class="math inline">\(\mu(i p)=-\mu(i)\)</span> since <span class="math inline">\(i p\)</span> is squarefree with one more distinct prime</li>
</ul></li>
</ul>
<p>The linear loop stops at the first prime dividing <span class="math inline">\(i\)</span>, so each composite is processed exactly once. Thus total work is proportional to <span class="math inline">\(N\)</span> and the recurrence of signs matches the definition of <span class="math inline">\(\mu\)</span>.</p>
</section>
<section id="try-it-yourself-44" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-44">Try It Yourself</h4>
<ol type="1">
<li>Verify that <span class="math inline">\(\sum_{d\mid n} \mu(d) = 0\)</span> for <span class="math inline">\(n&gt;1\)</span> and equals <span class="math inline">\(1\)</span> for <span class="math inline">\(n=1\)</span>.</li>
<li>Compute count of squarefree integers up to <span class="math inline">\(N\)</span> using <span class="math inline">\(\sum_{n\le N} [\mu(n)\ne 0]\)</span>.</li>
<li>Implement Dirichlet convolution with precomputed <span class="math inline">\(\mu\)</span> to invert divisor sums.</li>
<li>Compare runtime of the linear sieve versus factoring each <span class="math inline">\(n\)</span>.</li>
<li>Extend the sieve to also store the smallest prime factor and reuse it.</li>
</ol>
</section>
<section id="test-cases-44" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-44">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(\mu(n)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>0</td>
</tr>
<tr class="odd">
<td>6</td>
<td><span class="math inline">\(+1\)</span></td>
</tr>
<tr class="even">
<td>10</td>
<td><span class="math inline">\(+1\)</span></td>
</tr>
<tr class="odd">
<td>12</td>
<td>0</td>
</tr>
<tr class="even">
<td>30</td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-44" class="level4">
<h4 class="anchored" data-anchor-id="complexity-44">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(N)\)</span> using the linear sieve</li>
<li>Space: <span class="math inline">\(O(N)\)</span> for arrays</li>
</ul>
<p>The Möbius sieve delivers <span class="math inline">\(\mu\)</span> values for an entire range in one pass, making inversion and squarefree analysis practical at scale.</p>
</section>
</section>
<section id="eulers-totient-sieve" class="level3">
<h3 class="anchored" data-anchor-id="eulers-totient-sieve">546 Euler’s Totient Sieve</h3>
<p>The Euler Totient Function <span class="math inline">\(\varphi(n)\)</span> counts how many integers <span class="math inline">\(1 \le k \le n\)</span> are coprime to <span class="math inline">\(n\)</span>. That is, numbers such that <span class="math inline">\(\gcd(k,n)=1\)</span>.</p>
<p>We can compute all <span class="math inline">\(\varphi(1), \dots, \varphi(N)\)</span> in <span class="math inline">\(O(N)\)</span> time using a linear sieve.</p>
<section id="what-problem-are-we-solving-45" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-45">What Problem Are We Solving?</h4>
<p>Naively, computing <span class="math inline">\(\varphi(n)\)</span> requires prime factorization: <span class="math display">\[
\varphi(n) = n \prod_{p|n}\left(1 - \frac{1}{p}\right)
\]</span> Doing that for each <span class="math inline">\(n\)</span> individually is too slow.</p>
<p>We want a fast sieve to compute <span class="math inline">\(\varphi\)</span> for every <span class="math inline">\(n\)</span> up to <span class="math inline">\(N\)</span> in one pass.</p>
</section>
<section id="how-does-it-work-plain-language-45" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-45">How Does It Work (Plain Language)</h4>
<p>We use a linear sieve similar to prime generation:</p>
<ol type="1">
<li><p>Start with <code>phi[1] = 1</code>.</p></li>
<li><p>For each number <span class="math inline">\(i\)</span>:</p>
<ul>
<li><p>If <span class="math inline">\(i\)</span> is prime, then <span class="math inline">\(\varphi(i)=i-1\)</span>.</p></li>
<li><p>For each prime <span class="math inline">\(p\)</span>:</p>
<ul>
<li><p>If <span class="math inline">\(i \cdot p &gt; N\)</span>, stop.</p></li>
<li><p>If <span class="math inline">\(p \mid i\)</span> (i.e., <span class="math inline">\(p\)</span> divides <span class="math inline">\(i\)</span>):</p>
<ul>
<li><span class="math inline">\(\varphi(i \cdot p) = \varphi(i) \cdot p\)</span></li>
<li>break (to ensure linear time)</li>
</ul></li>
<li><p>Else:</p>
<ul>
<li><span class="math inline">\(\varphi(i \cdot p) = \varphi(i) \cdot (p-1)\)</span></li>
</ul></li>
</ul></li>
</ul></li>
</ol>
<p>Each number is processed exactly once, preserving <span class="math inline">\(O(N)\)</span> complexity.</p>
</section>
<section id="example-17" class="level4">
<h4 class="anchored" data-anchor-id="example-17">Example</h4>
<p>Let’s compute <span class="math inline">\(\varphi(n)\)</span> for <span class="math inline">\(n=1\)</span> to <span class="math inline">\(10\)</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 20%">
<col style="width: 54%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Prime Factors</th>
<th>Formula</th>
<th><span class="math inline">\(\varphi(n)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>,</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(2\)</span></td>
<td><span class="math inline">\(2(1-\frac{1}{2})\)</span></td>
<td>1</td>
</tr>
<tr class="odd">
<td>3</td>
<td><span class="math inline">\(3\)</span></td>
<td><span class="math inline">\(3(1-\frac{1}{3})\)</span></td>
<td>2</td>
</tr>
<tr class="even">
<td>4</td>
<td><span class="math inline">\(2^2\)</span></td>
<td><span class="math inline">\(4(1-\frac{1}{2})\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>5</td>
<td><span class="math inline">\(5\)</span></td>
<td><span class="math inline">\(5(1-\frac{1}{5})\)</span></td>
<td>4</td>
</tr>
<tr class="even">
<td>6</td>
<td><span class="math inline">\(2\cdot3\)</span></td>
<td><span class="math inline">\(6(1-\frac{1}{2})(1-\frac{1}{3})\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>7</td>
<td><span class="math inline">\(7\)</span></td>
<td><span class="math inline">\(7(1-\frac{1}{7})\)</span></td>
<td>6</td>
</tr>
<tr class="even">
<td>8</td>
<td><span class="math inline">\(2^3\)</span></td>
<td><span class="math inline">\(8(1-\frac{1}{2})\)</span></td>
<td>4</td>
</tr>
<tr class="odd">
<td>9</td>
<td><span class="math inline">\(3^2\)</span></td>
<td><span class="math inline">\(9(1-\frac{1}{3})\)</span></td>
<td>6</td>
</tr>
<tr class="even">
<td>10</td>
<td><span class="math inline">\(2\cdot5\)</span></td>
<td><span class="math inline">\(10(1-\frac{1}{2})(1-\frac{1}{5})\)</span></td>
<td>4</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-easy-versions-42" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-42">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> totient_sieve(n):</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    phi <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    primes <span class="op">=</span> []</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    phi[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    is_comp <span class="op">=</span> [<span class="va">False</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> is_comp[i]:</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>            primes.append(i)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>            phi[i] <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p <span class="kw">in</span> primes:</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>            ip <span class="op">=</span> i <span class="op">*</span> p</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ip <span class="op">&gt;</span> n:</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>            is_comp[ip] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>                phi[ip] <span class="op">=</span> phi[i] <span class="op">*</span> p</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>                phi[ip] <span class="op">=</span> phi[i] <span class="op">*</span> (p <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> phi</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>phi <span class="op">=</span> totient_sieve(<span class="dv">20</span>)</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"phi(</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">) = </span><span class="sc">{</span>phi[i]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb102"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> totient_sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> phi<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> comp<span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> primes<span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">],</span> pc <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span> comp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> phi<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    phi<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>comp<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>            primes<span class="op">[</span>pc<span class="op">++]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>            phi<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> pc<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> p <span class="op">=</span> primes<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>            <span class="dt">long</span> <span class="dt">long</span> ip <span class="op">=</span> <span class="dv">1</span><span class="bu">LL</span> <span class="op">*</span> i <span class="op">*</span> p<span class="op">;</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>ip <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>            comp<span class="op">[</span>ip<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>                phi<span class="op">[</span>ip<span class="op">]</span> <span class="op">=</span> phi<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> p<span class="op">;</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>                phi<span class="op">[</span>ip<span class="op">]</span> <span class="op">=</span> phi<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> <span class="op">(</span>p <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">20</span><span class="op">,</span> phi<span class="op">[</span><span class="dv">21</span><span class="op">];</span></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>    totient_sieve<span class="op">(</span>n<span class="op">,</span> phi<span class="op">);</span></span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"phi(</span><span class="sc">%d</span><span class="st">) = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> phi<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-45" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-45">Why It Matters</h4>
<p>The totient function <span class="math inline">\(\varphi(n)\)</span> is foundational in:</p>
<ul>
<li>Euler’s theorem: <span class="math inline">\(a^{\varphi(n)} \equiv 1 \pmod n\)</span> if <span class="math inline">\(\gcd(a,n)=1\)</span></li>
<li>RSA encryption: <span class="math inline">\(\varphi(n)\)</span> defines modular inverses for keys</li>
<li>Counting reduced fractions: number of coprime pairs</li>
<li>Group theory: size of multiplicative group <span class="math inline">\((\mathbb{Z}/n\mathbb{Z})^\times\)</span></li>
</ul>
<p>And useful in:</p>
<ul>
<li>Modular arithmetic</li>
<li>Cryptography</li>
<li>Number-theoretic combinatorics</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-45" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-45">A Gentle Proof (Why It Works)</h4>
<p>Let <span class="math inline">\(i\)</span> be current number, <span class="math inline">\(p\)</span> a prime:</p>
<ul>
<li>If <span class="math inline">\(p\nmid i\)</span>, <span class="math inline">\(\varphi(i p) = \varphi(i) \cdot (p-1)\)</span> since we multiply by a new distinct prime.</li>
<li>If <span class="math inline">\(p\mid i\)</span>, <span class="math inline">\(\varphi(i p) = \varphi(i) \cdot p\)</span> because we’re extending a power of an existing prime.</li>
</ul>
<p>Every number is built from its smallest prime factor in exactly one way → linear time.</p>
</section>
<section id="try-it-yourself-45" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-45">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(\varphi(n)\)</span> for <span class="math inline">\(n=1\)</span> to <span class="math inline">\(20\)</span>.</li>
<li>Verify <span class="math inline">\(\sum_{d|n} \varphi(d) = n\)</span>.</li>
<li>Plot <span class="math inline">\(\varphi(n)/n\)</span> to visualize density of coprime numbers.</li>
<li>Use <span class="math inline">\(\varphi(n)\)</span> to compute modular inverses via Euler’s theorem.</li>
<li>Adapt sieve to also store primes and smallest prime factors.</li>
</ol>
</section>
<section id="test-cases-45" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-45">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th><span class="math inline">\(\varphi(n)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
</tr>
<tr class="odd">
<td>5</td>
<td>4</td>
</tr>
<tr class="even">
<td>6</td>
<td>2</td>
</tr>
<tr class="odd">
<td>10</td>
<td>4</td>
</tr>
<tr class="even">
<td>12</td>
<td>4</td>
</tr>
<tr class="odd">
<td>15</td>
<td>8</td>
</tr>
<tr class="even">
<td>20</td>
<td>8</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-45" class="level4">
<h4 class="anchored" data-anchor-id="complexity-45">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(N)\)</span></li>
<li>Space: <span class="math inline">\(O(N)\)</span></li>
</ul>
<p>The Euler Totient Sieve is the backbone for arithmetic, cryptographic, and modular reasoning, one pass, all <span class="math inline">\(\varphi(n)\)</span> ready.</p>
</section>
</section>
<section id="divisor-count-sieve" class="level3">
<h3 class="anchored" data-anchor-id="divisor-count-sieve">547 Divisor Count Sieve</h3>
<p>The Divisor Count Sieve precomputes the number of positive divisors <span class="math inline">\(d(n)\)</span> (also written <span class="math inline">\(\tau(n)\)</span>) for all integers <span class="math inline">\(1 \le n \le N\)</span>. It’s a powerful tool in number theory and combinatorics, perfect for counting factors efficiently in <span class="math inline">\(O(N\log N)\)</span> time.</p>
<section id="what-problem-are-we-solving-46" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-46">What Problem Are We Solving?</h4>
<p>We want to compute the number of divisors for every integer up to <span class="math inline">\(N\)</span>: <span class="math display">\[
d(n) = \sum_{i \mid n} 1
\]</span> or equivalently, if the prime factorization of <span class="math inline">\(n\)</span> is <span class="math display">\[
n = p_1^{a_1} p_2^{a_2} \dots p_k^{a_k},
\]</span> then <span class="math display">\[
d(n) = (a_1 + 1)(a_2 + 1)\dots(a_k + 1).
\]</span></p>
<p>Naively factoring each number is too slow. The sieve method does it in one unified pass.</p>
</section>
<section id="how-does-it-work-plain-language-46" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-46">How Does It Work (Plain Language)</h4>
<p>We use a divisor accumulation sieve:</p>
<p>For each <span class="math inline">\(i\)</span> from <span class="math inline">\(1\)</span> to <span class="math inline">\(N\)</span>:</p>
<ul>
<li><p>Add <span class="math inline">\(1\)</span> to every multiple of <span class="math inline">\(i\)</span> (because <span class="math inline">\(i\)</span> divides each multiple)</p></li>
<li><p>In code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, N<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, N<span class="op">+</span><span class="dv">1</span>, i):</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>        div[j] <span class="op">+=</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ul>
<p>Each integer <span class="math inline">\(n\)</span> gets incremented once for each divisor <span class="math inline">\(i \mid n\)</span>. Total operations <span class="math inline">\(\sim N\log N\)</span>.</p>
</section>
<section id="example-18" class="level4">
<h4 class="anchored" data-anchor-id="example-18">Example</h4>
<p>For <span class="math inline">\(N = 10\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Divisors</th>
<th><span class="math inline">\(d(n)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>1, 2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1, 3</td>
<td>2</td>
</tr>
<tr class="even">
<td>4</td>
<td>1, 2, 4</td>
<td>3</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1, 5</td>
<td>2</td>
</tr>
<tr class="even">
<td>6</td>
<td>1, 2, 3, 6</td>
<td>4</td>
</tr>
<tr class="odd">
<td>7</td>
<td>1, 7</td>
<td>2</td>
</tr>
<tr class="even">
<td>8</td>
<td>1, 2, 4, 8</td>
<td>4</td>
</tr>
<tr class="odd">
<td>9</td>
<td>1, 3, 9</td>
<td>3</td>
</tr>
<tr class="even">
<td>10</td>
<td>1, 2, 5, 10</td>
<td>4</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-easy-versions-43" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-43">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> divisor_count_sieve(n):</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    div <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, n <span class="op">+</span> <span class="dv">1</span>, i):</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>            div[j] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> div</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>div <span class="op">=</span> divisor_count_sieve(N)</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, N <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"d(</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">) = </span><span class="sc">{</span>div[i]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb105"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> divisor_count_sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> div<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> div<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i<span class="op">;</span> j <span class="op">&lt;=</span> n<span class="op">;</span> j <span class="op">+=</span> i<span class="op">)</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>            div<span class="op">[</span>j<span class="op">]++;</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N <span class="op">=</span> <span class="dv">10</span><span class="op">,</span> div<span class="op">[</span><span class="dv">11</span><span class="op">];</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    divisor_count_sieve<span class="op">(</span>N<span class="op">,</span> div<span class="op">);</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> N<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"d(</span><span class="sc">%d</span><span class="st">) = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> div<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-46" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-46">Why It Matters</h4>
<p>The divisor count function <span class="math inline">\(d(n)\)</span> is essential in:</p>
<ul>
<li>Divisor-sum problems</li>
<li>Highly composite numbers</li>
<li>Counting lattice points</li>
<li>Summation over divisors (e.g.&nbsp;<span class="math inline">\(\sum_{i=1}^N d(i)\)</span>)</li>
<li>Dynamic programming and combinatorial enumeration</li>
<li>Number-theoretic transforms</li>
</ul>
<p>Also appears in formulas like: <span class="math display">\[
\sigma_0(n) = d(n), \quad \sigma_1(n) = \text{sum of divisors}
\]</span></p>
</section>
<section id="a-gentle-proof-why-it-works-46" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-46">A Gentle Proof (Why It Works)</h4>
<p>Each integer <span class="math inline">\(i\)</span> divides exactly <span class="math inline">\(\lfloor N/i \rfloor\)</span> numbers ≤ <span class="math inline">\(N\)</span>. So in the nested loop, <span class="math inline">\(i\)</span> contributes <span class="math inline">\(+1\)</span> to <span class="math inline">\(\lfloor N/i \rfloor\)</span> entries. Summing over <span class="math inline">\(i\)</span> gives total operations: <span class="math display">\[
\sum_{i=1}^{N} \frac{N}{i} \approx N \log N
\]</span></p>
<p>This is efficient and straightforward.</p>
</section>
<section id="try-it-yourself-46" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-46">Try It Yourself</h4>
<ol type="1">
<li><p>Print <span class="math inline">\(d(n)\)</span> for <span class="math inline">\(n = 1\)</span> to <span class="math inline">\(30\)</span>.</p></li>
<li><p>Plot <span class="math inline">\(d(n)\)</span> to see how divisor counts fluctuate.</p></li>
<li><p>Modify code to compute sum of divisors:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>divsum[j] <span class="op">+=</span> i</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Combine with totient sieve to study divisor distributions.</p></li>
<li><p>Count numbers with exactly <span class="math inline">\(k\)</span> divisors.</p></li>
</ol>
</section>
<section id="test-cases-46" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-46">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(n\)</span></th>
<th>Divisors</th>
<th><span class="math inline">\(d(n)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>1, 2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1, 2, 4</td>
<td>3</td>
</tr>
<tr class="even">
<td>6</td>
<td>1, 2, 3, 6</td>
<td>4</td>
</tr>
<tr class="odd">
<td>8</td>
<td>1, 2, 4, 8</td>
<td>4</td>
</tr>
<tr class="even">
<td>12</td>
<td>1, 2, 3, 4, 6, 12</td>
<td>6</td>
</tr>
<tr class="odd">
<td>30</td>
<td>1, 2, 3, 5, 6, 10, 15, 30</td>
<td>8</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-46" class="level4">
<h4 class="anchored" data-anchor-id="complexity-46">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(N\log N)\)</span></li>
<li>Space: <span class="math inline">\(O(N)\)</span></li>
</ul>
<p>The Divisor Count Sieve is simple yet mighty, precomputing factor structure for every number with a few nested loops.</p>
</section>
</section>
<section id="modular-precomputation" class="level3">
<h3 class="anchored" data-anchor-id="modular-precomputation">548 Modular Precomputation</h3>
<p>Modular precomputation prepares tables like factorials, inverse elements, and powers modulo <span class="math inline">\(M\)</span> so that later queries run in <span class="math inline">\(O(1)\)</span> time after an <span class="math inline">\(O(N)\)</span> or <span class="math inline">\(O(N \log M)\)</span> setup. This is the backbone for fast combinatorics, DP, and number theoretic transforms under a modulus.</p>
<section id="what-problem-are-we-solving-47" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-47">What Problem Are We Solving?</h4>
<p>We often need to compute repeatedly:</p>
<ul>
<li><span class="math inline">\(a+b\)</span>, <span class="math inline">\(a-b\)</span>, <span class="math inline">\(a\cdot b\)</span>, <span class="math inline">\(a^k \bmod M\)</span></li>
<li>modular inverses <span class="math inline">\(a^{-1} \bmod M\)</span></li>
<li>binomial coefficients <span class="math inline">\(\binom{n}{r} \bmod M\)</span></li>
</ul>
<p>Doing these from scratch per query costs <span class="math inline">\(O(\log M)\)</span> time via exponentiation. With precomputation we answer in <span class="math inline">\(O(1)\)</span> per query after one linear pass.</p>
</section>
<section id="what-do-we-precompute" class="level4">
<h4 class="anchored" data-anchor-id="what-do-we-precompute">What Do We Precompute?</h4>
<p>For a prime modulus <span class="math inline">\(M\)</span> and a chosen limit <span class="math inline">\(N\)</span>:</p>
<ul>
<li><code>fact[i] = i! mod M</code> for <span class="math inline">\(0 \le i \le N\)</span></li>
<li><code>inv[i] = i^{-1} mod M</code> for <span class="math inline">\(1 \le i \le N\)</span></li>
<li><code>invfact[i] = (i!)^{-1} mod M</code> for <span class="math inline">\(0 \le i \le N\)</span></li>
<li>optional: <code>powA[i] = A^i mod M</code> for fixed bases</li>
</ul>
<p>Then <span class="math display">\[
\binom{n}{r} \bmod M = \text{fact}[n]\cdot \text{invfact}[r]\cdot \text{invfact}[n-r] \bmod M
\]</span> in <span class="math inline">\(O(1)\)</span> time.</p>
</section>
<section id="how-does-it-work-plain-language-47" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-47">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Factorials: one forward pass</li>
<li>Inverse factorials: compute <span class="math inline">\(\text{invfact}[N]=\text{fact}[N]^{M-2}\bmod M\)</span> by Fermat then run backward</li>
<li>Elementwise inverses: either from <code>invfact</code> and <code>fact</code> or linearly by the identity <span class="math display">\[
\text{inv}[1]=1,\qquad
\text{inv}[i]=M-\left(\left\lfloor \frac{M}{i}\right\rfloor\cdot \text{inv}[M\bmod i]\right)\bmod M
\]</span> which runs in <span class="math inline">\(O(N)\)</span>.</li>
</ol>
<p>These rely on <span class="math inline">\(M\)</span> being prime so that every <span class="math inline">\(1\le i&lt;M\)</span> is invertible.</p>
</section>
<section id="edge-cases" class="level4">
<h4 class="anchored" data-anchor-id="edge-cases">Edge Cases</h4>
<ul>
<li>If <span class="math inline">\(M\)</span> is not prime: use extended Euclid to invert numbers coprime with <span class="math inline">\(M\)</span>, or use factorial tables only for indices not hitting noninvertible factors. For combinatorics with composite <span class="math inline">\(M\)</span>, use prime factorization of <span class="math inline">\(M\)</span> plus CRT, or use Lucas or Garner methods when applicable.</li>
<li>Range limit: choose <span class="math inline">\(N\)</span> at least as large as the maximum <span class="math inline">\(n\)</span> you will query.</li>
</ul>
</section>
<section id="tiny-code-easy-versions-44" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-44">Tiny Code (Easy Versions)</h4>
<p>Python Version (prime modulus)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> <span class="dv">109</span> <span class="op">+</span> <span class="dv">7</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modpow(a, e, m<span class="op">=</span>M):</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e:</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>: r <span class="op">=</span> r <span class="op">*</span> a <span class="op">%</span> m</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">*</span> a <span class="op">%</span> m</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_tables(N, M<span class="op">=</span><span class="dv">109</span><span class="op">+</span><span class="dv">7</span>):</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    fact <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, N <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>        fact[i] <span class="op">=</span> fact[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">*</span> i <span class="op">%</span> M</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>    invfact <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> (N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>    invfact[N] <span class="op">=</span> modpow(fact[N], M <span class="op">-</span> <span class="dv">2</span>, M)  <span class="co"># Fermat</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>        invfact[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> invfact[i] <span class="op">*</span> i <span class="op">%</span> M</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>    inv <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (N <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    inv[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, N <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>        inv[i] <span class="op">=</span> (M <span class="op">-</span> (M <span class="op">//</span> i) <span class="op">*</span> inv[M <span class="op">%</span> i] <span class="op">%</span> M) <span class="op">%</span> M</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact, invfact, inv</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nCr_mod(n, r, fact, invfact, M<span class="op">=</span><span class="dv">109</span><span class="op">+</span><span class="dv">7</span>):</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> r <span class="op">&lt;</span> <span class="dv">0</span> <span class="kw">or</span> r <span class="op">&gt;</span> n: <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact[n] <span class="op">*</span> invfact[r] <span class="op">%</span> M <span class="op">*</span> invfact[n <span class="op">-</span> r] <span class="op">%</span> M</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1_000_000</span></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>fact, invfact, inv <span class="op">=</span> build_tables(N, M)</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nCr_mod(<span class="dv">10</span>, <span class="dv">3</span>, fact, invfact, M))  <span class="co"># 120</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version (prime modulus)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb108"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="dv">1000000007</span><span class="op">;</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> modpow<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> r <span class="op">=</span> <span class="dv">1</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> r <span class="op">=</span> <span class="op">(</span>r <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="op">(</span>a <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> build_tables<span class="op">(</span><span class="dt">int</span> N<span class="op">,</span> <span class="dt">int</span> fact<span class="op">[],</span> <span class="dt">int</span> invfact<span class="op">[],</span> <span class="dt">int</span> inv<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    fact<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> N<span class="op">;</span> i<span class="op">++)</span> fact<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>fact<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">*</span> i <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>    invfact<span class="op">[</span>N<span class="op">]</span> <span class="op">=</span> modpow<span class="op">(</span>fact<span class="op">[</span>N<span class="op">],</span> MOD <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> N<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">--)</span> invfact<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>invfact<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> i <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>    inv<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> N<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>        inv<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)((</span>MOD <span class="op">-</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)(</span>MOD <span class="op">/</span> i<span class="op">)</span> <span class="op">*</span> inv<span class="op">[</span>MOD <span class="op">%</span> i<span class="op">]</span> <span class="op">%</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">);</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> nCr_mod<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> fact<span class="op">[],</span> <span class="dt">int</span> invfact<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">||</span> r <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">int</span><span class="op">)((</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>fact<span class="op">[</span>n<span class="op">]</span> <span class="op">*</span> invfact<span class="op">[</span>r<span class="op">]</span> <span class="op">%</span> MOD <span class="op">*</span> invfact<span class="op">[</span>n <span class="op">-</span> r<span class="op">]</span> <span class="op">%</span> MOD<span class="op">);</span></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N <span class="op">=</span> <span class="dv">1000000</span><span class="op">;</span></span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">static</span> <span class="dt">int</span> fact<span class="op">[</span><span class="dv">1000001</span><span class="op">],</span> invfact<span class="op">[</span><span class="dv">1000001</span><span class="op">],</span> inv<span class="op">[</span><span class="dv">1000001</span><span class="op">];</span></span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>    build_tables<span class="op">(</span>N<span class="op">,</span> fact<span class="op">,</span> invfact<span class="op">,</span> inv<span class="op">);</span></span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> nCr_mod<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> fact<span class="op">,</span> invfact<span class="op">));</span> <span class="co">// 120</span></span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-47" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-47">Why It Matters</h4>
<ul>
<li>Fast combinatorics: <span class="math inline">\(\binom{n}{r}\)</span>, permutations, multinomials in <span class="math inline">\(O(1)\)</span></li>
<li>DP under modulo: convolution like transitions, counting paths</li>
<li>Number theory: modular inverses and powers ready on demand</li>
<li>Competitive programming and crypto prototypes where repeated modular queries are common</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-47" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-47">A Gentle Proof (Why It Works)</h4>
<p>For prime <span class="math inline">\(M\)</span>, <span class="math inline">\(\mathbb{Z}_M^\times\)</span> is a field. Fermat gives <span class="math inline">\(a^{M-2}\equiv a^{-1}\pmod M\)</span> for <span class="math inline">\(a \not\equiv 0\)</span>. Backward fill yields <span class="math inline">\(\text{invfact}[i-1]=\text{invfact}[i]\cdot i \bmod M\)</span>, hence <span class="math inline">\((i-1)!^{-1}\)</span>. Then <span class="math display">\[
\binom{n}{r} = \frac{n!}{r!,(n-r)!} \equiv \text{fact}[n]\cdot \text{invfact}[r]\cdot \text{invfact}[n-r] \pmod M.
\]</span> The linear inverse identity follows from writing <span class="math inline">\(i\cdot \text{inv}[i]\equiv 1\)</span> and recursing on <span class="math inline">\(M\bmod i\)</span>.</p>
</section>
<section id="try-it-yourself-47" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-47">Try It Yourself</h4>
<ol type="1">
<li>Precompute up to <span class="math inline">\(N=10^7\)</span> with memory tuning and check that <span class="math inline">\(\sum_{r=0}^n \binom{n}{r}\equiv 2^n \pmod M\)</span>.</li>
<li>Add a table of powers <code>powA[i]</code> for a fixed base <span class="math inline">\(A\)</span> to answer <span class="math inline">\(A^k \bmod M\)</span> in <span class="math inline">\(O(1)\)</span>.</li>
<li>Implement multinomial: <span class="math inline">\(\frac{n!}{a_1!\cdots a_k!}\)</span> via <code>fact</code> and <code>invfact</code>.</li>
<li>For composite <span class="math inline">\(M\)</span>, factor <span class="math inline">\(M=\prod p_i^{e_i}\)</span>, compute modulo each <span class="math inline">\(p_i^{e_i}\)</span>, then combine with CRT.</li>
<li>Benchmark precompute once vs on-demand exponentiation per query.</li>
</ol>
</section>
<section id="test-cases-47" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-47">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Query</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\binom{10}{3}\bmod 10^9+7\)</span></td>
<td>120</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\binom{1000}{500}\bmod 10^9+7\)</span></td>
<td>computed in <span class="math inline">\(O(1)\)</span> from tables</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a^{-1}\bmod M\)</span> for <span class="math inline">\(a=123456\)</span></td>
<td><code>inv[a]</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A^k\bmod M\)</span> for many <span class="math inline">\(k\)</span></td>
<td><code>powA[k]</code> if precomputed</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-47" class="level4">
<h4 class="anchored" data-anchor-id="complexity-47">Complexity</h4>
<ul>
<li>Precompute: <span class="math inline">\(O(N)\)</span> time, <span class="math inline">\(O(N)\)</span> space</li>
<li>Per query: <span class="math inline">\(O(1)\)</span></li>
<li>One exp: a single <span class="math inline">\(O(\log M)\)</span> exponentiation to seed <code>invfact[N]</code> if you choose the backward method</li>
</ul>
<p>Modular precomputation turns heavy arithmetic into lookups. Pay once up front, answer instantly forever after.</p>
</section>
</section>
<section id="fermats-little-theorem" class="level3">
<h3 class="anchored" data-anchor-id="fermats-little-theorem">549 Fermat’s Little Theorem</h3>
<p>Fermat’s Little Theorem is the cornerstone of modular arithmetic. It states that if <span class="math inline">\(p\)</span> is a prime and <span class="math inline">\(a\)</span> is not divisible by <span class="math inline">\(p\)</span>, then:</p>
<p><span class="math display">\[
a^{p-1} \equiv 1 \pmod p
\]</span></p>
<p>This powerful relationship underpins modular inverses, primality tests, and exponentiation optimizations.</p>
<section id="what-problem-are-we-solving-48" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-48">What Problem Are We Solving?</h4>
<p>We often need to simplify or invert large modular expressions:</p>
<ul>
<li>Computing <span class="math inline">\(a^{-1} \bmod p\)</span></li>
<li>Simplifying huge exponents like <span class="math inline">\(a^k \bmod p\)</span></li>
<li>Verifying primality (Fermat, Miller–Rabin tests)</li>
</ul>
<p>Instead of performing expensive division, Fermat’s theorem gives us:</p>
<p><span class="math display">\[
a^{-1} \equiv a^{p-2} \pmod p
\]</span></p>
<p>So inversion becomes modular exponentiation, achievable in <span class="math inline">\(O(\log p)\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-48" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-48">How Does It Work (Plain Language)</h4>
<p>When <span class="math inline">\(p\)</span> is prime, multiplication modulo <span class="math inline">\(p\)</span> forms a group of <span class="math inline">\(p-1\)</span> elements (excluding <span class="math inline">\(0\)</span>). By Lagrange’s theorem, every element raised to the group size equals the identity:</p>
<p><span class="math display">\[
a^{p-1} \equiv 1 \pmod p
\]</span></p>
<p>Rearranging gives the modular inverse:</p>
<p><span class="math display">\[
a \cdot a^{p-2} \equiv 1 \pmod p
\]</span></p>
<p>So <span class="math inline">\(a^{p-2}\)</span> <em>is</em> the inverse of <span class="math inline">\(a\)</span> under mod <span class="math inline">\(p\)</span>.</p>
</section>
<section id="example-19" class="level4">
<h4 class="anchored" data-anchor-id="example-19">Example</h4>
<p>Let <span class="math inline">\(a=3\)</span>, <span class="math inline">\(p=7\)</span> (a prime):</p>
<p><span class="math display">\[
3^{6} = 729 \equiv 1 \pmod 7
\]</span></p>
<p>And indeed:</p>
<p><span class="math display">\[
3^{5} = 243 \equiv 5 \pmod 7
\]</span></p>
<p>Since <span class="math inline">\(3 \times 5 = 15 \equiv 1 \pmod 7\)</span>, <span class="math inline">\(5\)</span> is the modular inverse of <span class="math inline">\(3\)</span> mod <span class="math inline">\(7\)</span>.</p>
</section>
<section id="tiny-code-easy-versions-45" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-45">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modpow(a, e, m):</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e:</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>            r <span class="op">=</span> r <span class="op">*</span> a <span class="op">%</span> m</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">*</span> a <span class="op">%</span> m</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modinv(a, p):</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modpow(a, p <span class="op">-</span> <span class="dv">2</span>, p)  <span class="co"># Fermat's little theorem</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modpow(a, p <span class="op">-</span> <span class="dv">1</span>, p))  <span class="co"># should be 1</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modinv(a, p))         <span class="co"># should be 5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb110"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> modpow<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> e<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> r <span class="op">=</span> <span class="dv">1</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m<span class="op">;</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> r <span class="op">=</span> r <span class="op">*</span> a <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">*</span> a <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> modinv<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modpow<span class="op">(</span>a<span class="op">,</span> p <span class="op">-</span> <span class="dv">2</span><span class="op">,</span> p<span class="op">);</span> <span class="co">// Fermat's Little Theorem</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> a <span class="op">=</span> <span class="dv">3</span><span class="op">,</span> p <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"a^(p-1) mod p = </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> modpow<span class="op">(</span>a<span class="op">,</span> p <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> p<span class="op">));</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Inverse = </span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> modinv<span class="op">(</span>a<span class="op">,</span> p<span class="op">));</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-48" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-48">Why It Matters</h4>
<ul>
<li>Modular Inverses: Key for division under modulus (e.g., in combinatorics <span class="math inline">\(\binom{n}{r}\)</span> mod <span class="math inline">\(p\)</span>).</li>
<li>Exponent Reduction: For large exponents, use periodicity modulo <span class="math inline">\(p-1\)</span>.</li>
<li>Primality Tests: Forms the basis of Fermat and Miller–Rabin tests.</li>
<li>RSA &amp; Cryptography: Central to modular arithmetic with primes.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-48" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-48">A Gentle Proof (Why It Works)</h4>
<p>Consider all residues <span class="math inline">\({1,2,\ldots,p-1}\)</span> modulo prime <span class="math inline">\(p\)</span>. Multiplying each by <span class="math inline">\(a\)</span> (where <span class="math inline">\(\gcd(a,p)=1\)</span>) permutes them. Thus:</p>
<p><span class="math display">\[
1\cdot2\cdots(p-1) \equiv (a\cdot1)(a\cdot2)\cdots(a\cdot(p-1)) \pmod p
\]</span></p>
<p>Cancelling <span class="math inline">\((p-1)!\)</span> (nonzero mod <span class="math inline">\(p\)</span> by Wilson’s theorem) yields:</p>
<p><span class="math display">\[
a^{p-1} \equiv 1 \pmod p
\]</span></p>
</section>
<section id="try-it-yourself-48" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-48">Try It Yourself</h4>
<ol type="1">
<li>Verify <span class="math inline">\(a^{p-1}\equiv 1\)</span> for various primes <span class="math inline">\(p\)</span> and bases <span class="math inline">\(a\)</span>.</li>
<li>Use it to compute modular inverses: test <span class="math inline">\(a^{p-2}\)</span> for different <span class="math inline">\(a\)</span>.</li>
<li>Combine with modular exponentiation to speed up combinatorial formulas.</li>
<li>Explore what fails when <span class="math inline">\(p\)</span> is composite (Fermat pseudoprimes).</li>
<li>Implement Fermat primality test using <span class="math inline">\(a^{p-1}\bmod p\)</span>.</li>
</ol>
</section>
<section id="test-cases-48" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-48">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(a\)</span></th>
<th><span class="math inline">\(p\)</span></th>
<th><span class="math inline">\(a^{p-1}\bmod p\)</span></th>
<th><span class="math inline">\(a^{p-2}\bmod p\)</span> (inverse)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>5</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td>3</td>
<td>7</td>
<td>1</td>
<td>5</td>
</tr>
<tr class="odd">
<td>4</td>
<td>11</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td>10</td>
<td>13</td>
<td>1</td>
<td>4</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-48" class="level4">
<h4 class="anchored" data-anchor-id="complexity-48">Complexity</h4>
<ul>
<li>Modular Exponentiation: <span class="math inline">\(O(\log p)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Fermat’s Little Theorem transforms division into exponentiation, bringing algebraic structure into computational arithmetic.</p>
</section>
</section>
<section id="wilsons-theorem" class="level3">
<h3 class="anchored" data-anchor-id="wilsons-theorem">550 Wilson’s Theorem</h3>
<p>Wilson’s Theorem gives a remarkable characterization of prime numbers using factorials:</p>
<p><span class="math display">\[
(p-1)! \equiv -1 \pmod p
\]</span></p>
<p>That is, for a prime <span class="math inline">\(p\)</span>, the factorial of <span class="math inline">\((p-1)\)</span> leaves a remainder of <span class="math inline">\(p-1\)</span> (or equivalently <span class="math inline">\(-1\)</span>) when divided by <span class="math inline">\(p\)</span>.</p>
<p>Conversely, if this congruence holds, <span class="math inline">\(p\)</span> must be prime.</p>
<section id="what-problem-are-we-solving-49" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-49">What Problem Are We Solving?</h4>
<p>We want a way to test primality or understand modular inverses through factorials.</p>
<p>While it’s not practical for large primes due to factorial growth, Wilson’s theorem is conceptually elegant and connects factorials, inverses, and modular arithmetic beautifully.</p>
<p>It shows how the multiplicative structure modulo <span class="math inline">\(p\)</span> is cyclic and symmetric.</p>
</section>
<section id="how-does-it-work-plain-language-49" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-49">How Does It Work (Plain Language)</h4>
<p>For a prime <span class="math inline">\(p\)</span>, every number <span class="math inline">\(1,2,\dots,p-1\)</span> has a unique inverse modulo <span class="math inline">\(p\)</span>, and only <span class="math inline">\(1\)</span> and <span class="math inline">\(p-1\)</span> are self-inverse.</p>
<p>When we multiply all of them together:</p>
<ul>
<li>Each pair <span class="math inline">\(a \cdot a^{-1}\)</span> contributes <span class="math inline">\(1\)</span></li>
<li><span class="math inline">\(1\)</span> and <span class="math inline">\((p-1)\)</span> contribute <span class="math inline">\(1\)</span> and <span class="math inline">\((p-1)\)</span></li>
</ul>
<p>So the whole product becomes:</p>
<p><span class="math display">\[
(p-1)! \equiv 1 \cdot (p-1) \equiv -1 \pmod p
\]</span></p>
</section>
<section id="example-20" class="level4">
<h4 class="anchored" data-anchor-id="example-20">Example</h4>
<p>Let’s test small primes:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(p\)</span></th>
<th><span class="math inline">\((p-1)!\)</span></th>
<th><span class="math inline">\((p-1)! \bmod p\)</span></th>
<th>Check</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>1</td>
<td>1 ≡ -1 mod 2</td>
<td>✔</td>
</tr>
<tr class="even">
<td>3</td>
<td>2</td>
<td>2 ≡ -1 mod 3</td>
<td>✔</td>
</tr>
<tr class="odd">
<td>5</td>
<td>24</td>
<td>24 ≡ -1 mod 5</td>
<td>✔</td>
</tr>
<tr class="even">
<td>7</td>
<td>720</td>
<td>720 ≡ -1 mod 7</td>
<td>✔</td>
</tr>
<tr class="odd">
<td>11</td>
<td>10! = 3628800</td>
<td>3628800 ≡ -1 mod 11</td>
<td>✔</td>
</tr>
</tbody>
</table>
<p>Try a composite <span class="math inline">\(p=6\)</span>: <span class="math inline">\(5! = 120\)</span>, and <span class="math inline">\(120 \bmod 6 = 0\)</span> → fails.</p>
<p>So Wilson’s condition is both necessary and sufficient for primality.</p>
</section>
<section id="tiny-code-easy-versions-46" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-46">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> factorial_mod(n, m):</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> (res <span class="op">*</span> i) <span class="op">%</span> m</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_prime_wilson(p):</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> p <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> factorial_mod(p <span class="op">-</span> <span class="dv">1</span>, p) <span class="op">==</span> p <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">11</span>]:</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(p, is_prime_wilson(p))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb112"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> factorial_mod<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> mod<span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> <span class="op">(</span>res <span class="op">*</span> i<span class="op">)</span> <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> is_prime_wilson<span class="op">(</span><span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>p <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> factorial_mod<span class="op">(</span>p <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> p<span class="op">)</span> <span class="op">==</span> p <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ps<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">11</span><span class="op">};</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">6</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%s\n</span><span class="st">"</span><span class="op">,</span> ps<span class="op">[</span>i<span class="op">],</span> is_prime_wilson<span class="op">(</span>ps<span class="op">[</span>i<span class="op">])</span> <span class="op">?</span> <span class="st">"prime"</span> <span class="op">:</span> <span class="st">"composite"</span><span class="op">);</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-49" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-49">Why It Matters</h4>
<p>Wilson’s Theorem connects combinatorics, modular arithmetic, and primality:</p>
<ul>
<li>Primality characterization: <span class="math inline">\(p\)</span> is prime <span class="math inline">\(\iff (p-1)! \equiv -1 \pmod p\)</span></li>
<li>Proof of group structure: <span class="math inline">\((\mathbb{Z}/p\mathbb{Z})^\times\)</span> is a multiplicative group</li>
<li>Factorial inverses: <span class="math inline">\((p-1)!\)</span> acts as <span class="math inline">\(-1\)</span>, enabling certain modular proofs</li>
</ul>
<p>Though inefficient for large <span class="math inline">\(p\)</span>, it’s conceptually vital in number theory.</p>
</section>
<section id="a-gentle-proof-why-it-works-49" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-49">A Gentle Proof (Why It Works)</h4>
<p>Let <span class="math inline">\(p\)</span> be prime. The set <span class="math inline">\({1, 2, \dots, p-1}\)</span> under multiplication mod <span class="math inline">\(p\)</span> forms a group.</p>
<p>Each element <span class="math inline">\(a\)</span> has an inverse <span class="math inline">\(a^{-1}\)</span>. Multiplying all elements:</p>
<p><span class="math display">\[
(p-1)! \equiv \prod_{a=1}^{p-1} a \equiv \prod_{a=1}^{p-1} a^{-1} \equiv (p-1)!^{-1} \pmod p
\]</span></p>
<p>Thus:</p>
<p><span class="math display">\[
((p-1)!)^2 \equiv 1 \pmod p
\]</span></p>
<p>So <span class="math inline">\((p-1)! \equiv \pm 1\)</span>. If <span class="math inline">\((p-1)! \equiv 1\)</span>, then all numbers are self-inverse, only possible for <span class="math inline">\(p=2\)</span>. For <span class="math inline">\(p&gt;2\)</span>, it must be <span class="math inline">\(-1\)</span>.</p>
<p>Conversely, if <span class="math inline">\((p-1)! \equiv -1\)</span>, <span class="math inline">\(p\)</span> cannot be composite (since composite factorials are <span class="math inline">\(0 \bmod p\)</span>).</p>
</section>
<section id="try-it-yourself-49" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-49">Try It Yourself</h4>
<ol type="1">
<li>Verify <span class="math inline">\((p-1)! \bmod p\)</span> for small primes.</li>
<li>Check why it fails for <span class="math inline">\(p=4,6,8,9\)</span>.</li>
<li>Explore what happens mod a composite number (factorial will include factors of <span class="math inline">\(p\)</span>).</li>
<li>Use it to show <span class="math inline">\((p-1)! + 1\)</span> is divisible by <span class="math inline">\(p\)</span>.</li>
<li>Try optimizing factorial modulo <span class="math inline">\(p\)</span> for small ranges.</li>
</ol>
</section>
<section id="test-cases-49" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-49">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(p\)</span></th>
<th><span class="math inline">\((p-1)!\)</span></th>
<th><span class="math inline">\((p-1)! \bmod p\)</span></th>
<th>Prime?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>1</td>
<td>1</td>
<td>✔</td>
</tr>
<tr class="even">
<td>3</td>
<td>2</td>
<td>2</td>
<td>✔</td>
</tr>
<tr class="odd">
<td>4</td>
<td>6</td>
<td>2</td>
<td>✖</td>
</tr>
<tr class="even">
<td>5</td>
<td>24</td>
<td>4</td>
<td>✔</td>
</tr>
<tr class="odd">
<td>6</td>
<td>120</td>
<td>0</td>
<td>✖</td>
</tr>
<tr class="even">
<td>7</td>
<td>720</td>
<td>6</td>
<td>✔</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-49" class="level4">
<h4 class="anchored" data-anchor-id="complexity-49">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(p)\)</span> (factorial modulo computation)</li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Though inefficient for primality testing, Wilson’s Theorem beautifully bridges factorials, inverses, and primes, a gem of elementary number theory.</p>
</section>
</section>
</section>
<section id="section-56.-linear-algebra" class="level1">
<h1>Section 56. Linear Algebra</h1>
<section id="gaussian-elimination" class="level3">
<h3 class="anchored" data-anchor-id="gaussian-elimination">551 Gaussian Elimination</h3>
<p>Gaussian Elimination is the fundamental algorithm for solving systems of linear equations, computing determinants, and finding matrix rank. It systematically transforms a given matrix into an upper triangular form using row operations, after which solutions can be found by back-substitution.</p>
<section id="what-problem-are-we-solving-50" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-50">What Problem Are We Solving?</h4>
<p>We want to solve a system of <span class="math inline">\(n\)</span> linear equations in <span class="math inline">\(n\)</span> variables:</p>
<p><span class="math display">\[
A\mathbf{x} = \mathbf{b}
\]</span></p>
<p>where <span class="math inline">\(A\)</span> is an <span class="math inline">\(n \times n\)</span> matrix, <span class="math inline">\(\mathbf{x}\)</span> is the vector of unknowns, <span class="math inline">\(\mathbf{b}\)</span> is the constant vector.</p>
<p>Instead of guessing or manually substituting, Gaussian elimination gives a systematic, deterministic, and polynomial-time method.</p>
</section>
<section id="how-does-it-work-plain-language-50" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-50">How Does It Work (Plain Language)</h4>
<p>We perform elementary row operations to simplify the augmented matrix <span class="math inline">\([A | b]\)</span>:</p>
<ol type="1">
<li><p>Forward Elimination</p>
<ul>
<li>For each column, select a pivot (nonzero element).</li>
<li>Swap rows if needed (partial pivoting).</li>
<li>Eliminate all entries below the pivot to make them zero.</li>
</ul></li>
<li><p>Back Substitution</p>
<ul>
<li>Once in upper-triangular form, solve from the last equation upward.</li>
</ul></li>
</ol>
<p>This converts the system into: <span class="math display">\[
U\mathbf{x} = \mathbf{c}
\]</span> where <span class="math inline">\(U\)</span> is upper triangular, easily solvable.</p>
</section>
<section id="example-21" class="level4">
<h4 class="anchored" data-anchor-id="example-21">Example</h4>
<p>Solve: <span class="math display">\[
\begin{cases}
2x + y - z = 8 \
-3x - y + 2z = -11 \
-2x + y + 2z = -3
\end{cases}
\]</span></p>
<p>Step 1: Write the augmented matrix</p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
2 &amp; 1 &amp; -1 &amp; 8 \\
-3 &amp; -1 &amp; 2 &amp; -11 \\
-2 &amp; 1 &amp; 2 &amp; -3
\end{array}
\right]
\]</span></p>
<p>Step 2: Eliminate below first pivot</p>
<p>Use pivot = 2 (row 1).</p>
<p><span class="math display">\[
R_2 \gets R_2 + \tfrac{3}{2}R_1,\qquad
R_3 \gets R_3 + R_1
\]</span></p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
2 &amp; 1 &amp; -1 &amp; 8 \\
0 &amp; \tfrac{1}{2} &amp; \tfrac{1}{2} &amp; 1 \\
0 &amp; 2 &amp; 1 &amp; 5
\end{array}
\right]
\]</span></p>
<p>Step 3: Eliminate below second pivot</p>
<p>Pivot = <span class="math inline">\(\tfrac{1}{2}\)</span> (row 2).</p>
<p><span class="math display">\[
R_3 \gets R_3 - 4R_2
\]</span></p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
2 &amp; 1 &amp; -1 &amp; 8 \\
0 &amp; \tfrac{1}{2} &amp; \tfrac{1}{2} &amp; 1 \\
0 &amp; 0 &amp; -1 &amp; 1
\end{array}
\right]
\]</span></p>
<p>Step 4: Back Substitution</p>
<p>From bottom up:</p>
<ul>
<li><span class="math inline">\(-z = 1 \implies z = -1\)</span></li>
<li><span class="math inline">\(0.5y + 0.5z = 1 \implies y = 3\)</span></li>
<li><span class="math inline">\(2x + y - z = 8 \implies 2x + 3 + 1 = 8 \implies x = 2\)</span></li>
</ul>
<p>Solution: <span class="math inline">\((x, y, z) = (2, 3, -1)\)</span></p>
</section>
<section id="tiny-code-easy-versions-47" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-47">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gaussian_elimination(a, b):</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Pivot</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>        max_row <span class="op">=</span> <span class="bu">max</span>(<span class="bu">range</span>(i, n), key<span class="op">=</span><span class="kw">lambda</span> r: <span class="bu">abs</span>(a[r][i]))</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>        a[i], a[max_row] <span class="op">=</span> a[max_row], a[i]</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>        b[i], b[max_row] <span class="op">=</span> b[max_row], b[i]</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Eliminate below</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>            factor <span class="op">=</span> a[j][i] <span class="op">/</span> a[i][i]</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i, n):</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>                a[j][k] <span class="op">-=</span> factor <span class="op">*</span> a[i][k]</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>            b[j] <span class="op">-=</span> factor <span class="op">*</span> b[i]</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Back substitution</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> n</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">-</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="op">=</span> (b[i] <span class="op">-</span> <span class="bu">sum</span>(a[i][j] <span class="op">*</span> x[j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n))) <span class="op">/</span> a[i][i]</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">2</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="op">-</span><span class="dv">3</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>]]</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> [<span class="dv">8</span>, <span class="op">-</span><span class="dv">11</span>, <span class="op">-</span><span class="dv">3</span>]</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gaussian_elimination(A, B))  <span class="co"># [2.0, 3.0, -1.0]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb114"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">3</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> gaussian_elimination<span class="op">(</span><span class="dt">double</span> a<span class="op">[</span>N<span class="op">][</span>N<span class="op">],</span> <span class="dt">double</span> b<span class="op">[</span>N<span class="op">],</span> <span class="dt">double</span> x<span class="op">[</span>N<span class="op">])</span> <span class="op">{</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Pivot</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> max_row <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> r <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> r <span class="op">&lt;</span> N<span class="op">;</span> r<span class="op">++)</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>a<span class="op">[</span>r<span class="op">][</span>i<span class="op">])</span> <span class="op">&gt;</span> fabs<span class="op">(</span>a<span class="op">[</span>max_row<span class="op">][</span>i<span class="op">]))</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>                max_row <span class="op">=</span> r<span class="op">;</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> c <span class="op">&lt;</span> N<span class="op">;</span> c<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> tmp <span class="op">=</span> a<span class="op">[</span>i<span class="op">][</span>c<span class="op">];</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>            a<span class="op">[</span>i<span class="op">][</span>c<span class="op">]</span> <span class="op">=</span> a<span class="op">[</span>max_row<span class="op">][</span>c<span class="op">];</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>            a<span class="op">[</span>max_row<span class="op">][</span>c<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> tmp <span class="op">=</span> b<span class="op">[</span>i<span class="op">];</span> b<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> b<span class="op">[</span>max_row<span class="op">];</span> b<span class="op">[</span>max_row<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Eliminate</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> factor <span class="op">=</span> a<span class="op">[</span>j<span class="op">][</span>i<span class="op">]</span> <span class="op">/</span> a<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> N<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">-=</span> factor <span class="op">*</span> a<span class="op">[</span>i<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>            b<span class="op">[</span>j<span class="op">]</span> <span class="op">-=</span> factor <span class="op">*</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Back substitution</span></span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> N <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>            sum <span class="op">+=</span> a<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">*</span> x<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>b<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> sum<span class="op">)</span> <span class="op">/</span> a<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">},</span> <span class="op">{-</span><span class="dv">3</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">},</span> <span class="op">{-</span><span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">}};</span></span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> B<span class="op">[</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">8</span><span class="op">,</span> <span class="op">-</span><span class="dv">11</span><span class="op">,</span> <span class="op">-</span><span class="dv">3</span><span class="op">},</span> X<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>    gaussian_elimination<span class="op">(</span>A<span class="op">,</span> B<span class="op">,</span> X<span class="op">);</span></span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"x = </span><span class="sc">%.2f</span><span class="st">, y = </span><span class="sc">%.2f</span><span class="st">, z = </span><span class="sc">%.2f\n</span><span class="st">"</span><span class="op">,</span> X<span class="op">[</span><span class="dv">0</span><span class="op">],</span> X<span class="op">[</span><span class="dv">1</span><span class="op">],</span> X<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-50" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-50">Why It Matters</h4>
<p>Gaussian elimination is foundational in:</p>
<ul>
<li>Solving <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span></li>
<li>Finding determinants (<span class="math inline">\(\det(A)\)</span> is product of pivots)</li>
<li>Finding inverse matrices (by applying elimination to <span class="math inline">\([A|I]\)</span>)</li>
<li>Computing matrix rank (count nonzero rows after elimination)</li>
</ul>
<p>It underpins linear algebra libraries (BLAS/LAPACK), numerical solvers, and symbolic computation.</p>
</section>
<section id="a-gentle-proof-why-it-works-50" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-50">A Gentle Proof (Why It Works)</h4>
<p>Each elementary row operation corresponds to multiplication by an invertible matrix <span class="math inline">\(E_i\)</span>. After a sequence: <span class="math display">\[
E_k \cdots E_1 A = U
\]</span> where <span class="math inline">\(U\)</span> is upper triangular. Then: <span class="math display">\[
A = E_1^{-1}\cdots E_k^{-1}U
\]</span> so the system <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> becomes <span class="math inline">\(U\mathbf{x} = (E_k\cdots E_1)\mathbf{b}\)</span>, which is solvable by back substitution.</p>
<p>Each step preserves solution space, ensuring correctness.</p>
</section>
<section id="try-it-yourself-50" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-50">Try It Yourself</h4>
<ol type="1">
<li>Solve a 3×3 system using Gaussian elimination manually.</li>
<li>Modify the algorithm to return determinant = product of pivots.</li>
<li>Extend to augmented matrix to compute inverse.</li>
<li>Add partial pivoting to handle zero pivots.</li>
<li>Compare with matrix decomposition (LU).</li>
</ol>
</section>
<section id="test-cases-50" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-50">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>System</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(2x+y-z=8,\ -3x-y+2z=-11,\ -2x+y+2z=-3\)</span></td>
<td><span class="math inline">\((2,3,-1)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x+y=2,\ 2x-y=0\)</span></td>
<td><span class="math inline">\((2/3,4/3)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x-y=1,\ 2x+y=4\)</span></td>
<td><span class="math inline">\((5/3,2/3)\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-50" class="level4">
<h4 class="anchored" data-anchor-id="complexity-50">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^3)\)</span></li>
<li>Space: <span class="math inline">\(O(n^2)\)</span></li>
</ul>
<p>Gaussian Elimination is the workhorse of linear algebra, every advanced solver builds upon it.</p>
</section>
</section>
<section id="gaussjordan-elimination" class="level3">
<h3 class="anchored" data-anchor-id="gaussjordan-elimination">552 Gauss–Jordan Elimination</h3>
<p>Gauss–Jordan Elimination extends Gaussian elimination by continuing the reduction process until the matrix is in reduced row echelon form (RREF), not just upper-triangular. This makes it ideal for finding inverses, testing linear independence, and solving systems directly without back-substitution.</p>
<section id="what-problem-are-we-solving-51" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-51">What Problem Are We Solving?</h4>
<p>We want a full, systematic method to:</p>
<ul>
<li>Solve <span class="math inline">\(A\mathbf{x} = \mathbf{b}\)</span></li>
<li>Find <span class="math inline">\(A^{-1}\)</span> (inverse matrix)</li>
<li>Identify rank, null space, and pivots</li>
</ul>
<p>Instead of stopping at an upper-triangular system (as in Gaussian elimination), we go further to make every pivot <span class="math inline">\(1\)</span> and clear all entries above and below it.</p>
</section>
<section id="how-does-it-work-plain-language-51" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-51">How Does It Work (Plain Language)</h4>
<ol type="1">
<li><p>Form the augmented matrix Combine <span class="math inline">\(A\)</span> and <span class="math inline">\(\mathbf{b}\)</span>: <span class="math inline">\([A | \mathbf{b}]\)</span></p></li>
<li><p>Forward elimination For each pivot column:</p>
<ul>
<li>Choose pivot (swap if needed)</li>
<li>Scale row so pivot = 1</li>
<li>Eliminate below (make zeros under pivot)</li>
</ul></li>
<li><p>Backward elimination For each pivot column (starting from last):</p>
<ul>
<li>Eliminate above (make zeros above pivot)</li>
</ul></li>
</ol>
<p>At the end, <span class="math inline">\(A\)</span> becomes the identity matrix and the right-hand side gives the solution vector.</p>
<p>If augmenting with <span class="math inline">\(I\)</span>, the right-hand side becomes <span class="math inline">\(A^{-1}\)</span>.</p>
</section>
<section id="example-22" class="level4">
<h4 class="anchored" data-anchor-id="example-22">Example</h4>
<p>Solve:</p>
<p><span class="math display">\[
\begin{cases}
x + y + z = 6 \\
2y + 5z = -4 \\
2x + 5y - z = 27
\end{cases}
\]</span></p>
<p>Step 1: Write augmented matrix</p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
1 &amp; 1 &amp; 1 &amp; 6 \\
0 &amp; 2 &amp; 5 &amp; -4 \\
2 &amp; 5 &amp; -1 &amp; 27
\end{array}
\right]
\]</span></p>
<p>Step 2: Eliminate below first pivot</p>
<p><span class="math inline">\(R_3 \gets R_3 - 2R_1\)</span></p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
1 &amp; 1 &amp; 1 &amp; 6 \\
0 &amp; 2 &amp; 5 &amp; -4 \\
0 &amp; 3 &amp; -3 &amp; 15
\end{array}
\right]
\]</span></p>
<p>Step 3: Pivot at row 2</p>
<p><span class="math inline">\(R_2 \gets \tfrac{1}{2}R_2\)</span></p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
1 &amp; 1 &amp; 1 &amp; 6 \\
0 &amp; 1 &amp; \tfrac{5}{2} &amp; -2 \\
0 &amp; 3 &amp; -3 &amp; 15
\end{array}
\right]
\]</span></p>
<p>Step 4: Eliminate below and above the second pivot</p>
<p><span class="math inline">\(R_3 \gets R_3 - 3R_2,\quad R_1 \gets R_1 - R_2\)</span></p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
1 &amp; 0 &amp; -\tfrac{3}{2} &amp; 8 \\
0 &amp; 1 &amp; \tfrac{5}{2} &amp; -2 \\
0 &amp; 0 &amp; -\tfrac{21}{2} &amp; 21
\end{array}
\right]
\]</span></p>
<p>Normalize third pivot</p>
<p><span class="math inline">\(R_3 \gets -\tfrac{2}{21} R_3\)</span></p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
1 &amp; 0 &amp; -\tfrac{3}{2} &amp; 8 \\
0 &amp; 1 &amp; \tfrac{5}{2} &amp; -2 \\
0 &amp; 0 &amp; 1 &amp; -2
\end{array}
\right]
\]</span></p>
<p>Eliminate above the third pivot</p>
<p><span class="math inline">\(R_1 \gets R_1 + \tfrac{3}{2}R_3,\quad R_2 \gets R_2 - \tfrac{5}{2}R_3\)</span></p>
<p><span class="math display">\[
\left[
\begin{array}{rrr|r}
1 &amp; 0 &amp; 0 &amp; 5 \\
0 &amp; 1 &amp; 0 &amp; 3 \\
0 &amp; 0 &amp; 1 &amp; -2
\end{array}
\right]
\]</span></p>
<p>Solution:</p>
<p><span class="math display">\[
x=5,\quad y=3,\quad z=-2
\]</span></p>
</section>
<section id="tiny-code-easy-versions-48" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-48">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gauss_jordan(a, b):</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Augment A with b</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>        a[i].append(b[i])</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Pivot selection</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>        max_row <span class="op">=</span> <span class="bu">max</span>(<span class="bu">range</span>(i, n), key<span class="op">=</span><span class="kw">lambda</span> r: <span class="bu">abs</span>(a[r][i]))</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>        a[i], a[max_row] <span class="op">=</span> a[max_row], a[i]</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Normalize pivot row</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>        pivot <span class="op">=</span> a[i][i]</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>            a[i][j] <span class="op">/=</span> pivot</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Eliminate all other rows</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> k <span class="op">!=</span> i:</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>                factor <span class="op">=</span> a[k][i]</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>                    a[k][j] <span class="op">-=</span> factor <span class="op">*</span> a[i][j]</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract solution</span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [a[i][n] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>     [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>],</span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>     [<span class="dv">2</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> [<span class="dv">6</span>, <span class="op">-</span><span class="dv">4</span>, <span class="dv">27</span>]</span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gauss_jordan(A, B))  <span class="co"># [5.0, 3.0, -2.0]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb116"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">3</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> gauss_jordan<span class="op">(</span><span class="dt">double</span> a<span class="op">[</span>N<span class="op">][</span>N<span class="op">+</span><span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Pivot selection</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> max_row <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> r <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> r <span class="op">&lt;</span> N<span class="op">;</span> r<span class="op">++)</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>a<span class="op">[</span>r<span class="op">][</span>i<span class="op">])</span> <span class="op">&gt;</span> fabs<span class="op">(</span>a<span class="op">[</span>max_row<span class="op">][</span>i<span class="op">]))</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>                max_row <span class="op">=</span> r<span class="op">;</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> c <span class="op">&lt;=</span> N<span class="op">;</span> c<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> tmp <span class="op">=</span> a<span class="op">[</span>i<span class="op">][</span>c<span class="op">];</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>            a<span class="op">[</span>i<span class="op">][</span>c<span class="op">]</span> <span class="op">=</span> a<span class="op">[</span>max_row<span class="op">][</span>c<span class="op">];</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>            a<span class="op">[</span>max_row<span class="op">][</span>c<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Normalize pivot row</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> pivot <span class="op">=</span> a<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> c <span class="op">&lt;=</span> N<span class="op">;</span> c<span class="op">++)</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>            a<span class="op">[</span>i<span class="op">][</span>c<span class="op">]</span> <span class="op">/=</span> pivot<span class="op">;</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Eliminate other rows</span></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> r <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> r <span class="op">&lt;</span> N<span class="op">;</span> r<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>r <span class="op">!=</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>                <span class="dt">double</span> factor <span class="op">=</span> a<span class="op">[</span>r<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> c <span class="op">&lt;=</span> N<span class="op">;</span> c<span class="op">++)</span></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>                    a<span class="op">[</span>r<span class="op">][</span>c<span class="op">]</span> <span class="op">-=</span> factor <span class="op">*</span> a<span class="op">[</span>i<span class="op">][</span>c<span class="op">];</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">+</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">6</span><span class="op">},</span></span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="op">-</span><span class="dv">4</span><span class="op">},</span></span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">27</span><span class="op">}</span></span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>    gauss_jordan<span class="op">(</span>A<span class="op">);</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"x</span><span class="sc">%d</span><span class="st"> = </span><span class="sc">%.2f\n</span><span class="st">"</span><span class="op">,</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> A<span class="op">[</span>i<span class="op">][</span>N<span class="op">]);</span></span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-51" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-51">Why It Matters</h4>
<p>Gauss–Jordan Elimination is versatile:</p>
<ul>
<li>Direct solution without back-substitution</li>
<li>Matrix inversion by applying to <span class="math inline">\([A|I]\)</span></li>
<li>Rank computation (number of pivots)</li>
<li>Linear independence testing</li>
</ul>
<p>It’s conceptually clear and forms the basis for high-level linear algebra routines.</p>
</section>
<section id="a-gentle-proof-why-it-works-51" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-51">A Gentle Proof (Why It Works)</h4>
<p>Each row operation corresponds to multiplication by an invertible matrix <span class="math inline">\(E_i\)</span>. After full reduction: <span class="math display">\[
E_k \cdots E_1 [A | I] = [I | A^{-1}]
\]</span> Thus, <span class="math inline">\(A^{-1} = E_k \cdots E_1\)</span>. The method transforms <span class="math inline">\(A\)</span> into <span class="math inline">\(I\)</span> through reversible operations, so the right-hand side evolves into <span class="math inline">\(A^{-1}\)</span>.</p>
<p>For <span class="math inline">\(A\mathbf{x} = \mathbf{b}\)</span>, augmenting <span class="math inline">\(A\)</span> with <span class="math inline">\(\mathbf{b}\)</span> gives the unique solution vector.</p>
</section>
<section id="try-it-yourself-51" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-51">Try It Yourself</h4>
<ol type="1">
<li>Solve <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> using full RREF.</li>
<li>Augment <span class="math inline">\(A\)</span> with <span class="math inline">\(I\)</span> and compute <span class="math inline">\(A^{-1}\)</span>.</li>
<li>Count nonzero rows to find rank.</li>
<li>Implement with partial pivoting for stability.</li>
<li>Compare with LU decomposition in performance.</li>
</ol>
</section>
<section id="test-cases-51" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-51">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>System</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x+y+z=6,\ 2y+5z=-4,\ 2x+5y-z=27\)</span></td>
<td><span class="math inline">\((5,3,-2)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x+y=2,\ 3x-2y=1\)</span></td>
<td><span class="math inline">\((1,1)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2x+y=5,\ 4x-2y=6\)</span></td>
<td><span class="math inline">\((2,1)\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-51" class="level4">
<h4 class="anchored" data-anchor-id="complexity-51">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^3)\)</span></li>
<li>Space: <span class="math inline">\(O(n^2)\)</span></li>
</ul>
<p>Gauss–Jordan is a complete solver, producing identity on the left, and solution or inverse on the right, all in one pass.</p>
</section>
</section>
<section id="lu-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="lu-decomposition">553 LU Decomposition</h3>
<p>LU Decomposition factors a matrix <span class="math inline">\(A\)</span> into the product of a lower triangular matrix <span class="math inline">\(L\)</span> and an upper triangular matrix <span class="math inline">\(U\)</span>:</p>
<p><span class="math display">\[
A = L \cdot U
\]</span></p>
<p>This factorization is a workhorse of numerical linear algebra. Once <span class="math inline">\(A\)</span> is decomposed, we can solve systems <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> quickly for multiple right-hand sides by forward and backward substitution.</p>
<section id="what-problem-are-we-solving-52" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-52">What Problem Are We Solving?</h4>
<p>We want to solve <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> efficiently and repeatedly.</p>
<p>Gaussian elimination works once, but LU decomposition reuses the factorization:</p>
<ul>
<li>First solve <span class="math inline">\(L\mathbf{y}=\mathbf{b}\)</span> (forward substitution)</li>
<li>Then solve <span class="math inline">\(U\mathbf{x}=\mathbf{y}\)</span> (back substitution)</li>
</ul>
<p>Also useful for:</p>
<ul>
<li>Determinant computation (<span class="math inline">\(\det(A)=\det(L)\det(U)\)</span>)</li>
<li>Matrix inversion</li>
<li>Numerical stability with pivoting (<span class="math inline">\(PA=LU\)</span>)</li>
</ul>
</section>
<section id="how-does-it-work-plain-language-52" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-52">How Does It Work (Plain Language)</h4>
<p>LU decomposition performs the same operations as Gaussian elimination but records the multipliers in <span class="math inline">\(L\)</span>.</p>
<ol type="1">
<li><p>Initialize</p>
<ul>
<li><span class="math inline">\(L\)</span> as identity</li>
<li><span class="math inline">\(U\)</span> as a copy of <span class="math inline">\(A\)</span></li>
</ul></li>
<li><p>Eliminate below each pivot</p>
<ul>
<li><p>For <span class="math inline">\(i\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(n-1\)</span>:</p>
<ul>
<li>For <span class="math inline">\(j&gt;i\)</span>: <span class="math inline">\(L[j][i] = U[j][i] / U[i][i]\)</span> Subtract <span class="math inline">\(L[j][i] \times\)</span> (row <span class="math inline">\(i\)</span>) from row <span class="math inline">\(j\)</span> of <span class="math inline">\(U\)</span></li>
</ul></li>
</ul></li>
</ol>
<p>At the end:</p>
<ul>
<li><span class="math inline">\(L\)</span> has ones on the diagonal and multipliers below.</li>
<li><span class="math inline">\(U\)</span> is upper triangular.</li>
</ul>
<p>If <span class="math inline">\(A\)</span> requires row swaps for stability, we include a permutation matrix <span class="math inline">\(P\)</span>: <span class="math display">\[
PA = LU
\]</span></p>
</section>
<section id="example-23" class="level4">
<h4 class="anchored" data-anchor-id="example-23">Example</h4>
<p>Decompose <span class="math display">\[
A = \begin{bmatrix}
2 &amp; 3 &amp; 1\
4 &amp; 7 &amp; 7\
-2 &amp; 4 &amp; 5
\end{bmatrix}
\]</span></p>
<p>Step 1: Pivot at <span class="math inline">\(a_{11}=2\)</span></p>
<p>Eliminate below:</p>
<ul>
<li>Row 2: <span class="math inline">\(L_{21}=4/2=2\)</span> → Row2 = Row2 - 2*Row1</li>
<li>Row 3: <span class="math inline">\(L_{31}=-2/2=-1\)</span> → Row3 = Row3 + Row1</li>
</ul>
<p><span class="math inline">\(L = \begin{bmatrix}
1 &amp; 0 &amp; 0\
2 &amp; 1 &amp; 0\
-1 &amp; 0 &amp; 1
\end{bmatrix},\
U = \begin{bmatrix}
2 &amp; 3 &amp; 1\
0 &amp; 1 &amp; 5\
0 &amp; 7 &amp; 6
\end{bmatrix}\)</span></p>
<p>Step 2: Pivot at <span class="math inline">\(U_{22}=1\)</span></p>
<p>Eliminate below:</p>
<ul>
<li>Row3: <span class="math inline">\(L_{32}=7/1=7\)</span> → Row3 = Row3 - 7*Row2</li>
</ul>
<p><span class="math inline">\(L = \begin{bmatrix}
1 &amp; 0 &amp; 0\
2 &amp; 1 &amp; 0\
-1 &amp; 7 &amp; 1
\end{bmatrix},\
U = \begin{bmatrix}
2 &amp; 3 &amp; 1\
0 &amp; 1 &amp; 5\
0 &amp; 0 &amp; -29
\end{bmatrix}\)</span></p>
<p>Check: <span class="math inline">\(A = L \cdot U\)</span></p>
</section>
<section id="tiny-code-easy-versions-49" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-49">Tiny Code (Easy Versions)</h4>
<p>Python Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lu_decompose(A):</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> [[<span class="dv">0</span>]<span class="op">*</span>n <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> [[<span class="dv">0</span>]<span class="op">*</span>n <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>        L[i][i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Upper Triangular</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i, n):</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>            U[i][k] <span class="op">=</span> A[i][k] <span class="op">-</span> <span class="bu">sum</span>(L[i][j] <span class="op">*</span> U[j][k] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i))</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Lower Triangular</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>            L[k][i] <span class="op">=</span> (A[k][i] <span class="op">-</span> <span class="bu">sum</span>(L[k][j] <span class="op">*</span> U[j][i] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i))) <span class="op">/</span> U[i][i]</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> L, U</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>],</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">7</span>],</span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>L, U <span class="op">=</span> lu_decompose(A)</span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"L ="</span>, L)</span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"U ="</span>, U)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C Version</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb118"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">3</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> lu_decompose<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">],</span> <span class="dt">double</span> L<span class="op">[</span>N<span class="op">][</span>N<span class="op">],</span> <span class="dt">double</span> U<span class="op">[</span>N<span class="op">][</span>N<span class="op">])</span> <span class="op">{</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>            L<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>i <span class="op">==</span> j<span class="op">)</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>            U<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> N<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>                sum <span class="op">+=</span> L<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">*</span> U<span class="op">[</span>j<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>            U<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">-</span> sum<span class="op">;</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;</span> N<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>                sum <span class="op">+=</span> L<span class="op">[</span>k<span class="op">][</span>j<span class="op">]</span> <span class="op">*</span> U<span class="op">[</span>j<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>            L<span class="op">[</span>k<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>A<span class="op">[</span>k<span class="op">][</span>i<span class="op">]</span> <span class="op">-</span> sum<span class="op">)</span> <span class="op">/</span> U<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">1</span><span class="op">},{</span><span class="dv">4</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">7</span><span class="op">},{-</span><span class="dv">2</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">5</span><span class="op">}},</span> L<span class="op">[</span>N<span class="op">][</span>N<span class="op">],</span> U<span class="op">[</span>N<span class="op">][</span>N<span class="op">];</span></span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a>    lu_decompose<span class="op">(</span>A<span class="op">,</span> L<span class="op">,</span> U<span class="op">);</span></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"L:</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++){</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>N<span class="op">;</span>j<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%6.2f</span><span class="st"> "</span><span class="op">,</span>L<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"U:</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++){</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>N<span class="op">;</span>j<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%6.2f</span><span class="st"> "</span><span class="op">,</span>U<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-52" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-52">Why It Matters</h4>
<ul>
<li>Fast solving: Reuse <span class="math inline">\(LU\)</span> to solve for multiple <span class="math inline">\(\mathbf{b}\)</span></li>
<li>Determinant: <span class="math inline">\(\det(A)=\prod_i U_{ii}\)</span></li>
<li>Inverse: Solve <span class="math inline">\(LU\mathbf{x}=\mathbf{e}_i\)</span> for each <span class="math inline">\(i\)</span></li>
<li>Foundation: Basis of Cholesky, Crout, and Doolittle variants</li>
<li>Stability: Combine with pivoting for robustness (<span class="math inline">\(PA=LU\)</span>)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-52" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-52">A Gentle Proof (Why It Works)</h4>
<p>Each elimination step corresponds to multiplying <span class="math inline">\(A\)</span> by an elementary lower-triangular matrix <span class="math inline">\(E_i\)</span>. After all steps: <span class="math display">\[
U = E_k E_{k-1} \cdots E_1 A
\]</span> Then <span class="math display">\[
A = E_1^{-1} E_2^{-1} \cdots E_k^{-1} U
\]</span> Let <span class="math display">\[
L = E_1^{-1}E_2^{-1}\cdots E_k^{-1}
\]</span> so <span class="math inline">\(A = L U\)</span>, with <span class="math inline">\(L\)</span> lower-triangular (unit diagonal) and <span class="math inline">\(U\)</span> upper-triangular.</p>
</section>
<section id="try-it-yourself-52" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-52">Try It Yourself</h4>
<ol type="1">
<li>Perform LU decomposition on a <span class="math inline">\(3\times3\)</span> matrix by hand.</li>
<li>Verify <span class="math inline">\(A = L \cdot U\)</span> by multiplication.</li>
<li>Solve <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> via forward + backward substitution.</li>
<li>Implement determinant computation via <span class="math inline">\(\prod U_{ii}\)</span>.</li>
<li>Add partial pivoting (compute <span class="math inline">\(P,L,U\)</span>).</li>
</ol>
</section>
<section id="test-cases-52" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-52">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(A\)</span></th>
<th><span class="math inline">\(L\)</span></th>
<th><span class="math inline">\(U\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix} 2 &amp; 3 \\ 4 &amp; 7 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(\begin{bmatrix} 1 &amp; 0 \\ 2 &amp; 1 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(\begin{bmatrix} 2 &amp; 3 \\ 0 &amp; 1 \end{bmatrix}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\begin{bmatrix} 1 &amp; 1 \\ 2 &amp; 3 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(\begin{bmatrix} 1 &amp; 0 \\ 2 &amp; 1 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(\begin{bmatrix} 1 &amp; 1 \\ 0 &amp; 1 \end{bmatrix}\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-52" class="level4">
<h4 class="anchored" data-anchor-id="complexity-52">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^3)\)</span> (factorization)</li>
<li>Solve: <span class="math inline">\(O(n^2)\)</span> per right-hand side</li>
<li>Space: <span class="math inline">\(O(n^2)\)</span></li>
</ul>
<p>LU decomposition is the backbone of numerical linear algebra, turning Gaussian elimination into a reusable, modular tool.</p>
</section>
</section>
<section id="cholesky-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="cholesky-decomposition">554 Cholesky Decomposition</h3>
<p>Cholesky Decomposition is a special case of LU decomposition for symmetric positive definite (SPD) matrices. It factors a matrix <span class="math inline">\(A\)</span> into the product of a lower triangular matrix <span class="math inline">\(L\)</span> and its transpose:</p>
<p><span class="math display">\[
A = L \cdot L^{T}
\]</span></p>
<p>This method is twice as efficient as LU decomposition and numerically more stable for SPD matrices, a favorite in optimization, machine learning, and statistics.</p>
<section id="what-problem-are-we-solving-53" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-53">What Problem Are We Solving?</h4>
<p>We want to solve <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> efficiently when <span class="math inline">\(A\)</span> is symmetric (<span class="math inline">\(A=A^T\)</span>) and positive definite (<span class="math inline">\(\mathbf{x}^T A \mathbf{x} &gt; 0\)</span> for all <span class="math inline">\(\mathbf{x}\neq0\)</span>).</p>
<p>Instead of general elimination, we exploit symmetry to reduce work by half.</p>
<p>Once we find <span class="math inline">\(L\)</span>, we solve:</p>
<ul>
<li>Forward: <span class="math inline">\(L\mathbf{y}=\mathbf{b}\)</span></li>
<li>Backward: <span class="math inline">\(L^{T}\mathbf{x}=\mathbf{y}\)</span></li>
</ul>
</section>
<section id="how-does-it-work-plain-language-53" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-53">How Does It Work (Plain Language)</h4>
<p>We build <span class="math inline">\(L\)</span> row by row (or column by column), using the formulas:</p>
<p>For diagonal elements: <span class="math display">\[
L_{ii} = \sqrt{A_{ii} - \sum_{k=1}^{i-1}L_{ik}^2}
\]</span></p>
<p>For off-diagonal elements: <span class="math display">\[
L_{ij} = \frac{1}{L_{jj}}\Big(A_{ij} - \sum_{k=1}^{j-1}L_{ik}L_{jk}\Big), \quad i&gt;j
\]</span></p>
<p>The upper half is just the transpose of <span class="math inline">\(L\)</span>.</p>
</section>
<section id="example-24" class="level4">
<h4 class="anchored" data-anchor-id="example-24">Example</h4>
<p>Given <span class="math display">\[
A =
\begin{bmatrix}
4 &amp; 12 &amp; -16\
12 &amp; 37 &amp; -43\
-16 &amp; -43 &amp; 98
\end{bmatrix}
\]</span></p>
<p>Step 1: <span class="math inline">\(L_{11} = \sqrt{4} = 2\)</span></p>
<p>Step 2: <span class="math inline">\(L_{21} = 12/2 = 6\)</span>, <span class="math inline">\(L_{31} = -16/2 = -8\)</span></p>
<p>Step 3: <span class="math inline">\(L_{22} = \sqrt{37 - 6^2} = \sqrt{1} = 1\)</span></p>
<p>Step 4: <span class="math inline">\(L_{32} = \frac{-43 - (-8)(6)}{1} = 5\)</span></p>
<p>Step 5: <span class="math inline">\(L_{33} = \sqrt{98 - (-8)^2 - 5^2} = \sqrt{9} = 3\)</span></p>
<p>So: <span class="math display">\[
L =
\begin{bmatrix}
2 &amp; 0 &amp; 0\
6 &amp; 1 &amp; 0\
-8 &amp; 5 &amp; 3
\end{bmatrix}
,\quad
A = L \cdot L^{T}
\]</span></p>
</section>
<section id="tiny-code-easy-versions-50" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-50">Tiny Code (Easy Versions)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cholesky(A):</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>    L <span class="op">=</span> [[<span class="dv">0</span>]<span class="op">*</span>n <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>            s <span class="op">=</span> <span class="bu">sum</span>(L[i][k]<span class="op">*</span>L[j][k] <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(j))</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">==</span> j:</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>                L[i][j] <span class="op">=</span> math.sqrt(A[i][i] <span class="op">-</span> s)</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>                L[i][j] <span class="op">=</span> (A[i][j] <span class="op">-</span> s) <span class="op">/</span> L[j][j]</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> L</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">4</span>, <span class="dv">12</span>, <span class="op">-</span><span class="dv">16</span>],</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">12</span>, <span class="dv">37</span>, <span class="op">-</span><span class="dv">43</span>],</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="dv">16</span>, <span class="op">-</span><span class="dv">43</span>, <span class="dv">98</span>]</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> cholesky(A)</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> L:</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb120"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">3</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> cholesky<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">],</span> <span class="dt">double</span> L<span class="op">[</span>N<span class="op">][</span>N<span class="op">])</span> <span class="op">{</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> i<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> j<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>                sum <span class="op">+=</span> L<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">*</span> L<span class="op">[</span>j<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> j<span class="op">)</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>                L<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> sqrt<span class="op">(</span>A<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">-</span> sum<span class="op">);</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>                L<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">-</span> sum<span class="op">)</span> <span class="op">/</span> L<span class="op">[</span>j<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span><span class="dv">4</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="op">-</span><span class="dv">16</span><span class="op">},</span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span><span class="dv">12</span><span class="op">,</span> <span class="dv">37</span><span class="op">,</span> <span class="op">-</span><span class="dv">43</span><span class="op">},</span></span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">{-</span><span class="dv">16</span><span class="op">,</span> <span class="op">-</span><span class="dv">43</span><span class="op">,</span> <span class="dv">98</span><span class="op">}</span></span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">},</span> L<span class="op">[</span>N<span class="op">][</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>    cholesky<span class="op">(</span>A<span class="op">,</span> L<span class="op">);</span></span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"L:</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">"</span><span class="sc">%8.3f</span><span class="st"> "</span><span class="op">,</span> L<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-53" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-53">Why It Matters</h4>
<ul>
<li><p>Half the work of LU decomposition.</p></li>
<li><p>Numerically stable for SPD matrices.</p></li>
<li><p>Essential for:</p>
<ul>
<li>Least squares regression</li>
<li>Kalman filters</li>
<li>Gaussian processes</li>
<li>Covariance matrix decomposition</li>
</ul></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-53" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-53">A Gentle Proof (Why It Works)</h4>
<p>For an SPD matrix <span class="math inline">\(A\)</span>, all leading principal minors are positive. This guarantees every diagonal pivot (<span class="math inline">\(A_{ii} - \sum L_{ik}^2\)</span>) is positive, so we can take square roots.</p>
<p>Hence <span class="math inline">\(L\)</span> exists and is unique.</p>
<p>We can see <span class="math inline">\(A = L L^T\)</span> because every element <span class="math inline">\(A_{ij}\)</span> is reproduced by summing the dot product of row <span class="math inline">\(i\)</span> and row <span class="math inline">\(j\)</span> of <span class="math inline">\(L\)</span>.</p>
</section>
<section id="try-it-yourself-53" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-53">Try It Yourself</h4>
<ol type="1">
<li>Decompose a <span class="math inline">\(3\times3\)</span> SPD matrix by hand.</li>
<li>Multiply <span class="math inline">\(L L^T\)</span> to verify.</li>
<li>Use it to solve <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span>.</li>
<li>Compare runtime with LU decomposition.</li>
<li>Test on a covariance matrix (e.g.&nbsp;symmetric, positive).</li>
</ol>
</section>
<section id="test-case" class="level4">
<h4 class="anchored" data-anchor-id="test-case">Test Case</h4>
<p><span class="math display">\[
A =
\begin{bmatrix}
25 &amp; 15 &amp; -5\
15 &amp; 18 &amp;  0\
-5 &amp;  0 &amp; 11
\end{bmatrix}
\Rightarrow
L =
\begin{bmatrix}
5 &amp; 0 &amp; 0\
3 &amp; 3 &amp; 0\
-1 &amp; 1 &amp; 3
\end{bmatrix}
\]</span></p>
<p>Check: <span class="math inline">\(L L^T = A\)</span></p>
</section>
<section id="complexity-53" class="level4">
<h4 class="anchored" data-anchor-id="complexity-53">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^3/3)\)</span></li>
<li>Solve: <span class="math inline">\(O(n^2)\)</span></li>
<li>Space: <span class="math inline">\(O(n^2)\)</span></li>
</ul>
<p>Cholesky decomposition is your go-to method for fast, stable, and symmetric systems, a cornerstone in numerical analysis and machine learning.</p>
</section>
</section>
<section id="qr-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="qr-decomposition">555 QR Decomposition</h3>
<p>QR Decomposition breaks a matrix <span class="math inline">\(A\)</span> into two orthogonal factors:</p>
<p><span class="math display">\[
A = Q \cdot R
\]</span></p>
<p>where <span class="math inline">\(Q\)</span> is orthogonal (<span class="math inline">\(Q^T Q = I\)</span>) and <span class="math inline">\(R\)</span> is upper triangular. This decomposition is key in solving least squares problems, eigenvalue computations, and orthogonalization tasks.</p>
<section id="what-problem-are-we-solving-54" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-54">What Problem Are We Solving?</h4>
<p>We often need to solve <span class="math inline">\(A\mathbf{x} = \mathbf{b}\)</span> when <span class="math inline">\(A\)</span> is not square (e.g.&nbsp;<span class="math inline">\(m &gt; n\)</span>). Instead of normal equations <span class="math inline">\((A^TA)\mathbf{x}=A^T\mathbf{b}\)</span>, QR gives a more stable solution:</p>
<p><span class="math display">\[
A = Q R \implies R \mathbf{x} = Q^T \mathbf{b}
\]</span></p>
<p>No need to form <span class="math inline">\(A^T A\)</span>, which can amplify numerical errors.</p>
</section>
<section id="how-does-it-work-plain-language-54" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-54">How Does It Work (Plain Language)</h4>
<p>QR decomposition orthogonalizes the columns of <span class="math inline">\(A\)</span> step by step:</p>
<ol type="1">
<li>Start with columns <span class="math inline">\(a_1, a_2, \ldots, a_n\)</span> of <span class="math inline">\(A\)</span></li>
<li>Build orthogonal basis <span class="math inline">\(q_1, q_2, \ldots, q_n\)</span> using Gram–Schmidt</li>
<li>Normalize to get orthonormal columns of <span class="math inline">\(Q\)</span></li>
<li>Compute R as projection coefficients</li>
</ol>
<p>For each <span class="math inline">\(i\)</span>: <span class="math display">\[
r_{ii} = |a_i - \sum_{j=1}^{i-1}r_{ji}q_j|, \quad q_i = \frac{a_i - \sum_{j=1}^{i-1}r_{ji}q_j}{r_{ii}}
\]</span></p>
<p>Compactly:</p>
<ul>
<li><span class="math inline">\(Q\)</span>: orthonormal basis</li>
<li><span class="math inline">\(R\)</span>: upper-triangular coefficients</li>
</ul>
<p>Variants:</p>
<ul>
<li>Classical Gram–Schmidt (CGS): simple but unstable</li>
<li>Modified Gram–Schmidt (MGS): more stable</li>
<li>Householder reflections: best for numerical accuracy</li>
</ul>
</section>
<section id="example-25" class="level4">
<h4 class="anchored" data-anchor-id="example-25">Example</h4>
<p>Let <span class="math display">\[
A =
\begin{bmatrix}
1 &amp; 1 \
1 &amp; -1 \
1 &amp; 1
\end{bmatrix}
\]</span></p>
<p>Step 1: Take <span class="math inline">\(a_1 = (1, 1, 1)^T\)</span></p>
<p><span class="math display">\[
q_1 = \frac{a_1}{|a_1|} = \frac{1}{\sqrt{3}}(1, 1, 1)
\]</span></p>
<p>Step 2: Remove projection from <span class="math inline">\(a_2\)</span></p>
<p><span class="math display">\[
r_{12} = q_1^T a_2 = \frac{1}{\sqrt{3}}(1 + (-1) + 1) = \frac{1}{\sqrt{3}}
\]</span></p>
<p><span class="math display">\[
u_2 = a_2 - r_{12} q_1 = (1, -1, 1) - \frac{1}{\sqrt{3}}\cdot\frac{1}{\sqrt{3}}(1,1,1) = (1-\tfrac{1}{3}, -1-\tfrac{1}{3}, 1-\tfrac{1}{3})
\]</span></p>
<p><span class="math display">\[
u_2 = \left(\frac{2}{3}, -\frac{4}{3}, \frac{2}{3}\right)
\]</span></p>
<p>Normalize:</p>
<p><span class="math display">\[
q_2 = \frac{u_2}{|u_2|} = \frac{1}{\sqrt{8/3}} \left(\frac{2}{3}, -\frac{4}{3}, \frac{2}{3}\right) = \frac{1}{\sqrt{6}}(1, -2, 1)
\]</span></p>
<p>Then <span class="math inline">\(Q = [q_1\ q_2]\)</span>, <span class="math inline">\(R = Q^T A\)</span></p>
</section>
<section id="tiny-code-easy-versions-51" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-51">Tiny Code (Easy Versions)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> qr_decompose(A):</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> np.array(A, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    m, n <span class="op">=</span> A.shape</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>    Q <span class="op">=</span> np.zeros((m, n))</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> np.zeros((n, n))</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>        v <span class="op">=</span> A[:, i]</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i):</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>            R[j, i] <span class="op">=</span> np.dot(Q[:, j], A[:, i])</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>            v <span class="op">=</span> v <span class="op">-</span> R[j, i] <span class="op">*</span> Q[:, j]</span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>        R[i, i] <span class="op">=</span> np.linalg.norm(v)</span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>        Q[:, i] <span class="op">=</span> v <span class="op">/</span> R[i, i]</span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Q, R</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>]]</span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>Q, R <span class="op">=</span> qr_decompose(A)</span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Q =</span><span class="ch">\n</span><span class="st">"</span>, Q)</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R =</span><span class="ch">\n</span><span class="st">"</span>, R)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (Simplified Gram–Schmidt)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb122"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define M </span><span class="dv">3</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">2</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> qr_decompose<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span>M<span class="op">][</span>N<span class="op">],</span> <span class="dt">double</span> Q<span class="op">[</span>M<span class="op">][</span>N<span class="op">],</span> <span class="dt">double</span> R<span class="op">[</span>N<span class="op">][</span>N<span class="op">])</span> <span class="op">{</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> M<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>            Q<span class="op">[</span>k<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>k<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>            R<span class="op">[</span>j<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> M<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>                R<span class="op">[</span>j<span class="op">][</span>i<span class="op">]</span> <span class="op">+=</span> Q<span class="op">[</span>k<span class="op">][</span>j<span class="op">]</span> <span class="op">*</span> A<span class="op">[</span>k<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> M<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>                Q<span class="op">[</span>k<span class="op">][</span>i<span class="op">]</span> <span class="op">-=</span> R<span class="op">[</span>j<span class="op">][</span>i<span class="op">]</span> <span class="op">*</span> Q<span class="op">[</span>k<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>        R<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> M<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>            R<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">+=</span> Q<span class="op">[</span>k<span class="op">][</span>i<span class="op">]</span> <span class="op">*</span> Q<span class="op">[</span>k<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>        R<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> sqrt<span class="op">(</span>R<span class="op">[</span>i<span class="op">][</span>i<span class="op">]);</span></span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> M<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>            Q<span class="op">[</span>k<span class="op">][</span>i<span class="op">]</span> <span class="op">/=</span> R<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>M<span class="op">][</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">},{</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">},{</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">}},</span> Q<span class="op">[</span>M<span class="op">][</span>N<span class="op">],</span> R<span class="op">[</span>N<span class="op">][</span>N<span class="op">];</span></span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>    qr_decompose<span class="op">(</span>A<span class="op">,</span> Q<span class="op">,</span> R<span class="op">);</span></span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Q:</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>M<span class="op">;</span>i<span class="op">++){</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>N<span class="op">;</span>j<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%8.3f</span><span class="st"> "</span><span class="op">,</span> Q<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"R:</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++){</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>N<span class="op">;</span>j<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%8.3f</span><span class="st"> "</span><span class="op">,</span> R<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-54" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-54">Why It Matters</h4>
<ul>
<li>Numerical stability for least squares</li>
<li>Orthogonal basis for column space</li>
<li>Eigenvalue algorithms (QR iteration)</li>
<li>Machine learning: regression, PCA</li>
<li>Signal processing: orthogonalization, projections</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-54" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-54">A Gentle Proof (Why It Works)</h4>
<p>Every full-rank matrix <span class="math inline">\(A\)</span> with independent columns can be written as: <span class="math display">\[
A = [a_1, a_2, \ldots, a_n] = [q_1, q_2, \ldots, q_n] R
\]</span></p>
<p>Each <span class="math inline">\(a_i\)</span> is expressed as a linear combination of the orthogonal basis vectors <span class="math inline">\(q_j\)</span>: <span class="math display">\[
a_i = \sum_{j=1}^{i} r_{ji} q_j
\]</span></p>
<p>Collecting <span class="math inline">\(q_j\)</span> as columns of <span class="math inline">\(Q\)</span> gives <span class="math inline">\(A=QR\)</span>.</p>
</section>
<section id="try-it-yourself-54" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-54">Try It Yourself</h4>
<ol type="1">
<li>Orthogonalize two 3D vectors manually.</li>
<li>Verify <span class="math inline">\(Q^T Q = I\)</span>.</li>
<li>Compute <span class="math inline">\(R = Q^T A\)</span>.</li>
<li>Use <span class="math inline">\(QR\)</span> to solve an overdetermined system.</li>
<li>Compare classical vs modified Gram–Schmidt.</li>
</ol>
</section>
<section id="test-case-1" class="level4">
<h4 class="anchored" data-anchor-id="test-case-1">Test Case</h4>
<p><span class="math display">\[
A =
\begin{bmatrix}
1 &amp; 1\
1 &amp; 0\
0 &amp; 1
\end{bmatrix}
,\quad
Q =
\begin{bmatrix}
\frac{1}{\sqrt{2}} &amp; \frac{1}{\sqrt{6}}\
\frac{1}{\sqrt{2}} &amp; -\frac{1}{\sqrt{6}}\
0 &amp; \frac{2}{\sqrt{6}}
\end{bmatrix}
,\quad
R =
\begin{bmatrix}
\sqrt{2} &amp; \frac{1}{\sqrt{2}}\
0 &amp; \sqrt{\frac{3}{2}}
\end{bmatrix}
\]</span></p>
<p>Check: <span class="math inline">\(A = Q R\)</span></p>
</section>
<section id="complexity-54" class="level4">
<h4 class="anchored" data-anchor-id="complexity-54">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(mn^2)\)</span></li>
<li>Space: <span class="math inline">\(O(mn)\)</span></li>
<li>Stability: High (especially with Householder reflections)</li>
</ul>
<p>QR decomposition is your orthogonal compass, guiding you to stable, geometric solutions in least squares, PCA, and spectral algorithms.</p>
</section>
</section>
<section id="matrix-inversion-gaussjordan-method" class="level3">
<h3 class="anchored" data-anchor-id="matrix-inversion-gaussjordan-method">556 Matrix Inversion (Gauss–Jordan Method)</h3>
<p>Matrix Inversion finds a matrix <span class="math inline">\(A^{-1}\)</span> such that</p>
<p><span class="math display">\[
A \cdot A^{-1} = I
\]</span></p>
<p>This operation is fundamental for solving systems, transforming spaces, and expressing linear mappings. While direct inversion is rarely used in practice (solving <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> is cheaper), learning how to compute it reveals the structure of linear algebra itself.</p>
<section id="what-problem-are-we-solving-55" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-55">What Problem Are We Solving?</h4>
<p>We want to find <span class="math inline">\(A^{-1}\)</span>, the matrix that undoes <span class="math inline">\(A\)</span>. Once we have <span class="math inline">\(A^{-1}\)</span>, any system <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> can be solved simply by:</p>
<p><span class="math display">\[
\mathbf{x} = A^{-1} \mathbf{b}
\]</span></p>
<p>But inversion is only defined when <span class="math inline">\(A\)</span> is square and non-singular (i.e.&nbsp;<span class="math inline">\(\det(A)\neq0\)</span>).</p>
</section>
<section id="how-does-it-work-plain-language-55" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-55">How Does It Work (Plain Language)</h4>
<p>The Gauss–Jordan method augments <span class="math inline">\(A\)</span> with the identity matrix <span class="math inline">\(I\)</span>, then performs row operations to transform <span class="math inline">\(A\)</span> into <span class="math inline">\(I\)</span>. Whatever <span class="math inline">\(I\)</span> becomes on the right-hand side is <span class="math inline">\(A^{-1}\)</span>.</p>
<p>Step-by-step:</p>
<ol type="1">
<li>Form the augmented matrix <span class="math inline">\([A | I]\)</span></li>
<li>Apply row operations to make <span class="math inline">\(A\)</span> into <span class="math inline">\(I\)</span></li>
<li>The right half becomes <span class="math inline">\(A^{-1}\)</span></li>
</ol>
</section>
<section id="example-26" class="level4">
<h4 class="anchored" data-anchor-id="example-26">Example</h4>
<p>Let <span class="math display">\[
A=
\begin{bmatrix}
2 &amp; 1\\
5 &amp; 3
\end{bmatrix}.
\]</span></p>
<p>Augment with the identity: <span class="math display">\[
\left[
\begin{array}{cc|cc}
2 &amp; 1 &amp; 1 &amp; 0\\
5 &amp; 3 &amp; 0 &amp; 1
\end{array}
\right].
\]</span></p>
<p>Step 1: <span class="math inline">\(R_1 \gets \tfrac{1}{2}R_1\)</span> <span class="math display">\[
\left[
\begin{array}{cc|cc}
1 &amp; \tfrac{1}{2} &amp; \tfrac{1}{2} &amp; 0\\
5 &amp; 3 &amp; 0 &amp; 1
\end{array}
\right].
\]</span></p>
<p>Step 2: <span class="math inline">\(R_2 \gets R_2 - 5R_1\)</span> <span class="math display">\[
\left[
\begin{array}{cc|cc}
1 &amp; \tfrac{1}{2} &amp; \tfrac{1}{2} &amp; 0\\
0 &amp; \tfrac{1}{2} &amp; -\tfrac{5}{2} &amp; 1
\end{array}
\right].
\]</span></p>
<p>Step 3: <span class="math inline">\(R_2 \gets 2R_2\)</span> <span class="math display">\[
\left[
\begin{array}{cc|cc}
1 &amp; \tfrac{1}{2} &amp; \tfrac{1}{2} &amp; 0\\
0 &amp; 1 &amp; -5 &amp; 2
\end{array}
\right].
\]</span></p>
<p>Step 4: <span class="math inline">\(R_1 \gets R_1 - \tfrac{1}{2}R_2\)</span> <span class="math display">\[
\left[
\begin{array}{cc|cc}
1 &amp; 0 &amp; 3 &amp; -1\\
0 &amp; 1 &amp; -5 &amp; 2
\end{array}
\right].
\]</span></p>
<p>Thus <span class="math display">\[
A^{-1}=
\begin{bmatrix}
3 &amp; -1\\
-5 &amp; 2
\end{bmatrix}.
\]</span></p>
<p>Check: <span class="math display">\[
A\,A^{-1}=
\begin{bmatrix}
2 &amp; 1\\
5 &amp; 3
\end{bmatrix}
\begin{bmatrix}
3 &amp; -1\\
-5 &amp; 2
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0\\
0 &amp; 1
\end{bmatrix}.
\]</span></p>
</section>
<section id="tiny-code-easy-versions-52" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-52">Tiny Code (Easy Versions)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> invert_matrix(A):</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Augment with identity</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>    aug <span class="op">=</span> [row <span class="op">+</span> [<span class="bu">int</span>(i <span class="op">==</span> j) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)] <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(A)]</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make pivot 1</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>        pivot <span class="op">=</span> aug[i][i]</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span>n):</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>            aug[i][j] <span class="op">/=</span> pivot</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Eliminate other rows</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> k <span class="op">!=</span> i:</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>                factor <span class="op">=</span> aug[k][i]</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span>n):</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>                    aug[k][j] <span class="op">-=</span> factor <span class="op">*</span> aug[i][j]</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract inverse</span></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [row[n:] <span class="cf">for</span> row <span class="kw">in</span> aug]</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">2</span>,<span class="dv">1</span>],[<span class="dv">5</span>,<span class="dv">3</span>]]</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>A_inv <span class="op">=</span> invert_matrix(A)</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> A_inv:</span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(row)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb124"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">2</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> invert_matrix<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">],</span> <span class="dt">double</span> I<span class="op">[</span>N<span class="op">][</span>N<span class="op">])</span> <span class="op">{</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> aug<span class="op">[</span>N<span class="op">][</span><span class="dv">2</span><span class="op">*</span>N<span class="op">];</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>            aug<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>i<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>            aug<span class="op">[</span>i<span class="op">][</span>j<span class="op">+</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>i <span class="op">==</span> j<span class="op">)</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> pivot <span class="op">=</span> aug<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">2</span><span class="op">*</span>N<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>            aug<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">/=</span> pivot<span class="op">;</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> N<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>k <span class="op">==</span> i<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> factor <span class="op">=</span> aug<span class="op">[</span>k<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">2</span><span class="op">*</span>N<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>                aug<span class="op">[</span>k<span class="op">][</span>j<span class="op">]</span> <span class="op">-=</span> factor <span class="op">*</span> aug<span class="op">[</span>i<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>            I<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> aug<span class="op">[</span>i<span class="op">][</span>j<span class="op">+</span>N<span class="op">];</span></span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">},{</span><span class="dv">5</span><span class="op">,</span><span class="dv">3</span><span class="op">}},</span> Inv<span class="op">[</span>N<span class="op">][</span>N<span class="op">];</span></span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>    invert_matrix<span class="op">(</span>A<span class="op">,</span> Inv<span class="op">);</span></span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++){</span> <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>N<span class="op">;</span>j<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%6.2f</span><span class="st"> "</span><span class="op">,</span>Inv<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-55" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-55">Why It Matters</h4>
<ul>
<li>Conceptual clarity: defines what “inverse” means</li>
<li>Solving systems: <span class="math inline">\(\mathbf{x}=A^{-1}\mathbf{b}\)</span></li>
<li>Geometry: undo linear transformations</li>
<li>Symbolic algebra: e.g.&nbsp;transformations, coordinate changes</li>
</ul>
<p>In practice, you rarely compute <span class="math inline">\(A^{-1}\)</span> explicitly, you factor and solve instead.</p>
</section>
<section id="a-gentle-proof-why-it-works-55" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-55">A Gentle Proof (Why It Works)</h4>
<p>Elementary row operations correspond to multiplying by elementary matrices <span class="math inline">\(E_i\)</span>. If</p>
<p><span class="math display">\[
E_k \cdots E_2 E_1 A = I
\]</span></p>
<p>then</p>
<p><span class="math display">\[
A^{-1} = E_k \cdots E_2 E_1
\]</span></p>
<p>Each <span class="math inline">\(E_i\)</span> is invertible, so their product is invertible.</p>
</section>
<section id="try-it-yourself-55" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-55">Try It Yourself</h4>
<ol type="1">
<li>Invert a <span class="math inline">\(3 \times 3\)</span> matrix by hand.</li>
<li>Verify <span class="math inline">\(A \cdot A^{-1} = I\)</span>.</li>
<li>Observe what happens if <span class="math inline">\(\det(A)=0\)</span>.</li>
<li>Compare with LU-based inversion.</li>
<li>Time it vs solving <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span>.</li>
</ol>
</section>
<section id="test-case-2" class="level4">
<h4 class="anchored" data-anchor-id="test-case-2">Test Case</h4>
<p><span class="math display">\[
A =
\begin{bmatrix}
1 &amp; 2 &amp; 3\
0 &amp; 1 &amp; 4\
5 &amp; 6 &amp; 0
\end{bmatrix}
\implies
A^{-1} =
\begin{bmatrix}
-24 &amp; 18 &amp; 5\
20 &amp; -15 &amp; -4\
-5 &amp; 4 &amp; 1
\end{bmatrix}
\]</span></p>
<p>Check: <span class="math inline">\(A A^{-1} = I\)</span></p>
</section>
<section id="complexity-55" class="level4">
<h4 class="anchored" data-anchor-id="complexity-55">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^3)\)</span></li>
<li>Space: <span class="math inline">\(O(n^2)\)</span></li>
</ul>
<p>Matrix inversion is a mirror: turning transformations back upon themselves, and teaching us that “solving” and “inverting” are two sides of the same operation.</p>
</section>
</section>
<section id="determinant-by-elimination" class="level3">
<h3 class="anchored" data-anchor-id="determinant-by-elimination">557 Determinant by Elimination</h3>
<p>The determinant of a matrix measures its scaling factor and invertibility. Through Gaussian elimination, we can compute it efficiently by converting the matrix to upper triangular form, where the determinant equals the product of the diagonal entries, adjusted for any row swaps.</p>
<p><span class="math display">\[
\det(A) = (\text{sign}) \times \prod_{i=1}^{n} U_{ii}
\]</span></p>
<section id="what-problem-are-we-solving-56" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-56">What Problem Are We Solving?</h4>
<p>We want to compute <span class="math inline">\(\det(A)\)</span> without recursive expansion (which is <span class="math inline">\(O(n!)\)</span>). Elimination-based methods do it in <span class="math inline">\(O(n^3)\)</span>, the same as LU decomposition.</p>
<p>The determinant tells us:</p>
<ul>
<li>If <span class="math inline">\(\det(A)=0\)</span>: <span class="math inline">\(A\)</span> is singular (non-invertible)</li>
<li>If <span class="math inline">\(\det(A)\ne0\)</span>: <span class="math inline">\(A\)</span> is invertible</li>
<li>The volume scaling factor of the linear transformation by <span class="math inline">\(A\)</span></li>
<li>The orientation (positive = preserved, negative = flipped)</li>
</ul>
</section>
<section id="how-does-it-work-plain-language-56" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-56">How Does It Work (Plain Language)</h4>
<p>We perform elimination to form an upper triangular matrix <span class="math inline">\(U\)</span>, keeping track of row swaps and scaling.</p>
<p>Steps:</p>
<ol type="1">
<li><p>Start with <span class="math inline">\(A\)</span></p></li>
<li><p>For each pivot row <span class="math inline">\(i\)</span>:</p>
<ul>
<li>Swap rows if pivot is zero (each swap flips determinant sign)</li>
<li>Eliminate below using row operations (adding multiples doesn’t change determinant)</li>
</ul></li>
<li><p>Once <span class="math inline">\(U\)</span> is upper triangular: <span class="math display">\[
\det(A) = (\pm 1) \times \prod_{i=1}^n U_{ii}
\]</span></p></li>
</ol>
<p>Only row swaps affect the sign.</p>
</section>
<section id="example-27" class="level4">
<h4 class="anchored" data-anchor-id="example-27">Example</h4>
<p>Let <span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 1 &amp; 3\
4 &amp; 2 &amp; 6\
1 &amp; -1 &amp; 1
\end{bmatrix}
\]</span></p>
<p>Perform elimination:</p>
<ul>
<li>Row2 = Row2 - 2×Row1 → <span class="math inline">\([0, 0, 0]\)</span></li>
<li>Row3 = Row3 - ½×Row1 → <span class="math inline">\([0, -1.5, -0.5]\)</span></li>
</ul>
<p>Now <span class="math inline">\(U =
\begin{bmatrix}
2 &amp; 1 &amp; 3\
0 &amp; 0 &amp; 0\
0 &amp; -1.5 &amp; -0.5
\end{bmatrix}\)</span></p>
<p>A zero row appears → <span class="math inline">\(\det(A)=0\)</span>.</p>
<p>Now let’s test a non-singular case:</p>
<p><span class="math display">\[
B =
\begin{bmatrix}
2 &amp; 1 &amp; 1\
1 &amp; 3 &amp; 2\
1 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>Eliminate:</p>
<ul>
<li>Row2 = Row2 - ½×Row1 → <span class="math inline">\([0, 2.5, 1.5]\)</span></li>
<li>Row3 = Row3 - ½×Row1 → <span class="math inline">\([0, -0.5, -0.5]\)</span></li>
<li>Row3 = Row3 + 0.2×Row2 → <span class="math inline">\([0, 0, -0.2]\)</span></li>
</ul>
<p>Now <span class="math inline">\(U_{11}=2\)</span>, <span class="math inline">\(U_{22}=2.5\)</span>, <span class="math inline">\(U_{33}=-0.2\)</span></p>
<p><span class="math display">\[
\det(B) = 2 \times 2.5 \times (-0.2) = -1
\]</span></p>
</section>
<section id="tiny-code-easy-versions-53" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-53">Tiny Code (Easy Versions)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> determinant(A):</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> [row[:] <span class="cf">for</span> row <span class="kw">in</span> A]</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    det <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Pivoting</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> A[i][i] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, n):</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> A[j][i] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>                    A[i], A[j] <span class="op">=</span> A[j], A[i]</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>                    sign <span class="op">*=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>        pivot <span class="op">=</span> A[i][i]</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pivot <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>        det <span class="op">*=</span> pivot</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>, n):</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>            factor <span class="op">=</span> A[j][i] <span class="op">/</span> pivot</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i, n):</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>                A[j][k] <span class="op">-=</span> factor <span class="op">*</span> A[i][k]</span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sign <span class="op">*</span> det</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>],[<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>]]</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"det ="</span>, determinant(A))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb126"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">3</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> determinant<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">])</span> <span class="op">{</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> det <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sign <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>A<span class="op">[</span>i<span class="op">][</span>i<span class="op">])</span> <span class="op">&lt;</span> <span class="fl">1e-9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> swap <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i<span class="op">+</span><span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>A<span class="op">[</span>j<span class="op">][</span>i<span class="op">])</span> <span class="op">&gt;</span> <span class="fl">1e-9</span><span class="op">)</span> <span class="op">{</span> swap <span class="op">=</span> j<span class="op">;</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>swap <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> N<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>                <span class="dt">double</span> tmp <span class="op">=</span> A<span class="op">[</span>i<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>                A<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>swap<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>                A<span class="op">[</span>swap<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>            sign <span class="op">*=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>        det <span class="op">*=</span> A<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i<span class="op">+</span><span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> factor <span class="op">=</span> A<span class="op">[</span>j<span class="op">][</span>i<span class="op">]</span> <span class="op">/</span> A<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> N<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>                A<span class="op">[</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">-=</span> factor <span class="op">*</span> A<span class="op">[</span>i<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> det <span class="op">*</span> sign<span class="op">;</span></span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">},{</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">2</span><span class="op">},{</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">}};</span></span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"det = </span><span class="sc">%.2f\n</span><span class="st">"</span><span class="op">,</span> determinant<span class="op">(</span>A<span class="op">));</span></span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-56" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-56">Why It Matters</h4>
<ul>
<li><p>Invertibility check (<span class="math inline">\(\det(A)\ne0\)</span> means invertible)</p></li>
<li><p>Volume scaling under linear transform</p></li>
<li><p>Orientation detection (sign of determinant)</p></li>
<li><p>Crucial for:</p>
<ul>
<li>Jacobians in calculus</li>
<li>Change of variables</li>
<li>Eigenvalue computation</li>
</ul></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-56" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-56">A Gentle Proof (Why It Works)</h4>
<p>Gaussian elimination expresses <span class="math inline">\(A\)</span> as:</p>
<p><span class="math display">\[
A = L U
\]</span></p>
<p>with <span class="math inline">\(L\)</span> unit-lower-triangular. Then: <span class="math display">\[
\det(A) = \det(L)\det(U) = 1 \times \prod_{i=1}^n U_{ii}
\]</span></p>
<p>Row swaps multiply <span class="math inline">\(\det(A)\)</span> by <span class="math inline">\(-1\)</span> each time. Adding multiples of rows doesn’t change <span class="math inline">\(\det(A)\)</span>.</p>
</section>
<section id="try-it-yourself-56" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-56">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(\det(A)\)</span> by cofactor expansion and elimination, compare.</li>
<li>Track how sign changes with swaps.</li>
<li>Verify with a triangular matrix.</li>
<li>Observe determinant of singular matrices (should be 0).</li>
<li>Compare LU-based determinant.</li>
</ol>
</section>
<section id="test-case-3" class="level4">
<h4 class="anchored" data-anchor-id="test-case-3">Test Case</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 82%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>Matrix <span class="math inline">\(A\)</span></th>
<th>Determinant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(-2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\begin{bmatrix} 2 &amp; 1 &amp; 1 \\ 1 &amp; 3 &amp; 2 \\ 1 &amp; 0 &amp; 0 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix} 2 &amp; 1 &amp; 3 \\ 4 &amp; 2 &amp; 6 \\ 1 &amp; -1 &amp; 1 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(0\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-56" class="level4">
<h4 class="anchored" data-anchor-id="complexity-56">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^3)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span> (in-place)</li>
</ul>
<p>Determinant by elimination turns algebraic chaos into structure, each pivot a volume factor, each swap a flip of orientation.</p>
</section>
</section>
<section id="rank-of-a-matrix" class="level3">
<h3 class="anchored" data-anchor-id="rank-of-a-matrix">558 Rank of a Matrix</h3>
<p>The rank of a matrix tells us how many independent rows or columns it has, in other words, the dimension of its image (column space). It’s the bridge between linear independence, solvability, and dimension.</p>
<p>We can compute it efficiently using Gaussian elimination: transform the matrix to row echelon form (REF) and count the non-zero rows.</p>
<section id="what-problem-are-we-solving-57" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-57">What Problem Are We Solving?</h4>
<p>We want to measure how much information is in a matrix. Rank answers questions like:</p>
<ul>
<li>Are the columns independent?</li>
<li>Does <span class="math inline">\(A\mathbf{x}=\mathbf{b}\)</span> have a solution?</li>
<li>What is the dimension of the span of rows/columns?</li>
</ul>
<p>For <span class="math inline">\(m\times n\)</span> matrix <span class="math inline">\(A\)</span>: <span class="math display">\[
\text{rank}(A) = \text{number of leading pivots in REF}
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-57" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-57">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Apply Gaussian elimination to reduce <span class="math inline">\(A\)</span> to row echelon form (REF)</li>
<li>Each non-zero row represents one pivot (independent direction)</li>
<li>Count the pivots → that’s the rank</li>
</ol>
<p>If full rank:</p>
<ul>
<li><span class="math inline">\(\text{rank}(A)=n\)</span> → columns independent</li>
<li><span class="math inline">\(\text{rank}(A)&lt;n\)</span> → some columns are dependent</li>
</ul>
<p>In reduced row echelon form (RREF), the pivots are explicit 1s with zeros above and below.</p>
</section>
<section id="example-28" class="level4">
<h4 class="anchored" data-anchor-id="example-28">Example</h4>
<p>Let <span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 1 &amp; 3\
4 &amp; 2 &amp; 6\
1 &amp; -1 &amp; 1
\end{bmatrix}
\]</span></p>
<p>Perform elimination:</p>
<p>Row2 = Row2 - 2×Row1 → <span class="math inline">\([0, 0, 0]\)</span> Row3 = Row3 - ½×Row1 → <span class="math inline">\([0, -1.5, -0.5]\)</span></p>
<p>Result: <span class="math display">\[
\begin{bmatrix}
2 &amp; 1 &amp; 3\
0 &amp; -1.5 &amp; -0.5\
0 &amp; 0 &amp; 0
\end{bmatrix}
\]</span></p>
<p>Two non-zero rows → rank = 2</p>
<p>So the rows span a 2D plane, not all of <span class="math inline">\(\mathbb{R}^3\)</span>.</p>
</section>
<section id="tiny-code-easy-versions-54" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-54">Tiny Code (Easy Versions)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> matrix_rank(A):</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    n, m <span class="op">=</span> <span class="bu">len</span>(A), <span class="bu">len</span>(A[<span class="dv">0</span>])</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> [row[:] <span class="cf">for</span> row <span class="kw">in</span> A]</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    rank <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(m):</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Find pivot</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>        pivot_row <span class="op">=</span> <span class="va">None</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(rank, n):</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">abs</span>(A[row][col]) <span class="op">&gt;</span> <span class="fl">1e-9</span>:</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>                pivot_row <span class="op">=</span> row</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pivot_row <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Swap to current rank row</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>        A[rank], A[pivot_row] <span class="op">=</span> A[pivot_row], A[rank]</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Normalize pivot row</span></span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>        pivot <span class="op">=</span> A[rank][col]</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>        A[rank] <span class="op">=</span> [x <span class="op">/</span> pivot <span class="cf">for</span> x <span class="kw">in</span> A[rank]]</span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Eliminate below</span></span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> r <span class="kw">in</span> <span class="bu">range</span>(rank<span class="op">+</span><span class="dv">1</span>, n):</span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>            factor <span class="op">=</span> A[r][col]</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>            A[r] <span class="op">=</span> [A[r][c] <span class="op">-</span> factor<span class="op">*</span>A[rank][c] <span class="cf">for</span> c <span class="kw">in</span> <span class="bu">range</span>(m)]</span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>        rank <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rank</span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>],[<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>],[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>]]</span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"rank ="</span>, matrix_rank(A))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (Gaussian Elimination)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb128"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">3</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define M </span><span class="dv">3</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> matrix_rank<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>M<span class="op">])</span> <span class="op">{</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rank <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> col <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> col <span class="op">&lt;</span> M<span class="op">;</span> col<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> pivot <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> r <span class="op">=</span> rank<span class="op">;</span> r <span class="op">&lt;</span> N<span class="op">;</span> r<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>A<span class="op">[</span>r<span class="op">][</span>col<span class="op">])</span> <span class="op">&gt;</span> <span class="fl">1e-9</span><span class="op">)</span> <span class="op">{</span> pivot <span class="op">=</span> r<span class="op">;</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>pivot <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Swap</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>pivot <span class="op">!=</span> rank<span class="op">)</span> <span class="op">{</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> c <span class="op">&lt;</span> M<span class="op">;</span> c<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>                <span class="dt">double</span> tmp <span class="op">=</span> A<span class="op">[</span>rank<span class="op">][</span>c<span class="op">];</span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>                A<span class="op">[</span>rank<span class="op">][</span>c<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>pivot<span class="op">][</span>c<span class="op">];</span></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>                A<span class="op">[</span>pivot<span class="op">][</span>c<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Normalize</span></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> div <span class="op">=</span> A<span class="op">[</span>rank<span class="op">][</span>col<span class="op">];</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> c <span class="op">&lt;</span> M<span class="op">;</span> c<span class="op">++)</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>            A<span class="op">[</span>rank<span class="op">][</span>c<span class="op">]</span> <span class="op">/=</span> div<span class="op">;</span></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Eliminate</span></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> r <span class="op">=</span> rank <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> r <span class="op">&lt;</span> N<span class="op">;</span> r<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> factor <span class="op">=</span> A<span class="op">[</span>r<span class="op">][</span>col<span class="op">];</span></span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> c <span class="op">&lt;</span> M<span class="op">;</span> c<span class="op">++)</span></span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a>                A<span class="op">[</span>r<span class="op">][</span>c<span class="op">]</span> <span class="op">-=</span> factor <span class="op">*</span> A<span class="op">[</span>rank<span class="op">][</span>c<span class="op">];</span></span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>        rank<span class="op">++;</span></span>
<span id="cb128-38"><a href="#cb128-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb128-39"><a href="#cb128-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rank<span class="op">;</span></span>
<span id="cb128-40"><a href="#cb128-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb128-41"><a href="#cb128-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-42"><a href="#cb128-42" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb128-43"><a href="#cb128-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>M<span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">},{</span><span class="dv">4</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">6</span><span class="op">},{</span><span class="dv">1</span><span class="op">,-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">}};</span></span>
<span id="cb128-44"><a href="#cb128-44" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"rank = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> matrix_rank<span class="op">(</span>A<span class="op">));</span></span>
<span id="cb128-45"><a href="#cb128-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-57" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-57">Why It Matters</h4>
<ul>
<li><p>Dimension of span: rank = number of independent directions</p></li>
<li><p>Solvability:</p>
<ul>
<li>If <span class="math inline">\(\text{rank}(A)=\text{rank}([A|\mathbf{b}])\)</span>, system is consistent</li>
<li>If <span class="math inline">\(\text{rank}(A)&lt;n\)</span>, infinite or no solutions</li>
</ul></li>
<li><p>Column space: rank = dimension of image</p></li>
<li><p>Row space: same as column space dimension (rank = rank<span class="math inline">\(^T\)</span>)</p></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-57" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-57">A Gentle Proof (Why It Works)</h4>
<p>Row operations don’t change the span of rows, hence don’t change rank. Once in echelon form, each non-zero row adds one linearly independent vector to the row space.</p>
<p>Thus: <span class="math display">\[
\text{rank}(A) = \text{number of pivot positions}
\]</span></p>
</section>
<section id="try-it-yourself-57" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-57">Try It Yourself</h4>
<ol type="1">
<li>Reduce a <span class="math inline">\(3\times3\)</span> matrix to REF.</li>
<li>Count pivot rows → rank.</li>
<li>Compare with column independence check.</li>
<li>Compute rank(<span class="math inline">\(A\)</span>) and rank(<span class="math inline">\(A^T\)</span>).</li>
<li>Test with singular matrices (rank &lt; n).</li>
</ol>
</section>
<section id="test-cases-53" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-53">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 92%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Matrix</th>
<th>Rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 6 \end{bmatrix}\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix}\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix} 2 &amp; 1 &amp; 3 \\ 4 &amp; 2 &amp; 6 \\ 1 &amp; -1 &amp; 1 \end{bmatrix}\)</span></td>
<td>2</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-57" class="level4">
<h4 class="anchored" data-anchor-id="complexity-57">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^3)\)</span></li>
<li>Space: <span class="math inline">\(O(n^2)\)</span></li>
</ul>
<p>The rank is the soul of a matrix, telling you how many truly independent voices sing in its rows and columns.</p>
</section>
</section>
<section id="eigenvalue-power-method" class="level3">
<h3 class="anchored" data-anchor-id="eigenvalue-power-method">559 Eigenvalue Power Method</h3>
<p>The Power Method is a simple iterative algorithm to approximate the dominant eigenvalue (the one with the largest magnitude) and its corresponding eigenvector of a matrix <span class="math inline">\(A\)</span>.</p>
<p>It’s one of the earliest and most intuitive ways to “listen” to the matrix and find its strongest direction, the one that stays steady under repeated transformation.</p>
<section id="what-problem-are-we-solving-58" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-58">What Problem Are We Solving?</h4>
<p>We want to find <span class="math inline">\(\lambda_{\max}\)</span> and <span class="math inline">\(\mathbf{v}_{\max}\)</span> such that:</p>
<p><span class="math display">\[
A \mathbf{v}*{\max} = \lambda*{\max} \mathbf{v}_{\max}
\]</span></p>
<p>When <span class="math inline">\(A\)</span> is large or sparse, solving the characteristic polynomial is infeasible. The Power Method gives an iterative, low-memory approximation, crucial in numerical linear algebra, PageRank, and PCA.</p>
</section>
<section id="how-does-it-work-plain-language-58" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-58">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Start with a random vector <span class="math inline">\(\mathbf{x}_0\)</span></li>
<li>Repeatedly apply <span class="math inline">\(A\)</span>: <span class="math inline">\(\mathbf{x}_{k+1} = A \mathbf{x}_k\)</span></li>
<li>Normalize each step to prevent overflow</li>
<li>When <span class="math inline">\(\mathbf{x}_k\)</span> stabilizes, it aligns with the dominant eigenvector</li>
<li>The corresponding eigenvalue is approximated by the Rayleigh quotient:</li>
</ol>
<p><span class="math display">\[
\lambda_k \approx \frac{\mathbf{x}_k^T A \mathbf{x}_k}{\mathbf{x}_k^T \mathbf{x}_k}
\]</span></p>
<p>Because <span class="math inline">\(A^k \mathbf{x}*0\)</span> amplifies the component in the direction of <span class="math inline">\(\mathbf{v}*{\max}\)</span>.</p>
</section>
<section id="algorithm-step-by-step" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-step-by-step">Algorithm (Step-by-Step)</h4>
<p>Given <span class="math inline">\(A\)</span> and tolerance <span class="math inline">\(\varepsilon\)</span>:</p>
<ol type="1">
<li><p>Choose <span class="math inline">\(\mathbf{x}_0\)</span> (non-zero vector)</p></li>
<li><p>Repeat:</p>
<ul>
<li><span class="math inline">\(\mathbf{y} = A \mathbf{x}\)</span></li>
<li><span class="math inline">\(\lambda = \max(|y_i|)\)</span> or <span class="math inline">\(\mathbf{x}^T A \mathbf{x}\)</span></li>
<li><span class="math inline">\(\mathbf{x} = \mathbf{y} / \lambda\)</span></li>
</ul></li>
<li><p>Stop when <span class="math inline">\(|\mathbf{x}_{k+1} - \mathbf{x}_k| &lt; \varepsilon\)</span></p></li>
</ol>
<p>Return <span class="math inline">\(\lambda, \mathbf{x}\)</span>.</p>
<p>Convergence requires that <span class="math inline">\(A\)</span> has a unique largest eigenvalue.</p>
</section>
<section id="example-29" class="level4">
<h4 class="anchored" data-anchor-id="example-29">Example</h4>
<p>Let <span class="math display">\[
A =
\begin{bmatrix}
2 &amp; 1\
1 &amp; 3
\end{bmatrix}
\]</span></p>
<p>Start <span class="math display">\[
\mathbf{x}_0 = \begin{bmatrix} 1 \\ 1 \end{bmatrix}
\]</span></p>
<ol type="1">
<li><span class="math inline">\(\mathbf{y} = A\mathbf{x}_0 = [3, 4]^T\)</span>, normalize: <span class="math inline">\(\mathbf{x}_1 = [0.6, 0.8]\)</span></li>
<li><span class="math inline">\(\mathbf{y} = A\mathbf{x}_1 = [2.0, 3.0]^T\)</span>, normalize: <span class="math inline">\(\mathbf{x}_2 = [0.5547, 0.8321]\)</span></li>
<li>Repeat, <span class="math inline">\(\mathbf{x}_k\)</span> converges to eigenvector <span class="math inline">\([0.447, 0.894]\)</span></li>
<li><span class="math inline">\(\lambda \approx 3.618\)</span> (dominant eigenvalue)</li>
</ol>
</section>
<section id="tiny-code-easy-versions-55" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-55">Tiny Code (Easy Versions)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> power_method(A, tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(A)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.ones(n)</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    lambda_old <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.dot(A, x)</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>        lambda_new <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(y))</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> y <span class="op">/</span> lambda_new</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(x <span class="op">-</span> y<span class="op">/</span>np.linalg.norm(y)) <span class="op">&lt;</span> tol:</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>        lambda_old <span class="op">=</span> lambda_new</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lambda_new, x <span class="op">/</span> np.linalg.norm(x)</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">3</span>]], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>lam, v <span class="op">=</span> power_method(A)</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"lambda ≈"</span>, lam)</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"v ≈"</span>, v)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb130"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define N </span><span class="dv">2</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAX_ITER </span><span class="dv">1000</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TOL </span><span class="fl">1e-6</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> power_method<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">],</span> <span class="dt">double</span> v<span class="op">[</span>N<span class="op">])</span> <span class="op">{</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> y<span class="op">[</span>N<span class="op">],</span> lambda <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> lambda_old<span class="op">;</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++)</span> v<span class="op">[</span>i<span class="op">]=</span><span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> iter<span class="op">=</span><span class="dv">0</span><span class="op">;</span>iter<span class="op">&lt;</span>MAX_ITER<span class="op">;</span>iter<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">// y = A * v</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>            y<span class="op">[</span>i<span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>N<span class="op">;</span>j<span class="op">++)</span> y<span class="op">[</span>i<span class="op">]+=</span>A<span class="op">[</span>i<span class="op">][</span>j<span class="op">]*</span>v<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// estimate eigenvalue</span></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>        lambda_old <span class="op">=</span> lambda<span class="op">;</span></span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>        lambda <span class="op">=</span> fabs<span class="op">(</span>y<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++)</span> <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>y<span class="op">[</span>i<span class="op">])&gt;</span>lambda<span class="op">)</span> lambda<span class="op">=</span>fabs<span class="op">(</span>y<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">// normalize</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++)</span> v<span class="op">[</span>i<span class="op">]=</span>y<span class="op">[</span>i<span class="op">]/</span>lambda<span class="op">;</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">// check convergence</span></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> diff<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>N<span class="op">;</span>i<span class="op">++)</span> diff<span class="op">+=</span>fabs<span class="op">(</span>y<span class="op">[</span>i<span class="op">]-</span>lambda<span class="op">*</span>v<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>diff<span class="op">&lt;</span>TOL<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"lambda ≈ </span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> lambda<span class="op">);</span></span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"v ≈ [</span><span class="sc">%.3f</span><span class="st">, </span><span class="sc">%.3f</span><span class="st">]</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> v<span class="op">[</span><span class="dv">0</span><span class="op">],</span> v<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span>N<span class="op">][</span>N<span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">},{</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">}},</span> v<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a>    power_method<span class="op">(</span>A<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-58" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-58">Why It Matters</h4>
<ul>
<li><p>Finds dominant eigenvalue/vector</p></li>
<li><p>Works with large sparse matrices</p></li>
<li><p>Foundation for:</p>
<ul>
<li>PageRank (Google)</li>
<li>PCA (Principal Component Analysis)</li>
<li>Spectral methods</li>
<li>Markov chains steady states</li>
</ul></li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-58" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-58">A Gentle Proof (Why It Works)</h4>
<p>If <span class="math inline">\(A\)</span> has eigen-decomposition <span class="math display">\[
A = V \Lambda V^{-1}
\]</span> and <span class="math inline">\(\mathbf{x}_0 = c_1\mathbf{v}_1 + \dots + c_n\mathbf{v}_n\)</span>,</p>
<p>then <span class="math display">\[
A^k \mathbf{x}_0 = c_1\lambda_1^k\mathbf{v}_1 + \cdots + c_n\lambda_n^k\mathbf{v}_n
\]</span></p>
<p>As <span class="math inline">\(k \to \infty\)</span>, <span class="math inline">\(\lambda_1^k\)</span> dominates, so direction <span class="math inline">\(\to \mathbf{v}_1\)</span>. Normalization removes scale, leaving the dominant eigenvector.</p>
</section>
<section id="try-it-yourself-58" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-58">Try It Yourself</h4>
<ol type="1">
<li>Apply to a <span class="math inline">\(3\times3\)</span> symmetric matrix.</li>
<li>Compare result with <code>numpy.linalg.eig</code>.</li>
<li>Try on a diagonal matrix, verify it finds largest diagonal.</li>
<li>Observe divergence if eigenvalues are equal in magnitude.</li>
<li>Modify to inverse power method to find smallest eigenvalue.</li>
</ol>
</section>
<section id="test-case-4" class="level4">
<h4 class="anchored" data-anchor-id="test-case-4">Test Case</h4>
<p><span class="math display">\[
A =
\begin{bmatrix}
4 &amp; 1\
2 &amp; 3
\end{bmatrix},
\quad
\lambda_{\max} \approx 4.561,
\quad
\mathbf{v}_{\max} \approx
\begin{bmatrix}
0.788\
0.615
\end{bmatrix}
\]</span></p>
</section>
<section id="complexity-58" class="level4">
<h4 class="anchored" data-anchor-id="complexity-58">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(kn^2)\)</span> (for <span class="math inline">\(k\)</span> iterations)</li>
<li>Space: <span class="math inline">\(O(n^2)\)</span></li>
</ul>
<p>The Power Method is the simplest window into eigenvalues, each iteration aligns your vector more closely with the matrix’s strongest echo.</p>
</section>
</section>
<section id="singular-value-decomposition-svd" class="level3">
<h3 class="anchored" data-anchor-id="singular-value-decomposition-svd">560 Singular Value Decomposition (SVD)</h3>
<p>The Singular Value Decomposition (SVD) is one of the most powerful and universal factorizations in linear algebra. It expresses any matrix<span class="math inline">\(A\)</span> (square or rectangular) as a product of three special matrices:</p>
<p><span class="math display">\[
A = U \Sigma V^T
\]</span></p>
<p>-<span class="math inline">\(U\)</span>: orthogonal matrix of left singular vectors -<span class="math inline">\(\Sigma\)</span>: diagonal matrix of singular values (non-negative) -<span class="math inline">\(V\)</span>: orthogonal matrix of right singular vectors</p>
<p>SVD generalizes the eigendecomposition, works for any matrix (even non-square), and reveals deep structure, from geometry to data compression.</p>
<section id="what-problem-are-we-solving-59" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-59">What Problem Are We Solving?</h4>
<p>We want to decompose<span class="math inline">\(A\)</span> into simpler, interpretable parts:</p>
<ul>
<li>Directions of stretching (via<span class="math inline">\(V\)</span>)</li>
<li>Amount of stretching (via<span class="math inline">\(\Sigma\)</span>)</li>
<li>Resulting orthogonal directions (via<span class="math inline">\(U\)</span>)</li>
</ul>
<p>SVD is used to:</p>
<ul>
<li>Compute rank, null space, and range</li>
<li>Perform dimensionality reduction (PCA)</li>
<li>Solve least squares problems</li>
<li>Compute pseudoinverse</li>
<li>Perform noise reduction in signals and images</li>
</ul>
</section>
<section id="how-does-it-work-plain-language-59" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-59">How Does It Work (Plain Language)</h4>
<p>For any<span class="math inline">\(A \in \mathbb{R}^{m \times n}\)</span>:</p>
<ol type="1">
<li>Compute<span class="math inline">\(A^T A\)</span> (symmetric and positive semidefinite)</li>
<li>Find eigenvalues<span class="math inline">\(\lambda_i\)</span> and eigenvectors<span class="math inline">\(v_i\)</span></li>
<li>Singular values<span class="math inline">\(\sigma_i = \sqrt{\lambda_i}\)</span></li>
<li>Form<span class="math inline">\(V = [v_1, \ldots, v_n]\)</span></li>
<li>Form<span class="math inline">\(U = \frac{1}{\sigma_i} A v_i\)</span> for non-zero<span class="math inline">\(\sigma_i\)</span></li>
<li>Assemble<span class="math inline">\(\Sigma\)</span> with<span class="math inline">\(\sigma_i\)</span> on the diagonal</li>
</ol>
<p>Result: <span class="math display">\[
A = U \Sigma V^T
\]</span></p>
<p>If<span class="math inline">\(A\)</span> is<span class="math inline">\(m \times n\)</span>:</p>
<p>-<span class="math inline">\(U\)</span>:<span class="math inline">\(m \times m\)</span> -<span class="math inline">\(\Sigma\)</span>:<span class="math inline">\(m \times n\)</span> -<span class="math inline">\(V\)</span>:<span class="math inline">\(n \times n\)</span></p>
</section>
<section id="example-30" class="level4">
<h4 class="anchored" data-anchor-id="example-30">Example</h4>
<p>Let <span class="math display">\[
A=
\begin{bmatrix}
3 &amp; 1\\
1 &amp; 3
\end{bmatrix}.
\]</span></p>
<ol type="1">
<li><p>Compute <span class="math inline">\(A^{\mathsf T}A\)</span>: <span class="math display">\[
A^{\mathsf T}A
=
\begin{bmatrix}
3 &amp; 1\\
1 &amp; 3
\end{bmatrix}
\begin{bmatrix}
3 &amp; 1\\
1 &amp; 3
\end{bmatrix}
=
\begin{bmatrix}
10 &amp; 6\\
6 &amp; 10
\end{bmatrix}.
\]</span></p></li>
<li><p>Eigenvalues: <span class="math inline">\(16,\,4\)</span><br>
Singular values: <span class="math inline">\(\sigma_1=4,\ \sigma_2=2\)</span>.</p></li>
<li><p>Right singular vectors: <span class="math display">\[
v_1=\frac{1}{\sqrt{2}}\begin{bmatrix}1\\1\end{bmatrix}, \quad
v_2=\frac{1}{\sqrt{2}}\begin{bmatrix}1\\-1\end{bmatrix}, \quad
V=[v_1,v_2].
\]</span></p></li>
<li><p>Compute <span class="math inline">\(u_i=\frac{1}{\sigma_i}A v_i\)</span>: <span class="math display">\[
u_1=\frac{1}{4}A v_1
=\frac{1}{4}
\begin{bmatrix}3 &amp; 1\\1 &amp; 3\end{bmatrix}
\frac{1}{\sqrt{2}}
\begin{bmatrix}1\\1\end{bmatrix}
=\frac{1}{\sqrt{2}}\begin{bmatrix}1\\1\end{bmatrix},
\]</span> <span class="math display">\[
u_2=\frac{1}{2}A v_2
=\frac{1}{2}
\begin{bmatrix}3 &amp; 1\\1 &amp; 3\end{bmatrix}
\frac{1}{\sqrt{2}}
\begin{bmatrix}1\\-1\end{bmatrix}
=\frac{1}{\sqrt{2}}\begin{bmatrix}1\\-1\end{bmatrix}.
\]</span></p></li>
</ol>
<p>Thus <span class="math display">\[
U=\frac{1}{\sqrt{2}}
\begin{bmatrix}
1 &amp; 1\\
1 &amp; -1
\end{bmatrix}, \quad
\Sigma=
\begin{bmatrix}
4 &amp; 0\\
0 &amp; 2
\end{bmatrix}, \quad
V=U.
\]</span></p>
<p>Check: <span class="math inline">\(A = U\,\Sigma\,V^{\mathsf T}\)</span>.</p>
</section>
<section id="tiny-code-easy-versions-56" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-56">Tiny Code (Easy Versions)</h4>
<p>Python (NumPy built-in)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">3</span>]], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>U, S, Vt <span class="op">=</span> np.linalg.svd(A)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"U =</span><span class="ch">\n</span><span class="st">"</span>, U)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"S =</span><span class="ch">\n</span><span class="st">"</span>, np.diag(S))</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"V^T =</span><span class="ch">\n</span><span class="st">"</span>, Vt)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python (Manual Approximation for 2×2)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> svd_2x2(A):</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    ATA <span class="op">=</span> A.T <span class="op">@</span> A</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>    eigvals, V <span class="op">=</span> np.linalg.eig(ATA)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> np.argsort(<span class="op">-</span>eigvals)</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    eigvals, V <span class="op">=</span> eigvals[idx], V[:, idx]</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> np.sqrt(eigvals)</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> (A <span class="op">@</span> V) <span class="op">/</span> S</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> U, S, V</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">3</span>]], <span class="bu">float</span>)</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>U, S, V <span class="op">=</span> svd_2x2(A)</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"U ="</span>, U)</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"S ="</span>, S)</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"V ="</span>, V)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (Conceptual Skeleton)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb133"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co">// For 2x2 SVD demonstration</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> svd_2x2<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> a<span class="op">=</span>A<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">],</span> b<span class="op">=</span>A<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">],</span> c<span class="op">=</span>A<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">],</span> d<span class="op">=</span>A<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> ATA<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span>a<span class="op">*</span>a <span class="op">+</span> c<span class="op">*</span>c<span class="op">,</span> a<span class="op">*</span>b <span class="op">+</span> c<span class="op">*</span>d<span class="op">},</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span>a<span class="op">*</span>b <span class="op">+</span> c<span class="op">*</span>d<span class="op">,</span> b<span class="op">*</span>b <span class="op">+</span> d<span class="op">*</span>d<span class="op">}</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> trace <span class="op">=</span> ATA<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> ATA<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> det <span class="op">=</span> ATA<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]*</span>ATA<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">-</span> ATA<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">]*</span>ATA<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> s <span class="op">=</span> sqrt<span class="op">(</span>trace<span class="op">*</span>trace<span class="op">/</span><span class="dv">4</span> <span class="op">-</span> det<span class="op">);</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> sigma1 <span class="op">=</span> sqrt<span class="op">(</span>trace<span class="op">/</span><span class="dv">2</span> <span class="op">+</span> s<span class="op">);</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> sigma2 <span class="op">=</span> sqrt<span class="op">(</span>trace<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> s<span class="op">);</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Singular values: </span><span class="sc">%.3f</span><span class="st">, </span><span class="sc">%.3f\n</span><span class="st">"</span><span class="op">,</span> sigma1<span class="op">,</span> sigma2<span class="op">);</span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">3</span><span class="op">,</span><span class="dv">1</span><span class="op">},{</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">}};</span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>    svd_2x2<span class="op">(</span>A<span class="op">);</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-59" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-59">Why It Matters</h4>
<ul>
<li>Universal factorization: works for any matrix</li>
<li>Geometry: describes stretching and rotation</li>
<li>Data science: PCA, low-rank approximation</li>
<li>Numerical analysis: stable pseudoinverse</li>
<li>Signal processing: denoising, compression</li>
</ul>
<p>SVD powers tools like Latent Semantic Analysis (LSA) and Truncated SVD for dimensionality reduction.</p>
</section>
<section id="a-gentle-proof-why-it-works-59" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-59">A Gentle Proof (Why It Works)</h4>
<p>From<span class="math inline">\(A^T A = V \Lambda V^T\)</span>, where<span class="math inline">\(\Lambda\)</span> is diagonal with eigenvalues<span class="math inline">\(\lambda_i \ge 0\)</span>. Define<span class="math inline">\(\Sigma = \sqrt{\Lambda}\)</span>. Then:</p>
<p><span class="math display">\[
A = (A V \Sigma^{-1}) \Sigma V^T
\]</span></p>
<p>Set<span class="math inline">\(U = A V \Sigma^{-1}\)</span>, which is orthogonal. Thus<span class="math inline">\(A = U \Sigma V^T\)</span>.</p>
</section>
<section id="try-it-yourself-59" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-59">Try It Yourself</h4>
<ol type="1">
<li>Decompose a<span class="math inline">\(3\times2\)</span> matrix manually.</li>
<li>Verify<span class="math inline">\(U^T U = I\)</span>,<span class="math inline">\(V^T V = I\)</span>.</li>
<li>Compare singular values with<span class="math inline">\(\sqrt{\text{eigenvalues of } A^T A}\)</span>.</li>
<li>Use SVD to find rank (count of non-zero singular values).</li>
<li>Reconstruct<span class="math inline">\(A\)</span> from top-1 singular value for compression.</li>
</ol>
</section>
<section id="test-case-5" class="level4">
<h4 class="anchored" data-anchor-id="test-case-5">Test Case</h4>
<p><span class="math display">\[
A =
\begin{bmatrix}
3 &amp; 1\
1 &amp; 3
\end{bmatrix},
\quad
U =
\frac{1}{\sqrt{2}}
\begin{bmatrix}
1 &amp; 1\
1 &amp; -1
\end{bmatrix},
\quad
\Sigma =
\begin{bmatrix}
4 &amp; 0\
0 &amp; 2
\end{bmatrix},
\quad
V = U
\]</span></p>
<p>Check:<span class="math inline">\(A = U \Sigma V^T\)</span></p>
</section>
<section id="complexity-59" class="level4">
<h4 class="anchored" data-anchor-id="complexity-59">Complexity</h4>
<ul>
<li>Time:<span class="math inline">\(O(mn^2)\)</span> for dense matrices</li>
<li>Space:<span class="math inline">\(O(mn)\)</span></li>
</ul>
<p>SVD is the master key of linear algebra, unlocking rank, eigenstructure, geometry, and data all at once.</p>
</section>
</section>
</section>
<section id="section-57.-fft-and-ntt-fast-transforms" class="level1">
<h1>Section 57. FFT and NTT (Fast Transforms)</h1>
<section id="discrete-fourier-transform-dft" class="level3">
<h3 class="anchored" data-anchor-id="discrete-fourier-transform-dft">561 Discrete Fourier Transform (DFT)</h3>
<p>The Discrete Fourier Transform (DFT) is the mathematical bridge between time (or spatial) domain and frequency domain. It decomposes a finite sequence of numbers into a sum of complex sinusoids, revealing the hidden frequencies that make up the signal.</p>
<p>The DFT is the foundation for signal processing, audio compression, image filtering, and polynomial multiplication. It’s beautiful, exact, and fundamental.</p>
<section id="what-problem-are-we-solving-60" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-60">What Problem Are We Solving?</h4>
<p>Given a sequence of<span class="math inline">\(n\)</span> complex numbers:</p>
<p><span class="math display">\[
x = (x_0, x_1, \ldots, x_{n-1})
\]</span></p>
<p>we want to compute a new sequence<span class="math inline">\(X = (X_0, X_1, \ldots, X_{n-1})\)</span> that describes how much of each frequency is present in<span class="math inline">\(x\)</span>.</p>
<p>The transform is defined as:</p>
<p><span class="math display">\[
X_k = \sum_{j=0}^{n-1} x_j \cdot e^{-2\pi i \frac{jk}{n}}
\quad \text{for } k = 0, 1, \ldots, n-1
\]</span></p>
<p>Each<span class="math inline">\(X_k\)</span> measures the amplitude of the complex sinusoid with frequency<span class="math inline">\(k/n\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-60" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-60">How Does It Work (Plain Language)</h4>
<p>Think of your input sequence as a chord played on a piano, a mix of multiple frequencies. The DFT “listens” to the signal and tells you which notes (frequencies) are present and how strong they are.</p>
<p>At its core, it multiplies the signal by complex sinusoids<span class="math inline">\(e^{-2\pi i jk/n}\)</span>, summing the results to find how strongly each sinusoid contributes.</p>
</section>
<section id="example-31" class="level4">
<h4 class="anchored" data-anchor-id="example-31">Example</h4>
<p>Let<span class="math inline">\(n = 4\)</span>, and<span class="math inline">\(x = (1, 2, 3, 4)\)</span></p>
<p>Then:</p>
<p><span class="math display">\[
X_k = \sum_{j=0}^{3} x_j \cdot e^{-2\pi i \frac{jk}{4}}
\]</span></p>
<p>Compute each:</p>
<p>-<span class="math inline">\(X_0 = 1 + 2 + 3 + 4 = 10\)</span> -<span class="math inline">\(X_1 = 1 + 2i - 3 - 4i = -2 - 2i\)</span> -<span class="math inline">\(X_2 = 1 - 2 + 3 - 4 = -2\)</span> -<span class="math inline">\(X_3 = 1 - 2i - 3 + 4i = -2 + 2i\)</span></p>
<p>So the DFT is:</p>
<p><span class="math display">\[
X = [10, -2-2i, -2, -2+2i]
\]</span></p>
</section>
<section id="inverse-dft" class="level4">
<h4 class="anchored" data-anchor-id="inverse-dft">Inverse DFT</h4>
<p>To reconstruct the original sequence from its frequencies:</p>
<p><span class="math display">\[
x_j = \frac{1}{n} \sum_{k=0}^{n-1} X_k \cdot e^{2\pi i \frac{jk}{n}}
\]</span></p>
<p>The forward and inverse transform form a perfect pair, no information is lost.</p>
</section>
<section id="tiny-code-easy-versions-57" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-57">Tiny Code (Easy Versions)</h4>
<p>Python (Naive DFT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmath</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dft(x):</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> []</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>            angle <span class="op">=</span> <span class="op">-</span><span class="ot">2j</span> <span class="op">*</span> cmath.pi <span class="op">*</span> j <span class="op">*</span> k <span class="op">/</span> n</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>            s <span class="op">+=</span> x[j] <span class="op">*</span> cmath.exp(angle)</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>        X.append(s)</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dft(x)</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DFT:"</span>, X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Python (Inverse DFT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> idft(X):</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(X)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> []</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>            angle <span class="op">=</span> <span class="ot">2j</span> <span class="op">*</span> cmath.pi <span class="op">*</span> j <span class="op">*</span> k <span class="op">/</span> n</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>            s <span class="op">+=</span> X[k] <span class="op">*</span> cmath.exp(angle)</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>        x.append(s <span class="op">/</span> n)</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (Naive Implementation)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb136"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;complex.h&gt;</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define PI </span><span class="fl">3.14159265358979323846</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dft<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">double</span> <span class="dt">complex</span> x<span class="op">[],</span> <span class="dt">double</span> <span class="dt">complex</span> X<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>        X<span class="op">[</span>k<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> angle <span class="op">=</span> <span class="op">-</span><span class="fl">2.0</span> <span class="op">*</span> PI <span class="op">*</span> j <span class="op">*</span> k <span class="op">/</span> n<span class="op">;</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>            X<span class="op">[</span>k<span class="op">]</span> <span class="op">+=</span> x<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> cexp<span class="op">(</span>I <span class="op">*</span> angle<span class="op">);</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> <span class="dt">complex</span> x<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">};</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> <span class="dt">complex</span> X<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>    dft<span class="op">(</span>n<span class="op">,</span> x<span class="op">,</span> X<span class="op">);</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"X[</span><span class="sc">%d</span><span class="st">] = </span><span class="sc">%.2f</span><span class="st"> + </span><span class="sc">%.2f</span><span class="st">i</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> k<span class="op">,</span> creal<span class="op">(</span>X<span class="op">[</span>k<span class="op">]),</span> cimag<span class="op">(</span>X<span class="op">[</span>k<span class="op">]));</span></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-60" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-60">Why It Matters</h4>
<ul>
<li>Converts time-domain signals into frequency-domain insights</li>
<li>Enables filtering, compression, and pattern detection</li>
<li>Fundamental in signal processing, audio/video, cryptography, machine learning, and FFT-based algorithms</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-60" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-60">A Gentle Proof (Why It Works)</h4>
<p>The DFT uses the orthogonality of complex exponentials:</p>
<p><span class="math display">\[
\sum_{j=0}^{n-1} e^{-2\pi i (k-l) j / n} =
\begin{cases}
n, &amp; \text{if } k = l, \\
0, &amp; \text{if } k \ne l.
\end{cases}
\]</span></p>
<p>This property ensures we can isolate each frequency component uniquely and invert the transform exactly.</p>
</section>
<section id="try-it-yourself-60" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-60">Try It Yourself</h4>
<ol type="1">
<li>Compute DFT of<span class="math inline">\([1, 0, 1, 0]\)</span>.</li>
<li>Verify that applying IDFT brings back the original sequence.</li>
<li>Plot real and imaginary parts of<span class="math inline">\(X_k\)</span>.</li>
<li>Observe how<span class="math inline">\(X_0\)</span> represents the average of input values.</li>
<li>Compare runtime with FFT for large<span class="math inline">\(n\)</span>.</li>
</ol>
</section>
<section id="test-cases-54" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-54">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input<span class="math inline">\(x\)</span></th>
<th>Output<span class="math inline">\(X\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1, 1, 1, 1]</td>
<td>[4, 0, 0, 0]</td>
</tr>
<tr class="even">
<td>[1, 0, 1, 0]</td>
<td>[2, 0, 2, 0]</td>
</tr>
<tr class="odd">
<td>[1, 2, 3, 4]</td>
<td>[10, -2-2i, -2, -2+2i]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-60" class="level4">
<h4 class="anchored" data-anchor-id="complexity-60">Complexity</h4>
<ul>
<li>Time:<span class="math inline">\(O(n^2)\)</span></li>
<li>Space:<span class="math inline">\(O(n)\)</span></li>
</ul>
<p>DFT is the mathematical microscope that reveals the hidden harmonies inside data, every signal becomes a song of frequencies.</p>
</section>
</section>
<section id="fast-fourier-transform-fft" class="level3">
<h3 class="anchored" data-anchor-id="fast-fourier-transform-fft">562 Fast Fourier Transform (FFT)</h3>
<p>The Fast Fourier Transform (FFT) is one of the most important algorithms in computational mathematics. It takes the Discrete Fourier Transform (DFT), originally an<span class="math inline">\(O(n^2)\)</span> operation, and reduces it to<span class="math inline">\(O(n \log n)\)</span> by exploiting symmetry and recursion. It’s the beating heart behind digital signal processing, convolution, polynomial multiplication, and spectral analysis.</p>
<section id="what-problem-are-we-solving-61" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-61">What Problem Are We Solving?</h4>
<p>We want to compute the same transformation as the DFT:</p>
<p><span class="math display">\[
X_k = \sum_{j=0}^{n-1} x_j \cdot e^{-2\pi i \frac{jk}{n}}
\]</span></p>
<p>but faster.</p>
<p>A direct implementation loops over both<span class="math inline">\(j\)</span> and<span class="math inline">\(k\)</span>, requiring<span class="math inline">\(n^2\)</span> operations. FFT cleverly reorganizes computation by dividing the sequence into even and odd parts, halving the work each time.</p>
</section>
<section id="how-does-it-work-plain-language-61" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-61">How Does It Work (Plain Language)</h4>
<p>FFT uses a divide-and-conquer idea:</p>
<ol type="1">
<li>Split the sequence into even and odd indexed elements.</li>
<li>Compute the DFT of each half (recursively).</li>
<li>Combine results using the symmetry of complex roots of unity.</li>
</ol>
<p>This works best when<span class="math inline">\(n\)</span> is a power of 2, because we can split evenly each time until reaching single elements.</p>
<p>Mathematically:</p>
<p>Let<span class="math inline">\(n = 2m\)</span>. Then:</p>
<p><span class="math display">\[
X_k = E_k + \omega_n^k O_k \
X_{k+m} = E_k - \omega_n^k O_k
\]</span></p>
<p>where:</p>
<p>-<span class="math inline">\(E_k\)</span> is the DFT of even-indexed terms, -<span class="math inline">\(O_k\)</span> is the DFT of odd-indexed terms, -<span class="math inline">\(\omega_n = e^{-2\pi i / n}\)</span> is the primitive root of unity.</p>
</section>
<section id="example-32" class="level4">
<h4 class="anchored" data-anchor-id="example-32">Example</h4>
<p>Let<span class="math inline">\(n = 4\)</span>,<span class="math inline">\(x = [1, 2, 3, 4]\)</span></p>
<p>Split:</p>
<ul>
<li>Evens:<span class="math inline">\([1, 3]\)</span></li>
<li>Odds:<span class="math inline">\([2, 4]\)</span></li>
</ul>
<p>Compute DFT of each (size 2):</p>
<p>-<span class="math inline">\(E = [4, -2]\)</span> -<span class="math inline">\(O = [6, -2]\)</span></p>
<p>Then combine:</p>
<p>-<span class="math inline">\(X_0 = E_0 + O_0 = 10\)</span> -<span class="math inline">\(X_1 = E_1 + \omega_4^1 O_1 = -2 + i(-2) = -2 - 2i\)</span> -<span class="math inline">\(X_2 = E_0 - O_0 = -2\)</span> -<span class="math inline">\(X_3 = E_1 - \omega_4^1 O_1 = -2 + 2i\)</span></p>
<p>So<span class="math inline">\(X = [10, -2-2i, -2, -2+2i]\)</span>, same as DFT but computed faster.</p>
</section>
<section id="tiny-code-recursive-fft" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-recursive-fft">Tiny Code (Recursive FFT)</h4>
<p>Python (Cooley–Tukey FFT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmath</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fft(x):</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>    w_n <span class="op">=</span> cmath.exp(<span class="op">-</span><span class="ot">2j</span> <span class="op">*</span> cmath.pi <span class="op">/</span> n)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    x_even <span class="op">=</span> fft(x[<span class="dv">0</span>::<span class="dv">2</span>])</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    x_odd <span class="op">=</span> fft(x[<span class="dv">1</span>::<span class="dv">2</span>])</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> n</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> w <span class="op">*</span> x_odd[k]</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>        X[k] <span class="op">=</span> x_even[k] <span class="op">+</span> t</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>        X[k <span class="op">+</span> n <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> x_even[k] <span class="op">-</span> t</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>        w <span class="op">*=</span> w_n</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> fft(x)</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"FFT:"</span>, X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (Recursive FFT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb138"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;complex.h&gt;</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define PI </span><span class="fl">3.14159265358979323846</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fft<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> <span class="dt">complex</span> even<span class="op">[</span>n<span class="op">/</span><span class="dv">2</span><span class="op">],</span> odd<span class="op">[</span>n<span class="op">/</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>        even<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> x<span class="op">[</span><span class="dv">2</span><span class="op">*</span>i<span class="op">];</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>        odd<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> x<span class="op">[</span><span class="dv">2</span><span class="op">*</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">,</span> even<span class="op">);</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">,</span> odd<span class="op">);</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> <span class="dt">complex</span> w <span class="op">=</span> cexp<span class="op">(-</span><span class="fl">2.0</span> <span class="op">*</span> I <span class="op">*</span> PI <span class="op">*</span> k <span class="op">/</span> n<span class="op">);</span></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> <span class="dt">complex</span> t <span class="op">=</span> w <span class="op">*</span> odd<span class="op">[</span>k<span class="op">];</span></span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>k<span class="op">]</span> <span class="op">=</span> even<span class="op">[</span>k<span class="op">]</span> <span class="op">+</span> t<span class="op">;</span></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>k <span class="op">+</span> n<span class="op">/</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> even<span class="op">[</span>k<span class="op">]</span> <span class="op">-</span> t<span class="op">;</span></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> <span class="dt">complex</span> x<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">};</span></span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span><span class="dv">4</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"X[</span><span class="sc">%d</span><span class="st">] = </span><span class="sc">%.2f</span><span class="st"> + </span><span class="sc">%.2f</span><span class="st">i</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> creal<span class="op">(</span>x<span class="op">[</span>i<span class="op">]),</span> cimag<span class="op">(</span>x<span class="op">[</span>i<span class="op">]));</span></span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-61" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-61">Why It Matters</h4>
<ul>
<li>Transforms signals, images, and time-series to frequency domain in milliseconds.</li>
<li>Foundation for digital filters, convolution, and compression.</li>
<li>Core in machine learning (spectral methods) and physics simulations.</li>
<li>Enables polynomial multiplication in<span class="math inline">\(O(n \log n)\)</span>.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-61" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-61">A Gentle Proof (Why It Works)</h4>
<p>The trick is recognizing that the DFT matrix has repeated patterns due to powers of<span class="math inline">\(\omega_n\)</span>:</p>
<p><span class="math display">\[
W_n =
\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; \omega_n &amp; \omega_n^{2} &amp; \omega_n^{3} \\
1 &amp; \omega_n^{2} &amp; \omega_n^{4} &amp; \omega_n^{6} \\
1 &amp; \omega_n^{3} &amp; \omega_n^{6} &amp; \omega_n^{9}
\end{bmatrix}
\]</span></p>
<p>By splitting into even and odd columns, we reuse computations recursively. This halves the problem size at each level, leading to<span class="math inline">\(\log n\)</span> recursion depth and<span class="math inline">\(n\)</span> work per level.</p>
<p>Total:<span class="math inline">\(O(n \log n)\)</span></p>
</section>
<section id="try-it-yourself-61" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-61">Try It Yourself</h4>
<ol type="1">
<li>Implement FFT for<span class="math inline">\(n = 8\)</span> with random values.</li>
<li>Compare runtime with naive DFT.</li>
<li>Plot runtime vs<span class="math inline">\(n\)</span> (log-log scale).</li>
<li>Apply FFT to a sine wave and visualize peaks in frequency.</li>
<li>Multiply two polynomials using FFT convolution.</li>
</ol>
</section>
<section id="test-cases-55" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-55">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input<span class="math inline">\(x\)</span></th>
<th>FFT<span class="math inline">\(X\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1, 1, 1, 1]</td>
<td>[4, 0, 0, 0]</td>
</tr>
<tr class="even">
<td>[1, 2, 3, 4]</td>
<td>[10, -2-2i, -2, -2+2i]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-61" class="level4">
<h4 class="anchored" data-anchor-id="complexity-61">Complexity</h4>
<ul>
<li>Time:<span class="math inline">\(O(n \log n)\)</span></li>
<li>Space:<span class="math inline">\(O(n)\)</span> (recursive) or<span class="math inline">\(O(1)\)</span> (iterative)</li>
</ul>
<p>FFT turned a quadratic computation into a nearly linear one, a leap so profound it reshaped science, engineering, and computing forever.</p>
</section>
</section>
<section id="cooleytukey-fft" class="level3">
<h3 class="anchored" data-anchor-id="cooleytukey-fft">563 Cooley–Tukey FFT</h3>
<p>The Cooley–Tukey algorithm is the most widely used implementation of the Fast Fourier Transform (FFT). It’s the algorithm that made the FFT practical, elegant, and efficient—reducing the <span class="math inline">\(O(n^2)\)</span> Discrete Fourier Transform to <span class="math inline">\(O(n\log n)\)</span> by recursively decomposing it into smaller transforms.</p>
<p>This method leverages the divide-and-conquer principle and the symmetry of complex roots of unity, making it the backbone of nearly all FFT libraries.</p>
<section id="what-problem-are-we-solving-62" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-62">What Problem Are We Solving?</h4>
<p>We want to compute the Discrete Fourier Transform efficiently:</p>
<p><span class="math display">\[
X_k=\sum_{j=0}^{n-1}x_j\cdot e^{-2\pi i\frac{jk}{n}}
\]</span></p>
<p>Instead of computing all terms directly, we split the sequence into smaller pieces and reuse results—dramatically cutting down redundant computation.</p>
</section>
<section id="how-does-it-work-plain-language-62" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-62">How Does It Work (Plain Language)</h4>
<p>Cooley–Tukey works by recursively dividing the DFT into smaller DFTs:</p>
<ol type="1">
<li><p>Split the input sequence into even and odd indexed elements:</p>
<ul>
<li><span class="math inline">\(x_{\text{even}}=[x_0,x_2,x_4,\ldots]\)</span></li>
<li><span class="math inline">\(x_{\text{odd}}=[x_1,x_3,x_5,\ldots]\)</span></li>
</ul></li>
<li><p>Compute two smaller DFTs of size <span class="math inline">\(n/2\)</span>:</p>
<ul>
<li><span class="math inline">\(E_k=\text{DFT}(x_{\text{even}})\)</span></li>
<li><span class="math inline">\(O_k=\text{DFT}(x_{\text{odd}})\)</span></li>
</ul></li>
<li><p>Combine them using twiddle factors:</p>
<ul>
<li><span class="math inline">\(\omega_n=e^{-2\pi i/n}\)</span></li>
</ul></li>
</ol>
<p>The combination step:</p>
<p><span class="math display">\[
X_k=E_k+\omega_n^kO_k
\]</span></p>
<p><span class="math display">\[
X_{k+n/2}=E_k-\omega_n^kO_k
\]</span></p>
</section>
<section id="example-n8" class="level4">
<h4 class="anchored" data-anchor-id="example-n8">Example (<span class="math inline">\(n=8\)</span>)</h4>
<p>Suppose <span class="math inline">\(x=[x_0,x_1,\ldots,x_7]\)</span></p>
<ol type="1">
<li><p>Split into evens and odds:</p>
<ul>
<li><span class="math inline">\([x_0,x_2,x_4,x_6]\)</span></li>
<li><span class="math inline">\([x_1,x_3,x_5,x_7]\)</span></li>
</ul></li>
<li><p>Recursively compute 4-point FFTs for each.</p></li>
<li><p>Combine:</p>
<ul>
<li><span class="math inline">\(X_k=E_k+\omega_8^kO_k\)</span></li>
<li><span class="math inline">\(X_{k+4}=E_k-\omega_8^kO_k\)</span></li>
</ul></li>
</ol>
<p>Each recursion layer halves the problem, and there are <span class="math inline">\(\log_2 n\)</span> layers total.</p>
</section>
<section id="tiny-code-recursive-implementation" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-recursive-implementation">Tiny Code (Recursive Implementation)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmath</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cooley_tukey_fft(x):</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>    w_n <span class="op">=</span> cmath.exp(<span class="op">-</span><span class="ot">2j</span> <span class="op">*</span> cmath.pi <span class="op">/</span> n)</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>    X_even <span class="op">=</span> cooley_tukey_fft(x[<span class="dv">0</span>::<span class="dv">2</span>])</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>    X_odd <span class="op">=</span> cooley_tukey_fft(x[<span class="dv">1</span>::<span class="dv">2</span>])</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> n</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> w <span class="op">*</span> X_odd[k]</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>        X[k] <span class="op">=</span> X_even[k] <span class="op">+</span> t</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>        X[k <span class="op">+</span> n <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> X_even[k] <span class="op">-</span> t</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>        w <span class="op">*=</span> w_n</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>]</span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> cooley_tukey_fft(x)</span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"FFT:"</span>, X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (Recursive)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb140"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;complex.h&gt;</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define PI </span><span class="fl">3.14159265358979323846</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fft<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> <span class="dt">complex</span> even<span class="op">[</span>n<span class="op">/</span><span class="dv">2</span><span class="op">],</span> odd<span class="op">[</span>n<span class="op">/</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>        even<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> x<span class="op">[</span><span class="dv">2</span><span class="op">*</span>i<span class="op">];</span></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>        odd<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> x<span class="op">[</span><span class="dv">2</span><span class="op">*</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">,</span> even<span class="op">);</span></span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">,</span> odd<span class="op">);</span></span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> <span class="dt">complex</span> w <span class="op">=</span> cexp<span class="op">(-</span><span class="fl">2.0</span> <span class="op">*</span> I <span class="op">*</span> PI <span class="op">*</span> k <span class="op">/</span> n<span class="op">);</span></span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> <span class="dt">complex</span> t <span class="op">=</span> w <span class="op">*</span> odd<span class="op">[</span>k<span class="op">];</span></span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>k<span class="op">]</span> <span class="op">=</span> even<span class="op">[</span>k<span class="op">]</span> <span class="op">+</span> t<span class="op">;</span></span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>k <span class="op">+</span> n<span class="op">/</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> even<span class="op">[</span>k<span class="op">]</span> <span class="op">-</span> t<span class="op">;</span></span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> <span class="dt">complex</span> x<span class="op">[</span><span class="dv">8</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">8</span><span class="op">};</span></span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span><span class="dv">8</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">8</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"X[</span><span class="sc">%d</span><span class="st">] = </span><span class="sc">%.2f</span><span class="st"> + </span><span class="sc">%.2f</span><span class="st">i</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> creal<span class="op">(</span>x<span class="op">[</span>i<span class="op">]),</span> cimag<span class="op">(</span>x<span class="op">[</span>i<span class="op">]));</span></span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-62" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-62">Why It Matters</h4>
<ul>
<li>Reduces runtime from <span class="math inline">\(O(n^2)\)</span> to <span class="math inline">\(O(n\log n)\)</span></li>
<li>Basis for audio/video processing, image transforms, and DSP</li>
<li>Essential for fast polynomial multiplication, signal filtering, and spectral analysis</li>
<li>Universally adopted in FFT libraries (FFTW, NumPy, cuFFT)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-62" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-62">A Gentle Proof (Why It Works)</h4>
<p>The DFT matrix <span class="math inline">\(W_n\)</span> is built from complex roots of unity:</p>
<p><span class="math display">\[
W_n =
\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; \dots &amp; 1 \\
1 &amp; \omega_n &amp; \omega_n^2 &amp; \dots &amp; \omega_n^{n-1} \\
1 &amp; \omega_n^2 &amp; \omega_n^4 &amp; \dots &amp; \omega_n^{2(n-1)} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; \omega_n^{n-1} &amp; \omega_n^{2(n-1)} &amp; \dots &amp; \omega_n^{(n-1)^2}
\end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(\omega_n = e^{-2\pi i / n}\)</span> is the <span class="math inline">\(n\)</span>th root of unity.</p>
<p>By reordering and grouping even/odd columns, we get two smaller <span class="math inline">\(W_{n/2}\)</span> blocks, multiplied by twiddle factors. Thus, each recursive step halves the problem size—leading to <span class="math inline">\(\log_2 n\)</span> levels of computation.</p>
</section>
<section id="try-it-yourself-62" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-62">Try It Yourself</h4>
<ol type="1">
<li>Compute FFT for <span class="math inline">\([1,2,3,4,5,6,7,8]\)</span> by hand (2 levels).</li>
<li>Verify symmetry <span class="math inline">\(X_{k+n/2}=E_k-\omega_n^kO_k\)</span>.</li>
<li>Compare runtime with DFT for <span class="math inline">\(n=1024\)</span>.</li>
<li>Visualize recursion tree.</li>
<li>Test on sine wave input—check peaks in frequency domain.</li>
</ol>
</section>
<section id="test-cases-56" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-56">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>Input</th>
<th>Output (Magnitude)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,1,1,1,1,1,1,1]</td>
<td>[8,0,0,0,0,0,0,0]</td>
</tr>
<tr class="even">
<td>[1,2,3,4,5,6,7,8]</td>
<td>[36,-4+9.66i,-4+4i,-4+1.66i,-4,-4-1.66i,-4-4i,-4-9.66i]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-62" class="level4">
<h4 class="anchored" data-anchor-id="complexity-62">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span> (recursion) or <span class="math inline">\(O(1)\)</span> (iterative version)</li>
</ul>
<p>The Cooley–Tukey FFT is more than a clever trick—it’s a profound insight into symmetry and structure, transforming the way we compute, analyze, and understand signals across every field of science and engineering.</p>
</section>
</section>
<section id="iterative-fft" class="level3">
<h3 class="anchored" data-anchor-id="iterative-fft">564 Iterative FFT</h3>
<p>The Iterative FFT is an efficient, non-recursive implementation of the Cooley–Tukey Fast Fourier Transform. Instead of recursive calls, it computes the transform in-place, reordering elements using bit-reversal permutation and iteratively combining results in layers.</p>
<p>This approach is widely used in high-performance FFT libraries (like FFTW or cuFFT) because it’s cache-friendly, stack-safe, and parallelizable.</p>
<section id="what-problem-are-we-solving-63" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-63">What Problem Are We Solving?</h4>
<p>Recursive FFT is elegant, but function calls and memory allocation overheads can slow it down. The iterative FFT eliminates recursion, doing all the same computations directly in loops.</p>
<p>We still want to compute:</p>
<p><span class="math display">\[
X_k=\sum_{j=0}^{n-1}x_j\cdot e^{-2\pi i\frac{jk}{n}}
\]</span></p>
<p>but we’ll reuse the divide-and-conquer pattern iteratively.</p>
</section>
<section id="how-does-it-work-plain-language-63" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-63">How Does It Work (Plain Language)</h4>
<p>The iterative FFT runs in logarithmic stages, each stage doubling the subproblem size:</p>
<ol type="1">
<li><p>Bit-Reversal Permutation Reorder the input so indices follow bit-reversed order (mirror the binary digits). Example: for <span class="math inline">\(n=8\)</span>, indices <span class="math inline">\([0,1,2,3,4,5,6,7]\)</span> become <span class="math inline">\([0,4,2,6,1,5,3,7]\)</span>.</p></li>
<li><p>Butterfly Computation Combine pairs of elements (like wings of a butterfly) using twiddle factors: <span class="math display">\[
t=\omega_n^k\cdot X_{\text{odd}}
\]</span> Then update: <span class="math display">\[
X_{\text{even}}'=X_{\text{even}}+t
\]</span> <span class="math display">\[
X_{\text{odd}}'=X_{\text{even}}-t
\]</span></p></li>
<li><p>Iterate over stages Each stage merges smaller DFTs into larger ones, doubling the block size until full length.</p></li>
</ol>
<p>By the end, <span class="math inline">\(x\)</span> is transformed in-place to <span class="math inline">\(X\)</span>.</p>
</section>
<section id="example-n8-1" class="level4">
<h4 class="anchored" data-anchor-id="example-n8-1">Example (<span class="math inline">\(n=8\)</span>)</h4>
<ol type="1">
<li>Input: <span class="math inline">\(x=[x_0,x_1,x_2,x_3,x_4,x_5,x_6,x_7]\)</span></li>
<li>Reorder via bit-reversal: <span class="math inline">\([x_0,x_4,x_2,x_6,x_1,x_5,x_3,x_7]\)</span></li>
<li>Stage 1: combine pairs <span class="math inline">\((x_0,x_1),(x_2,x_3),\ldots\)</span></li>
<li>Stage 2: combine blocks of size 4</li>
<li>Stage 3: combine blocks of size 8</li>
</ol>
<p>Each stage multiplies by twiddle factors <span class="math inline">\(\omega_n^k=e^{-2\pi i k/n}\)</span>, performing butterflies iteratively.</p>
</section>
<section id="tiny-code-iterative-fft" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-iterative-fft">Tiny Code (Iterative FFT)</h4>
<p>Python (In-Place Iterative FFT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmath</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bit_reverse(x):</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>        bit <span class="op">=</span> n <span class="op">&gt;&gt;</span> <span class="dv">1</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> j <span class="op">&amp;</span> bit:</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>            j <span class="op">^=</span> bit</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>            bit <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>        j <span class="op">^=</span> bit</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&lt;</span> j:</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>            x[i], x[j] <span class="op">=</span> x[j], x[i]</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> iterative_fft(x):</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>    bit_reverse(x)</span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>    size <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> size <span class="op">&lt;=</span> n:</span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>        w_m <span class="op">=</span> cmath.exp(<span class="op">-</span><span class="ot">2j</span> <span class="op">*</span> cmath.pi <span class="op">/</span> size)</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, size):</span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>            w <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(size <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>                t <span class="op">=</span> w <span class="op">*</span> x[k <span class="op">+</span> j <span class="op">+</span> size <span class="op">//</span> <span class="dv">2</span>]</span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>                u <span class="op">=</span> x[k <span class="op">+</span> j]</span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a>                x[k <span class="op">+</span> j] <span class="op">=</span> u <span class="op">+</span> t</span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a>                x[k <span class="op">+</span> j <span class="op">+</span> size <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> u <span class="op">-</span> t</span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a>                w <span class="op">*=</span> w_m</span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a>        size <span class="op">*=</span> <span class="dv">2</span></span>
<span id="cb141-30"><a href="#cb141-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb141-31"><a href="#cb141-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-32"><a href="#cb141-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb141-33"><a href="#cb141-33" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>]</span>
<span id="cb141-34"><a href="#cb141-34" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> iterative_fft([<span class="bu">complex</span>(a, <span class="dv">0</span>) <span class="cf">for</span> a <span class="kw">in</span> x])</span>
<span id="cb141-35"><a href="#cb141-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"FFT:"</span>, X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (In-Place Iterative FFT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb142"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;complex.h&gt;</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define PI </span><span class="fl">3.14159265358979323846</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> bit_reverse<span class="op">(</span><span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>x<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> bit <span class="op">=</span> n <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>j <span class="op">&amp;</span> bit<span class="op">)</span> <span class="op">{</span> j <span class="op">^=</span> bit<span class="op">;</span> bit <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>        j <span class="op">^=</span> bit<span class="op">;</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">&lt;</span> j<span class="op">)</span> <span class="op">{</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> <span class="dt">complex</span> temp <span class="op">=</span> x<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>            x<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> x<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>            x<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> iterative_fft<span class="op">(</span><span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>x<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>    bit_reverse<span class="op">(</span>x<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> size <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> size <span class="op">&lt;=</span> n<span class="op">;</span> size <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> angle <span class="op">=</span> <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> PI <span class="op">/</span> size<span class="op">;</span></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> <span class="dt">complex</span> w_m <span class="op">=</span> cos<span class="op">(</span>angle<span class="op">)</span> <span class="op">+</span> I <span class="op">*</span> sin<span class="op">(</span>angle<span class="op">);</span></span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">;</span> k <span class="op">+=</span> size<span class="op">)</span> <span class="op">{</span></span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> <span class="dt">complex</span> w <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> size<span class="op">/</span><span class="dv">2</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>                <span class="dt">double</span> <span class="dt">complex</span> t <span class="op">=</span> w <span class="op">*</span> x<span class="op">[</span>k <span class="op">+</span> j <span class="op">+</span> size<span class="op">/</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a>                <span class="dt">double</span> <span class="dt">complex</span> u <span class="op">=</span> x<span class="op">[</span>k <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a>                x<span class="op">[</span>k <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> u <span class="op">+</span> t<span class="op">;</span></span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a>                x<span class="op">[</span>k <span class="op">+</span> j <span class="op">+</span> size<span class="op">/</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> u <span class="op">-</span> t<span class="op">;</span></span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a>                w <span class="op">*=</span> w_m<span class="op">;</span></span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-63" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-63">Why It Matters</h4>
<ul>
<li>Removes recursion overhead, faster in practice</li>
<li>In-place, requires no extra arrays</li>
<li>Foundation for GPU FFTs, DSP hardware, and real-time systems</li>
<li>Enables batch FFTs efficiently (parallelizable loops)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-63" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-63">A Gentle Proof (Why It Works)</h4>
<p>The iterative FFT simply traverses the same recursion tree bottom-up. The bit-reversal ensures inputs line up as they would in recursive order. Each stage merges DFTs of size <span class="math inline">\(2^k\)</span> into <span class="math inline">\(2^{k+1}\)</span>, using identical butterfly equations:</p>
<p><span class="math display">\[
X_k=E_k+\omega_n^kO_k,\quad X_{k+n/2}=E_k-\omega_n^kO_k
\]</span></p>
<p>By repeating for <span class="math inline">\(\log_2 n\)</span> stages, we compute the full FFT.</p>
</section>
<section id="try-it-yourself-63" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-63">Try It Yourself</h4>
<ol type="1">
<li>Apply iterative FFT to <span class="math inline">\([1,2,3,4,5,6,7,8]\)</span>.</li>
<li>Print array after bit-reversal, confirm order.</li>
<li>Compare result to recursive FFT.</li>
<li>Plot runtime for <span class="math inline">\(n=2^k\)</span>.</li>
<li>Extend to inverse FFT (change sign in exponent, divide by <span class="math inline">\(n\)</span>).</li>
</ol>
</section>
<section id="test-cases-57" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-57">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>Input</th>
<th>Output (Magnitude)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,1,1,1,1,1,1,1]</td>
<td>[8,0,0,0,0,0,0,0]</td>
</tr>
<tr class="even">
<td>[1,2,3,4,5,6,7,8]</td>
<td>[36,-4+9.66i,-4+4i,-4+1.66i,-4,-4-1.66i,-4-4i,-4-9.66i]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-63" class="level4">
<h4 class="anchored" data-anchor-id="complexity-63">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span> (in-place)</li>
</ul>
<p>The iterative FFT replaces elegant recursion with raw efficiency—bringing the same mathematical beauty into tight, blazing-fast loops.</p>
</section>
</section>
<section id="inverse-fft-ifft" class="level3">
<h3 class="anchored" data-anchor-id="inverse-fft-ifft">565 Inverse FFT (IFFT)</h3>
<p>The Inverse Fast Fourier Transform (IFFT) is the mirror image of the FFT. It takes a signal from the frequency domain back to the time domain, perfectly reconstructing the original sequence. Where FFT decomposes a signal into frequencies, IFFT reassembles it from those same components, a complete round-trip transformation.</p>
<section id="what-problem-are-we-solving-64" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-64">What Problem Are We Solving?</h4>
<p>Given the Fourier coefficients <span class="math inline">\(X_0, X_1, \ldots, X_{n-1}\)</span>, we want to reconstruct the original signal <span class="math inline">\(x_0, x_1, \ldots, x_{n-1}\)</span>.</p>
<p>The definition of the inverse DFT is:</p>
<p><span class="math display">\[
x_j=\frac{1}{n}\sum_{k=0}^{n-1}X_k\cdot e^{2\pi i\frac{jk}{n}}
\]</span></p>
<p>IFFT allows us to recover time-domain data after performing operations (like filtering or convolution) in the frequency domain.</p>
</section>
<section id="how-does-it-work-plain-language-64" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-64">How Does It Work (Plain Language)</h4>
<p>IFFT works just like FFT, same butterfly structure, same recursion or iteration, but with conjugated twiddle factors and a final scaling by <span class="math inline">\(1/n\)</span>.</p>
<p>To compute the IFFT:</p>
<ol type="1">
<li>Take the complex conjugate of all frequency components.</li>
<li>Run a forward FFT.</li>
<li>Take the complex conjugate again.</li>
<li>Divide every result by <span class="math inline">\(n\)</span>.</li>
</ol>
<p>This uses the fact that: <span class="math display">\[
\text{IFFT}(X)=\frac{1}{n}\cdot\overline{\text{FFT}(\overline{X})}
\]</span></p>
</section>
<section id="example-33" class="level4">
<h4 class="anchored" data-anchor-id="example-33">Example</h4>
<p>Let <span class="math inline">\(X=[10,-2-2i,-2,-2+2i]\)</span></p>
<ol type="1">
<li>Conjugate: <span class="math inline">\([10,-2+2i,-2,-2-2i]\)</span></li>
<li>FFT of conjugated values <span class="math inline">\(\to [4,8,12,16]\)</span></li>
<li>Conjugate again: <span class="math inline">\([4,8,12,16]\)</span></li>
<li>Divide by <span class="math inline">\(n=4\)</span>: <span class="math inline">\([1,2,3,4]\)</span></li>
</ol>
<p>Recovered original: <span class="math inline">\(x=[1,2,3,4]\)</span></p>
<p>Perfect reconstruction confirmed.</p>
</section>
<section id="tiny-code-easy-versions-58" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-58">Tiny Code (Easy Versions)</h4>
<p>Python (IFFT via FFT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmath</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fft(x):</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    w_n <span class="op">=</span> cmath.exp(<span class="op">-</span><span class="ot">2j</span> <span class="op">*</span> cmath.pi <span class="op">/</span> n)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    X_even <span class="op">=</span> fft(x[<span class="dv">0</span>::<span class="dv">2</span>])</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    X_odd <span class="op">=</span> fft(x[<span class="dv">1</span>::<span class="dv">2</span>])</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> n</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> w <span class="op">*</span> X_odd[k]</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>        X[k] <span class="op">=</span> X_even[k] <span class="op">+</span> t</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>        X[k <span class="op">+</span> n <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> X_even[k] <span class="op">-</span> t</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>        w <span class="op">*=</span> w_n</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ifft(X):</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(X)</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>    X_conj <span class="op">=</span> [x.conjugate() <span class="cf">for</span> x <span class="kw">in</span> X]</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> fft(X_conj)</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> [val.conjugate() <span class="op">/</span> n <span class="cf">for</span> val <span class="kw">in</span> x]</span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> [<span class="dv">10</span>, <span class="op">-</span><span class="dv">2</span><span class="op">-</span><span class="ot">2j</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span><span class="op">+</span><span class="ot">2j</span>]</span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"IFFT:"</span>, ifft(X))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (IFFT using FFT structure)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb144"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;complex.h&gt;</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#define PI </span><span class="fl">3.14159265358979323846</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fft<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>x<span class="op">,</span> <span class="dt">int</span> inverse<span class="op">)</span> <span class="op">{</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> <span class="dt">complex</span> even<span class="op">[</span>n<span class="op">/</span><span class="dv">2</span><span class="op">],</span> odd<span class="op">[</span>n<span class="op">/</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>        even<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> x<span class="op">[</span><span class="dv">2</span><span class="op">*</span>i<span class="op">];</span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>        odd<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> x<span class="op">[</span><span class="dv">2</span><span class="op">*</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">,</span> even<span class="op">,</span> inverse<span class="op">);</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">,</span> odd<span class="op">,</span> inverse<span class="op">);</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> sign <span class="op">=</span> inverse <span class="op">?</span> <span class="fl">2.0</span> <span class="op">*</span> PI <span class="op">:</span> <span class="op">-</span><span class="fl">2.0</span> <span class="op">*</span> PI<span class="op">;</span></span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">/</span><span class="dv">2</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> <span class="dt">complex</span> w <span class="op">=</span> cexp<span class="op">(</span>I <span class="op">*</span> sign <span class="op">*</span> k <span class="op">/</span> n<span class="op">);</span></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> <span class="dt">complex</span> t <span class="op">=</span> w <span class="op">*</span> odd<span class="op">[</span>k<span class="op">];</span></span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>k<span class="op">]</span> <span class="op">=</span> even<span class="op">[</span>k<span class="op">]</span> <span class="op">+</span> t<span class="op">;</span></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>k <span class="op">+</span> n<span class="op">/</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> even<span class="op">[</span>k<span class="op">]</span> <span class="op">-</span> t<span class="op">;</span></span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>inverse<span class="op">)</span> <span class="op">{</span></span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>            x<span class="op">[</span>k<span class="op">]</span> <span class="op">/=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>            x<span class="op">[</span>k <span class="op">+</span> n<span class="op">/</span><span class="dv">2</span><span class="op">]</span> <span class="op">/=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> <span class="dt">complex</span> X<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">10</span><span class="op">,</span> <span class="op">-</span><span class="dv">2</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>I<span class="op">,</span> <span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="op">-</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>I<span class="op">};</span></span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span><span class="dv">4</span><span class="op">,</span> X<span class="op">,</span> <span class="dv">1</span><span class="op">);</span> <span class="co">// inverse FFT</span></span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"x[</span><span class="sc">%d</span><span class="st">] = </span><span class="sc">%.2f</span><span class="st"> + </span><span class="sc">%.2f</span><span class="st">i</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> creal<span class="op">(</span>X<span class="op">[</span>i<span class="op">]),</span> cimag<span class="op">(</span>X<span class="op">[</span>i<span class="op">]));</span></span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-64" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-64">Why It Matters</h4>
<ul>
<li>Restores time-domain data from frequency components</li>
<li>Used in signal reconstruction, convolution, and filter design</li>
<li>Guarantees perfect reversibility with FFT</li>
<li>Central to compression algorithms, image restoration, and physics simulations</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-64" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-64">A Gentle Proof (Why It Works)</h4>
<p>The DFT and IFFT matrices are Hermitian inverses:</p>
<p><span class="math display">\[
F_{n}^{-1}=\frac{1}{n}\overline{F_n}^T
\]</span></p>
<p>Thus, applying FFT followed by IFFT yields the identity:</p>
<p><span class="math display">\[
\text{IFFT}(\text{FFT}(x))=x
\]</span></p>
<p>Conjugation flips the sign of exponents, and scaling by <span class="math inline">\(1/n\)</span> ensures normalization.</p>
</section>
<section id="try-it-yourself-64" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-64">Try It Yourself</h4>
<ol type="1">
<li>Compute FFT of <span class="math inline">\([1,2,3,4]\)</span>, then apply IFFT.</li>
<li>Compare reconstructed result to original.</li>
<li>Modify <span class="math inline">\(X\)</span> by zeroing high frequencies, watch smoothing effect.</li>
<li>Use IFFT for polynomial multiplication results.</li>
<li>Visualize magnitude and phase before and after IFFT.</li>
</ol>
</section>
<section id="test-cases-58" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-58">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input <span class="math inline">\(X\)</span></th>
<th>Output <span class="math inline">\(x\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[10,-2-2i,-2,-2+2i]</td>
<td>[1,2,3,4]</td>
</tr>
<tr class="even">
<td>[4,0,0,0]</td>
<td>[1,1,1,1]</td>
</tr>
<tr class="odd">
<td>[8,0,0,0,0,0,0,0]</td>
<td>[1,1,1,1,1,1,1,1]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-64" class="level4">
<h4 class="anchored" data-anchor-id="complexity-64">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>IFFT is the mirror step of FFT, same structure, reversed flow. It completes the cycle: from time to frequency and back, without losing a single bit of truth.</p>
</section>
</section>
<section id="convolution-via-fft" class="level3">
<h3 class="anchored" data-anchor-id="convolution-via-fft">566 Convolution via FFT</h3>
<p>Convolution is one of the most fundamental operations in mathematics, signal processing, and computer science. It combines two sequences into one, blending information over shifts. But computing convolution directly takes <span class="math inline">\(O(n^2)\)</span> time. The FFT Convolution Theorem gives us a shortcut: by transforming to the frequency domain, we can do it in <span class="math inline">\(O(n\log n)\)</span> time.</p>
<section id="what-problem-are-we-solving-65" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-65">What Problem Are We Solving?</h4>
<p>Given two sequences <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> of lengths <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>, we want their convolution <span class="math inline">\(c = a * b\)</span>:</p>
<p><span class="math display">\[
c_k=\sum_{i=0}^{k}a_i\cdot b_{k-i}
\]</span></p>
<p>for <span class="math inline">\(k=0,\ldots,n+m-2\)</span>.</p>
<p>This appears in:</p>
<ul>
<li>Signal processing (filtering, correlation)</li>
<li>Polynomial multiplication</li>
<li>Pattern matching</li>
<li>Probability distributions (sum of random variables)</li>
</ul>
<p>A direct computation is <span class="math inline">\(O(nm)\)</span>. Using FFT, we can reduce it to <span class="math inline">\(O(n\log n)\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-65" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-65">How Does It Work (Plain Language)</h4>
<p>The Convolution Theorem says:</p>
<p><span class="math display">\[
\text{DFT}(a*b)=\text{DFT}(a)\cdot\text{DFT}(b)
\]</span></p>
<p>That is, convolution in time domain equals pointwise multiplication in frequency domain.</p>
<p>So to compute convolution fast:</p>
<ol type="1">
<li>Pad both sequences to size <span class="math inline">\(N\ge n+m-1\)</span> (power of 2).</li>
<li>Compute FFT of both: <span class="math inline">\(A=\text{FFT}(a)\)</span>, <span class="math inline">\(B=\text{FFT}(b)\)</span>.</li>
<li>Multiply pointwise: <span class="math inline">\(C_k=A_k\cdot B_k\)</span>.</li>
<li>Apply inverse FFT: <span class="math inline">\(c=\text{IFFT}(C)\)</span>.</li>
<li>Take real parts (round small errors).</li>
</ol>
</section>
<section id="example-34" class="level4">
<h4 class="anchored" data-anchor-id="example-34">Example</h4>
<p>Let <span class="math inline">\(a=[1,2,3]\)</span>, <span class="math inline">\(b=[4,5,6]\)</span></p>
<p>Expected convolution (by hand):</p>
<p><span class="math display">\[
c=[1\cdot4,1\cdot5+2\cdot4,1\cdot6+2\cdot5+3\cdot4,2\cdot6+3\cdot5,3\cdot6]
\]</span></p>
<p><span class="math display">\[
c=[4,13,28,27,18]
\]</span></p>
<p>FFT method:</p>
<ol type="1">
<li>Pad <span class="math inline">\(a,b\)</span> to length 8</li>
<li><span class="math inline">\(A=\text{FFT}(a)\)</span>, <span class="math inline">\(B=\text{FFT}(b)\)</span></li>
<li><span class="math inline">\(C=A\cdot B\)</span></li>
<li><span class="math inline">\(c=\text{IFFT}(C)\)</span></li>
<li>Round to integers <span class="math inline">\(\Rightarrow [4,13,28,27,18]\)</span></li>
</ol>
<p>Matches perfectly.</p>
</section>
<section id="tiny-code-easy-versions-59" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-easy-versions-59">Tiny Code (Easy Versions)</h4>
<p>Python (FFT Convolution)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmath</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fft(x):</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>    w_n <span class="op">=</span> cmath.exp(<span class="op">-</span><span class="ot">2j</span> <span class="op">*</span> cmath.pi <span class="op">/</span> n)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>    X_even <span class="op">=</span> fft(x[<span class="dv">0</span>::<span class="dv">2</span>])</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    X_odd <span class="op">=</span> fft(x[<span class="dv">1</span>::<span class="dv">2</span>])</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> n</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> w <span class="op">*</span> X_odd[k]</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>        X[k] <span class="op">=</span> X_even[k] <span class="op">+</span> t</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>        X[k <span class="op">+</span> n <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> X_even[k] <span class="op">-</span> t</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>        w <span class="op">*=</span> w_n</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ifft(X):</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(X)</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>    X_conj <span class="op">=</span> [x.conjugate() <span class="cf">for</span> x <span class="kw">in</span> X]</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> fft(X_conj)</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [v.conjugate()<span class="op">/</span>n <span class="cf">for</span> v <span class="kw">in</span> x]</span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convolution(a, b):</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> n <span class="op">&lt;</span> <span class="bu">len</span>(a) <span class="op">+</span> <span class="bu">len</span>(b) <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>        n <span class="op">*=</span> <span class="dv">2</span></span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>    a <span class="op">+=</span> [<span class="dv">0</span>]<span class="op">*</span>(n <span class="op">-</span> <span class="bu">len</span>(a))</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a>    b <span class="op">+=</span> [<span class="dv">0</span>]<span class="op">*</span>(n <span class="op">-</span> <span class="bu">len</span>(b))</span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> fft(a)</span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> fft(b)</span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [A[i]<span class="op">*</span>B[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> ifft(C)</span>
<span id="cb145-35"><a href="#cb145-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">round</span>(v.real) <span class="cf">for</span> v <span class="kw">in</span> c]</span>
<span id="cb145-36"><a href="#cb145-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-37"><a href="#cb145-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb145-38"><a href="#cb145-38" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb145-39"><a href="#cb145-39" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb145-40"><a href="#cb145-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(convolution(a, b))  <span class="co"># [4, 13, 28, 27, 18]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (FFT Convolution Skeleton)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb146"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Assume fft() and ifft() functions are implemented</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> convolution<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>b<span class="op">,</span> <span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> size <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>size <span class="op">&lt;</span> <span class="dv">2</span> <span class="op">*</span> n<span class="op">)</span> size <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// pad arrays</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">;</span> i <span class="op">&lt;</span> size<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>        a<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>        b<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>size<span class="op">,</span> a<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>size<span class="op">,</span> b<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> size<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>        c<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>size<span class="op">,</span> c<span class="op">,</span> <span class="dv">1</span><span class="op">);</span> <span class="co">// inverse FFT (scaled)</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-65" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-65">Why It Matters</h4>
<ul>
<li>Turns slow <span class="math inline">\(O(n^2)\)</span> convolution into <span class="math inline">\(O(n\log n)\)</span></li>
<li>Core technique in polynomial multiplication, digital filters, signal correlation, neural network layers, probabilistic sums</li>
<li>Used in big integer multiplication (Karatsuba, Schönhage–Strassen)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-65" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-65">A Gentle Proof (Why It Works)</h4>
<p>The DFT converts convolution to multiplication:</p>
<p><span class="math display">\[
C=\text{DFT}(a*b)=\text{DFT}(a)\cdot\text{DFT}(b)
\]</span></p>
<p>Because the DFT matrix diagonalizes cyclic shifts, it transforms convolution (which involves shifts and sums) into independent multiplications of frequencies.</p>
<p>Then applying <span class="math inline">\(\text{IDFT}\)</span> recovers the exact result.</p>
</section>
<section id="try-it-yourself-65" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-65">Try It Yourself</h4>
<ol type="1">
<li>Convolve <span class="math inline">\([1,2,3]\)</span> and <span class="math inline">\([4,5,6]\)</span> manually, then verify via FFT.</li>
<li>Pad inputs to power of 2 and observe intermediate arrays.</li>
<li>Try longer polynomials (length 1000), measure speed difference.</li>
<li>Plot inputs, their spectra, and output.</li>
<li>Implement modulo convolution (e.g.&nbsp;with Number Theoretic Transform).</li>
</ol>
</section>
<section id="test-cases-59" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-59">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(a\)</span></th>
<th><span class="math inline">\(b\)</span></th>
<th><span class="math inline">\(a*b\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2,3]</td>
<td>[4,5,6]</td>
<td>[4,13,28,27,18]</td>
</tr>
<tr class="even">
<td>[1,1,1]</td>
<td>[1,2,3]</td>
<td>[1,3,6,5,3]</td>
</tr>
<tr class="odd">
<td>[2,0,1]</td>
<td>[3,4]</td>
<td>[6,8,3,4]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-65" class="level4">
<h4 class="anchored" data-anchor-id="complexity-65">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>FFT Convolution is how computers multiply long numbers, combine signals, and merge patterns, faster than you could ever do by hand.</p>
</section>
</section>
<section id="number-theoretic-transform-ntt" class="level3">
<h3 class="anchored" data-anchor-id="number-theoretic-transform-ntt">567 Number Theoretic Transform (NTT)</h3>
<p>The Number Theoretic Transform (NTT) is the modular arithmetic version of the FFT. It replaces complex numbers with integers under a finite modulus, allowing all computations to be done exactly (no floating-point error), perfect for cryptography, combinatorics, and competitive programming.</p>
<p>While FFT uses complex roots of unity <span class="math inline">\(e^{2\pi i/n}\)</span>, NTT uses primitive roots of unity modulo a prime.</p>
<section id="what-problem-are-we-solving-66" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-66">What Problem Are We Solving?</h4>
<p>We want to perform polynomial multiplication (or convolution) exactly, using modular arithmetic instead of floating-point numbers.</p>
<p>Given two polynomials:</p>
<p><span class="math display">\[
A(x)=\sum_{i=0}^{n-1}a_i x^i,\quad B(x)=\sum_{i=0}^{m-1}b_i x^i
\]</span></p>
<p>Their product:</p>
<p><span class="math display">\[
C(x)=A(x)\cdot B(x)=\sum_{k=0}^{n+m-2}c_kx^k
\]</span></p>
<p>with</p>
<p><span class="math display">\[
c_k=\sum_{i=0}^{k}a_i\cdot b_{k-i}
\]</span></p>
<p>We want to compute all <span class="math inline">\(c_k\)</span> efficiently, under modulo <span class="math inline">\(M\)</span>.</p>
</section>
<section id="key-idea" class="level4">
<h4 class="anchored" data-anchor-id="key-idea">Key Idea</h4>
<p>The Convolution Theorem holds in modular arithmetic too, if we can find a primitive <span class="math inline">\(n\)</span>-th root of unity <span class="math inline">\(g\)</span> such that:</p>
<p><span class="math display">\[
g^n\equiv1\pmod M
\]</span></p>
<p>and</p>
<p><span class="math display">\[
g^k\not\equiv1\pmod M,\ \text{for } 0&lt;k&lt;n
\]</span></p>
<p>Then, we can define an NTT just like FFT:</p>
<p><span class="math display">\[
A_k=\sum_{j=0}^{n-1}a_j\cdot g^{jk}\pmod M
\]</span></p>
<p>and invert it using <span class="math inline">\(g^{-1}\)</span> and <span class="math inline">\(n^{-1}\pmod M\)</span>.</p>
</section>
<section id="how-it-works-plain-language" class="level4">
<h4 class="anchored" data-anchor-id="how-it-works-plain-language">How It Works (Plain Language)</h4>
<ol type="1">
<li>Choose a modulus <span class="math inline">\(M\)</span> where <span class="math inline">\(M=k\cdot 2^m+1\)</span> (a FFT-friendly prime). Example: <span class="math inline">\(M=998244353=119\cdot2^{23}+1\)</span></li>
<li>Find primitive root <span class="math inline">\(g\)</span> (e.g.&nbsp;<span class="math inline">\(g=3\)</span>).</li>
<li>Perform FFT-like butterflies with modular multiplications.</li>
<li>For inverse, use <span class="math inline">\(g^{-1}\)</span> and divide by <span class="math inline">\(n\)</span> via modular inverse.</li>
</ol>
<p>This ensures exact results, no rounding errors.</p>
</section>
<section id="example-35" class="level4">
<h4 class="anchored" data-anchor-id="example-35">Example</h4>
<p>Let <span class="math inline">\(M=17\)</span>, <span class="math inline">\(n=4\)</span>, and <span class="math inline">\(g=4\)</span> since <span class="math inline">\(4^4\equiv1\pmod{17}\)</span>.</p>
<p>Input: <span class="math inline">\(a=[1,2,3,4]\)</span></p>
<p>Compute NTT:</p>
<p><span class="math display">\[
A_k=\sum_{j=0}^{3}a_j\cdot g^{jk}\pmod{17}
\]</span></p>
<p>Result: <span class="math inline">\(A=[10,2,16,15]\)</span></p>
<p>Inverse NTT (using <span class="math inline">\(g^{-1}=13\)</span>, <span class="math inline">\(n^{-1}=13\)</span> mod 17):</p>
<p><span class="math display">\[
a_j=\frac{1}{n}\sum_{k=0}^{3}A_k\cdot g^{-jk}\pmod{17}
\]</span></p>
<p>Recovered: <span class="math inline">\([1,2,3,4]\)</span></p>
</section>
<section id="tiny-code-ntt-template" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-ntt-template">Tiny Code (NTT Template)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>MOD <span class="op">=</span> <span class="dv">998244353</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>ROOT <span class="op">=</span> <span class="dv">3</span>  <span class="co"># primitive root</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modpow(a, e, m):</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e:</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> res <span class="op">*</span> a <span class="op">%</span> m</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">*</span> a <span class="op">%</span> m</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ntt(a, invert):</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>        bit <span class="op">=</span> n <span class="op">&gt;&gt;</span> <span class="dv">1</span></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> j <span class="op">&amp;</span> bit:</span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>            j <span class="op">^=</span> bit</span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>            bit <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>        j <span class="op">^=</span> bit</span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&lt;</span> j:</span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>            a[i], a[j] <span class="op">=</span> a[j], a[i]</span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>    len_ <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> len_ <span class="op">&lt;=</span> n:</span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>        wlen <span class="op">=</span> modpow(ROOT, (MOD <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> len_, MOD)</span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> invert:</span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a>            wlen <span class="op">=</span> modpow(wlen, MOD <span class="op">-</span> <span class="dv">2</span>, MOD)</span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, len_):</span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a>            w <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(len_ <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a>                u <span class="op">=</span> a[i <span class="op">+</span> j]</span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a>                v <span class="op">=</span> a[i <span class="op">+</span> j <span class="op">+</span> len_ <span class="op">//</span> <span class="dv">2</span>] <span class="op">*</span> w <span class="op">%</span> MOD</span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a>                a[i <span class="op">+</span> j] <span class="op">=</span> (u <span class="op">+</span> v) <span class="op">%</span> MOD</span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a>                a[i <span class="op">+</span> j <span class="op">+</span> len_ <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> (u <span class="op">-</span> v <span class="op">+</span> MOD) <span class="op">%</span> MOD</span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a>                w <span class="op">=</span> w <span class="op">*</span> wlen <span class="op">%</span> MOD</span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a>        len_ <span class="op">&lt;&lt;=</span> <span class="dv">1</span></span>
<span id="cb147-38"><a href="#cb147-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> invert:</span>
<span id="cb147-39"><a href="#cb147-39" aria-hidden="true" tabindex="-1"></a>        inv_n <span class="op">=</span> modpow(n, MOD <span class="op">-</span> <span class="dv">2</span>, MOD)</span>
<span id="cb147-40"><a href="#cb147-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb147-41"><a href="#cb147-41" aria-hidden="true" tabindex="-1"></a>            a[i] <span class="op">=</span> a[i] <span class="op">*</span> inv_n <span class="op">%</span> MOD</span>
<span id="cb147-42"><a href="#cb147-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-43"><a href="#cb147-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiply(a, b):</span>
<span id="cb147-44"><a href="#cb147-44" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb147-45"><a href="#cb147-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> n <span class="op">&lt;</span> <span class="bu">len</span>(a) <span class="op">+</span> <span class="bu">len</span>(b):</span>
<span id="cb147-46"><a href="#cb147-46" aria-hidden="true" tabindex="-1"></a>        n <span class="op">&lt;&lt;=</span> <span class="dv">1</span></span>
<span id="cb147-47"><a href="#cb147-47" aria-hidden="true" tabindex="-1"></a>    a <span class="op">+=</span> [<span class="dv">0</span>]<span class="op">*</span>(n <span class="op">-</span> <span class="bu">len</span>(a))</span>
<span id="cb147-48"><a href="#cb147-48" aria-hidden="true" tabindex="-1"></a>    b <span class="op">+=</span> [<span class="dv">0</span>]<span class="op">*</span>(n <span class="op">-</span> <span class="bu">len</span>(b))</span>
<span id="cb147-49"><a href="#cb147-49" aria-hidden="true" tabindex="-1"></a>    ntt(a, <span class="va">False</span>)</span>
<span id="cb147-50"><a href="#cb147-50" aria-hidden="true" tabindex="-1"></a>    ntt(b, <span class="va">False</span>)</span>
<span id="cb147-51"><a href="#cb147-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb147-52"><a href="#cb147-52" aria-hidden="true" tabindex="-1"></a>        a[i] <span class="op">=</span> a[i] <span class="op">*</span> b[i] <span class="op">%</span> MOD</span>
<span id="cb147-53"><a href="#cb147-53" aria-hidden="true" tabindex="-1"></a>    ntt(a, <span class="va">True</span>)</span>
<span id="cb147-54"><a href="#cb147-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-66" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-66">Why It Matters</h4>
<ul>
<li>Exact modular results, no floating-point rounding</li>
<li>Enables polynomial multiplication, combinatorial transforms, big integer multiplication</li>
<li>Critical in cryptography, lattice algorithms, and competitive programming</li>
<li>Used in modern schemes (like NTT-based homomorphic encryption)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-66" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-66">A Gentle Proof (Why It Works)</h4>
<p>The NTT matrix <span class="math inline">\(W_n\)</span> with <span class="math inline">\(W_{jk}=g^{jk}\pmod M\)</span> satisfies:</p>
<p><span class="math display">\[
W_n^{-1}=\frac{1}{n}\overline{W_n}
\]</span></p>
<p>Because <span class="math inline">\(g\)</span> is a primitive <span class="math inline">\(n\)</span>-th root of unity, columns of <span class="math inline">\(W_n\)</span> are orthogonal modulo <span class="math inline">\(M\)</span>, and modular inverses exist (since <span class="math inline">\(M\)</span> is prime). Hence, the forward and inverse transforms perfectly invert each other.</p>
</section>
<section id="try-it-yourself-66" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-66">Try It Yourself</h4>
<ol type="1">
<li>Use <span class="math inline">\(M=17\)</span>, <span class="math inline">\(g=4\)</span>, <span class="math inline">\(a=[1,2,3,4]\)</span>, compute NTT manually.</li>
<li>Multiply <span class="math inline">\([1,2,3]\)</span> and <span class="math inline">\([4,5,6]\)</span> under mod <span class="math inline">\(17\)</span> using NTT.</li>
<li>Test mod <span class="math inline">\(998244353\)</span>, length <span class="math inline">\(8\)</span>.</li>
<li>Compare FFT (float) vs NTT (modular) results.</li>
<li>Observe rounding-free exactness.</li>
</ol>
</section>
<section id="test-cases-60" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-60">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(a\)</span></th>
<th><span class="math inline">\(b\)</span></th>
<th><span class="math inline">\(a*b\)</span> (mod 17)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2,3]</td>
<td>[4,5,6]</td>
<td>[4,13,28,27,18] mod 17 = [4,13,11,10,1]</td>
</tr>
<tr class="even">
<td>[1,1]</td>
<td>[1,1]</td>
<td>[1,2,1]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-66" class="level4">
<h4 class="anchored" data-anchor-id="complexity-66">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The NTT is the FFT of the integers, same beauty, different universe. It merges algebra, number theory, and computation into one seamless engine of exactness.</p>
</section>
</section>
<section id="inverse-ntt-intt" class="level3">
<h3 class="anchored" data-anchor-id="inverse-ntt-intt">568 Inverse NTT (INTT)</h3>
<p>The Inverse Number Theoretic Transform (INTT) is the reverse operation of the NTT. It brings data back from the frequency domain to the coefficient domain, fully reconstructing the original sequence. Just like IFFT for FFT, the INTT undoes the modular transform using the inverse root of unity and a modular scaling factor.</p>
<section id="what-problem-are-we-solving-67" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-67">What Problem Are We Solving?</h4>
<p>Given an NTT-transformed sequence <span class="math inline">\(A=[A_0,A_1,\ldots,A_{n-1}]\)</span>, we want to recover the original sequence <span class="math inline">\(a=[a_0,a_1,\ldots,a_{n-1}]\)</span> under modulus <span class="math inline">\(M\)</span>.</p>
<p>The definition mirrors the inverse DFT:</p>
<p><span class="math display">\[
a_j = n^{-1} \sum_{k=0}^{n-1} A_k \cdot g^{-jk} \pmod M
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(g\)</span> is a primitive <span class="math inline">\(n\)</span>-th root of unity mod <span class="math inline">\(M\)</span></li>
<li><span class="math inline">\(n^{-1}\)</span> is the modular inverse of <span class="math inline">\(n\)</span> under mod <span class="math inline">\(M\)</span></li>
</ul>
</section>
<section id="how-does-it-work-plain-language-66" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-66">How Does It Work (Plain Language)</h4>
<p>The INTT follows the same butterfly structure as the NTT, but:</p>
<ol type="1">
<li>Use inverse twiddle factors <span class="math inline">\(g^{-1}\)</span> instead of <span class="math inline">\(g\)</span></li>
<li>After all stages, multiply each element by <span class="math inline">\(n^{-1}\)</span> mod <span class="math inline">\(M\)</span></li>
</ol>
<p>This ensures perfect inversion:</p>
<p><span class="math display">\[
\text{INTT}(\text{NTT}(a)) = a
\]</span></p>
</section>
<section id="example-36" class="level4">
<h4 class="anchored" data-anchor-id="example-36">Example</h4>
<p>Let <span class="math inline">\(M=17\)</span>, <span class="math inline">\(n=4\)</span>, <span class="math inline">\(g=4\)</span> Then <span class="math inline">\(g^{-1}=13\)</span> (since <span class="math inline">\(4\cdot13\equiv1\pmod{17}\)</span>), <span class="math inline">\(n^{-1}=13\)</span> (since <span class="math inline">\(4\cdot13\equiv1\pmod{17}\)</span>)</p>
<p>Suppose <span class="math inline">\(A=[10,2,16,15]\)</span></p>
<p>Compute:</p>
<p><span class="math display">\[
a_j=13\cdot\sum_{k=0}^{3}A_k\cdot(13)^{jk}\pmod{17}
\]</span></p>
<p>After calculation: <span class="math inline">\(a=[1,2,3,4]\)</span></p>
<p>Perfect reconstruction.</p>
</section>
<section id="tiny-code-inverse-ntt" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-inverse-ntt">Tiny Code (Inverse NTT)</h4>
<p>Python (Inverse NTT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>MOD <span class="op">=</span> <span class="dv">998244353</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>ROOT <span class="op">=</span> <span class="dv">3</span>  <span class="co"># primitive root</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modpow(a, e, m):</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> e:</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> res <span class="op">*</span> a <span class="op">%</span> m</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">*</span> a <span class="op">%</span> m</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>        e <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ntt(a, invert<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>        bit <span class="op">=</span> n <span class="op">&gt;&gt;</span> <span class="dv">1</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> j <span class="op">&amp;</span> bit:</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>            j <span class="op">^=</span> bit</span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>            bit <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>        j <span class="op">^=</span> bit</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&lt;</span> j:</span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>            a[i], a[j] <span class="op">=</span> a[j], a[i]</span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a>    len_ <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> len_ <span class="op">&lt;=</span> n:</span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a>        wlen <span class="op">=</span> modpow(ROOT, (MOD <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> len_, MOD)</span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> invert:</span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a>            wlen <span class="op">=</span> modpow(wlen, MOD <span class="op">-</span> <span class="dv">2</span>, MOD)</span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, len_):</span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a>            w <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(len_ <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a>                u <span class="op">=</span> a[i <span class="op">+</span> j]</span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a>                v <span class="op">=</span> a[i <span class="op">+</span> j <span class="op">+</span> len_ <span class="op">//</span> <span class="dv">2</span>] <span class="op">*</span> w <span class="op">%</span> MOD</span>
<span id="cb148-35"><a href="#cb148-35" aria-hidden="true" tabindex="-1"></a>                a[i <span class="op">+</span> j] <span class="op">=</span> (u <span class="op">+</span> v) <span class="op">%</span> MOD</span>
<span id="cb148-36"><a href="#cb148-36" aria-hidden="true" tabindex="-1"></a>                a[i <span class="op">+</span> j <span class="op">+</span> len_ <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> (u <span class="op">-</span> v <span class="op">+</span> MOD) <span class="op">%</span> MOD</span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a>                w <span class="op">=</span> w <span class="op">*</span> wlen <span class="op">%</span> MOD</span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a>        len_ <span class="op">&lt;&lt;=</span> <span class="dv">1</span></span>
<span id="cb148-39"><a href="#cb148-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-40"><a href="#cb148-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> invert:</span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a>        inv_n <span class="op">=</span> modpow(n, MOD <span class="op">-</span> <span class="dv">2</span>, MOD)</span>
<span id="cb148-42"><a href="#cb148-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb148-43"><a href="#cb148-43" aria-hidden="true" tabindex="-1"></a>            a[i] <span class="op">=</span> a[i] <span class="op">*</span> inv_n <span class="op">%</span> MOD</span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">16</span>, <span class="dv">15</span>]</span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a>ntt(A, invert<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Inverse NTT:"</span>, A)  <span class="co"># [1,2,3,4]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (Inverse NTT Skeleton)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb149"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> ntt<span class="op">(</span><span class="dt">double</span> <span class="dt">complex</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> invert<span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... (bit-reversal same as NTT)</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;=</span> n<span class="op">;</span> len <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> wlen <span class="op">=</span> modpow<span class="op">(</span>ROOT<span class="op">,</span> <span class="op">(</span>MOD <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> len<span class="op">,</span> MOD<span class="op">);</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>invert<span class="op">)</span> wlen <span class="op">=</span> modinv<span class="op">(</span>wlen<span class="op">,</span> MOD<span class="op">);</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">+=</span> len<span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">long</span> <span class="dt">long</span> w <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>                <span class="dt">long</span> <span class="dt">long</span> u <span class="op">=</span> a<span class="op">[</span>i <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>                <span class="dt">long</span> <span class="dt">long</span> v <span class="op">=</span> a<span class="op">[</span>i <span class="op">+</span> j <span class="op">+</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">]</span> <span class="op">*</span> w <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>i <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>u <span class="op">+</span> v<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>i <span class="op">+</span> j <span class="op">+</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>u <span class="op">-</span> v <span class="op">+</span> MOD<span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>                w <span class="op">=</span> w <span class="op">*</span> wlen <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>invert<span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> inv_n <span class="op">=</span> modinv<span class="op">(</span>n<span class="op">,</span> MOD<span class="op">);</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>            a<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> inv_n <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-67" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-67">Why It Matters</h4>
<ul>
<li>Completes the modular FFT pipeline</li>
<li>Ensures exact reconstruction of coefficients</li>
<li>Core for polynomial multiplication, cryptographic transforms, error-correcting codes</li>
<li>Enables precise modular computations with no floating-point errors</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-67" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-67">A Gentle Proof (Why It Works)</h4>
<p>NTT and INTT are modular inverses of each other:</p>
<p><span class="math display">\[
\text{NTT}(a)=W_n\cdot a,\quad \text{INTT}(A)=n^{-1}\cdot W_n^{-1}\cdot A
\]</span></p>
<p>where <span class="math inline">\(W_n\)</span> is the Vandermonde matrix over <span class="math inline">\(g\)</span>. Because <span class="math inline">\(W_nW_n^{-1}=I\)</span>, and <span class="math inline">\(g\)</span> is primitive, the two transforms form a bijection.</p>
</section>
<section id="try-it-yourself-67" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-67">Try It Yourself</h4>
<ol type="1">
<li>Compute NTT of <span class="math inline">\([1,2,3,4]\)</span> under mod <span class="math inline">\(17\)</span>, then apply INTT.</li>
<li>Verify <span class="math inline">\(\text{INTT}(\text{NTT}(a))=a\)</span>.</li>
<li>Check inverse properties for different <span class="math inline">\(n=8,16\)</span>.</li>
<li>Multiply polynomials using NTT + INTT pipeline.</li>
<li>Compare modular vs floating-point FFT.</li>
</ol>
</section>
<section id="test-cases-61" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-61">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input <span class="math inline">\(A\)</span></th>
<th>Output <span class="math inline">\(a\)</span> (mod 17)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[10,2,16,15]</td>
<td>[1,2,3,4]</td>
</tr>
<tr class="even">
<td>[4,13,11,10,1,0,0,0]</td>
<td>[1,2,3,4,5]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-67" class="level4">
<h4 class="anchored" data-anchor-id="complexity-67">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The INTT closes the circle: every modular transformation now has a perfect inverse. From number theory to code, it keeps exactness at every step.</p>
</section>
</section>
<section id="bluesteins-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="bluesteins-algorithm">569 Bluestein’s Algorithm</h3>
<p>Bluestein’s Algorithm, also known as the chirp z-transform, is a clever method to compute a Discrete Fourier Transform (DFT) of arbitrary length <span class="math inline">\(n\)</span> using a Fast Fourier Transform (FFT) of length <span class="math inline">\(m \ge 2n-1\)</span>. Unlike Cooley–Tukey, it works even when <span class="math inline">\(n\)</span> is not a power of two.</p>
<section id="what-problem-are-we-solving-68" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-68">What Problem Are We Solving?</h4>
<p>Standard FFTs (like Cooley–Tukey) require <span class="math inline">\(n\)</span> to be a power of two for fast computation. What if we want to compute the DFT for an arbitrary <span class="math inline">\(n\)</span>, such as <span class="math inline">\(n=12\)</span>, <span class="math inline">\(30\)</span>, or a prime number?</p>
<p>Bluestein’s algorithm rewrites the DFT as a convolution, which can then be computed efficiently using any FFT of sufficient size.</p>
<p>Given a sequence <span class="math inline">\(a=[a_0,a_1,\ldots,a_{n-1}]\)</span>, we want:</p>
<p><span class="math display">\[
A_k = \sum_{j=0}^{n-1} a_j \cdot \omega_n^{jk}, \quad 0 \le k &lt; n
\]</span></p>
<p>where <span class="math inline">\(\omega_n = e^{-2\pi i / n}\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-67" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-67">How Does It Work (Plain Language)</h4>
<p>Bluestein’s algorithm transforms the DFT into a convolution problem:</p>
<p><span class="math display">\[
A_k = \sum_{j=0}^{n-1} a_j \cdot \omega_n^{j^2/2} \cdot \omega_n^{(k-j)^2/2}
\]</span></p>
<p>Define:</p>
<ul>
<li><span class="math inline">\(b_j = a_j \cdot \omega_n^{j^2/2}\)</span></li>
<li><span class="math inline">\(c_j = \omega_n^{-j^2/2}\)</span></li>
</ul>
<p>Then <span class="math inline">\(A_k\)</span> is the convolution of <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span>, scaled by <span class="math inline">\(\omega_n^{k^2/2}\)</span>.</p>
<p>We can compute this convolution using FFT-based polynomial multiplication, even when <span class="math inline">\(n\)</span> is arbitrary.</p>
</section>
<section id="algorithm-steps" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps">Algorithm Steps</h4>
<ol type="1">
<li>Precompute chirp factors <span class="math inline">\(\omega_n^{j^2/2}\)</span> and their inverses.</li>
<li>Build sequences <span class="math inline">\(b_j\)</span> and <span class="math inline">\(c_j\)</span>.</li>
<li>Pad both to length <span class="math inline">\(m \ge 2n-1\)</span>.</li>
<li>Perform FFT-based convolution: <span class="math display">\[
d = \text{IFFT}(\text{FFT}(b) \cdot \text{FFT}(c))
\]</span></li>
<li>Extract <span class="math inline">\(A_k = d_k \cdot \omega_n^{-k^2/2}\)</span> for <span class="math inline">\(k=0,\ldots,n-1\)</span>.</li>
</ol>
</section>
<section id="tiny-code-python" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-python">Tiny Code (Python)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmath</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> next_power_of_two(x):</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> (x <span class="op">-</span> <span class="dv">1</span>).bit_length()</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fft(a, invert<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>    a_even <span class="op">=</span> fft(a[<span class="dv">0</span>::<span class="dv">2</span>], invert)</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>    a_odd <span class="op">=</span> fft(a[<span class="dv">1</span>::<span class="dv">2</span>], invert)</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>    ang <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.pi <span class="op">/</span> n <span class="op">*</span> (<span class="op">-</span><span class="dv">1</span> <span class="cf">if</span> <span class="kw">not</span> invert <span class="cf">else</span> <span class="dv">1</span>)</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    w, wn <span class="op">=</span> <span class="dv">1</span>, cmath.exp(<span class="ot">1j</span> <span class="op">*</span> ang)</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> n</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> w <span class="op">*</span> a_odd[k]</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>        y[k] <span class="op">=</span> a_even[k] <span class="op">+</span> t</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>        y[k <span class="op">+</span> n <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> a_even[k] <span class="op">-</span> t</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>        w <span class="op">*=</span> wn</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> invert:</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>            y[i] <span class="op">/=</span> <span class="dv">2</span></span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bluestein_dft(a):</span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> next_power_of_two(<span class="dv">2</span> <span class="op">*</span> n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>    ang <span class="op">=</span> math.pi <span class="op">/</span> n</span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> [cmath.exp(<span class="op">-</span><span class="ot">1j</span> <span class="op">*</span> ang <span class="op">*</span> j <span class="op">*</span> j) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> [a[j] <span class="op">*</span> w[j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)] <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (m <span class="op">-</span> n)</span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> [w[j].conjugate() <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n)] <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (m <span class="op">-</span> n)</span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> fft(b)</span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> fft(c)</span>
<span id="cb150-36"><a href="#cb150-36" aria-hidden="true" tabindex="-1"></a>    D <span class="op">=</span> [B[i] <span class="op">*</span> C[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(m)]</span>
<span id="cb150-37"><a href="#cb150-37" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> fft(D, invert<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb150-38"><a href="#cb150-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-39"><a href="#cb150-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [d[k] <span class="op">*</span> w[k] <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb150-40"><a href="#cb150-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-41"><a href="#cb150-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb150-42"><a href="#cb150-42" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb150-43"><a href="#cb150-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DFT via Bluestein:"</span>, bluestein_dft(a))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-68" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-68">Why It Matters</h4>
<ul>
<li>Handles arbitrary-length DFTs (prime <span class="math inline">\(n\)</span>, non-power-of-two)</li>
<li>Widely used in signal processing, polynomial arithmetic, NTT generalization</li>
<li>Enables uniform FFT pipelines without length restriction</li>
<li>Core idea: Chirp-z transform → Convolution → FFT</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-68" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-68">A Gentle Proof (Why It Works)</h4>
<p>We rewrite DFT terms:</p>
<p><span class="math display">\[
A_k = \sum_{j=0}^{n-1} a_j \cdot \omega_n^{jk}
\]</span></p>
<p>Multiply and divide by <span class="math inline">\(\omega_n^{(j^2 + k^2)/2}\)</span>:</p>
<p><span class="math display">\[
A_k = \omega_n^{-k^2/2} \sum_{j=0}^{n-1} (a_j \cdot \omega_n^{j^2/2}) \cdot \omega_n^{(k-j)^2/2}
\]</span></p>
<p>This is a discrete convolution of two sequences, computable via FFT. Thus, DFT reduces to convolution, enabling <span class="math inline">\(O(m\log m)\)</span> performance for any <span class="math inline">\(n\)</span>.</p>
</section>
<section id="try-it-yourself-68" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-68">Try It Yourself</h4>
<ol type="1">
<li>Compute DFT for <span class="math inline">\(n=6\)</span>, <span class="math inline">\(a=[1,2,3,4,5,6]\)</span>.</li>
<li>Compare results from Bluestein and Cooley–Tukey (if <span class="math inline">\(n\)</span> is power of two).</li>
<li>Try <span class="math inline">\(n=7\)</span> (prime), only Bluestein works efficiently.</li>
<li>Verify that applying inverse DFT returns the original sequence.</li>
<li>Explore zero-padding effect when <span class="math inline">\(m&gt;2n-1\)</span>.</li>
</ol>
</section>
<section id="test-cases-62" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-62">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input <span class="math inline">\(a\)</span></th>
<th><span class="math inline">\(n\)</span></th>
<th>Output (approx)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2,3]</td>
<td>3</td>
<td>[6,(-1.5+0.866i),(-1.5-0.866i)]</td>
</tr>
<tr class="even">
<td>[1,2,3,4,5]</td>
<td>5</td>
<td>[15,-2.5+3.44i,-2.5+0.81i,-2.5-0.81i,-2.5-3.44i]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-68" class="level4">
<h4 class="anchored" data-anchor-id="complexity-68">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(m\log m)\)</span> where <span class="math inline">\(m\ge2n-1\)</span></li>
<li>Space: <span class="math inline">\(O(m)\)</span></li>
</ul>
<p>Bluestein’s algorithm bridges the gap between power-of-two FFTs and general-length DFTs, turning every sequence into a convolutional melody computable by fast transforms.</p>
</section>
</section>
<section id="fft-based-multiplication" class="level3">
<h3 class="anchored" data-anchor-id="fft-based-multiplication">570 FFT-Based Multiplication</h3>
<p>FFT-Based Multiplication uses the Fast Fourier Transform to multiply large integers or polynomials efficiently by transforming multiplication into pointwise products in the frequency domain.</p>
<p>Instead of multiplying term by term (which is <span class="math inline">\(O(n^2)\)</span>), we leverage the FFT to compute the convolution in <span class="math inline">\(O(n\log n)\)</span> time.</p>
<section id="what-problem-are-we-solving-69" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-69">What Problem Are We Solving?</h4>
<p>When multiplying two large polynomials (or integers), the naive approach requires <span class="math inline">\(O(n^2)\)</span> operations. For large <span class="math inline">\(n\)</span>, this becomes impractical.</p>
<p>We want to compute:</p>
<p><span class="math display">\[
C(x) = A(x) \cdot B(x)
\]</span></p>
<p>where</p>
<p><span class="math display">\[
A(x) = \sum_{i=0}^{n-1} a_i x^i,\quad B(x) = \sum_{j=0}^{n-1} b_j x^j
\]</span></p>
<p>We need coefficients <span class="math inline">\(c_k\)</span> of <span class="math inline">\(C(x)\)</span> such that</p>
<p><span class="math display">\[
c_k = \sum_{i+j=k} a_i b_j
\]</span></p>
<p>This is exactly a convolution. The FFT computes it efficiently.</p>
</section>
<section id="how-does-it-work-plain-language-68" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-68">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Pad the sequences so their lengths are a power of two and large enough to hold the full result.</li>
<li>FFT-transform both sequences to frequency space.</li>
<li>Multiply the results elementwise.</li>
<li>Inverse FFT to bring back the coefficients.</li>
<li>Round to nearest integer (for integer multiplication).</li>
</ol>
<p>It’s like tuning two melodies into frequency space, multiplying harmonics, and transforming them back into time.</p>
</section>
<section id="algorithm-steps-1" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-1">Algorithm Steps</h4>
<ol type="1">
<li>Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be coefficient arrays.</li>
<li>Choose <span class="math inline">\(n\)</span> as the smallest power of two <span class="math inline">\(\ge 2 \cdot \max(\text{len}(A), \text{len}(B))\)</span>.</li>
<li>Pad <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> to length <span class="math inline">\(n\)</span>.</li>
<li>Compute FFT<span class="math inline">\((A)\)</span> and FFT<span class="math inline">\((B)\)</span>.</li>
<li>Compute <span class="math inline">\(C'[k] = A'[k] \cdot B'[k]\)</span>.</li>
<li>Compute <span class="math inline">\(C = \text{IFFT}(C')\)</span>.</li>
<li>Round real parts of <span class="math inline">\(C\)</span> to nearest integer.</li>
</ol>
</section>
<section id="tiny-code-python-1" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-python-1">Tiny Code (Python)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmath</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fft(a, invert<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>    a_even <span class="op">=</span> fft(a[<span class="dv">0</span>::<span class="dv">2</span>], invert)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>    a_odd <span class="op">=</span> fft(a[<span class="dv">1</span>::<span class="dv">2</span>], invert)</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>    ang <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.pi <span class="op">/</span> n <span class="op">*</span> (<span class="op">-</span><span class="dv">1</span> <span class="cf">if</span> <span class="kw">not</span> invert <span class="cf">else</span> <span class="dv">1</span>)</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    w, wn <span class="op">=</span> <span class="dv">1</span>, cmath.exp(<span class="ot">1j</span> <span class="op">*</span> ang)</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> n</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n <span class="op">//</span> <span class="dv">2</span>):</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> w <span class="op">*</span> a_odd[k]</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>        y[k] <span class="op">=</span> a_even[k] <span class="op">+</span> t</span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>        y[k <span class="op">+</span> n <span class="op">//</span> <span class="dv">2</span>] <span class="op">=</span> a_even[k] <span class="op">-</span> t</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>        w <span class="op">*=</span> wn</span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> invert:</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>            y[i] <span class="op">/=</span> <span class="dv">2</span></span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiply(a, b):</span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> n <span class="op">&lt;</span> <span class="bu">len</span>(a) <span class="op">+</span> <span class="bu">len</span>(b):</span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>        n <span class="op">&lt;&lt;=</span> <span class="dv">1</span></span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>    fa <span class="op">=</span> a <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">-</span> <span class="bu">len</span>(a))</span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>    fb <span class="op">=</span> b <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">-</span> <span class="bu">len</span>(b))</span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a>    FA <span class="op">=</span> fft(fa)</span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>    FB <span class="op">=</span> fft(fb)</span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>    FC <span class="op">=</span> [FA[i] <span class="op">*</span> FB[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> fft(FC, invert<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">round</span>(c.real) <span class="cf">for</span> c <span class="kw">in</span> C]</span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Multiply (1 + 2x + 3x^2) * (4 + 5x + 6x^2)</span></span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(multiply([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]))</span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Output: [4, 13, 28, 27, 18]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-69" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-69">Why It Matters</h4>
<ul>
<li>Foundation of big integer arithmetic (used in libraries like GMP).</li>
<li>Enables fast polynomial multiplication.</li>
<li>Used in cryptography, signal processing, and FFT-based convolution.</li>
<li>Scales to millions of terms efficiently.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-69" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-69">A Gentle Proof (Why It Works)</h4>
<p>Let</p>
<p><span class="math display">\[
C(x) = A(x)B(x)
\]</span></p>
<p>In the frequency domain (using DFT):</p>
<p><span class="math display">\[
\text{DFT}(C) = \text{DFT}(A) \cdot \text{DFT}(B)
\]</span></p>
<p>By the Convolution Theorem, multiplication in frequency space corresponds to convolution in time:</p>
<p><span class="math display">\[
C = \text{IFFT}(\text{FFT}(A) \cdot \text{FFT}(B))
\]</span></p>
<p>Thus, we get <span class="math inline">\(c_k = \sum_{i+j=k} a_i b_j\)</span> automatically after inverse transform.</p>
</section>
<section id="try-it-yourself-69" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-69">Try It Yourself</h4>
<ol type="1">
<li>Multiply <span class="math inline">\((1+2x+3x^2)\)</span> and <span class="math inline">\((4+5x+6x^2)\)</span> by hand.</li>
<li>Implement integer multiplication using base-10 digits as coefficients.</li>
<li>Compare FFT vs naive multiplication for <span class="math inline">\(n=1024\)</span>.</li>
<li>Try with complex or modular arithmetic.</li>
<li>Explore rounding issues and precision.</li>
</ol>
</section>
<section id="test-cases-63" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-63">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>A(x)</th>
<th>B(x)</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2,3]</td>
<td>[4,5,6]</td>
<td>[4,13,28,27,18]</td>
</tr>
<tr class="even">
<td>[3,2,1]</td>
<td>[1,0,1]</td>
<td>[3,2,4,2,1]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-69" class="level4">
<h4 class="anchored" data-anchor-id="complexity-69">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>FFT-based multiplication turns a slow quadratic process into a symphony of frequency-domain operations, fast, elegant, and scalable.</p>
</section>
</section>
</section>
<section id="section-58.-numerical-methods" class="level1">
<h1>Section 58. Numerical Methods</h1>
<section id="newtonraphson" class="level3">
<h3 class="anchored" data-anchor-id="newtonraphson">571 Newton–Raphson</h3>
<p>Newton–Raphson is a fast root finding method that refines a guess <span class="math inline">\(x\)</span> for <span class="math inline">\(f(x)=0\)</span> by following the tangent line of <span class="math inline">\(f\)</span> at <span class="math inline">\(x\)</span>. It has quadratic convergence near a simple root if the derivative does not vanish.</p>
<section id="what-problem-are-we-solving-70" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-70">What Problem Are We Solving?</h4>
<p>Given a differentiable function <span class="math inline">\(f:\mathbb{R}\to\mathbb{R}\)</span>, find <span class="math inline">\(x^*\)</span> such that <span class="math inline">\(f(x^*)=0\)</span>. Typical use cases include solving nonlinear equations, optimizing <span class="math inline">\(1\)</span>D functions via <span class="math inline">\(f^\prime(x)=0\)</span>, and as an inner step in larger numerical methods.</p>
</section>
<section id="how-does-it-work-plain-language-69" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-69">How Does It Work (Plain Language)</h4>
<p>At a current guess <span class="math inline">\(x_k\)</span>, approximate <span class="math inline">\(f\)</span> by its tangent: <span class="math display">\[
f(x)\approx f(x_k)+f^\prime(x_k)(x-x_k).
\]</span> Set this linear model to zero and solve for the intercept: <span class="math display">\[
x_{k+1}=x_k-\frac{f(x_k)}{f^\prime(x_k)}.
\]</span> Repeat until the change is small or <span class="math inline">\(|f(x_k)|\)</span> is small.</p>
<p>Update rule <span class="math display">\[
x_{k+1}=x_k-\frac{f(x_k)}{f^\prime(x_k)}.
\]</span></p>
</section>
<section id="example-37" class="level4">
<h4 class="anchored" data-anchor-id="example-37">Example</h4>
<p>Solve <span class="math inline">\(x^2-2=0\)</span> (square root of <span class="math inline">\(2\)</span>).</p>
<p>Let <span class="math inline">\(f(x)=x^2-2\)</span>, <span class="math inline">\(f^\prime(x)=2x\)</span>, start <span class="math inline">\(x_0=1\)</span>.</p>
<ul>
<li><span class="math inline">\(x_1=1-\frac{-1}{2}=1.5\)</span></li>
<li><span class="math inline">\(x_2=1.5-\frac{1.5^2-2}{3}=1.416\overline{6}\)</span></li>
<li><span class="math inline">\(x_3\approx1.4142157\)</span></li>
</ul>
<p>Rapid approach to <span class="math inline">\(\sqrt{2}\approx1.41421356\)</span>.</p>
</section>
<section id="tiny-code" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> newton(f, df, x0, tol<span class="op">=</span><span class="fl">1e-10</span>, max_iter<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x0</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>        fx <span class="op">=</span> f(x)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>        dfx <span class="op">=</span> df(x)</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> dfx <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ZeroDivisionError</span>(<span class="st">"Derivative became zero"</span>)</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>        x_new <span class="op">=</span> x <span class="op">-</span> fx <span class="op">/</span> dfx</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(x_new <span class="op">-</span> x) <span class="op">&lt;=</span> tol:</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> x_new</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x_new</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: sqrt(2)</span></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> newton(<span class="kw">lambda</span> x: x<span class="op">*</span>x <span class="op">-</span> <span class="dv">2</span>, <span class="kw">lambda</span> x: <span class="dv">2</span><span class="op">*</span>x, <span class="fl">1.0</span>)</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(root)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb153"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> newton<span class="op">(</span><span class="dt">double</span> <span class="op">(*</span>f<span class="op">)(</span><span class="dt">double</span><span class="op">),</span> <span class="dt">double</span> <span class="op">(*</span>df<span class="op">)(</span><span class="dt">double</span><span class="op">),</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>              <span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> tol<span class="op">,</span> <span class="dt">int</span> max_iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> x0<span class="op">;</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> max_iter<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> fx <span class="op">=</span> f<span class="op">(</span>x<span class="op">),</span> dfx <span class="op">=</span> df<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>dfx <span class="op">==</span> <span class="fl">0.0</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> x_new <span class="op">=</span> x <span class="op">-</span> fx <span class="op">/</span> dfx<span class="op">;</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>x_new <span class="op">-</span> x<span class="op">)</span> <span class="op">&lt;=</span> tol<span class="op">)</span> <span class="cf">return</span> x_new<span class="op">;</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x_new<span class="op">;</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">){</span> <span class="cf">return</span> x<span class="op">*</span>x <span class="op">-</span> <span class="fl">2.0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> df<span class="op">(</span><span class="dt">double</span> x<span class="op">){</span> <span class="cf">return</span> <span class="fl">2.0</span><span class="op">*</span>x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">){</span></span>
<span id="cb153-21"><a href="#cb153-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> r <span class="op">=</span> newton<span class="op">(</span>f<span class="op">,</span> df<span class="op">,</span> <span class="fl">1.0</span><span class="op">,</span> <span class="fl">1e-10</span><span class="op">,</span> <span class="dv">100</span><span class="op">);</span></span>
<span id="cb153-22"><a href="#cb153-22" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%.12f\n</span><span class="st">"</span><span class="op">,</span> r<span class="op">);</span></span>
<span id="cb153-23"><a href="#cb153-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb153-24"><a href="#cb153-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-70" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-70">Why It Matters</h4>
<ul>
<li>Very fast near a simple root: error roughly squares each step</li>
<li>Widely used inside solvers for nonlinear systems, optimization, and implicit ODE steps</li>
<li>Easy to implement when <span class="math inline">\(f^\prime\)</span> is available or cheap to approximate</li>
</ul>
</section>
<section id="a-gentle-proof-idea" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-idea">A Gentle Proof Idea</h4>
<p>If <span class="math inline">\(f\in C^2\)</span> and <span class="math inline">\(x^*\)</span> is a simple root with <span class="math inline">\(f(x^*)=0\)</span> and <span class="math inline">\(f^\prime(x^*)\ne0\)</span>, a Taylor expansion around <span class="math inline">\(x^*\)</span> gives <span class="math display">\[
f(x)=f^\prime(x^*)(x-x^*)+\tfrac12 f^{\prime\prime}(\xi)(x-x^*)^2.
\]</span> Plugging the Newton update shows the new error <span class="math inline">\(e_{k+1}=x_{k+1}-x^*\)</span> satisfies <span class="math display">\[
e_{k+1}\approx -\frac{f^{\prime\prime}(x^*)}{2f^\prime(x^*)}e_k^2,
\]</span> which is quadratic convergence when <span class="math inline">\(e_k\)</span> is small.</p>
</section>
<section id="practical-tips" class="level4">
<h4 class="anchored" data-anchor-id="practical-tips">Practical Tips</h4>
<ul>
<li>Choose a good initial guess <span class="math inline">\(x_0\)</span> to avoid divergence</li>
<li>Guard against <span class="math inline">\(f^\prime(x_k)=0\)</span> or tiny derivatives</li>
<li>Use damping: <span class="math inline">\(x_{k+1}=x_k-\alpha\frac{f(x_k)}{f^\prime(x_k)}\)</span> with <span class="math inline">\(0&lt;\alpha\le1\)</span> if steps overshoot</li>
<li>Stop criteria: <span class="math inline">\(|f(x_k)|\le\varepsilon\)</span> or <span class="math inline">\(|x_{k+1}-x_k|\le\varepsilon\)</span></li>
</ul>
</section>
<section id="try-it-yourself-70" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-70">Try It Yourself</h4>
<ol type="1">
<li>Solve <span class="math inline">\(\cos x - x=0\)</span> starting at <span class="math inline">\(x_0=0.5\)</span>.</li>
<li>Find cube root of <span class="math inline">\(5\)</span> via <span class="math inline">\(f(x)=x^3-5\)</span>.</li>
<li>Minimize <span class="math inline">\(g(x)=(x-3)^2\)</span> by applying Newton to <span class="math inline">\(g^\prime(x)=0\)</span>.</li>
<li>Experiment with a poor initial guess for <span class="math inline">\(f(x)=\tan x - x\)</span> near <span class="math inline">\(\pi/2\)</span> and observe failure modes.</li>
<li>Add line search or damping and compare robustness.</li>
</ol>
</section>
<section id="test-cases-64" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-64">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(f(x)\)</span></th>
<th><span class="math inline">\(f^\prime(x)\)</span></th>
<th>Root</th>
<th>Start <span class="math inline">\(x_0\)</span></th>
<th>Iter to <span class="math inline">\(10^{-10}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2-2\)</span></td>
<td><span class="math inline">\(2x\)</span></td>
<td><span class="math inline">\(\sqrt{2}\)</span></td>
<td><span class="math inline">\(1.0\)</span></td>
<td>5</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\cos x - x\)</span></td>
<td><span class="math inline">\(-,\sin x - 1\)</span></td>
<td><span class="math inline">\(\approx0.739085\)</span></td>
<td><span class="math inline">\(0.5\)</span></td>
<td>5–6</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x^3-5\)</span></td>
<td><span class="math inline">\(3x^2\)</span></td>
<td><span class="math inline">\(\sqrt[3]{5}\)</span></td>
<td><span class="math inline">\(1.5\)</span></td>
<td>6–7</td>
</tr>
</tbody>
</table>
<p><em>(Iterations are indicative and depend on tolerances.)</em></p>
</section>
<section id="complexity-70" class="level4">
<h4 class="anchored" data-anchor-id="complexity-70">Complexity</h4>
<ul>
<li>Per iteration: one <span class="math inline">\(f\)</span> and one <span class="math inline">\(f^\prime\)</span> evaluation plus <span class="math inline">\(O(1)\)</span> arithmetic</li>
<li>Convergence: typically quadratic near a simple root</li>
<li>Overall cost: small number of iterations for well behaved problems</li>
</ul>
<p>Newton–Raphson is the standard <span class="math inline">\(1\)</span>D root finder when derivatives are available and the initial guess is reasonable. It is simple, fast, and forms the backbone of many higher dimensional methods.</p>
</section>
</section>
<section id="bisection-method" class="level3">
<h3 class="anchored" data-anchor-id="bisection-method">572 Bisection Method</h3>
<p>The Bisection Method is one of the simplest and most reliable ways to find a root of a continuous function. It’s a “divide and narrow” search for <span class="math inline">\(x^*\)</span> such that <span class="math inline">\(f(x^*)=0\)</span> within an interval where the function changes sign.</p>
<section id="what-problem-are-we-solving-71" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-71">What Problem Are We Solving?</h4>
<p>We want to solve <span class="math inline">\(f(x)=0\)</span> for a continuous function <span class="math inline">\(f\)</span> when we know two points <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> such that:</p>
<p><span class="math display">\[
f(a)\cdot f(b) &lt; 0
\]</span></p>
<p>That means the function crosses zero between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> by the Intermediate Value Theorem.</p>
</section>
<section id="how-does-it-work-plain-language-70" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-70">How Does It Work (Plain Language)</h4>
<p>At each step:</p>
<ol type="1">
<li><p>Compute midpoint <span class="math inline">\(m=\frac{a+b}{2}\)</span></p></li>
<li><p>Check sign of <span class="math inline">\(f(m)\)</span></p>
<ul>
<li>If <span class="math inline">\(f(a)\cdot f(m) &lt; 0\)</span>, root is between <span class="math inline">\(a\)</span> and <span class="math inline">\(m\)</span></li>
<li>Else root is between <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span></li>
</ul></li>
<li><p>Replace the interval with the new one and repeat until the interval is small enough</p></li>
</ol>
<p>It halves the search space every step, like a binary search for roots.</p>
</section>
<section id="algorithm-steps-2" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-2">Algorithm Steps</h4>
<ol type="1">
<li><p>Start with <span class="math inline">\([a,b]\)</span> such that <span class="math inline">\(f(a)\cdot f(b)&lt;0\)</span></p></li>
<li><p>While <span class="math inline">\(|b-a|&gt;\varepsilon\)</span>:</p>
<ul>
<li><span class="math inline">\(m=\frac{a+b}{2}\)</span></li>
<li>If <span class="math inline">\(f(m)=0\)</span> (or close enough), stop</li>
<li>Else, pick the half where sign changes</li>
</ul></li>
<li><p>Return midpoint as approximate root</p></li>
</ol>
</section>
<section id="tiny-code-1" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-1">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bisection(f, a, b, tol<span class="op">=</span><span class="fl">1e-10</span>, max_iter<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>    fa, fb <span class="op">=</span> f(a), f(b)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fa <span class="op">*</span> fb <span class="op">&gt;=</span> <span class="dv">0</span>:</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"f(a) and f(b) must have opposite signs"</span>)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>        m <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> (a <span class="op">+</span> b)</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>        fm <span class="op">=</span> f(m)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(fm) <span class="op">&lt;</span> tol <span class="kw">or</span> (b <span class="op">-</span> a) <span class="op">/</span> <span class="dv">2</span> <span class="op">&lt;</span> tol:</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> m</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> fa <span class="op">*</span> fm <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>            b, fb <span class="op">=</span> m, fm</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>            a, fa <span class="op">=</span> m, fm</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.5</span> <span class="op">*</span> (a <span class="op">+</span> b)</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: root of x^3 - x - 2 = 0</span></span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> bisection(<span class="kw">lambda</span> x: x3 <span class="op">-</span> x <span class="op">-</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(root)  <span class="co"># ~1.5213797</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb155"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x<span class="op">*</span>x<span class="op">*</span>x <span class="op">-</span> x <span class="op">-</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> bisection<span class="op">(</span><span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">,</span> <span class="dt">double</span> tol<span class="op">,</span> <span class="dt">int</span> max_iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> fa <span class="op">=</span> f<span class="op">(</span>a<span class="op">),</span> fb <span class="op">=</span> f<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>fa <span class="op">*</span> fb <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> NAN<span class="op">;</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> max_iter<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> m <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span>a <span class="op">+</span> b<span class="op">);</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> fm <span class="op">=</span> f<span class="op">(</span>m<span class="op">);</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>fm<span class="op">)</span> <span class="op">&lt;</span> tol <span class="op">||</span> <span class="op">(</span>b <span class="op">-</span> a<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">&lt;</span> tol<span class="op">)</span> <span class="cf">return</span> m<span class="op">;</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fa <span class="op">*</span> fm <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>            b <span class="op">=</span> m<span class="op">;</span> fb <span class="op">=</span> fm<span class="op">;</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>            a <span class="op">=</span> m<span class="op">;</span> fa <span class="op">=</span> fm<span class="op">;</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span>a <span class="op">+</span> b<span class="op">);</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%.10f\n</span><span class="st">"</span><span class="op">,</span> bisection<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="fl">1e-10</span><span class="op">,</span> <span class="dv">100</span><span class="op">));</span></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-71" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-71">Why It Matters</h4>
<ul>
<li>Guaranteed convergence if <span class="math inline">\(f\)</span> is continuous and sign changes</li>
<li>No derivative required (unlike Newton–Raphson)</li>
<li>Robust and simple to implement</li>
<li>Basis for hybrid methods like Brent’s method</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-70" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-70">A Gentle Proof (Why It Works)</h4>
<p>By the Intermediate Value Theorem, if <span class="math inline">\(f(a)\cdot f(b)&lt;0\)</span> and <span class="math inline">\(f\)</span> is continuous, there exists <span class="math inline">\(x^*\in[a,b]\)</span> such that <span class="math inline">\(f(x^*)=0\)</span>.</p>
<p>Each iteration halves the interval: <span class="math display">\[
|b_{k+1}-a_{k+1}|=\frac{1}{2}|b_k-a_k|
\]</span> After <span class="math inline">\(k\)</span> iterations: <span class="math display">\[
|b_k-a_k|=\frac{1}{2^k}|b_0-a_0|
\]</span> To achieve tolerance <span class="math inline">\(\varepsilon\)</span>: <span class="math display">\[
k \ge \log_2\frac{|b_0-a_0|}{\varepsilon}
\]</span></p>
</section>
<section id="try-it-yourself-71" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-71">Try It Yourself</h4>
<ol type="1">
<li>Find root of <span class="math inline">\(f(x)=x^3-x-2\)</span> on <span class="math inline">\([1,2]\)</span>.</li>
<li>Try <span class="math inline">\(f(x)=\cos x - x\)</span> on <span class="math inline">\([0,1]\)</span>.</li>
<li>Compare iterations vs Newton–Raphson.</li>
<li>Test failure if <span class="math inline">\(f(a)\)</span> and <span class="math inline">\(f(b)\)</span> have same sign.</li>
<li>Observe how tolerance affects accuracy and iterations.</li>
</ol>
</section>
<section id="test-cases-65" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-65">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Interval</th>
<th>Root (approx)</th>
<th>Iterations (ε=1e-6)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2-2\)</span></td>
<td>[1,2]</td>
<td>1.414214</td>
<td>20</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^3-x-2\)</span></td>
<td>[1,2]</td>
<td>1.521380</td>
<td>20</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\cos x - x\)</span></td>
<td>[0,1]</td>
<td>0.739085</td>
<td>20</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-71" class="level4">
<h4 class="anchored" data-anchor-id="complexity-71">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(\log_2(\frac{b-a}{\varepsilon}))\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>The Bisection Method trades speed for certainty, it never fails when the sign condition holds, making it a cornerstone of reliable root finding.</p>
</section>
</section>
<section id="secant-method" class="level3">
<h3 class="anchored" data-anchor-id="secant-method">573 Secant Method</h3>
<p>The Secant Method is a root-finding algorithm that uses two initial guesses and repeatedly refines them using secant lines, straight lines passing through two recent points of the function. It’s like a derivative-free Newton–Raphson: instead of using <span class="math inline">\(f'(x)\)</span>, we estimate it from the slope of the secant.</p>
<section id="what-problem-are-we-solving-72" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-72">What Problem Are We Solving?</h4>
<p>We want to solve for <span class="math inline">\(x^*\)</span> such that <span class="math inline">\(f(x^*)=0\)</span>, but sometimes we don’t have the derivative <span class="math inline">\(f'(x)\)</span>. The secant method approximates it numerically:</p>
<p><span class="math display">\[
f'(x_k)\approx \frac{f(x_k)-f(x_{k-1})}{x_k-x_{k-1}}
\]</span></p>
<p>By replacing the exact derivative with this difference quotient, we still follow the Newton-like update.</p>
</section>
<section id="how-does-it-work-plain-language-71" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-71">How Does It Work (Plain Language)</h4>
<p>Think of drawing a line through two points <span class="math inline">\((x_{k-1},f(x_{k-1}))\)</span> and <span class="math inline">\((x_k,f(x_k))\)</span>. That line crosses the <span class="math inline">\(x\)</span>-axis at a new guess <span class="math inline">\(x_{k+1}\)</span>. Repeat the process until convergence.</p>
<p>The update formula is:</p>
<p><span class="math display">\[
x_{k+1}=x_k-f(x_k)\frac{x_k-x_{k-1}}{f(x_k)-f(x_{k-1})}
\]</span></p>
<p>Each iteration uses the last two estimates instead of one (like Newton).</p>
</section>
<section id="algorithm-steps-3" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-3">Algorithm Steps</h4>
<ol type="1">
<li><p>Start with two initial guesses <span class="math inline">\(x_0\)</span> and <span class="math inline">\(x_1\)</span> such that <span class="math inline">\(f(x_0)\ne f(x_1)\)</span>.</p></li>
<li><p>Repeat until convergence:</p>
<p><span class="math display">\[
x_{k+1}=x_k-f(x_k)\frac{x_k-x_{k-1}}{f(x_k)-f(x_{k-1})}
\]</span></p></li>
<li><p>Stop when <span class="math inline">\(|x_{k+1}-x_k|&lt;\varepsilon\)</span> or <span class="math inline">\(|f(x_{k+1})|&lt;\varepsilon\)</span>.</p></li>
</ol>
</section>
<section id="tiny-code-2" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-2">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> secant(f, x0, x1, tol<span class="op">=</span><span class="fl">1e-10</span>, max_iter<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>    f0, f1 <span class="op">=</span> f(x0), f(x1)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> f1 <span class="op">==</span> f0:</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ZeroDivisionError</span>(<span class="st">"Division by zero in secant method"</span>)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>        x2 <span class="op">=</span> x1 <span class="op">-</span> f1 <span class="op">*</span> (x1 <span class="op">-</span> x0) <span class="op">/</span> (f1 <span class="op">-</span> f0)</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(x2 <span class="op">-</span> x1) <span class="op">&lt;</span> tol:</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> x2</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>        x0, x1 <span class="op">=</span> x1, x2</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>        f0, f1 <span class="op">=</span> f1, f(x1)</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x1</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: root of x^3 - x - 2 = 0</span></span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> secant(<span class="kw">lambda</span> x: x3 <span class="op">-</span> x <span class="op">-</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(root)  <span class="co"># ~1.5213797</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb157"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x<span class="op">*</span>x<span class="op">*</span>x <span class="op">-</span> x <span class="op">-</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> secant<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> x1<span class="op">,</span> <span class="dt">double</span> tol<span class="op">,</span> <span class="dt">int</span> max_iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> f0 <span class="op">=</span> f<span class="op">(</span>x0<span class="op">),</span> f1 <span class="op">=</span> f<span class="op">(</span>x1<span class="op">);</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> max_iter<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>f1 <span class="op">==</span> f0<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> x2 <span class="op">=</span> x1 <span class="op">-</span> f1 <span class="op">*</span> <span class="op">(</span>x1 <span class="op">-</span> x0<span class="op">)</span> <span class="op">/</span> <span class="op">(</span>f1 <span class="op">-</span> f0<span class="op">);</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>x2 <span class="op">-</span> x1<span class="op">)</span> <span class="op">&lt;</span> tol<span class="op">)</span> <span class="cf">return</span> x2<span class="op">;</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x1<span class="op">;</span> f0 <span class="op">=</span> f1<span class="op">;</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> x2<span class="op">;</span> f1 <span class="op">=</span> f<span class="op">(</span>x1<span class="op">);</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x1<span class="op">;</span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%.10f\n</span><span class="st">"</span><span class="op">,</span> secant<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="fl">1e-10</span><span class="op">,</span> <span class="dv">100</span><span class="op">));</span></span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-72" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-72">Why It Matters</h4>
<ul>
<li>No derivative needed (uses finite differences)</li>
<li>Faster than Bisection (superlinear, ≈1.618 order)</li>
<li>Commonly used when <span class="math inline">\(f'(x)\)</span> is expensive or unavailable</li>
<li>A stepping stone to hybrid methods (e.g.&nbsp;Brent’s method)</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-71" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-71">A Gentle Proof (Why It Works)</h4>
<p>Newton’s method update:</p>
<p><span class="math display">\[
x_{k+1}=x_k-\frac{f(x_k)}{f'(x_k)}
\]</span></p>
<p>Approximate <span class="math inline">\(f'(x_k)\)</span> via difference quotient:</p>
<p><span class="math display">\[
f'(x_k)\approx\frac{f(x_k)-f(x_{k-1})}{x_k-x_{k-1}}
\]</span></p>
<p>Substitute into Newton’s update:</p>
<p><span class="math display">\[
x_{k+1}=x_k-f(x_k)\frac{x_k-x_{k-1}}{f(x_k)-f(x_{k-1})}
\]</span></p>
<p>Thus, it’s Newton’s method without explicit derivatives, retaining superlinear convergence when close to the root.</p>
</section>
<section id="try-it-yourself-72" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-72">Try It Yourself</h4>
<ol type="1">
<li>Solve <span class="math inline">\(x^3-x-2=0\)</span> with <span class="math inline">\((x_0,x_1)=(1,2)\)</span>.</li>
<li>Compare iteration count vs Newton (<span class="math inline">\(x_0=1\)</span>).</li>
<li>Try <span class="math inline">\(\cos x - x=0\)</span> with <span class="math inline">\((0,1)\)</span>.</li>
<li>Observe failure when <span class="math inline">\(f(x_k)=f(x_{k-1})\)</span>.</li>
<li>Add fallback to bisection for robustness.</li>
</ol>
</section>
<section id="test-cases-66" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-66">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 29%">
<col style="width: 20%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Initial <span class="math inline">\((x_0,x_1)\)</span></th>
<th>Root (approx)</th>
<th>Iterations (ε=1e-10)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2-2\)</span></td>
<td>(1,2)</td>
<td>1.41421356</td>
<td>6</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^3-x-2\)</span></td>
<td>(1,2)</td>
<td>1.5213797</td>
<td>7</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\cos x - x\)</span></td>
<td>(0,1)</td>
<td>0.73908513</td>
<td>6</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-72" class="level4">
<h4 class="anchored" data-anchor-id="complexity-72">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(k)\)</span> iterations, each <span class="math inline">\(O(1)\)</span> (1 function eval per step)</li>
<li>Convergence: Superlinear (<span class="math inline">\(\approx1.618\)</span> order)</li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>The Secant Method blends the speed of Newton’s method with the simplicity of bisection, a derivative-free bridge between theory and practicality.</p>
</section>
</section>
<section id="fixed-point-iteration" class="level3">
<h3 class="anchored" data-anchor-id="fixed-point-iteration">574 Fixed-Point Iteration</h3>
<p>Fixed-Point Iteration is a general method for solving equations of the form <span class="math inline">\(x=g(x)\)</span>. Instead of finding where <span class="math inline">\(f(x)=0\)</span>, we repeatedly apply a transformation that should converge to a stable point, the fixed point where input equals output.</p>
<section id="what-problem-are-we-solving-73" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-73">What Problem Are We Solving?</h4>
<p>We want to find <span class="math inline">\(x^*\)</span> such that</p>
<p><span class="math display">\[
x^* = g(x^*)
\]</span></p>
<p>If we can express a problem <span class="math inline">\(f(x)=0\)</span> as <span class="math inline">\(x=g(x)\)</span>, then the solution of one is the fixed point of the other. For example, solving <span class="math inline">\(x^2-2=0\)</span> is equivalent to solving</p>
<p><span class="math display">\[
x = \sqrt{2}
\]</span></p>
<p>or in iterative form,</p>
<p><span class="math display">\[
x_{k+1} = g(x_k) = \frac{1}{2}\left(x_k + \frac{2}{x_k}\right)
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-72" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-72">How Does It Work (Plain Language)</h4>
<p>Start with an initial guess <span class="math inline">\(x_0\)</span>, then keep applying <span class="math inline">\(g\)</span>:</p>
<p><span class="math display">\[
x_{k+1} = g(x_k)
\]</span></p>
<p>If <span class="math inline">\(g\)</span> is well-behaved (a contraction near <span class="math inline">\(x^*\)</span>), this sequence will settle closer and closer to the fixed point.</p>
<p>You can think of it like repeatedly bouncing toward equilibrium, each bounce gets smaller until you land at <span class="math inline">\(x^*\)</span>.</p>
</section>
<section id="convergence-condition" class="level4">
<h4 class="anchored" data-anchor-id="convergence-condition">Convergence Condition</h4>
<p>Fixed-point iteration converges if <span class="math inline">\(g\)</span> is continuous near <span class="math inline">\(x^*\)</span> and</p>
<p><span class="math display">\[
|g'(x^*)| &lt; 1
\]</span></p>
<p>If <span class="math inline">\(|g'(x^*)| &gt; 1\)</span>, the iteration diverges.</p>
<p>This means the slope of <span class="math inline">\(g\)</span> at the fixed point must not be too steep, it should “pull” you in rather than push you away.</p>
</section>
<section id="algorithm-steps-4" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-4">Algorithm Steps</h4>
<ol type="1">
<li>Choose initial guess <span class="math inline">\(x_0\)</span>.</li>
<li>Compute <span class="math inline">\(x_{k+1} = g(x_k)\)</span>.</li>
<li>Stop if <span class="math inline">\(|x_{k+1} - x_k| &lt; \varepsilon\)</span> or after max iterations.</li>
<li>Return <span class="math inline">\(x_{k+1}\)</span> as the approximate root.</li>
</ol>
</section>
<section id="tiny-code-3" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-3">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fixed_point(g, x0, tol<span class="op">=</span><span class="fl">1e-10</span>, max_iter<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x0</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>        x_new <span class="op">=</span> g(x)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(x_new <span class="op">-</span> x) <span class="op">&lt;</span> tol:</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> x_new</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x_new</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Solve x = cos(x)</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> fixed_point(<span class="kw">lambda</span> x: math.cos(x), <span class="fl">0.5</span>)</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(root)  <span class="co"># ~0.739085</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb159"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> g<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> cos<span class="op">(</span>x<span class="op">);</span> <span class="op">}</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> fixed_point<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> tol<span class="op">,</span> <span class="dt">int</span> max_iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> x0<span class="op">,</span> x_new<span class="op">;</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> max_iter<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>        x_new <span class="op">=</span> g<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>x_new <span class="op">-</span> x<span class="op">)</span> <span class="op">&lt;</span> tol<span class="op">)</span> <span class="cf">return</span> x_new<span class="op">;</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x_new<span class="op">;</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%.10f\n</span><span class="st">"</span><span class="op">,</span> fixed_point<span class="op">(</span><span class="fl">0.5</span><span class="op">,</span> <span class="fl">1e-10</span><span class="op">,</span> <span class="dv">100</span><span class="op">));</span></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-73" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-73">Why It Matters</h4>
<ul>
<li>Foundation for Newton–Raphson, Gauss–Seidel, and many nonlinear solvers.</li>
<li>Conceptually simple and general.</li>
<li>Shows how convergence depends on transformation design, not just the function.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-72" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-72">A Gentle Proof (Why It Works)</h4>
<p>Suppose <span class="math inline">\(x^*\)</span> is a fixed point, <span class="math inline">\(g(x^*)=x^*\)</span>. Expand <span class="math inline">\(g\)</span> near <span class="math inline">\(x^*\)</span> by Taylor approximation:</p>
<p><span class="math display">\[
g(x) = g(x^*) + g'(x^*)(x - x^*) + O((x-x^*)^2)
\]</span></p>
<p>Subtract <span class="math inline">\(x^*\)</span>:</p>
<p><span class="math display">\[
x_{k+1}-x^* = g'(x^*)(x_k-x^*) + O((x_k-x^*)^2)
\]</span></p>
<p>So for small errors, <span class="math display">\[
|x_{k+1}-x^*| \approx |g'(x^*)||x_k-x^*|
\]</span></p>
<p>If <span class="math inline">\(|g'(x^*)|&lt;1\)</span>, the error shrinks every iteration, geometric convergence.</p>
</section>
<section id="try-it-yourself-73" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-73">Try It Yourself</h4>
<ol type="1">
<li>Solve <span class="math inline">\(x=\cos(x)\)</span> starting at <span class="math inline">\(x_0=0.5\)</span>.</li>
<li>Solve <span class="math inline">\(x=\sqrt{2}\)</span> using <span class="math inline">\(x_{k+1}=\frac{1}{2}(x_k+\frac{2}{x_k})\)</span>.</li>
<li>Try <span class="math inline">\(x=g(x)=1+\frac{1}{x}\)</span>, watch it diverge.</li>
<li>Experiment with transformations of <span class="math inline">\(f(x)=x^3-x-2\)</span> into different <span class="math inline">\(g(x)\)</span>.</li>
<li>Observe sensitivity to initial guesses and slope.</li>
</ol>
</section>
<section id="test-cases-67" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-67">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 17%">
<col style="width: 23%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(g(x)\)</span></th>
<th>Start <span class="math inline">\(x_0\)</span></th>
<th>Result (approx)</th>
<th>Converges?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\cos x\)</span></td>
<td>0.5</td>
<td>0.739085</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\frac{1}{2}(x+\frac{2}{x})\)</span></td>
<td>1</td>
<td>1.41421356</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(1+\frac{1}{x}\)</span></td>
<td>1</td>
<td>Divergent</td>
<td>No</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-73" class="level4">
<h4 class="anchored" data-anchor-id="complexity-73">Complexity</h4>
<ul>
<li>Per iteration: <span class="math inline">\(O(1)\)</span> (one function evaluation)</li>
<li>Convergence: Linear (if <span class="math inline">\(|g'(x^*)|&lt;1\)</span>)</li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Fixed-point iteration is the gentle heartbeat of numerical solving, simple, geometric, and foundational to modern root-finding and optimization algorithms.</p>
</section>
</section>
<section id="gaussian-quadrature" class="level3">
<h3 class="anchored" data-anchor-id="gaussian-quadrature">575 Gaussian Quadrature</h3>
<p>Gaussian Quadrature is a high-accuracy numerical integration method that approximates <span class="math display">\[
I=\int_a^b f(x),dx
\]</span> by evaluating <span class="math inline">\(f(x)\)</span> at optimally chosen points (nodes) and weighting them carefully. It achieves maximum precision for a given number of evaluations, far more accurate than trapezoidal or Simpson’s rules for smooth functions.</p>
<section id="what-problem-are-we-solving-74" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-74">What Problem Are We Solving?</h4>
<p>We want to approximate an integral numerically, but instead of equally spaced sample points, we’ll choose the best possible points to minimize error.</p>
<p>Traditional methods sample uniformly, but Gaussian quadrature uses orthogonal polynomials (like Legendre, Chebyshev, Laguerre, or Hermite) to determine ideal nodes <span class="math inline">\(x_i\)</span> and weights <span class="math inline">\(w_i\)</span> that make the rule exact for all polynomials up to degree <span class="math inline">\(2n-1\)</span>.</p>
<p>Formally,</p>
<p><span class="math display">\[
\int_a^b f(x),dx \approx \sum_{i=1}^n w_i,f(x_i)
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-73" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-73">How Does It Work (Plain Language)</h4>
<ol type="1">
<li>Choose a set of orthogonal polynomials on <span class="math inline">\([a,b]\)</span> (often Legendre for standard integrals).</li>
<li>The roots of the <span class="math inline">\(n\)</span>-th polynomial become the sample points <span class="math inline">\(x_i\)</span>.</li>
<li>Compute corresponding weights <span class="math inline">\(w_i\)</span> so that the formula integrates all polynomials up to degree <span class="math inline">\(2n-1\)</span> exactly.</li>
<li>Evaluate <span class="math inline">\(f(x_i)\)</span>, multiply by weights, and sum.</li>
</ol>
<p>Each <span class="math inline">\(x_i\)</span> and <span class="math inline">\(w_i\)</span> is precomputed, you just plug in your function.</p>
</section>
<section id="example-gausslegendre-quadrature-on--11" class="level4">
<h4 class="anchored" data-anchor-id="example-gausslegendre-quadrature-on--11">Example: Gauss–Legendre Quadrature on <span class="math inline">\([-1,1]\)</span></h4>
<p>For <span class="math inline">\(n=2\)</span>: <span class="math display">\[
x_1=-\frac{1}{\sqrt{3}}, \quad x_2=\frac{1}{\sqrt{3}}, \quad w_1=w_2=1.
\]</span></p>
<p>Thus, <span class="math display">\[
\int_{-1}^{1} f(x),dx \approx f(-1/\sqrt{3})+f(1/\sqrt{3}).
\]</span></p>
<p>For arbitrary <span class="math inline">\([a,b]\)</span>, map via <span class="math display">\[
t=\frac{b-a}{2}x+\frac{a+b}{2},
\]</span> and scale the result by <span class="math inline">\(\frac{b-a}{2}\)</span>.</p>
</section>
<section id="tiny-code-4" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-4">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gauss_legendre(f, a, b, n<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nodes and weights for n=2, extendable for larger n</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">1</span><span class="op">/</span>np.sqrt(<span class="dv">3</span>), <span class="dv">1</span><span class="op">/</span>np.sqrt(<span class="dv">3</span>)])</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># transform to [a,b]</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>(b <span class="op">-</span> a)<span class="op">*</span>x <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>(b <span class="op">+</span> a)</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.5</span><span class="op">*</span>(b <span class="op">-</span> a)<span class="op">*</span>np.<span class="bu">sum</span>(w <span class="op">*</span> f(t))</span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: integrate f(x)=x^2 from 0 to 1</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> gauss_legendre(<span class="kw">lambda</span> x: x2, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)  <span class="co"># ~0.333333</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb161"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x<span class="op">*</span>x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> gauss_legendre<span class="op">(</span><span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x1 <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span><span class="op">/</span>sqrt<span class="op">(</span><span class="fl">3.0</span><span class="op">),</span> x2 <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span>sqrt<span class="op">(</span><span class="fl">3.0</span><span class="op">);</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> w1 <span class="op">=</span> <span class="fl">1.0</span><span class="op">,</span> w2 <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> t1 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*(</span>b <span class="op">-</span> a<span class="op">)*</span>x1 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*(</span>b <span class="op">+</span> a<span class="op">);</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> t2 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*(</span>b <span class="op">-</span> a<span class="op">)*</span>x2 <span class="op">+</span> <span class="fl">0.5</span><span class="op">*(</span>b <span class="op">+</span> a<span class="op">);</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fl">0.5</span><span class="op">*(</span>b <span class="op">-</span> a<span class="op">)*(</span>w1<span class="op">*</span>f<span class="op">(</span>t1<span class="op">)</span> <span class="op">+</span> w2<span class="op">*</span>f<span class="op">(</span>t2<span class="op">));</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> gauss_legendre<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">));</span> <span class="co">// 0.333333</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-74" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-74">Why It Matters</h4>
<ul>
<li>High precision with few points</li>
<li>Exact for all polynomials up to degree <span class="math inline">\(2n-1\)</span></li>
<li>Works beautifully for smooth integrands</li>
<li>Forms the foundation for spectral methods, finite elements, and probability integration</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-73" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-73">A Gentle Proof (Why It Works)</h4>
<p>Let <span class="math inline">\(p_n(x)\)</span> be an orthogonal polynomial of degree <span class="math inline">\(n\)</span> on <span class="math inline">\([a,b]\)</span> with respect to a weight function <span class="math inline">\(w(x)\)</span>. Its <span class="math inline">\(n\)</span> roots <span class="math inline">\(x_i\)</span> satisfy orthogonality:</p>
<p><span class="math display">\[
\int_a^b p_n(x),p_m(x),w(x),dx=0 \quad (m&lt;n).
\]</span></p>
<p>If <span class="math inline">\(f\)</span> is a polynomial of degree <span class="math inline">\(\le2n-1\)</span>, it can be decomposed into terms up to <span class="math inline">\(p_{2n-1}(x)\)</span>, and integrating with the quadrature rule using these roots yields the exact value.</p>
<p>Thus, Gaussian quadrature minimizes integration error within polynomial spaces.</p>
</section>
<section id="try-it-yourself-74" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-74">Try It Yourself</h4>
<ol type="1">
<li>Integrate <span class="math inline">\(\sin x\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(\pi/2\)</span> using 2- and 3-point Gauss–Legendre.</li>
<li>Compare with Simpson’s rule.</li>
<li>Extend to <span class="math inline">\(n=3\)</span> using precomputed nodes and weights.</li>
<li>Try <span class="math inline">\(f(x)=e^x\)</span> over <span class="math inline">\([0,1]\)</span>.</li>
<li>Experiment with scaling to non-standard intervals <span class="math inline">\([a,b]\)</span>.</li>
</ol>
</section>
<section id="test-cases-68" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-68">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Interval</th>
<th><span class="math inline">\(n\)</span></th>
<th>Result (approx)</th>
<th>True Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2\)</span></td>
<td>[0,1]</td>
<td>2</td>
<td>0.333333</td>
<td>1/3</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sin x\)</span></td>
<td>[0,π/2]</td>
<td>2</td>
<td>0.99984</td>
<td>1.00000</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(e^x\)</span></td>
<td>[0,1]</td>
<td>2</td>
<td>1.71828</td>
<td>1.71828</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-74" class="level4">
<h4 class="anchored" data-anchor-id="complexity-74">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span> evaluations of <span class="math inline">\(f\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span> for nodes and weights</li>
<li>Accuracy: exact for all polynomials of degree ≤ <span class="math inline">\(2n-1\)</span></li>
</ul>
<p>Gaussian Quadrature shows how pure mathematics and computation intertwine, orthogonal polynomials guiding us to integrate with surgical precision.</p>
</section>
</section>
<section id="simpsons-rule" class="level3">
<h3 class="anchored" data-anchor-id="simpsons-rule">576 Simpson’s Rule</h3>
<p>Simpson’s Rule is a classical numerical integration method that approximates the integral of a smooth function using parabolas rather than straight lines. It combines the simplicity of the trapezoidal rule with higher-order accuracy, making it one of the most practical methods for evenly spaced data.</p>
<section id="what-problem-are-we-solving-75" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-75">What Problem Are We Solving?</h4>
<p>We want to approximate the definite integral</p>
<p><span class="math display">\[
I = \int_a^b f(x),dx
\]</span></p>
<p>when we only know <span class="math inline">\(f(x)\)</span> at discrete points or cannot find an analytic antiderivative.</p>
<p>Instead of approximating <span class="math inline">\(f\)</span> by a straight line between each pair of points, Simpson’s Rule uses quadratic interpolation through every two subintervals for much higher accuracy.</p>
</section>
<section id="how-does-it-work-plain-language-74" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-74">How Does It Work (Plain Language)</h4>
<p>Imagine you take three points <span class="math inline">\((x_0,f(x_0))\)</span>, <span class="math inline">\((x_1,f(x_1))\)</span>, <span class="math inline">\((x_2,f(x_2))\)</span> equally spaced by <span class="math inline">\(h\)</span>. Fit a parabola through them, integrate that parabola, and repeat.</p>
<p>For a single parabolic arc:</p>
<p><span class="math display">\[
\int_{x_0}^{x_2} f(x),dx \approx \frac{h}{3}\big[f(x_0) + 4f(x_1) + f(x_2)\big]
\]</span></p>
<p>For <span class="math inline">\(n\)</span> subintervals (where <span class="math inline">\(n\)</span> is even):</p>
<p><span class="math display">\[
I \approx \frac{h}{3}\Big[f(x_0) + 4\sum_{i=1,3,5,\ldots}^{n-1} f(x_i) + 2\sum_{i=2,4,6,\ldots}^{n-2} f(x_i) + f(x_n)\Big]
\]</span></p>
<p>where <span class="math inline">\(h = \frac{b - a}{n}\)</span>.</p>
</section>
<section id="tiny-code-5" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-5">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simpson(f, a, b, n<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>        n <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># must be even</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> n</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> f(a) <span class="op">+</span> f(b)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> a <span class="op">+</span> i <span class="op">*</span> h</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>        s <span class="op">+=</span> <span class="dv">4</span> <span class="op">*</span> f(x) <span class="cf">if</span> i <span class="op">%</span> <span class="dv">2</span> <span class="cf">else</span> <span class="dv">2</span> <span class="op">*</span> f(x)</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s <span class="op">*</span> h <span class="op">/</span> <span class="dv">3</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: integrate sin(x) from 0 to π</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> simpson(math.sin, <span class="dv">0</span>, math.pi, n<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)  <span class="co"># ~2.000000</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb163"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> sin<span class="op">(</span>x<span class="op">);</span> <span class="op">}</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> simpson<span class="op">(</span><span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> n<span class="op">++;</span> <span class="co">// must be even</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> h <span class="op">=</span> <span class="op">(</span>b <span class="op">-</span> a<span class="op">)</span> <span class="op">/</span> n<span class="op">;</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> s <span class="op">=</span> f<span class="op">(</span>a<span class="op">)</span> <span class="op">+</span> f<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> x <span class="op">=</span> a <span class="op">+</span> i <span class="op">*</span> h<span class="op">;</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>        s <span class="op">+=</span> <span class="op">(</span>i <span class="op">%</span> <span class="dv">2</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> <span class="dv">2</span><span class="op">)</span> <span class="op">*</span> f<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s <span class="op">*</span> h <span class="op">/</span> <span class="fl">3.0</span><span class="op">;</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> simpson<span class="op">(</span><span class="dv">0</span><span class="op">,</span> M_PI<span class="op">,</span> <span class="dv">100</span><span class="op">));</span> <span class="co">// 2.000000</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-75" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-75">Why It Matters</h4>
<ul>
<li>Accurate and simple for smooth functions</li>
<li>Exact for cubic polynomials</li>
<li>Often the best balance between accuracy and computation for tabulated data</li>
<li>Forms the backbone of adaptive and composite integration schemes</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-74" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-74">A Gentle Proof (Why It Works)</h4>
<p>Let <span class="math inline">\(f(x)\)</span> be approximated by a quadratic polynomial <span class="math display">\[
p(x) = ax^2 + bx + c
\]</span> that passes through <span class="math inline">\((x_0,f_0)\)</span>, <span class="math inline">\((x_1,f_1)\)</span>, <span class="math inline">\((x_2,f_2)\)</span>. Integrating <span class="math inline">\(p(x)\)</span> over <span class="math inline">\([x_0,x_2]\)</span> yields</p>
<p><span class="math display">\[
\int_{x_0}^{x_2} p(x),dx = \frac{h}{3}\big[f_0 + 4f_1 + f_2\big].
\]</span></p>
<p>Because the error term depends on <span class="math inline">\(f^{(4)}(\xi)\)</span>, Simpson’s Rule is fourth-order accurate, i.e.</p>
<p><span class="math display">\[
E = -\frac{(b-a)}{180}h^4f^{(4)}(\xi)
\]</span></p>
<p>for some <span class="math inline">\(\xi\in[a,b]\)</span>.</p>
</section>
<section id="try-it-yourself-75" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-75">Try It Yourself</h4>
<ol type="1">
<li>Integrate <span class="math inline">\(\sin x\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(\pi\)</span> (should be <span class="math inline">\(2\)</span>).</li>
<li>Integrate <span class="math inline">\(x^4\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span>, check exactness for polynomials ≤ degree 3.</li>
<li>Compare with trapezoidal rule for the same <span class="math inline">\(n\)</span>.</li>
<li>Experiment with uneven <span class="math inline">\(n\)</span> and verify convergence.</li>
<li>Implement adaptive Simpson’s rule for automatic refinement.</li>
</ol>
</section>
<section id="test-cases-69" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-69">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Interval</th>
<th><span class="math inline">\(n\)</span></th>
<th>Simpson Result</th>
<th>True Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sin x\)</span></td>
<td>[0, π]</td>
<td>100</td>
<td>1.999999</td>
<td>2.000000</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^2\)</span></td>
<td>[0, 1]</td>
<td>10</td>
<td>0.333333</td>
<td>1/3</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(e^x\)</span></td>
<td>[0, 1]</td>
<td>20</td>
<td>1.718282</td>
<td>1.718282</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-75" class="level4">
<h4 class="anchored" data-anchor-id="complexity-75">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span> evaluations of <span class="math inline">\(f(x)\)</span></li>
<li>Accuracy: <span class="math inline">\(O(h^4)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Simpson’s Rule is the perfect blend of simplicity and precision, a parabolic leap beyond straight-line approximations.</p>
</section>
</section>
<section id="trapezoidal-rule" class="level3">
<h3 class="anchored" data-anchor-id="trapezoidal-rule">577 Trapezoidal Rule</h3>
<p>The Trapezoidal Rule is one of the simplest numerical integration methods. It approximates the area under a curve by dividing it into trapezoids instead of rectangles, providing a linear interpolation between sampled points.</p>
<section id="what-problem-are-we-solving-76" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-76">What Problem Are We Solving?</h4>
<p>We want to estimate</p>
<p><span class="math display">\[
I = \int_a^b f(x),dx
\]</span></p>
<p>when we only know <span class="math inline">\(f(x)\)</span> at discrete points, or when the integral has no simple analytical form. The idea is to approximate <span class="math inline">\(f(x)\)</span> as piecewise linear between each pair of neighboring points.</p>
</section>
<section id="how-does-it-work-plain-language-75" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-75">How Does It Work (Plain Language)</h4>
<p>If you know <span class="math inline">\(f(a)\)</span> and <span class="math inline">\(f(b)\)</span>, the simplest estimate is the area of a trapezoid:</p>
<p><span class="math display">\[
I \approx \frac{b-a}{2},[f(a)+f(b)].
\]</span></p>
<p>For multiple subintervals of equal width <span class="math inline">\(h=(b-a)/n\)</span>:</p>
<p><span class="math display">\[
I \approx \frac{h}{2}\Big[f(x_0)+2\sum_{i=1}^{n-1}f(x_i)+f(x_n)\Big].
\]</span></p>
<p>Each pair of consecutive points defines a trapezoid, we sum their areas to approximate the total.</p>
</section>
<section id="tiny-code-6" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-6">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trapezoidal(f, a, b, n<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> n</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> (f(a) <span class="op">+</span> f(b))</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>        s <span class="op">+=</span> f(a <span class="op">+</span> i <span class="op">*</span> h)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s <span class="op">*</span> h</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: integrate e^x from 0 to 1</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> trapezoidal(math.exp, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)  <span class="co"># ~1.718282</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb165"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> exp<span class="op">(</span>x<span class="op">);</span> <span class="op">}</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> trapezoidal<span class="op">(</span><span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> h <span class="op">=</span> <span class="op">(</span>b <span class="op">-</span> a<span class="op">)</span> <span class="op">/</span> n<span class="op">;</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> s <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span>f<span class="op">(</span>a<span class="op">)</span> <span class="op">+</span> f<span class="op">(</span>b<span class="op">));</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>        s <span class="op">+=</span> f<span class="op">(</span>a <span class="op">+</span> i <span class="op">*</span> h<span class="op">);</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s <span class="op">*</span> h<span class="op">;</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> trapezoidal<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">));</span> <span class="co">// 1.718282</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-76" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-76">Why It Matters</h4>
<ul>
<li>Simple and widely used as a first numerical integration method</li>
<li>Robust for smooth functions</li>
<li>Serves as a building block for Simpson’s rule and Romberg integration</li>
<li>Works directly with tabulated data</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-75" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-75">A Gentle Proof (Why It Works)</h4>
<p>Over one subinterval <span class="math inline">\([x_i,x_{i+1}]\)</span>, approximate <span class="math inline">\(f(x)\)</span> by a straight line:</p>
<p><span class="math display">\[
f(x)\approx f(x_i)+\frac{f(x_{i+1})-f(x_i)}{h}(x-x_i).
\]</span></p>
<p>Integrating this line exactly gives</p>
<p><span class="math display">\[
\int_{x_i}^{x_{i+1}} f(x),dx \approx \frac{h}{2}[f(x_i)+f(x_{i+1})].
\]</span></p>
<p>Summing across all intervals yields the composite trapezoidal rule.</p>
<p>The error term for one interval is proportional to the curvature of <span class="math inline">\(f\)</span>:</p>
<p><span class="math display">\[
E = -\frac{(b-a)}{12}h^2f''(\xi)
\]</span></p>
<p>for some <span class="math inline">\(\xi\in[a,b]\)</span>. Thus, it’s second-order accurate.</p>
</section>
<section id="try-it-yourself-76" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-76">Try It Yourself</h4>
<ol type="1">
<li>Integrate <span class="math inline">\(\sin x\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(\pi\)</span> (result <span class="math inline">\(\approx2\)</span>).</li>
<li>Integrate <span class="math inline">\(x^2\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> and compare with exact <span class="math inline">\(1/3\)</span>.</li>
<li>Compare error with Simpson’s Rule for the same <span class="math inline">\(n\)</span>.</li>
<li>Try <span class="math inline">\(f(x)=1/x\)</span> on <span class="math inline">\([1,2]\)</span>.</li>
<li>Explore how halving <span class="math inline">\(h\)</span> affects accuracy.</li>
</ol>
</section>
<section id="test-cases-70" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-70">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Interval</th>
<th><span class="math inline">\(n\)</span></th>
<th>Trapezoidal</th>
<th>True Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sin x\)</span></td>
<td>[0, π]</td>
<td>100</td>
<td>1.9998</td>
<td>2.0000</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^2\)</span></td>
<td>[0,1]</td>
<td>100</td>
<td>0.33335</td>
<td>1/3</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(e^x\)</span></td>
<td>[0,1]</td>
<td>100</td>
<td>1.71828</td>
<td>1.71828</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-76" class="level4">
<h4 class="anchored" data-anchor-id="complexity-76">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span> function evaluations</li>
<li>Accuracy: <span class="math inline">\(O(h^2)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>The Trapezoidal Rule is the entryway to numerical integration, intuitive, reliable, and surprisingly effective when used with fine discretization or smooth functions.</p>
</section>
</section>
<section id="rungekutta-rk4-method" class="level3">
<h3 class="anchored" data-anchor-id="rungekutta-rk4-method">578 Runge–Kutta (RK4) Method</h3>
<p>The Runge–Kutta (RK4) method is one of the most widely used techniques for numerically solving ordinary differential equations (ODEs). It provides a beautiful balance between accuracy and computational simplicity, using multiple slope evaluations within each step to achieve fourth-order precision.</p>
<section id="what-problem-are-we-solving-77" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-77">What Problem Are We Solving?</h4>
<p>We want to solve an initial value problem (IVP):</p>
<p><span class="math display">\[
\frac{dy}{dx}=f(x,y), \quad y(x_0)=y_0
\]</span></p>
<p>When no analytical solution exists (or is hard to find), RK4 approximates <span class="math inline">\(y(x)\)</span> step by step, with high accuracy.</p>
</section>
<section id="how-does-it-work-plain-language-76" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-76">How Does It Work (Plain Language)</h4>
<p>Instead of taking a single slope per step (like Euler’s method), RK4 samples four slopes and combines them:</p>
<p><span class="math display">\[
\begin{aligned}
k_1 &amp;= f(x_n, y_n),\
k_2 &amp;= f(x_n + h/2,, y_n + h k_1/2),\
k_3 &amp;= f(x_n + h/2,, y_n + h k_2/2),\
k_4 &amp;= f(x_n + h,, y_n + h k_3),\
y_{n+1} &amp;= y_n + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4).
\end{aligned}
\]</span></p>
<p>This weighted average captures both curvature and local behavior with surprising precision.</p>
</section>
<section id="tiny-code-7" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-7">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rk4(f, x0, y0, h, n):</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> x0, y0</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>        k1 <span class="op">=</span> f(x, y)</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>        k2 <span class="op">=</span> f(x <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y <span class="op">+</span> h<span class="op">*</span>k1<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>        k3 <span class="op">=</span> f(x <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span>, y <span class="op">+</span> h<span class="op">*</span>k2<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>        k4 <span class="op">=</span> f(x <span class="op">+</span> h, y <span class="op">+</span> h<span class="op">*</span>k3)</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>        y <span class="op">+=</span> h<span class="op">*</span>(k1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k3 <span class="op">+</span> k4)<span class="op">/</span><span class="dv">6</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> h</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x, y</span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: dy/dx = y, y(0) = 1 → true solution y = e^x</span></span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x, y: y</span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> rk4(f, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y, <span class="st">"vs"</span>, math.e)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb167"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> y<span class="op">;</span> <span class="op">}</span> <span class="co">// dy/dx = y</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rk4<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> y0<span class="op">,</span> <span class="dt">double</span> h<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> x0<span class="op">,</span> y <span class="op">=</span> y0<span class="op">;</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> k1 <span class="op">=</span> f<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> k2 <span class="op">=</span> f<span class="op">(</span>x <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span><span class="op">,</span> y <span class="op">+</span> h<span class="op">*</span>k1<span class="op">/</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> k3 <span class="op">=</span> f<span class="op">(</span>x <span class="op">+</span> h<span class="op">/</span><span class="dv">2</span><span class="op">,</span> y <span class="op">+</span> h<span class="op">*</span>k2<span class="op">/</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> k4 <span class="op">=</span> f<span class="op">(</span>x <span class="op">+</span> h<span class="op">,</span> y <span class="op">+</span> h<span class="op">*</span>k3<span class="op">);</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>        y <span class="op">+=</span> h<span class="op">*(</span>k1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k3 <span class="op">+</span> k4<span class="op">)/</span><span class="fl">6.0</span><span class="op">;</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> h<span class="op">;</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"x=</span><span class="sc">%.2f</span><span class="st">, y=</span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>    rk4<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span> <span class="co">// y(1) ≈ e ≈ 2.718282</span></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-77" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-77">Why It Matters</h4>
<ul>
<li>Fourth-order accuracy without complex derivatives</li>
<li>Used in physics, engineering, and machine learning (ODE solvers)</li>
<li>Foundation for adaptive step-size solvers and neural ODEs</li>
<li>Much more stable and accurate than Euler or midpoint methods</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-76" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-76">A Gentle Proof (Why It Works)</h4>
<p>Expand the true solution with Taylor series:</p>
<p><span class="math display">\[
y(x+h)=y(x)+h y'(x)+\frac{h^2}{2}y''(x)+\frac{h^3}{6}y^{(3)}(x)+O(h^4)
\]</span></p>
<p>RK4’s combination of <span class="math inline">\(k_1,k_2,k_3,k_4\)</span> reproduces all terms up to <span class="math inline">\(h^4\)</span>, giving global error <span class="math inline">\(O(h^4)\)</span>.</p>
<p>Each <span class="math inline">\(k_i\)</span> estimates the derivative at intermediate points, forming a weighted average that captures local curvature.</p>
</section>
<section id="try-it-yourself-77" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-77">Try It Yourself</h4>
<ol type="1">
<li>Solve <span class="math inline">\(dy/dx = y\)</span> from <span class="math inline">\(x=0\)</span> to <span class="math inline">\(x=1\)</span> with <span class="math inline">\(h=0.1\)</span>.</li>
<li>Compare with Euler’s method.</li>
<li>Try <span class="math inline">\(dy/dx = -2y\)</span> with <span class="math inline">\(y(0)=1\)</span>.</li>
<li>Visualize <span class="math inline">\(k_1,k_2,k_3,k_4\)</span> on the slope field.</li>
<li>Test with nonlinear <span class="math inline">\(f(x,y)=x^2+y^2\)</span>.</li>
</ol>
</section>
<section id="test-cases-71" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-71">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 36%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Differential Equation</th>
<th>Interval</th>
<th>Step h</th>
<th>Result</th>
<th>True Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(dy/dx=y\)</span></td>
<td>[0,1]</td>
<td>0.1</td>
<td>2.71828</td>
<td><span class="math inline">\(e\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(dy/dx=-2y\)</span></td>
<td>[0,1]</td>
<td>0.1</td>
<td>0.13534</td>
<td><span class="math inline">\(e^{-2}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(dy/dx=x+y\)</span></td>
<td>[0,1]</td>
<td>0.1</td>
<td>2.7183</td>
<td>analytic <span class="math inline">\(2e-1\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-77" class="level4">
<h4 class="anchored" data-anchor-id="complexity-77">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span> evaluations of <span class="math inline">\(f\)</span> (4 per step)</li>
<li>Accuracy: Global error <span class="math inline">\(O(h^4)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>The Runge–Kutta method is a masterpiece of numerical design, simple enough to code in minutes, powerful enough to drive modern simulations and control systems.</p>
</section>
</section>
<section id="eulers-method" class="level3">
<h3 class="anchored" data-anchor-id="eulers-method">579 Euler’s Method</h3>
<p>Euler’s Method is the simplest numerical procedure for solving ordinary differential equations (ODEs). It’s the “hello world” of numerical integration, conceptually clear, easy to implement, and forms the foundation for more advanced methods like Runge–Kutta.</p>
<section id="what-problem-are-we-solving-78" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-78">What Problem Are We Solving?</h4>
<p>We want to approximate the solution of an initial value problem:</p>
<p><span class="math display">\[
\frac{dy}{dx}=f(x,y), \quad y(x_0)=y_0.
\]</span></p>
<p>If we can’t solve this analytically, we can approximate <span class="math inline">\(y(x)\)</span> at discrete points using small steps <span class="math inline">\(h\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-77" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-77">How Does It Work (Plain Language)</h4>
<p>The key idea: use the slope at the current point to predict the next one.</p>
<p>At each step:</p>
<p><span class="math display">\[
y_{n+1} = y_n + h f(x_n, y_n),
\]</span></p>
<p>and</p>
<p><span class="math display">\[
x_{n+1} = x_n + h.
\]</span></p>
<p>This is just “take a small step along the tangent.” The smaller <span class="math inline">\(h\)</span>, the better the approximation.</p>
</section>
<section id="tiny-code-8" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-8">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euler(f, x0, y0, h, n):</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>    x, y <span class="op">=</span> x0, y0</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>        y <span class="op">+=</span> h <span class="op">*</span> f(x, y)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> h</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x, y</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: dy/dx = y, y(0)=1 -&gt; y=e^x</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x, y: y</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> euler(f, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y, <span class="st">"vs"</span>, math.e)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb169"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> euler<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> y0<span class="op">,</span> <span class="dt">double</span> h<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> x0<span class="op">,</span> y <span class="op">=</span> y0<span class="op">;</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>        y <span class="op">+=</span> h <span class="op">*</span> f<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> h<span class="op">;</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"x=</span><span class="sc">%.2f</span><span class="st">, y=</span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>    euler<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span> <span class="co">// y(1) ≈ 2.5937 vs e ≈ 2.7183</span></span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-78" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-78">Why It Matters</h4>
<ul>
<li>The first step into numerical ODEs</li>
<li>Simple, intuitive, and educational</li>
<li>Shows the tradeoff between step size and accuracy</li>
<li>Used as a building block for Runge–Kutta, Heun’s, and predictor–corrector methods</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-77" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-77">A Gentle Proof (Why It Works)</h4>
<p>Using Taylor expansion:</p>
<p><span class="math display">\[
y(x+h) = y(x) + h y'(x) + \frac{h^2}{2} y''(\xi)
\]</span></p>
<p>Since <span class="math inline">\(y'(x)=f(x,y)\)</span>, Euler’s method approximates by ignoring higher-order terms:</p>
<p><span class="math display">\[
y_{n+1} \approx y_n + h f(x_n, y_n).
\]</span></p>
<p>The local error is <span class="math inline">\(O(h^2)\)</span>, and the global error is <span class="math inline">\(O(h)\)</span>.</p>
</section>
<section id="try-it-yourself-78" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-78">Try It Yourself</h4>
<ol type="1">
<li>Solve <span class="math inline">\(dy/dx=y\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span> with <span class="math inline">\(h=0.1\)</span>.</li>
<li>Decrease <span class="math inline">\(h\)</span> and observe convergence toward <span class="math inline">\(e\)</span>.</li>
<li>Try <span class="math inline">\(dy/dx=-2y\)</span> and plot exponential decay.</li>
<li>Compare with Runge–Kutta for same step size.</li>
<li>Implement a version that stores and plots all <span class="math inline">\((x,y)\)</span> pairs.</li>
</ol>
</section>
<section id="test-cases-72" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-72">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 20%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Differential Equation</th>
<th>Interval</th>
<th>Step <span class="math inline">\(h\)</span></th>
<th>Euler Result</th>
<th>True Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(dy/dx=y\)</span></td>
<td>[0,1]</td>
<td>0.1</td>
<td>2.5937</td>
<td>2.7183</td>
</tr>
<tr class="even">
<td><span class="math inline">\(dy/dx=-2y\)</span></td>
<td>[0,1]</td>
<td>0.1</td>
<td>0.1615</td>
<td>0.1353</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(dy/dx=x+y\)</span></td>
<td>[0,1]</td>
<td>0.1</td>
<td>2.65</td>
<td>2.7183</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-78" class="level4">
<h4 class="anchored" data-anchor-id="complexity-78">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span></li>
<li>Accuracy: Global <span class="math inline">\(O(h)\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Euler’s Method is the simplest step into numerical dynamics, a straight line drawn into the curved world of differential equations.</p>
</section>
</section>
<section id="gradient-descent-1d-numerical-optimization" class="level3">
<h3 class="anchored" data-anchor-id="gradient-descent-1d-numerical-optimization">580 Gradient Descent (1D Numerical Optimization)</h3>
<p>Gradient Descent is a simple yet powerful iterative algorithm for finding minima of differentiable functions. In one dimension, it’s an intuitive process: move in the opposite direction of the slope until the function stops decreasing.</p>
<section id="what-problem-are-we-solving-79" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-79">What Problem Are We Solving?</h4>
<p>We want to find the local minimum of a real-valued function <span class="math inline">\(f(x)\)</span>, that is:</p>
<p><span class="math display">\[
\min_x f(x)
\]</span></p>
<p>If <span class="math inline">\(f'(x)\)</span> exists but solving <span class="math inline">\(f'(x)=0\)</span> analytically is difficult, we can approach the minimum step-by-step using the gradient (slope).</p>
</section>
<section id="how-does-it-work-plain-language-78" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-78">How Does It Work (Plain Language)</h4>
<p>At each iteration, move opposite to the derivative, scaled by a learning rate <span class="math inline">\(\eta\)</span>:</p>
<p><span class="math display">\[
x_{t+1} = x_t - \eta f'(x_t)
\]</span></p>
<p>The derivative <span class="math inline">\(f'(x_t)\)</span> points uphill; subtracting it moves downhill. The step size <span class="math inline">\(\eta\)</span> determines how far we move.</p>
<ul>
<li>If <span class="math inline">\(\eta\)</span> is too small, convergence is slow.</li>
<li>If <span class="math inline">\(\eta\)</span> is too large, we may overshoot or diverge.</li>
</ul>
<p>The process repeats until <span class="math inline">\(|f'(x_t)|\)</span> becomes very small.</p>
</section>
<section id="tiny-code-9" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-9">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gradient_descent_1d(df, x0, eta<span class="op">=</span><span class="fl">0.1</span>, tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x0</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>        grad <span class="op">=</span> df(x)</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(grad) <span class="op">&lt;</span> tol:</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>        x <span class="op">-=</span> eta <span class="op">*</span> grad</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: minimize f(x) = x^2 -&gt; df/dx = 2x</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>f_prime <span class="op">=</span> <span class="kw">lambda</span> x: <span class="dv">2</span><span class="op">*</span>x</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>x_min <span class="op">=</span> gradient_descent_1d(f_prime, x0<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_min)  <span class="co"># ≈ 0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb171"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> df<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>x<span class="op">;</span> <span class="op">}</span> <span class="co">// derivative of x^2</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> gradient_descent<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> eta<span class="op">,</span> <span class="dt">double</span> tol<span class="op">,</span> <span class="dt">int</span> max_iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> x0<span class="op">;</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> max_iter<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> grad <span class="op">=</span> df<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>grad<span class="op">)</span> <span class="op">&lt;</span> tol<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">-=</span> eta <span class="op">*</span> grad<span class="op">;</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> xmin <span class="op">=</span> gradient_descent<span class="op">(</span><span class="fl">5.0</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="fl">1e-6</span><span class="op">,</span> <span class="dv">1000</span><span class="op">);</span></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"x_min = </span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> xmin<span class="op">);</span></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-79" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-79">Why It Matters</h4>
<ul>
<li>Fundamental to optimization, machine learning, and deep learning</li>
<li>Scales naturally from 1D to high dimensions</li>
<li>Helps visualize energy landscapes, convergence, and learning dynamics</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-78" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-78">A Gentle Proof (Why It Works)</h4>
<p>For convex and smooth <span class="math inline">\(f(x)\)</span>, the Taylor expansion gives:</p>
<p><span class="math display">\[
f(x-\eta f'(x)) \approx f(x) - \eta (f'(x))^2 + \frac{\eta^2}{2} f''(\xi) (f'(x))^2
\]</span></p>
<p>For small <span class="math inline">\(\eta&gt;0\)</span> and <span class="math inline">\(f''(\xi)&gt;0\)</span>, the term <span class="math inline">\(-\eta (f'(x))^2\)</span> dominates, ensuring that <span class="math inline">\(f(x)\)</span> decreases with each step.</p>
<p>This shows convergence toward the stationary point where <span class="math inline">\(f'(x)=0\)</span>.</p>
</section>
<section id="try-it-yourself-79" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-79">Try It Yourself</h4>
<ol type="1">
<li><span class="math inline">\(f(x)=x^2\)</span> with <span class="math inline">\(\eta=0.1\)</span>, starting from <span class="math inline">\(x_0=5\)</span>.</li>
<li>Try <span class="math inline">\(\eta=0.01\)</span> and <span class="math inline">\(\eta=1.0\)</span>, observe convergence or divergence.</li>
<li>Minimize <span class="math inline">\(f(x)=(x-3)^2\)</span>; check how quickly <span class="math inline">\(x\to3\)</span>.</li>
<li>Visualize each iteration on a plot of <span class="math inline">\(f(x)\)</span>.</li>
<li>Modify for stochastic or momentum variants.</li>
</ol>
</section>
<section id="test-cases-73" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-73">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Derivative</th>
<th>Start <span class="math inline">\(x_0\)</span></th>
<th><span class="math inline">\(\eta\)</span></th>
<th>Result</th>
<th>True Minimum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(2x\)</span></td>
<td>5</td>
<td>0.1</td>
<td>0.0000</td>
<td>0</td>
</tr>
<tr class="even">
<td><span class="math inline">\((x-3)^2\)</span></td>
<td><span class="math inline">\(2(x-3)\)</span></td>
<td>0</td>
<td>0.1</td>
<td>3.0000</td>
<td>3</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\cos x\)</span></td>
<td><span class="math inline">\(-\sin x\)</span></td>
<td>2</td>
<td>0.05</td>
<td>1.57</td>
<td><span class="math inline">\(\pi/2\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-79" class="level4">
<h4 class="anchored" data-anchor-id="complexity-79">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(k)\)</span> iterations (depends on step size and tolerance)</li>
<li>Accuracy: depends on <span class="math inline">\(\eta\)</span> and smoothness of <span class="math inline">\(f\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Gradient Descent is the simplest form of learning, a gentle step downhill that embodies the heart of optimization and machine intelligence.</p>
</section>
</section>
</section>
<section id="section-59.-mathematicial-optimization" class="level1">
<h1>Section 59. Mathematicial Optimization</h1>
<section id="simplex-method" class="level3">
<h3 class="anchored" data-anchor-id="simplex-method">581 Simplex Method</h3>
<p>The Simplex Method is a cornerstone of mathematical optimization, a geometric algorithm for solving linear programming (LP) problems efficiently. It walks along the vertices of the feasible region (a convex polytope) until it reaches the optimal vertex, where the objective function is maximized or minimized.</p>
<section id="what-problem-are-we-solving-80" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-80">What Problem Are We Solving?</h4>
<p>We want to optimize a linear objective function subject to linear constraints:</p>
<p><span class="math display">\[
\text{maximize } z = c_1x_1 + c_2x_2 + \dots + c_nx_n
\]</span></p>
<p>subject to</p>
<p><span class="math display">\[
\begin{aligned}
a_{11}x_1 + a_{12}x_2 + \dots + a_{1n}x_n &amp;\le b_1, \
a_{21}x_1 + a_{22}x_2 + \dots + a_{2n}x_n &amp;\le b_2, \
&amp;\vdots \
a_{m1}x_1 + a_{m2}x_2 + \dots + a_{mn}x_n &amp;\le b_m, \
x_i &amp;\ge 0.
\end{aligned}
\]</span></p>
<p>This is the standard form of a linear program.</p>
<p>The goal is to find <span class="math inline">\((x_1,\dots,x_n)\)</span> that gives the maximum (or minimum) value of <span class="math inline">\(z\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-79" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-79">How Does It Work (Plain Language)</h4>
<p>Imagine all constraints forming a polygon (in 2D) or polyhedron (in higher dimensions). The feasible region is convex, so the optimal point always lies on a vertex.</p>
<p>The Simplex method:</p>
<ol type="1">
<li>Starts at one vertex (feasible basic solution).</li>
<li>Moves along edges to an adjacent vertex that improves the objective function.</li>
<li>Repeats until no further improvement is possible, that vertex is optimal.</li>
</ol>
</section>
<section id="algebraic-view" class="level4">
<h4 class="anchored" data-anchor-id="algebraic-view">Algebraic View</h4>
<ol type="1">
<li><p>Convert inequalities to equalities using slack variables. Example: <span class="math inline">\(x_1 + x_2 \le 4\)</span> → <span class="math inline">\(x_1 + x_2 + s_1 = 4\)</span>, where <span class="math inline">\(s_1 \ge 0\)</span>.</p></li>
<li><p>Represent the system in tableau form.</p></li>
<li><p>Perform pivot operations (like Gaussian elimination) to move from one basic feasible solution to another.</p></li>
<li><p>Stop when all reduced costs in the objective row are non-negative (for maximization).</p></li>
</ol>
</section>
<section id="tiny-code-simplified-demonstration" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-simplified-demonstration">Tiny Code (Simplified Demonstration)</h4>
<p>Python (educational version)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplex(c, A, b):</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>    m, n <span class="op">=</span> A.shape</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>    tableau <span class="op">=</span> np.zeros((m<span class="op">+</span><span class="dv">1</span>, n<span class="op">+</span>m<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>    tableau[:m, :n] <span class="op">=</span> A</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>    tableau[:m, n:n<span class="op">+</span>m] <span class="op">=</span> np.eye(m)</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>    tableau[:m, <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> b</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>    tableau[<span class="op">-</span><span class="dv">1</span>, :n] <span class="op">=</span> <span class="op">-</span>c</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>        col <span class="op">=</span> np.argmin(tableau[<span class="op">-</span><span class="dv">1</span>, :<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> tableau[<span class="op">-</span><span class="dv">1</span>, col] <span class="op">&gt;=</span> <span class="dv">0</span>:</span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span>  <span class="co"># optimal</span></span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>        ratios <span class="op">=</span> [tableau[i, <span class="op">-</span><span class="dv">1</span>] <span class="op">/</span> tableau[i, col] <span class="cf">if</span> tableau[i, col] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> np.inf <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(m)]</span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> np.argmin(ratios)</span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>        pivot <span class="op">=</span> tableau[row, col]</span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a>        tableau[row, :] <span class="op">/=</span> pivot</span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(m<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> row:</span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>                tableau[i, :] <span class="op">-=</span> tableau[i, col] <span class="op">*</span> tableau[row, :]</span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tableau[<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: maximize z = 3x1 + 2x2</span></span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a><span class="co"># subject to: x1 + x2 ≤ 4, x1 ≤ 2, x2 ≤ 3</span></span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">2</span>])</span>
<span id="cb172-27"><a href="#cb172-27" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>]])</span>
<span id="cb172-28"><a href="#cb172-28" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb172-29"><a href="#cb172-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Max z ="</span>, simplex(c, A, b))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-80" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-80">Why It Matters</h4>
<ul>
<li>Foundation of operations research, economics, and optimization theory.</li>
<li>Used in logistics, finance, resource allocation, and machine learning (e.g., SVMs).</li>
<li>Despite exponential worst-case complexity, it is extremely fast in practice.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-79" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-79">A Gentle Proof (Why It Works)</h4>
<p>Because linear programs are convex, the optimum (if it exists) must occur at a vertex of the feasible region. The Simplex algorithm explores vertices in a way that strictly improves the objective function until reaching a vertex with no improving adjacent vertices.</p>
<p>This corresponds to the condition that all reduced costs in the tableau are non-negative, indicating optimality.</p>
</section>
<section id="try-it-yourself-80" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-80">Try It Yourself</h4>
<ol type="1">
<li><p>Solve the LP: maximize <span class="math inline">\(z = 3x_1 + 5x_2\)</span> subject to: <span class="math display">\[
\begin{cases}
2x_1 + x_2 \le 8 \
x_1 + 2x_2 \le 8 \
x_1, x_2 \ge 0
\end{cases}
\]</span></p></li>
<li><p>Draw the feasible region and verify the optimal vertex.</p></li>
<li><p>Modify constraints and observe how the solution moves.</p></li>
<li><p>Experiment with minimization by negating the objective.</p></li>
</ol>
</section>
<section id="test-cases-74" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-74">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 47%">
<col style="width: 26%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Objective</th>
<th>Constraints</th>
<th>Result <span class="math inline">\((x_1,x_2)\)</span></th>
<th>Max <span class="math inline">\(z\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(3x_1+2x_2\)</span></td>
<td><span class="math inline">\(x_1+x_2\le4,\ x_1\le2,\ x_2\le3\)</span></td>
<td>(1,3)</td>
<td>9</td>
</tr>
<tr class="even">
<td><span class="math inline">\(2x_1+3x_2\)</span></td>
<td><span class="math inline">\(2x_1+x_2\le8,\ x_1+2x_2\le8\)</span></td>
<td>(2,3)</td>
<td>13</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_1+x_2\)</span></td>
<td><span class="math inline">\(x_1,x_2\le5\)</span></td>
<td>(5,5)</td>
<td>10</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-80" class="level4">
<h4 class="anchored" data-anchor-id="complexity-80">Complexity</h4>
<ul>
<li>Time: Polynomial in practice (though worst-case exponential)</li>
<li>Space: <span class="math inline">\(O(mn)\)</span> for tableau storage</li>
</ul>
<p>The Simplex Method remains one of the most elegant algorithms ever created, a geometric dance over a convex landscape, always finding the corner of greatest value.</p>
</section>
</section>
<section id="dual-simplex-method" class="level3">
<h3 class="anchored" data-anchor-id="dual-simplex-method">582 Dual Simplex Method</h3>
<p>The Dual Simplex Method is a close cousin of the Simplex algorithm. While the original Simplex keeps the solution feasible and moves toward optimality, the Dual Simplex does the opposite, it keeps the solution optimal and moves toward feasibility.</p>
<p>It’s especially useful when constraints change or when we start with an infeasible solution that already satisfies optimality conditions.</p>
<section id="what-problem-are-we-solving-81" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-81">What Problem Are We Solving?</h4>
<p>We still solve a linear program (LP) in standard form, but we start from a tableau that is dual feasible (objective is optimal) but primal infeasible (some right-hand sides are negative).</p>
<p>Maximize</p>
<p><span class="math display">\[
z = c^T x
\]</span></p>
<p>subject to</p>
<p><span class="math display">\[
A x \le b, \quad x \ge 0.
\]</span></p>
<p>The dual simplex method works to restore feasibility while maintaining optimality of the reduced costs.</p>
</section>
<section id="how-does-it-work-plain-language-80" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-80">How Does It Work (Plain Language)</h4>
<p>Think of the Simplex and Dual Simplex as mirror images:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 38%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Simplex</th>
<th>Dual Simplex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Keeps</td>
<td>Feasible solution</td>
<td>Optimal reduced costs</td>
</tr>
<tr class="even">
<td>Fixes</td>
<td>Optimality</td>
<td>Feasibility</td>
</tr>
<tr class="odd">
<td>Pivot choice</td>
<td>Most negative reduced cost</td>
<td>Most negative right-hand side</td>
</tr>
</tbody>
</table>
<p>In the Dual Simplex, at each iteration:</p>
<ol type="1">
<li>Identify a row with a negative RHS (violating feasibility).</li>
<li>Among its coefficients, choose a pivot column that keeps reduced costs non-negative after pivoting.</li>
<li>Perform a pivot to make that constraint feasible.</li>
<li>Repeat until all RHS entries are non-negative (fully feasible).</li>
</ol>
</section>
<section id="algebraic-formulation" class="level4">
<h4 class="anchored" data-anchor-id="algebraic-formulation">Algebraic Formulation</h4>
<p>If we maintain tableau:</p>
<p><span class="math display">\[
\begin{bmatrix}
A &amp; I &amp; b \
c^T &amp; 0 &amp; z
\end{bmatrix}
\]</span></p>
<p>then the pivot condition becomes:</p>
<ul>
<li>Choose row <span class="math inline">\(r\)</span> with <span class="math inline">\(b_r &lt; 0\)</span>.</li>
<li>Choose column <span class="math inline">\(s\)</span> where <span class="math inline">\(a_{rs} &lt; 0\)</span> and <span class="math inline">\(\frac{c_s}{a_{rs}}\)</span> is minimal.</li>
<li>Pivot on <span class="math inline">\((r,s)\)</span>.</li>
</ul>
<p>This restores primal feasibility step by step while maintaining dual optimality.</p>
</section>
<section id="tiny-code-illustrative-example" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-illustrative-example">Tiny Code (Illustrative Example)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dual_simplex(A, b, c):</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>    m, n <span class="op">=</span> A.shape</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>    tableau <span class="op">=</span> np.zeros((m<span class="op">+</span><span class="dv">1</span>, n<span class="op">+</span>m<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    tableau[:m, :n] <span class="op">=</span> A</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    tableau[:m, n:n<span class="op">+</span>m] <span class="op">=</span> np.eye(m)</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>    tableau[:m, <span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> b</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>    tableau[<span class="op">-</span><span class="dv">1</span>, :n] <span class="op">=</span> <span class="op">-</span>c</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> np.<span class="bu">any</span>(tableau[:<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> <span class="dv">0</span>):</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> np.argmin(tableau[:<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>        ratios <span class="op">=</span> []</span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">+</span>m):</span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> tableau[r, j] <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a>                ratios.append(tableau[<span class="op">-</span><span class="dv">1</span>, j] <span class="op">/</span> tableau[r, j])</span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a>                ratios.append(np.inf)</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> np.argmin(ratios)</span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a>        tableau[r, :] <span class="op">/=</span> tableau[r, s]</span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(m<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> r:</span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a>                tableau[i, :] <span class="op">-=</span> tableau[i, s] <span class="op">*</span> tableau[r, :]</span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tableau[<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">1</span>]])</span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>])  <span class="co"># infeasible start</span></span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">2</span>])</span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal value:"</span>, dual_simplex(A, b, c))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-81" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-81">Why It Matters</h4>
<ul>
<li>Efficient for re-optimizing problems after small changes in constraints or RHS.</li>
<li>Commonly used in branch-and-bound and cutting-plane algorithms for integer programming.</li>
<li>Avoids recomputation when previous Simplex solutions become infeasible.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-80" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-80">A Gentle Proof (Why It Works)</h4>
<p>At each iteration, the pivot preserves dual feasibility, meaning the reduced costs remain non-negative, and decreases the objective value (for a maximization problem). When all basic variables become feasible (RHS non-negative), the solution is both feasible and optimal.</p>
<p>Thus, convergence is guaranteed in a finite number of steps for non-degenerate cases.</p>
</section>
<section id="try-it-yourself-81" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-81">Try It Yourself</h4>
<ol type="1">
<li>Start with a Simplex tableau that has a negative RHS.</li>
<li>Apply the Dual Simplex pivot rule to fix feasibility.</li>
<li>Observe that objective value never increases (for maximization).</li>
<li>Compare the path taken with the standard Simplex method.</li>
<li>Use it to re-solve a modified LP without starting from scratch.</li>
</ol>
</section>
<section id="test-cases-75" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-75">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 34%">
<col style="width: 20%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Objective</th>
<th>Constraints</th>
<th>Method Start</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(3x_1+2x_2\)</span></td>
<td><span class="math inline">\(x_1+x_2\le2\)</span>, <span class="math inline">\(x_1-x_2\ge1\)</span></td>
<td>infeasible primal</td>
<td><span class="math inline">\(x_1=1.5, x_2=0.5, z=5.5\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2x_1+x_2\)</span></td>
<td><span class="math inline">\(x_1-x_2\ge2\)</span>, <span class="math inline">\(x_1+x_2\le6\)</span></td>
<td>infeasible primal</td>
<td><span class="math inline">\(x_1=2, x_2=4, z=8\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-81" class="level4">
<h4 class="anchored" data-anchor-id="complexity-81">Complexity</h4>
<ul>
<li>Time: Similar to Simplex, efficient in practice</li>
<li>Space: <span class="math inline">\(O(mn)\)</span> for tableau</li>
</ul>
<p>The Dual Simplex is the mirror that balances infeasibility and optimality, a practical algorithm for when the landscape shifts but the solution must adapt gracefully.</p>
</section>
</section>
<section id="interior-point-method" class="level3">
<h3 class="anchored" data-anchor-id="interior-point-method">583 Interior-Point Method</h3>
<p>The Interior-Point Method is a modern alternative to the Simplex algorithm for solving linear and convex optimization problems. Instead of moving along the edges of the feasible region, it moves through the interior, following smooth curves toward the optimal point.</p>
<section id="what-problem-are-we-solving-82" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-82">What Problem Are We Solving?</h4>
<p>We want to solve a standard linear program:</p>
<p><span class="math display">\[
\text{minimize } c^T x
\]</span></p>
<p>subject to</p>
<p><span class="math display">\[
A x = b, \quad x \ge 0.
\]</span></p>
<p>This defines a convex feasible region, the intersection of half-spaces and equality constraints. The interior-point method searches for the optimal point inside that region rather than on its boundary.</p>
</section>
<section id="how-does-it-work-plain-language-81" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-81">How Does It Work (Plain Language)</h4>
<p>Think of the feasible region as a polyhedron. Instead of “walking along edges” like the Simplex method, we “slide” through its interior along a smooth central path guided by both the objective and the constraints.</p>
<p>The method uses a barrier function to prevent the solution from crossing boundaries. For example, to keep <span class="math inline">\(x_i \ge 0\)</span>, we add a penalty term <span class="math inline">\(-\mu \sum_i \ln(x_i)\)</span> to the objective.</p>
<p>So we solve:</p>
<p><span class="math display">\[
\text{minimize } c^T x - \mu \sum_i \ln(x_i)
\]</span></p>
<p>where <span class="math inline">\(\mu &gt; 0\)</span> controls how close we stay to the boundary. As <span class="math inline">\(\mu \to 0\)</span>, the solution approaches the true optimal vertex.</p>
</section>
<section id="mathematical-steps" class="level4">
<h4 class="anchored" data-anchor-id="mathematical-steps">Mathematical Steps</h4>
<ol type="1">
<li><p>Barrier problem formulation: <span class="math display">\[
\min_x ; c^T x - \mu \sum_{i=1}^n \ln(x_i)
\]</span> subject to <span class="math inline">\(A x = b\)</span>.</p></li>
<li><p>First-order condition: <span class="math display">\[
A x = b, \quad X s = \mu e, \quad s = c - A^T y,
\]</span> where <span class="math inline">\(X = \text{diag}(x_1, \dots, x_n)\)</span> and <span class="math inline">\(s\)</span> are slack variables.</p></li>
<li><p>Newton update: Solve the linearized KKT (Karush–Kuhn–Tucker) system for <span class="math inline">\(\Delta x, \Delta y, \Delta s\)</span>.</p></li>
<li><p>Step and update: <span class="math display">\[
x \leftarrow x + \alpha \Delta x, \quad y \leftarrow y + \alpha \Delta y, \quad s \leftarrow s + \alpha \Delta s,
\]</span> with step size <span class="math inline">\(\alpha\)</span> chosen to maintain positivity.</p></li>
<li><p>Reduce <span class="math inline">\(\mu\)</span> and repeat until convergence.</p></li>
</ol>
</section>
<section id="tiny-code-conceptual-example" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-conceptual-example">Tiny Code (Conceptual Example)</h4>
<p>Python (illustrative version)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> interior_point(A, b, c, mu<span class="op">=</span><span class="fl">1.0</span>, tol<span class="op">=</span><span class="fl">1e-8</span>, max_iter<span class="op">=</span><span class="dv">50</span>):</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>    m, n <span class="op">=</span> A.shape</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.ones(n)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.zeros(m)</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> np.ones(n)</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>        r1 <span class="op">=</span> A <span class="op">@</span> x <span class="op">-</span> b</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>        r2 <span class="op">=</span> A.T <span class="op">@</span> y <span class="op">+</span> s <span class="op">-</span> c</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>        r3 <span class="op">=</span> x <span class="op">*</span> s <span class="op">-</span> mu <span class="op">*</span> np.ones(n)</span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(r1) <span class="op">&lt;</span> tol <span class="kw">and</span> np.linalg.norm(r2) <span class="op">&lt;</span> tol <span class="kw">and</span> np.linalg.norm(r3) <span class="op">&lt;</span> tol:</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Construct Newton system</span></span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a>        diagX <span class="op">=</span> np.diag(x)</span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a>        diagS <span class="op">=</span> np.diag(s)</span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a>        M <span class="op">=</span> A <span class="op">@</span> np.linalg.inv(diagS) <span class="op">@</span> diagX <span class="op">@</span> A.T</span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a>        rhs <span class="op">=</span> <span class="op">-</span>r1 <span class="op">+</span> A <span class="op">@</span> np.linalg.inv(diagS) <span class="op">@</span> (r3 <span class="op">-</span> diagX <span class="op">@</span> r2)</span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a>        dy <span class="op">=</span> np.linalg.solve(M, rhs)</span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a>        ds <span class="op">=</span> <span class="op">-</span>r2 <span class="op">-</span> A.T <span class="op">@</span> dy</span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a>        dx <span class="op">=</span> (r3 <span class="op">-</span> diagX <span class="op">@</span> ds) <span class="op">/</span> s</span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step size</span></span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a>        alpha <span class="op">=</span> <span class="fl">0.99</span> <span class="op">*</span> <span class="bu">min</span>(<span class="dv">1</span>, <span class="bu">min</span>(<span class="op">-</span>x[dx <span class="op">&lt;</span> <span class="dv">0</span>] <span class="op">/</span> dx[dx <span class="op">&lt;</span> <span class="dv">0</span>], default<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb174-28"><a href="#cb174-28" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> alpha <span class="op">*</span> dx</span>
<span id="cb174-29"><a href="#cb174-29" aria-hidden="true" tabindex="-1"></a>        y <span class="op">+=</span> alpha <span class="op">*</span> dy</span>
<span id="cb174-30"><a href="#cb174-30" aria-hidden="true" tabindex="-1"></a>        s <span class="op">+=</span> alpha <span class="op">*</span> ds</span>
<span id="cb174-31"><a href="#cb174-31" aria-hidden="true" tabindex="-1"></a>        mu <span class="op">*=</span> <span class="fl">0.5</span></span>
<span id="cb174-32"><a href="#cb174-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x, y, c <span class="op">@</span> x</span>
<span id="cb174-33"><a href="#cb174-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-34"><a href="#cb174-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb174-35"><a href="#cb174-35" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]])</span>
<span id="cb174-36"><a href="#cb174-36" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb174-37"><a href="#cb174-37" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb174-38"><a href="#cb174-38" aria-hidden="true" tabindex="-1"></a>x, y, val <span class="op">=</span> interior_point(A, b, c)</span>
<span id="cb174-39"><a href="#cb174-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Optimal x:"</span>, x, <span class="st">"Objective:"</span>, val)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-82" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-82">Why It Matters</h4>
<ul>
<li>Competes with or outperforms Simplex for very large-scale LPs and QPs.</li>
<li>Smooth and robust, avoids corner-by-corner traversal.</li>
<li>Forms the foundation of modern convex optimization and machine learning solvers (e.g., SVMs, logistic regression).</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-81" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-81">A Gentle Proof (Why It Works)</h4>
<p>The logarithmic barrier ensures that the iterates remain strictly positive. Each Newton step minimizes a local quadratic approximation of the barrier-augmented objective. As <span class="math inline">\(\mu \to 0\)</span>, the barrier term vanishes, and the solution converges to the true KKT optimal point of the original LP.</p>
</section>
<section id="try-it-yourself-82" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-82">Try It Yourself</h4>
<ol type="1">
<li>Minimize <span class="math inline">\(x_1 + x_2\)</span> subject to <span class="math display">\[
\begin{cases}
x_1 + 2x_2 \ge 2, \
3x_1 + x_2 \ge 3, \
x_1, x_2 \ge 0.
\end{cases}
\]</span></li>
<li>Compare convergence with the Simplex solution.</li>
<li>Experiment with different <span class="math inline">\(\mu\)</span> reduction schedules.</li>
<li>Plot trajectory, note the smooth curve through the interior.</li>
</ol>
</section>
<section id="test-cases-76" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-76">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 42%">
<col style="width: 27%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Objective</th>
<th>Constraints</th>
<th>Optimal <span class="math inline">\((x_1,x_2)\)</span></th>
<th>Min <span class="math inline">\(c^T x\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x_1+x_2\)</span></td>
<td><span class="math inline">\(x_1+x_2\ge2\)</span></td>
<td>(1,1)</td>
<td>2</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_1+2x_2\)</span></td>
<td><span class="math inline">\(x_1+2x_2\ge4\)</span>, <span class="math inline">\(x_1,x_2\ge0\)</span></td>
<td>(0,2)</td>
<td>4</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2x_1+x_2\)</span></td>
<td><span class="math inline">\(x_1+x_2\ge3\)</span></td>
<td>(2,1)</td>
<td>5</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-82" class="level4">
<h4 class="anchored" data-anchor-id="complexity-82">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^{3.5}L)\)</span> for linear programs (polynomial time)</li>
<li>Space: <span class="math inline">\(O(n^2)\)</span> due to matrix factorizations</li>
</ul>
<p>The Interior-Point Method is the elegant smooth traveler of optimization, gliding through the feasible space’s heart while homing in on the global optimum with mathematical grace.</p>
</section>
</section>
<section id="gradient-descent-unconstrained-optimization" class="level3">
<h3 class="anchored" data-anchor-id="gradient-descent-unconstrained-optimization">584 Gradient Descent (Unconstrained Optimization)</h3>
<p>Gradient Descent is one of the simplest and most fundamental optimization algorithms. It is used to find the local minimum of a differentiable function by repeatedly moving in the opposite direction of the gradient, the direction of steepest descent.</p>
<section id="what-problem-are-we-solving-83" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-83">What Problem Are We Solving?</h4>
<p>We want to minimize a smooth function <span class="math inline">\(f(x)\)</span>, where <span class="math inline">\(x \in \mathbb{R}^n\)</span>:</p>
<p><span class="math display">\[
\min_x f(x)
\]</span></p>
<p>The function <span class="math inline">\(f(x)\)</span> could represent cost, loss, or error, and our goal is to find a point where the gradient (slope) is close to zero:</p>
<p><span class="math display">\[
\nabla f(x^*) = 0
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-82" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-82">How Does It Work (Plain Language)</h4>
<p>At each step, we update <span class="math inline">\(x\)</span> by moving <em>against</em> the gradient, since that’s the direction in which <span class="math inline">\(f(x)\)</span> decreases fastest.</p>
<p><span class="math display">\[
x_{t+1} = x_t - \eta \nabla f(x_t)
\]</span></p>
<p>Here:</p>
<ul>
<li><span class="math inline">\(\eta &gt; 0\)</span> is the learning rate (step size).</li>
<li><span class="math inline">\(\nabla f(x_t)\)</span> is the gradient vector at the current point.</li>
</ul>
<p>The algorithm continues until the gradient becomes very small or until changes in <span class="math inline">\(x\)</span> or <span class="math inline">\(f(x)\)</span> are negligible.</p>
</section>
<section id="step-by-step-example" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-example">Step-by-Step Example</h4>
<p>Let’s minimize <span class="math inline">\(f(x) = x^2\)</span>. Then <span class="math inline">\(\nabla f(x) = 2x\)</span>.</p>
<p><span class="math display">\[
x_{t+1} = x_t - \eta (2x_t) = (1 - 2\eta)x_t
\]</span></p>
<p>If <span class="math inline">\(0 &lt; \eta &lt; 1\)</span>, the sequence converges to <span class="math inline">\(x=0\)</span>, the global minimum.</p>
</section>
<section id="tiny-code-simple-implementation" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-simple-implementation">Tiny Code (Simple Implementation)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gradient_descent(fprime, x0, eta<span class="op">=</span><span class="fl">0.1</span>, tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x0</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>        grad <span class="op">=</span> fprime(x)</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(grad) <span class="op">&lt;</span> tol:</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>        x <span class="op">-=</span> eta <span class="op">*</span> grad</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: minimize f(x) = x^2 + y^2</span></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>fprime <span class="op">=</span> <span class="kw">lambda</span> v: np.array([<span class="dv">2</span><span class="op">*</span>v[<span class="dv">0</span>], <span class="dv">2</span><span class="op">*</span>v[<span class="dv">1</span>]])</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>x_min <span class="op">=</span> gradient_descent(fprime, np.array([<span class="fl">5.0</span>, <span class="op">-</span><span class="fl">3.0</span>]))</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Minimum at:"</span>, x_min)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb176"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> grad<span class="op">(</span><span class="dt">double</span> x<span class="op">[],</span> <span class="dt">double</span> g<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>    g<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>    g<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> gradient_descent<span class="op">(</span><span class="dt">double</span> x<span class="op">[],</span> <span class="dt">double</span> eta<span class="op">,</span> <span class="dt">double</span> tol<span class="op">,</span> <span class="dt">int</span> max_iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> g<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> max_iter<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>        grad<span class="op">(</span>x<span class="op">,</span> g<span class="op">);</span></span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> norm <span class="op">=</span> sqrt<span class="op">(</span>g<span class="op">[</span><span class="dv">0</span><span class="op">]*</span>g<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> g<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>g<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>norm <span class="op">&lt;</span> tol<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">-=</span> eta <span class="op">*</span> g<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">-=</span> eta <span class="op">*</span> g<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="fl">5.0</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.0</span><span class="op">};</span></span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>    gradient_descent<span class="op">(</span>x<span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="fl">1e-6</span><span class="op">,</span> <span class="dv">1000</span><span class="op">);</span></span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Minimum at (</span><span class="sc">%.4f</span><span class="st">, </span><span class="sc">%.4f</span><span class="st">)</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">[</span><span class="dv">0</span><span class="op">],</span> x<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-83" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-83">Why It Matters</h4>
<ul>
<li>Foundation for machine learning, deep learning, and optimization theory.</li>
<li>Works in high dimensions with simple computation per step.</li>
<li>Forms the basis of more advanced algorithms like SGD, Momentum, and Adam.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-82" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-82">A Gentle Proof (Why It Works)</h4>
<p>For convex and differentiable <span class="math inline">\(f(x)\)</span> with Lipschitz-continuous gradient (<span class="math inline">\(L\)</span>-smooth), the update rule guarantees:</p>
<p><span class="math display">\[
f(x_{t+1}) \le f(x_t) - \frac{\eta}{2}|\nabla f(x_t)|^2
\]</span></p>
<p>if <span class="math inline">\(0 &lt; \eta \le \frac{1}{L}\)</span>.</p>
<p>This means each step decreases <span class="math inline">\(f(x)\)</span> by a quantity proportional to the squared gradient magnitude, leading to convergence.</p>
</section>
<section id="try-it-yourself-83" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-83">Try It Yourself</h4>
<ol type="1">
<li>Minimize <span class="math inline">\(f(x)=x^2+y^2\)</span> starting from <span class="math inline">\((5,-3)\)</span>.</li>
<li>Try <span class="math inline">\(\eta=0.1\)</span>, <span class="math inline">\(\eta=0.5\)</span>, and <span class="math inline">\(\eta=1.0\)</span>, see which converges fastest.</li>
<li>Add a stopping condition based on <span class="math inline">\(|f(x_{t+1}) - f(x_t)|\)</span>.</li>
<li>Visualize the path on a contour plot of <span class="math inline">\(f(x,y)\)</span>.</li>
<li>Extend to non-convex functions like <span class="math inline">\(f(x)=x^4 - 3x^3 + 2\)</span>.</li>
</ol>
</section>
<section id="test-cases-77" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-77">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Gradient</th>
<th>Start <span class="math inline">\(x_0\)</span></th>
<th><span class="math inline">\(\eta\)</span></th>
<th>Result</th>
<th>True Minimum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(2x\)</span></td>
<td>5</td>
<td>0.1</td>
<td>0.0000</td>
<td>0</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^2+y^2\)</span></td>
<td><span class="math inline">\((2x,2y)\)</span></td>
<td>(5,-3)</td>
<td>0.1</td>
<td>(0,0)</td>
<td>(0,0)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\((x-2)^2\)</span></td>
<td><span class="math inline">\(2(x-2)\)</span></td>
<td>0</td>
<td>0.1</td>
<td>2.0000</td>
<td>2</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-83" class="level4">
<h4 class="anchored" data-anchor-id="complexity-83">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(k)\)</span> iterations (depends on learning rate and tolerance)</li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>Gradient Descent is the universal descent path, a simple, elegant method that lies at the foundation of optimization and learning across all of modern computation.</p>
</section>
</section>
<section id="stochastic-gradient-descent-sgd" class="level3">
<h3 class="anchored" data-anchor-id="stochastic-gradient-descent-sgd">585 Stochastic Gradient Descent (SGD)</h3>
<p>Stochastic Gradient Descent (SGD) is the workhorse of modern machine learning. It extends ordinary gradient descent by using <em>random samples</em> (or mini-batches) to estimate the gradient at each step, allowing it to scale efficiently to massive datasets.</p>
<section id="what-problem-are-we-solving-84" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-84">What Problem Are We Solving?</h4>
<p>We aim to minimize a function defined as the average of many sample-based losses:</p>
<p><span class="math display">\[
f(x) = \frac{1}{N} \sum_{i=1}^N f_i(x)
\]</span></p>
<p>Computing the full gradient <span class="math inline">\(\nabla f(x) = \frac{1}{N}\sum_i \nabla f_i(x)\)</span> at every iteration can be very expensive when <span class="math inline">\(N\)</span> is large.</p>
<p>SGD avoids that by using only one (or a few) random samples per step:</p>
<p><span class="math display">\[
x_{t+1} = x_t - \eta \nabla f_{i_t}(x_t)
\]</span></p>
<p>where <span class="math inline">\(i_t\)</span> is randomly selected from <span class="math inline">\({1,2,\dots,N}\)</span>.</p>
</section>
<section id="how-does-it-work-plain-language-83" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-83">How Does It Work (Plain Language)</h4>
<p>Instead of calculating the <em>exact</em> slope of the entire landscape, SGD takes a noisy but much cheaper estimate of the slope. It zigzags its way downhill, sometimes overshooting, sometimes correcting, but overall, it trends toward the minimum.</p>
<p>This randomness acts like “built-in exploration,” helping SGD escape shallow local minima in non-convex problems.</p>
</section>
<section id="algorithm-steps-5" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-5">Algorithm Steps</h4>
<ol type="1">
<li><p>Initialize <span class="math inline">\(x_0\)</span> (random or zero).</p></li>
<li><p>For each iteration <span class="math inline">\(t\)</span>:</p>
<ul>
<li>Randomly sample <span class="math inline">\(i_t \in {1,\dots,N}\)</span></li>
<li>Compute gradient estimate <span class="math inline">\(g_t = \nabla f_{i_t}(x_t)\)</span></li>
<li>Update parameter: <span class="math inline">\(x_{t+1} = x_t - \eta g_t\)</span></li>
</ul></li>
<li><p>Optionally decay the learning rate <span class="math inline">\(\eta_t\)</span> over time.</p></li>
</ol>
<p>Common decay schedules: <span class="math display">\[
\eta_t = \frac{\eta_0}{1 + \lambda t}
\]</span></p>
</section>
<section id="tiny-code-simple-example" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-simple-example">Tiny Code (Simple Example)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sgd(fprime, x0, data, eta<span class="op">=</span><span class="fl">0.1</span>, epochs<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x0</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(epochs):</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> np.random.randint(N)</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>        grad <span class="op">=</span> fprime(x, data[i])</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>        x <span class="op">-=</span> eta <span class="op">*</span> grad</span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: minimize average (x - y)^2 over samples</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, <span class="fl">4.0</span>])</span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> grad(x, y): <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>(x <span class="op">-</span> y)</span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>x_min <span class="op">=</span> sgd(grad, x0<span class="op">=</span><span class="fl">0.0</span>, data<span class="op">=</span>data)</span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated minimum:"</span>, x_min)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb178"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> grad<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">2</span><span class="op">*(</span>x <span class="op">-</span> y<span class="op">);</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> sgd<span class="op">(</span><span class="dt">double</span> <span class="op">*</span>data<span class="op">,</span> <span class="dt">int</span> N<span class="op">,</span> <span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> eta<span class="op">,</span> <span class="dt">int</span> epochs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> x0<span class="op">;</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>    srand<span class="op">(</span>time<span class="op">(</span>NULL<span class="op">));</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">&lt;</span> epochs<span class="op">;</span> t<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> i <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> N<span class="op">;</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> g <span class="op">=</span> grad<span class="op">(</span>x<span class="op">,</span> data<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>        x <span class="op">-=</span> eta <span class="op">*</span> g<span class="op">;</span></span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> data<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="fl">1.0</span><span class="op">,</span> <span class="fl">2.0</span><span class="op">,</span> <span class="fl">3.0</span><span class="op">,</span> <span class="fl">4.0</span><span class="op">};</span></span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> xmin <span class="op">=</span> sgd<span class="op">(</span>data<span class="op">,</span> N<span class="op">,</span> <span class="fl">0.0</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dv">1000</span><span class="op">);</span></span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Estimated minimum: </span><span class="sc">%.4f\n</span><span class="st">"</span><span class="op">,</span> xmin<span class="op">);</span></span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-84" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-84">Why It Matters</h4>
<ul>
<li>Crucial for training neural networks and large-scale models.</li>
<li>Handles billions of data points efficiently.</li>
<li>Naturally fits streaming or online learning settings.</li>
<li>Randomness helps avoid bad local minima in non-convex landscapes.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-83" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-83">A Gentle Proof (Why It Works)</h4>
<p>If the learning rate <span class="math inline">\(\eta_t\)</span> satisfies <span class="math display">\[
\sum_t \eta_t = \infty \quad \text{and} \quad \sum_t \eta_t^2 &lt; \infty,
\]</span> then under mild convexity and smoothness assumptions, SGD converges in expectation to the true minimum <span class="math inline">\(x^*\)</span>.</p>
<p>The randomness introduces <em>variance</em>, but averaging or decreasing <span class="math inline">\(\eta_t\)</span> controls it.</p>
</section>
<section id="try-it-yourself-84" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-84">Try It Yourself</h4>
<ol type="1">
<li>Minimize <span class="math inline">\(f(x) = \frac{1}{N}\sum_i (x - y_i)^2\)</span> for random samples <span class="math inline">\(y_i\)</span>.</li>
<li>Compare full gradient descent vs SGD convergence speed.</li>
<li>Add learning rate decay: <span class="math inline">\(\eta_t = \eta_0/(1+0.01t)\)</span>.</li>
<li>Try mini-batch SGD (use several samples per step).</li>
<li>Plot <span class="math inline">\(f(x_t)\)</span> vs iteration, notice noisy but downward trend.</li>
</ol>
</section>
<section id="test-cases-78" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-78">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Gradient</th>
<th>Dataset</th>
<th>Result</th>
<th>True Minimum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\((x-y)^2\)</span></td>
<td><span class="math inline">\(2(x-y)\)</span></td>
<td>[1,2,3,4]</td>
<td>≈ 2.5</td>
<td>2.5</td>
</tr>
<tr class="even">
<td><span class="math inline">\((x-5)^2\)</span></td>
<td><span class="math inline">\(2(x-5)\)</span></td>
<td>[5]*100</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td><span class="math inline">\((x-y)^2\)</span></td>
<td>[1,1000]</td>
<td>large variance</td>
<td>~500</td>
<td>500</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-84" class="level4">
<h4 class="anchored" data-anchor-id="complexity-84">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(k)\)</span> iterations (each uses one or few samples)</li>
<li>Space: <span class="math inline">\(O(1)\)</span> or <span class="math inline">\(O(\text{mini-batch size})\)</span></li>
<li>Convergence: Sublinear but scalable</li>
</ul>
<p>SGD is the heart of modern learning, a simple yet powerful idea that trades precision for speed, letting massive systems learn efficiently from a sea of data.</p>
</section>
</section>
<section id="newtons-method-multivariate-optimization" class="level3">
<h3 class="anchored" data-anchor-id="newtons-method-multivariate-optimization">586 Newton’s Method (Multivariate Optimization)</h3>
<p>Newton’s Method in multiple dimensions generalizes the one-dimensional root-finding approach to efficiently locate stationary points of smooth functions. It uses both the gradient (first derivative) and Hessian (second derivative matrix) to make quadratic steps toward the optimum.</p>
<section id="what-problem-are-we-solving-85" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-85">What Problem Are We Solving?</h4>
<p>We want to minimize a smooth function <span class="math inline">\(f(x)\)</span>, where <span class="math inline">\(x \in \mathbb{R}^n\)</span>:</p>
<p><span class="math display">\[
\min_x f(x)
\]</span></p>
<p>At the minimum, the gradient vanishes:</p>
<p><span class="math display">\[
\nabla f(x^*) = 0.
\]</span></p>
<p>Newton’s method refines the guess <span class="math inline">\(x_t\)</span> by approximating <span class="math inline">\(f(x)\)</span> locally with its second-order Taylor expansion:</p>
<p><span class="math display">\[
f(x+\Delta x) \approx f(x) + \nabla f(x)^T \Delta x + \frac{1}{2} \Delta x^T H(x) \Delta x,
\]</span></p>
<p>where <span class="math inline">\(H(x)\)</span> is the Hessian matrix.</p>
<p>Setting the gradient of this approximation to zero gives:</p>
<p><span class="math display">\[
H(x) \Delta x = -\nabla f(x),
\]</span></p>
<p>which leads to the update rule:</p>
<p><span class="math display">\[
x_{t+1} = x_t - H(x_t)^{-1} \nabla f(x_t).
\]</span></p>
</section>
<section id="how-does-it-work-plain-language-84" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-84">How Does It Work (Plain Language)</h4>
<p>Imagine standing on a curved surface representing <span class="math inline">\(f(x)\)</span>. The gradient tells you the slope, but the Hessian tells you how the slope itself bends. By combining them, Newton’s method jumps directly toward the local minimum of that curve’s quadratic approximation, often converging in just a few steps when the surface is well-behaved.</p>
</section>
<section id="tiny-code-illustrative-example-1" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-illustrative-example-1">Tiny Code (Illustrative Example)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> newton_multivariate(fprime, hessian, x0, tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x0</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>        g <span class="op">=</span> fprime(x)</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>        H <span class="op">=</span> hessian(x)</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(g) <span class="op">&lt;</span> tol:</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>        dx <span class="op">=</span> np.linalg.solve(H, g)</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">-=</span> dx</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: f(x, y) = x^2 + y^2</span></span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>fprime <span class="op">=</span> <span class="kw">lambda</span> v: np.array([<span class="dv">2</span><span class="op">*</span>v[<span class="dv">0</span>], <span class="dv">2</span><span class="op">*</span>v[<span class="dv">1</span>]])</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>hessian <span class="op">=</span> <span class="kw">lambda</span> v: np.array([[<span class="dv">2</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">2</span>]])</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>x_min <span class="op">=</span> newton_multivariate(fprime, hessian, np.array([<span class="fl">5.0</span>, <span class="op">-</span><span class="fl">3.0</span>]))</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Minimum at:"</span>, x_min)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (simplified)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb180"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> gradient<span class="op">(</span><span class="dt">double</span> x<span class="op">[],</span> <span class="dt">double</span> g<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>    g<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>    g<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> hessian<span class="op">(</span><span class="dt">double</span> H<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>    H<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> H<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>    H<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> H<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> newton<span class="op">(</span><span class="dt">double</span> x<span class="op">[],</span> <span class="dt">double</span> tol<span class="op">,</span> <span class="dt">int</span> max_iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> g<span class="op">[</span><span class="dv">2</span><span class="op">],</span> H<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> max_iter<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>        gradient<span class="op">(</span>x<span class="op">,</span> g<span class="op">);</span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sqrt<span class="op">(</span>g<span class="op">[</span><span class="dv">0</span><span class="op">]*</span>g<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> g<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>g<span class="op">[</span><span class="dv">1</span><span class="op">])</span> <span class="op">&lt;</span> tol<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>        hessian<span class="op">(</span>H<span class="op">);</span></span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">-=</span> g<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">/</span> H<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">-=</span> g<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">/</span> H<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="fl">5.0</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.0</span><span class="op">};</span></span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a>    newton<span class="op">(</span>x<span class="op">,</span> <span class="fl">1e-6</span><span class="op">,</span> <span class="dv">100</span><span class="op">);</span></span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Minimum at (</span><span class="sc">%.4f</span><span class="st">, </span><span class="sc">%.4f</span><span class="st">)</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">[</span><span class="dv">0</span><span class="op">],</span> x<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-85" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-85">Why It Matters</h4>
<ul>
<li>Extremely fast near the optimum (quadratic convergence).</li>
<li>The foundation for many advanced solvers, BFGS, Newton-CG, and trust-region methods.</li>
<li>Central to optimization, machine learning, and numerical analysis.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-84" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-84">A Gentle Proof (Why It Works)</h4>
<p>Near a true minimum <span class="math inline">\(x^*\)</span>, the function behaves almost quadratically:</p>
<p><span class="math display">\[
f(x) \approx f(x^*) + \frac{1}{2}(x-x^*)^T H(x^*)(x-x^*).
\]</span></p>
<p>Thus, the Newton update <span class="math inline">\(x_{t+1}=x_t-H^{-1}\nabla f(x_t)\)</span> effectively solves this local quadratic model exactly. When <span class="math inline">\(H\)</span> is positive definite and <span class="math inline">\(x_t\)</span> is sufficiently close to <span class="math inline">\(x^*\)</span>, convergence is quadratic, the error shrinks roughly as the square of the previous error.</p>
</section>
<section id="try-it-yourself-85" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-85">Try It Yourself</h4>
<ol type="1">
<li>Minimize <span class="math inline">\(f(x,y)=x^2+y^2\)</span> from <span class="math inline">\((5,-3)\)</span>.</li>
<li>Try a non-diagonal Hessian: <span class="math inline">\(f(x,y)=x^2+xy+y^2\)</span>.</li>
<li>Compare convergence speed with Gradient Descent.</li>
<li>Observe behavior when the Hessian is not positive definite.</li>
<li>Add line search to improve robustness.</li>
</ol>
</section>
<section id="test-cases-79" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-79">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 41%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Gradient</th>
<th>Hessian</th>
<th>Start</th>
<th>Result</th>
<th>True Minimum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2 + y^2\)</span></td>
<td><span class="math inline">\((2x,\,2y)\)</span></td>
<td><span class="math inline">\(\begin{bmatrix} 2 &amp; 0 \\ 0 &amp; 2 \end{bmatrix}\)</span></td>
<td><span class="math inline">\((5,-3)\)</span></td>
<td><span class="math inline">\((0,0)\)</span></td>
<td><span class="math inline">\((0,0)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\((x-2)^2 + (y+1)^2\)</span></td>
<td><span class="math inline">\((2(x-2),\,2(y+1))\)</span></td>
<td><span class="math inline">\(\operatorname{diag}(2,2)\)</span></td>
<td><span class="math inline">\((0,0)\)</span></td>
<td><span class="math inline">\((2,-1)\)</span></td>
<td><span class="math inline">\((2,-1)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x^2 + xy + y^2\)</span></td>
<td><span class="math inline">\((2x+y,\,x+2y)\)</span></td>
<td><span class="math inline">\(\begin{bmatrix} 2 &amp; 1 \\ 1 &amp; 2 \end{bmatrix}\)</span></td>
<td><span class="math inline">\((3,-2)\)</span></td>
<td><span class="math inline">\((0,0)\)</span></td>
<td><span class="math inline">\((0,0)\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-85" class="level4">
<h4 class="anchored" data-anchor-id="complexity-85">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n^3)\)</span> per iteration (matrix inversion or linear solve)</li>
<li>Space: <span class="math inline">\(O(n^2)\)</span> (store Hessian)</li>
</ul>
<p>Newton’s Method is the mathematician’s scalpel, precise, elegant, and fast when the terrain is smooth, cutting straight to the heart of an optimum in just a few careful steps.</p>
</section>
</section>
<section id="conjugate-gradient-method" class="level3">
<h3 class="anchored" data-anchor-id="conjugate-gradient-method">587 Conjugate Gradient Method</h3>
<p>The Conjugate Gradient (CG) Method is an iterative algorithm for solving large systems of linear equations of the form</p>
<p><span class="math display">\[
A x = b
\]</span></p>
<p>where <span class="math inline">\(A\)</span> is symmetric positive definite (SPD). It’s especially powerful because it doesn’t require matrix inversion or even explicit storage of <span class="math inline">\(A\)</span>, only the ability to compute matrix–vector products.</p>
<p>CG can also be seen as a method for minimizing quadratic functions efficiently in high dimensions.</p>
<section id="what-problem-are-we-solving-86" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-86">What Problem Are We Solving?</h4>
<p>We want to minimize the quadratic form</p>
<p><span class="math display">\[
f(x) = \frac{1}{2}x^T A x - b^T x,
\]</span></p>
<p>which has the gradient</p>
<p><span class="math display">\[
\nabla f(x) = A x - b.
\]</span></p>
<p>Setting <span class="math inline">\(\nabla f(x)=0\)</span> gives the same equation <span class="math inline">\(A x = b\)</span>.</p>
<p>Thus, solving <span class="math inline">\(A x = b\)</span> and minimizing <span class="math inline">\(f(x)\)</span> are equivalent.</p>
</section>
<section id="how-does-it-work-plain-language-85" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work-plain-language-85">How Does It Work (Plain Language)</h4>
<p>Ordinary gradient descent may zigzag and converge slowly when contours of <span class="math inline">\(f(x)\)</span> are elongated. The Conjugate Gradient method fixes this by ensuring each search direction is A-orthogonal (conjugate) to all previous ones, meaning each step eliminates error in a new dimension without undoing progress from earlier steps.</p>
<p>It can find the exact solution in at most <span class="math inline">\(n\)</span> steps (for <span class="math inline">\(n\)</span> variables) in exact arithmetic.</p>
</section>
<section id="algorithm-steps-6" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-6">Algorithm Steps</h4>
<ol type="1">
<li>Initialize <span class="math inline">\(x_0\)</span> (e.g., zeros).</li>
<li>Compute initial residual <span class="math inline">\(r_0 = b - A x_0\)</span> and set direction <span class="math inline">\(p_0 = r_0\)</span>.</li>
<li>For each iteration <span class="math inline">\(k=0,1,2,\dots\)</span>: <span class="math display">\[
\alpha_k = \frac{r_k^T r_k}{p_k^T A p_k}
\]</span> <span class="math display">\[
x_{k+1} = x_k + \alpha_k p_k
\]</span> <span class="math display">\[
r_{k+1} = r_k - \alpha_k A p_k
\]</span> If <span class="math inline">\(|r_{k+1}|\)</span> is small enough, stop. Otherwise: <span class="math display">\[
\beta_k = \frac{r_{k+1}^T r_{k+1}}{r_k^T r_k}, \quad p_{k+1} = r_{k+1} + \beta_k p_k.
\]</span></li>
</ol>
<p>Each new <span class="math inline">\(p_k\)</span> is “conjugate” to all previous directions with respect to <span class="math inline">\(A\)</span>.</p>
</section>
<section id="tiny-code-minimal-implementation" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-minimal-implementation">Tiny Code (Minimal Implementation)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> conjugate_gradient(A, b, x0<span class="op">=</span><span class="va">None</span>, tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(b)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.zeros(n) <span class="cf">if</span> x0 <span class="kw">is</span> <span class="va">None</span> <span class="cf">else</span> x0</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> b <span class="op">-</span> A <span class="op">@</span> x</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> r.copy()</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>        Ap <span class="op">=</span> A <span class="op">@</span> p</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>        alpha <span class="op">=</span> np.dot(r, r) <span class="op">/</span> np.dot(p, Ap)</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> alpha <span class="op">*</span> p</span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>        r_new <span class="op">=</span> r <span class="op">-</span> alpha <span class="op">*</span> Ap</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(r_new) <span class="op">&lt;</span> tol:</span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>        beta <span class="op">=</span> np.dot(r_new, r_new) <span class="op">/</span> np.dot(r, r)</span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> r_new <span class="op">+</span> beta <span class="op">*</span> p</span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> r_new</span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Solve A x = b</span></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">3</span>]], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> conjugate_gradient(A, b)</span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Solution:"</span>, x)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb182"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> matvec<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">],</span> <span class="dt">double</span> x<span class="op">[</span><span class="dv">2</span><span class="op">],</span> <span class="dt">double</span> y<span class="op">[</span><span class="dv">2</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>    y<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> A<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]*</span>x<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> A<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">]*</span>x<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> A<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">]*</span>x<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> A<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">]*</span>x<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> conjugate_gradient<span class="op">(</span><span class="dt">double</span> A<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">],</span> <span class="dt">double</span> b<span class="op">[</span><span class="dv">2</span><span class="op">],</span> <span class="dt">double</span> x<span class="op">[</span><span class="dv">2</span><span class="op">],</span> <span class="dt">int</span> max_iter<span class="op">,</span> <span class="dt">double</span> tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> r<span class="op">[</span><span class="dv">2</span><span class="op">],</span> p<span class="op">[</span><span class="dv">2</span><span class="op">],</span> Ap<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>    matvec<span class="op">(</span>A<span class="op">,</span> x<span class="op">,</span> r<span class="op">);</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">2</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>        r<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> b<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> r<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>        p<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> r<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> max_iter<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>        matvec<span class="op">(</span>A<span class="op">,</span> p<span class="op">,</span> Ap<span class="op">);</span></span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> rr <span class="op">=</span> r<span class="op">[</span><span class="dv">0</span><span class="op">]*</span>r<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> r<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>r<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> alpha <span class="op">=</span> rr <span class="op">/</span> <span class="op">(</span>p<span class="op">[</span><span class="dv">0</span><span class="op">]*</span>Ap<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> p<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>Ap<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+=</span> alpha <span class="op">*</span> p<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">+=</span> alpha <span class="op">*</span> p<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">2</span><span class="op">;</span> i<span class="op">++)</span> r<span class="op">[</span>i<span class="op">]</span> <span class="op">-=</span> alpha <span class="op">*</span> Ap<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> rr_new <span class="op">=</span> r<span class="op">[</span><span class="dv">0</span><span class="op">]*</span>r<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> r<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>r<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sqrt<span class="op">(</span>rr_new<span class="op">)</span> <span class="op">&lt;</span> tol<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> beta <span class="op">=</span> rr_new <span class="op">/</span> rr<span class="op">;</span></span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">2</span><span class="op">;</span> i<span class="op">++)</span> p<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> r<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> beta <span class="op">*</span> p<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-30"><a href="#cb182-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb182-31"><a href="#cb182-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">4</span><span class="op">,</span> <span class="dv">1</span><span class="op">},</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">}};</span></span>
<span id="cb182-32"><a href="#cb182-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> b<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">};</span></span>
<span id="cb182-33"><a href="#cb182-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">};</span></span>
<span id="cb182-34"><a href="#cb182-34" aria-hidden="true" tabindex="-1"></a>    conjugate_gradient<span class="op">(</span>A<span class="op">,</span> b<span class="op">,</span> x<span class="op">,</span> <span class="dv">1000</span><span class="op">,</span> <span class="fl">1e-6</span><span class="op">);</span></span>
<span id="cb182-35"><a href="#cb182-35" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Solution: (</span><span class="sc">%.4f</span><span class="st">, </span><span class="sc">%.4f</span><span class="st">)</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">[</span><span class="dv">0</span><span class="op">],</span> x<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb182-36"><a href="#cb182-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb182-37"><a href="#cb182-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-86" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-86">Why It Matters</h4>
<ul>
<li>Ideal for large sparse systems, especially those from numerical PDEs and finite element methods.</li>
<li>Avoids explicit matrix inversion, only needs <span class="math inline">\(A p\)</span> products.</li>
<li>Core building block in machine learning, physics simulations, and scientific computing.</li>
</ul>
</section>
<section id="a-gentle-proof-why-it-works-85" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-why-it-works-85">A Gentle Proof (Why It Works)</h4>
<p>Each direction <span class="math inline">\(p_k\)</span> is chosen so that</p>
<p><span class="math display">\[
p_i^T A p_j = 0 \quad \text{for } i \ne j,
\]</span></p>
<p>ensuring orthogonality under the <span class="math inline">\(A\)</span>-inner product. This means each step eliminates error along one conjugate direction, never revisiting it. For an <span class="math inline">\(n\)</span>-dimensional system, all error components are eliminated after at most <span class="math inline">\(n\)</span> steps.</p>
</section>
<section id="try-it-yourself-86" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-86">Try It Yourself</h4>
<ol type="1">
<li><p>Solve <span class="math inline">\(A x = b\)</span> with <span class="math display">\[
A =
\begin{bmatrix}
4 &amp; 1\\
1 &amp; 3
\end{bmatrix},
\quad
b =
\begin{bmatrix}
1\\
2
\end{bmatrix}.
\]</span></p></li>
<li><p>Compare the result with Gaussian elimination.</p></li>
<li><p>Modify <span class="math inline">\(A\)</span> to be non-symmetric and observe failure or oscillation.</p></li>
<li><p>Add a preconditioner <span class="math inline">\(M^{-1}\)</span> to improve convergence.</p></li>
<li><p>Plot <span class="math inline">\(|r_k|\)</span> versus iterations and note the geometric decay.</p></li>
</ol>
</section>
<section id="test-cases-80" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-80">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 52%">
<col style="width: 11%">
<col style="width: 24%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(A\)</span></th>
<th><span class="math inline">\(b\)</span></th>
<th>Solution <span class="math inline">\(x^*\)</span></th>
<th>Iterations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix} 4 &amp; 1 \\ 1 &amp; 3 \end{bmatrix}\)</span></td>
<td><span class="math inline">\([1, 2]^T\)</span></td>
<td><span class="math inline">\((0.0909,\, 0.6364)\)</span></td>
<td>3</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\operatorname{diag}(2, 5, 10)\)</span></td>
<td><span class="math inline">\([1, 1, 1]^T\)</span></td>
<td><span class="math inline">\((0.5,\, 0.2,\, 0.1)\)</span></td>
<td>3</td>
</tr>
<tr class="odd">
<td>random SPD <span class="math inline">\((5 \times 5)\)</span></td>
<td>random <span class="math inline">\(b\)</span></td>
<td>accurate</td>
<td><span class="math inline">\(&lt; n\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-86" class="level4">
<h4 class="anchored" data-anchor-id="complexity-86">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(k n)\)</span> (each iteration needs one matrix–vector multiply)</li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
<li>Convergence: Linear but very efficient for well-conditioned <span class="math inline">\(A\)</span></li>
</ul>
<p>The Conjugate Gradient method is the quiet power of numerical optimization, using geometry and algebra hand in hand to solve vast systems with elegant efficiency.</p>
</section>
</section>
<section id="lagrange-multipliers-constrained-optimization" class="level3">
<h3 class="anchored" data-anchor-id="lagrange-multipliers-constrained-optimization">588 Lagrange Multipliers (Constrained Optimization)</h3>
<p>The Lagrange Multiplier Method provides a systematic way to find extrema (minima or maxima) of a function subject to equality constraints. It introduces auxiliary variables, called <em>Lagrange multipliers</em>, that enforce the constraints algebraically, transforming a constrained problem into an unconstrained one.</p>
<section id="what-problem-are-we-solving-87" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-87">What Problem Are We Solving?</h4>
<p>We want to minimize (or maximize) a function <span class="math display">\[
f(x_1, x_2, \dots, x_n)
\]</span> subject to one or more equality constraints: <span class="math display">\[
g_i(x_1, x_2, \dots, x_n) = 0, \quad i = 1, 2, \dots, m.
\]</span></p>
<p>For simplicity, start with a single constraint <span class="math inline">\(g(x) = 0\)</span>.</p>
</section>
<section id="the-core-idea-1" class="level4">
<h4 class="anchored" data-anchor-id="the-core-idea-1">The Core Idea</h4>
<p>At an optimum, the gradient of <span class="math inline">\(f\)</span> must lie in the same direction as the gradient of the constraint <span class="math inline">\(g\)</span>:</p>
<p><span class="math display">\[
\nabla f(x^*) = \lambda \nabla g(x^*),
\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> is the Lagrange multiplier. This captures the idea that any small movement along the constraint surface cannot reduce <span class="math inline">\(f\)</span> further.</p>
<p>We introduce the Lagrangian function:</p>
<p><span class="math display">\[
\mathcal{L}(x, \lambda) = f(x) - \lambda g(x),
\]</span></p>
<p>and find stationary points by setting all derivatives to zero:</p>
<p><span class="math display">\[
\nabla_x \mathcal{L} = 0, \quad g(x) = 0.
\]</span></p>
</section>
<section id="example-classic-two-variable-case" class="level4">
<h4 class="anchored" data-anchor-id="example-classic-two-variable-case">Example: Classic Two-Variable Case</h4>
<p>Minimize <span class="math display">\[
f(x, y) = x^2 + y^2
\]</span> subject to <span class="math display">\[
x + y = 1.
\]</span></p>
<ol type="1">
<li><p>Construct the Lagrangian: <span class="math display">\[
\mathcal{L}(x, y, \lambda) = x^2 + y^2 - \lambda(x + y - 1)
\]</span></p></li>
<li><p>Take partial derivatives and set them to zero: <span class="math display">\[
\frac{\partial \mathcal{L}}{\partial x} = 2x - \lambda = 0
\]</span> <span class="math display">\[
\frac{\partial \mathcal{L}}{\partial y} = 2y - \lambda = 0
\]</span> <span class="math display">\[
\frac{\partial \mathcal{L}}{\partial \lambda} = -(x + y - 1) = 0
\]</span></p></li>
<li><p>Solve: from the first two equations, <span class="math inline">\(2x = 2y = \lambda\)</span> → <span class="math inline">\(x = y\)</span>. Substituting into the constraint <span class="math inline">\(x + y = 1\)</span> → <span class="math inline">\(x = y = 0.5\)</span>.</p></li>
</ol>
<p>Thus the minimum occurs at <span class="math inline">\((x, y) = (0.5, 0.5)\)</span> with <span class="math inline">\(\lambda = 1\)</span>.</p>
</section>
<section id="tiny-code-simple-example-1" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-simple-example-1">Tiny Code (Simple Example)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>x, y, lam <span class="op">=</span> sp.symbols(<span class="st">'x y lam'</span>)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> x2 <span class="op">+</span> y2</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> x <span class="op">+</span> y <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> f <span class="op">-</span> lam <span class="op">*</span> g</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> sp.solve([sp.diff(L, x), sp.diff(L, y), sp.diff(L, lam)], [x, y, lam])</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sol)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Output:</p>
<pre><code>{x: 0.5, y: 0.5, lam: 1}</code></pre>
<p>C (conceptual numeric)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb185"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> <span class="fl">0.5</span><span class="op">,</span> y <span class="op">=</span> <span class="fl">0.5</span><span class="op">,</span> lam <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Minimum at (</span><span class="sc">%.2f</span><span class="st">, </span><span class="sc">%.2f</span><span class="st">), lambda = </span><span class="sc">%.2f\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">,</span> lam<span class="op">);</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-87" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-87">Why It Matters</h4>
<ul>
<li>Core of constrained optimization in calculus, economics, and machine learning.</li>
<li>Generalizes easily to multiple constraints and higher dimensions.</li>
<li>Forms the foundation for KKT conditions (see next section) used in convex optimization and support vector machines.</li>
</ul>
</section>
<section id="a-gentle-proof-geometric-view" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-geometric-view">A Gentle Proof (Geometric View)</h4>
<p>At the optimum point, any movement tangent to the constraint surface must not change <span class="math inline">\(f(x)\)</span>. Hence, <span class="math inline">\(\nabla f\)</span> must be perpendicular to that surface, that is, parallel to <span class="math inline">\(\nabla g\)</span>. Introducing <span class="math inline">\(\lambda\)</span> allows us to equate these directions algebraically, creating solvable equations.</p>
</section>
<section id="try-it-yourself-87" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-87">Try It Yourself</h4>
<ol type="1">
<li>Minimize <span class="math inline">\(f(x, y) = x^2 + y^2\)</span> subject to <span class="math inline">\(x + y = 1\)</span>.</li>
<li>Try <span class="math inline">\(f(x, y) = x^2 + 2y^2\)</span> subject to <span class="math inline">\(x - y = 0\)</span>.</li>
<li>Solve with two constraints: <span class="math display">\[
g_1(x, y) = x + y - 1 = 0, \quad g_2(x, y) = x - 2y = 0.
\]</span></li>
<li>Observe how <span class="math inline">\(\lambda_1, \lambda_2\)</span> act as “weights” enforcing constraints.</li>
</ol>
</section>
<section id="test-cases-81" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-81">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 56%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Constraint</th>
<th>Result <span class="math inline">\((x^*, y^*)\)</span></th>
<th><span class="math inline">\(\lambda\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2+y^2\)</span></td>
<td><span class="math inline">\(x+y=1\)</span></td>
<td>(0.5, 0.5)</td>
<td>1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^2+2y^2\)</span></td>
<td><span class="math inline">\(x-y=0\)</span></td>
<td>(0, 0)</td>
<td>0</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x^2+y^2\)</span></td>
<td><span class="math inline">\(x^2+y^2=4\)</span></td>
<td>circle constraint → any point on circle</td>
<td>variable</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-87" class="level4">
<h4 class="anchored" data-anchor-id="complexity-87">Complexity</h4>
<ul>
<li>Symbolic solution: <span class="math inline">\(O(n^3)\)</span> for solving equations.</li>
<li>Numeric solution: iterative methods (Newton–Raphson, SQP) for large systems.</li>
</ul>
<p>The method of Lagrange multipliers is the mathematical bridge between freedom and constraint, guiding optimization across boundaries defined by nature, design, or logic itself.</p>
</section>
</section>
<section id="karushkuhntucker-kkt-conditions" class="level3">
<h3 class="anchored" data-anchor-id="karushkuhntucker-kkt-conditions">589 Karush–Kuhn–Tucker (KKT) Conditions</h3>
<p>The Karush–Kuhn–Tucker (KKT) conditions generalize the Lagrange multiplier method to handle inequality and equality constraints in nonlinear optimization. They form the cornerstone of modern constrained optimization, especially in convex optimization, machine learning (SVMs), and economics.</p>
<section id="what-problem-are-we-solving-88" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-88">What Problem Are We Solving?</h4>
<p>We want to minimize</p>
<p><span class="math display">\[
f(x)
\]</span></p>
<p>subject to</p>
<p><span class="math display">\[
g_i(x) \le 0 \quad (i = 1, \dots, m)
\]</span></p>
<p>and</p>
<p><span class="math display">\[
h_j(x) = 0 \quad (j = 1, \dots, p).
\]</span></p>
<p>Here:</p>
<ul>
<li><span class="math inline">\(g_i(x)\)</span> are inequality constraints,</li>
<li><span class="math inline">\(h_j(x)\)</span> are equality constraints.</li>
</ul>
</section>
<section id="the-lagrangian-function" class="level4">
<h4 class="anchored" data-anchor-id="the-lagrangian-function">The Lagrangian Function</h4>
<p>We extend the idea of the Lagrange function:</p>
<p><span class="math display">\[
\mathcal{L}(x, \lambda, \mu) = f(x) + \sum_{i=1}^m \lambda_i g_i(x) + \sum_{j=1}^p \mu_j h_j(x),
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\lambda_i \ge 0\)</span> are multipliers for inequality constraints,</li>
<li><span class="math inline">\(\mu_j\)</span> are multipliers for equality constraints.</li>
</ul>
</section>
<section id="the-kkt-conditions" class="level4">
<h4 class="anchored" data-anchor-id="the-kkt-conditions">The KKT Conditions</h4>
<p>For an optimal point <span class="math inline">\(x^*\)</span>, there must exist <span class="math inline">\(\lambda_i\)</span> and <span class="math inline">\(\mu_j\)</span> satisfying the following four conditions:</p>
<ol type="1">
<li><p>Stationarity <span class="math display">\[
\nabla f(x^*) + \sum_{i=1}^m \lambda_i \nabla g_i(x^*) + \sum_{j=1}^p \mu_j \nabla h_j(x^*) = 0
\]</span></p></li>
<li><p>Primal Feasibility <span class="math display">\[
g_i(x^*) \le 0, \quad h_j(x^*) = 0
\]</span></p></li>
<li><p>Dual Feasibility <span class="math display">\[
\lambda_i \ge 0 \quad \text{for all } i
\]</span></p></li>
<li><p>Complementary Slackness <span class="math display">\[
\lambda_i g_i(x^*) = 0 \quad \text{for all } i
\]</span></p></li>
</ol>
<p>Complementary slackness means that if a constraint is not “tight” (inactive), its corresponding <span class="math inline">\(\lambda_i\)</span> must be zero, it exerts no force on the solution.</p>
</section>
<section id="example-quadratic-optimization-with-constraint" class="level4">
<h4 class="anchored" data-anchor-id="example-quadratic-optimization-with-constraint">Example: Quadratic Optimization with Constraint</h4>
<p>Minimize <span class="math display">\[
f(x) = x^2
\]</span> subject to <span class="math display">\[
g(x) = 1 - x \le 0.
\]</span></p>
<p>Step 1: Write the Lagrangian <span class="math display">\[
\mathcal{L}(x, \lambda) = x^2 + \lambda(1 - x)
\]</span></p>
<p>Step 2: KKT conditions</p>
<ul>
<li><p>Stationarity: <span class="math display">\[
\frac{d\mathcal{L}}{dx} = 2x - \lambda = 0
\]</span></p></li>
<li><p>Primal feasibility: <span class="math display">\[
1 - x \le 0
\]</span></p></li>
<li><p>Dual feasibility: <span class="math display">\[
\lambda \ge 0
\]</span></p></li>
<li><p>Complementary slackness: <span class="math display">\[
\lambda(1 - x) = 0
\]</span></p></li>
</ul>
<p>Solve: From stationarity, <span class="math inline">\(\lambda = 2x\)</span>. From complementary slackness, either <span class="math inline">\(\lambda=0\)</span> or <span class="math inline">\(1-x=0\)</span>.</p>
<ul>
<li>If <span class="math inline">\(\lambda=0\)</span>, then <span class="math inline">\(x=0\)</span>. But <span class="math inline">\(1-x=1&gt;0\)</span>, violates feasibility.</li>
<li>If <span class="math inline">\(1-x=0\)</span>, then <span class="math inline">\(x=1\)</span> and <span class="math inline">\(\lambda=2\)</span>.</li>
</ul>
<p>Solution: <span class="math inline">\(x^* = 1\)</span>, <span class="math inline">\(\lambda^* = 2\)</span>.</p>
</section>
<section id="tiny-code-symbolic-example" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-symbolic-example">Tiny Code (Symbolic Example)</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>x, lam <span class="op">=</span> sp.symbols(<span class="st">'x lam'</span>)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> x2</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> x</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> f <span class="op">+</span> lam <span class="op">*</span> g</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> sp.solve([sp.diff(L, x), g, lam <span class="op">&gt;=</span> <span class="dv">0</span>, lam <span class="op">*</span> g], [x, lam], <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sol)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Output:</p>
<pre><code>$${x: 1, lam: 2}]</code></pre>
</section>
<section id="why-it-matters-88" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-88">Why It Matters</h4>
<ul>
<li>Generalizes Lagrange multipliers to handle inequality constraints.</li>
<li>Fundamental to convex optimization, machine learning (SVMs), econometrics, and engineering design.</li>
<li>Provides necessary conditions (and sufficient for convex problems) for optimality.</li>
</ul>
</section>
<section id="a-gentle-proof-intuition" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-intuition">A Gentle Proof (Intuition)</h4>
<p>At an optimum, any feasible perturbation <span class="math inline">\(\Delta x\)</span> must not reduce <span class="math inline">\(f(x)\)</span>. This is only possible if the gradient of <span class="math inline">\(f\)</span> lies within the cone formed by the gradients of the active constraints. KKT multipliers <span class="math inline">\(\lambda_i\)</span> express this combination mathematically.</p>
</section>
<section id="try-it-yourself-88" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-88">Try It Yourself</h4>
<ol type="1">
<li>Minimize <span class="math inline">\(f(x)=x^2+y^2\)</span> subject to <span class="math inline">\(x+y\ge1\)</span>.</li>
<li>Solve <span class="math inline">\(f(x)=x^2\)</span> with constraint <span class="math inline">\(x\ge1\)</span>.</li>
<li>Compare unconstrained and constrained solutions.</li>
<li>Implement KKT solver using symbolic differentiation.</li>
</ol>
</section>
<section id="test-cases-82" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-82">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Constraint</th>
<th>Result <span class="math inline">\((x^*)\)</span></th>
<th><span class="math inline">\(\lambda^*\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(1-x\le0\)</span></td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^2+y^2\)</span></td>
<td><span class="math inline">\(x+y-1=0\)</span></td>
<td><span class="math inline">\((0.5, 0.5)\)</span></td>
<td>1</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(x\ge0\)</span></td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-88" class="level4">
<h4 class="anchored" data-anchor-id="complexity-88">Complexity</h4>
<ul>
<li>Symbolic solving: <span class="math inline">\(O(n^3)\)</span> for small systems.</li>
<li>Numerical KKT solvers (e.g.&nbsp;Sequential Quadratic Programming): <span class="math inline">\(O(n^3)\)</span> per iteration.</li>
</ul>
<p>The KKT conditions are the grammar of optimization, expressing how objectives and constraints negotiate balance at the frontier of possibility.</p>
</section>
</section>
<section id="coordinate-descent" class="level3">
<h3 class="anchored" data-anchor-id="coordinate-descent">590 Coordinate Descent</h3>
<p>The Coordinate Descent method is one of the simplest yet surprisingly powerful algorithms for optimization. Instead of adjusting all variables at once, it updates one coordinate at a time, cycling through variables until convergence. It’s widely used in LASSO regression, matrix factorization, and sparse optimization.</p>
<section id="what-problem-are-we-solving-89" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-89">What Problem Are We Solving?</h4>
<p>We want to minimize a function</p>
<p><span class="math display">\[
f(x_1, x_2, \dots, x_n)
\]</span></p>
<p>possibly subject to simple constraints (like <span class="math inline">\(x_i \ge 0\)</span>).</p>
</section>
<section id="the-idea" class="level4">
<h4 class="anchored" data-anchor-id="the-idea">The Idea</h4>
<p>Rather than tackling the full gradient <span class="math inline">\(\nabla f(x)\)</span> at once, we fix all variables except one and minimize with respect to that variable.</p>
<p>For example, in 2D:</p>
<p><span class="math display">\[
f(x, y) \rightarrow \text{first fix } y, \text{ minimize over } x; \text{ then fix } x, \text{ minimize over } y.
\]</span></p>
<p>Each update step reduces the objective, leading to convergence for convex functions.</p>
</section>
<section id="algorithm-steps-7" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-7">Algorithm Steps</h4>
<p>Given an initial vector <span class="math inline">\(x^{(0)}\)</span>:</p>
<ol type="1">
<li><p>For each coordinate <span class="math inline">\(i = 1, \dots, n\)</span>:</p>
<ul>
<li>Define the <em>partial function</em> <span class="math inline">\(f_i(x_i) = f(x_1, \dots, x_i, \dots, x_n)\)</span>, holding other variables fixed.</li>
<li>Find <span class="math display">\[
x_i^{(k+1)} = \arg \min_{x_i} f_i(x_i)
\]</span></li>
</ul></li>
<li><p>Repeat until convergence (when <span class="math inline">\(f(x)\)</span> changes negligibly or <span class="math inline">\(|x^{(k+1)} - x^{(k)}| &lt; \varepsilon\)</span>).</p></li>
</ol>
</section>
<section id="example-simple-quadratic-function" class="level4">
<h4 class="anchored" data-anchor-id="example-simple-quadratic-function">Example: Simple Quadratic Function</h4>
<p>Minimize <span class="math display">\[
f(x, y) = (x - 2)^2 + (y - 3)^2.
\]</span></p>
<ol type="1">
<li>Initialize <span class="math inline">\((x, y) = (0, 0)\)</span>.</li>
<li>Fix <span class="math inline">\(y=0\)</span>: minimize <span class="math inline">\((x-2)^2\)</span> → <span class="math inline">\(x=2\)</span>.</li>
<li>Fix <span class="math inline">\(x=2\)</span>: minimize <span class="math inline">\((y-3)^2\)</span> → <span class="math inline">\(y=3\)</span>.</li>
<li>Done, reached <span class="math inline">\((2, 3)\)</span> in one sweep.</li>
</ol>
<p>For convex quadratics, coordinate descent converges linearly to the global minimum.</p>
</section>
<section id="tiny-code-10" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-10">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> coordinate_descent(f, grad, x0, tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x0.copy()</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(x)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iter):</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>        x_old <span class="op">=</span> x.copy()</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>            g <span class="op">=</span> grad(x)</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="op">-=</span> <span class="fl">0.1</span> <span class="op">*</span> g[i]  <span class="co"># simple step along coordinate gradient</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> np.linalg.norm(x <span class="op">-</span> x_old) <span class="op">&lt;</span> tol:</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: f(x,y) = (x-2)^2 + (y-3)^2</span></span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> v: (v[<span class="dv">0</span>]<span class="op">-</span><span class="dv">2</span>)<span class="dv">2</span> <span class="op">+</span> (v[<span class="dv">1</span>]<span class="op">-</span><span class="dv">3</span>)<span class="dv">2</span></span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>grad <span class="op">=</span> <span class="kw">lambda</span> v: np.array([<span class="dv">2</span><span class="op">*</span>(v[<span class="dv">0</span>]<span class="op">-</span><span class="dv">2</span>), <span class="dv">2</span><span class="op">*</span>(v[<span class="dv">1</span>]<span class="op">-</span><span class="dv">3</span>)])</span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> coordinate_descent(f, grad, np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>]))</span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Minimum:"</span>, x)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C (simple version)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb189"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">;</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> iter <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> iter <span class="op">&lt;</span> <span class="dv">100</span><span class="op">;</span> iter<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> x_old <span class="op">=</span> x<span class="op">,</span> y_old <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>        x <span class="op">-=</span> alpha <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> <span class="op">(</span>x <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>        y <span class="op">-=</span> alpha <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> <span class="op">(</span>y <span class="op">-</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>x <span class="op">-</span> x_old<span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-6</span> <span class="op">&amp;&amp;</span> fabs<span class="op">(</span>y <span class="op">-</span> y_old<span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-6</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Minimum at (</span><span class="sc">%.6f</span><span class="st">, </span><span class="sc">%.6f</span><span class="st">)</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-89" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-89">Why It Matters</h4>
<ul>
<li>Extremely simple to implement.</li>
<li>Works well when <span class="math inline">\(f(x)\)</span> is separable or coordinate-wise convex.</li>
<li>Scales to very high dimensions, since each step only updates one variable.</li>
<li>Used in LASSO, ridge regression, support vector machines, and matrix factorization.</li>
</ul>
</section>
<section id="a-gentle-proof-intuition-1" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-intuition-1">A Gentle Proof (Intuition)</h4>
<p>At each iteration, minimizing over one coordinate cannot increase <span class="math inline">\(f(x)\)</span>. Thus, <span class="math inline">\(f(x^{(k)})\)</span> is non-increasing and converges. For convex <span class="math inline">\(f\)</span>, this limit is the global minimum.</p>
</section>
<section id="try-it-yourself-89" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-89">Try It Yourself</h4>
<ol type="1">
<li>Minimize <span class="math inline">\(f(x, y) = (x-1)^2 + (2y-3)^2\)</span>.</li>
<li>Add constraint <span class="math inline">\(x, y \ge 0\)</span>.</li>
<li>Replace gradient update with exact 1D minimization per coordinate.</li>
<li>Try a non-convex example, observe convergence to local minima.</li>
</ol>
</section>
<section id="test-cases-83" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-83">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Start</th>
<th>Result</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\((x-2)^2+(y-3)^2\)</span></td>
<td>(0,0)</td>
<td>(2,3)</td>
<td>Quadratic, exact minimum</td>
</tr>
<tr class="even">
<td><span class="math inline">\((x-1)^2+(y-1)^2\)</span></td>
<td>(5,5)</td>
<td>(1,1)</td>
<td>Converges linearly</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sin(x)+\sin(y)\)</span></td>
<td>(2,2)</td>
<td>(π/2, π/2)</td>
<td>Local minimum</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-89" class="level4">
<h4 class="anchored" data-anchor-id="complexity-89">Complexity</h4>
<ul>
<li>Each coordinate update: <span class="math inline">\(O(1)\)</span> (if gradient is cheap).</li>
<li>One full cycle: <span class="math inline">\(O(n)\)</span>.</li>
<li>Total complexity: <span class="math inline">\(O(nk)\)</span> for <span class="math inline">\(k\)</span> iterations.</li>
</ul>
<p>Coordinate Descent embodies the minimalist spirit of optimization, improving one small piece at a time, yet always moving closer to the whole solution.</p>
</section>
</section>
</section>
<section id="section-60.-algebraic-tricks-and-transform-techniques" class="level1">
<h1>Section 60. Algebraic Tricks and Transform Techniques</h1>
<section id="polynomial-multiplication-fft" class="level3">
<h3 class="anchored" data-anchor-id="polynomial-multiplication-fft">591 Polynomial Multiplication (FFT)</h3>
<p>Multiply two polynomials fast by converting coefficient vectors to point values via the Fast Fourier Transform, multiplying pointwise, then transforming back. This computes convolution in <span class="math inline">\(O(n\log n)\)</span> instead of <span class="math inline">\(O(n^2)\)</span>.</p>
<section id="what-problem-are-we-solving-90" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-90">What Problem Are We Solving?</h4>
<p>Given <span class="math display">\[
A(x)=\sum_{i=0}^{n-1}a_i x^i,\quad B(x)=\sum_{j=0}^{m-1}b_j x^j,
\]</span> compute coefficients of <span class="math display">\[
C(x)=A(x)B(x)=\sum_{k=0}^{n+m-2}c_k x^k,
\quad c_k=\sum_{i+j=k}a_i b_j.
\]</span></p>
<p>Naive convolution is <span class="math inline">\(O(nm)\)</span>. FFT uses the Convolution Theorem to do it in <span class="math inline">\(O(N\log N)\)</span> where <span class="math inline">\(N\)</span> is a power of two with <span class="math inline">\(N\ge n+m-1\)</span>.</p>
</section>
<section id="how-does-it-work" class="level4">
<h4 class="anchored" data-anchor-id="how-does-it-work">How Does It Work</h4>
<ol type="1">
<li>Choose size: <span class="math inline">\(N=\text{next power of two}\ge n+m-1\)</span>.</li>
<li>Zero pad <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> to length <span class="math inline">\(N\)</span>.</li>
<li>FFT both sequences: <span class="math inline">\(\hat a=\operatorname{FFT}(a)\)</span>, <span class="math inline">\(\hat b=\operatorname{FFT}(b)\)</span>.</li>
<li>Pointwise multiply: <span class="math inline">\(\hat c_k=\hat a_k\hat b_k\)</span>.</li>
<li>Inverse FFT: <span class="math inline">\(c=\operatorname{IFFT}(\hat c)\)</span>.</li>
<li>Round real parts to nearest integers if inputs are integers.</li>
</ol>
<p>Convolution Theorem: <span class="math display">\[
\mathcal{F}(a*b)=\mathcal{F}(a)\odot \mathcal{F}(b).
\]</span></p>
</section>
<section id="tiny-code-11" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-11">Tiny Code</h4>
<p>Python (NumPy, real coefficients)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly_mul_fft(a, b):</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a) <span class="op">+</span> <span class="bu">len</span>(b) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> (n <span class="op">-</span> <span class="dv">1</span>).bit_length()</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>    fa <span class="op">=</span> np.fft.rfft(a, N)</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>    fb <span class="op">=</span> np.fft.rfft(b, N)</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>    fc <span class="op">=</span> fa <span class="op">*</span> fb</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> np.fft.irfft(fc, N)[:n]</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If inputs are integers, round to nearest int</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.rint(c).astype(<span class="bu">int</span>)</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(poly_mul_fft([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>]))  <span class="co"># [4,13,22,15]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C++17 (iterative Cooley–Tukey with std::complex)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb191"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> cd <span class="op">=</span> complex<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;;</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">double</span> PI <span class="op">=</span> acos<span class="op">(-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fft<span class="op">(</span>vector<span class="op">&lt;</span>cd<span class="op">&gt;&amp;</span> a<span class="op">,</span> <span class="dt">bool</span> inv<span class="op">){</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>a<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> rev<span class="op">;</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">static</span> vector<span class="op">&lt;</span>cd<span class="op">&gt;</span> roots<span class="op">{</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span><span class="dt">int</span><span class="op">)</span>rev<span class="op">.</span>size<span class="op">()</span> <span class="op">!=</span> n<span class="op">){</span></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> k <span class="op">=</span> <span class="fu">__builtin_ctz</span><span class="op">(</span>n<span class="op">);</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>        rev<span class="op">.</span>assign<span class="op">(</span>n<span class="op">,</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++)</span></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>            rev<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>rev<span class="op">[</span>i<span class="op">&gt;&gt;</span><span class="dv">1</span><span class="op">]&gt;&gt;</span><span class="dv">1</span><span class="op">)</span> <span class="op">|</span> <span class="op">((</span>i<span class="op">&amp;</span><span class="dv">1</span><span class="op">)&lt;&lt;(</span>k<span class="op">-</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span><span class="dt">int</span><span class="op">)</span>roots<span class="op">.</span>size<span class="op">()</span> <span class="op">&lt;</span> n<span class="op">){</span></span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> k <span class="op">=</span> <span class="fu">__builtin_ctz</span><span class="op">(</span>roots<span class="op">.</span>size<span class="op">());</span></span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>        roots<span class="op">.</span>resize<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">((</span><span class="dv">1</span><span class="op">&lt;&lt;</span>k<span class="op">)</span> <span class="op">&lt;</span> n<span class="op">){</span></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> ang <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>PI<span class="op">/(</span><span class="dv">1</span><span class="op">&lt;&lt;(</span>k<span class="op">+</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">&lt;&lt;(</span>k<span class="op">-</span><span class="dv">1</span><span class="op">);</span> i<span class="op">&lt;(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>k<span class="op">);</span> i<span class="op">++){</span></span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a>                roots<span class="op">[</span><span class="dv">2</span><span class="op">*</span>i<span class="op">]</span>   <span class="op">=</span> roots<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>                roots<span class="op">[</span><span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> cd<span class="op">(</span>cos<span class="op">(</span>ang<span class="op">*(</span><span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span><span class="op">-(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>k<span class="op">))),</span> sin<span class="op">(</span>ang<span class="op">*(</span><span class="dv">2</span><span class="op">*</span>i<span class="op">+</span><span class="dv">1</span><span class="op">-(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>k<span class="op">))));</span></span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>            k<span class="op">++;</span></span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb191-28"><a href="#cb191-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-29"><a href="#cb191-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++)</span> <span class="cf">if</span> <span class="op">(</span>i<span class="op">&lt;</span>rev<span class="op">[</span>i<span class="op">])</span> swap<span class="op">(</span>a<span class="op">[</span>i<span class="op">],</span>a<span class="op">[</span>rev<span class="op">[</span>i<span class="op">]]);</span></span>
<span id="cb191-30"><a href="#cb191-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> len<span class="op">=</span><span class="dv">1</span><span class="op">;</span> len<span class="op">&lt;</span>n<span class="op">;</span> len<span class="op">&lt;&lt;=</span><span class="dv">1</span><span class="op">){</span></span>
<span id="cb191-31"><a href="#cb191-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">+=</span><span class="dv">2</span><span class="op">*</span>len<span class="op">){</span></span>
<span id="cb191-32"><a href="#cb191-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>len<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb191-33"><a href="#cb191-33" aria-hidden="true" tabindex="-1"></a>                cd u<span class="op">=</span>a<span class="op">[</span>i<span class="op">+</span>j<span class="op">];</span></span>
<span id="cb191-34"><a href="#cb191-34" aria-hidden="true" tabindex="-1"></a>                cd v<span class="op">=</span>a<span class="op">[</span>i<span class="op">+</span>j<span class="op">+</span>len<span class="op">]*</span>roots<span class="op">[</span>len<span class="op">+</span>j<span class="op">];</span></span>
<span id="cb191-35"><a href="#cb191-35" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>i<span class="op">+</span>j<span class="op">]=</span>u<span class="op">+</span>v<span class="op">;</span></span>
<span id="cb191-36"><a href="#cb191-36" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>i<span class="op">+</span>j<span class="op">+</span>len<span class="op">]=</span>u<span class="op">-</span>v<span class="op">;</span></span>
<span id="cb191-37"><a href="#cb191-37" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb191-38"><a href="#cb191-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb191-39"><a href="#cb191-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-40"><a href="#cb191-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>inv<span class="op">){</span></span>
<span id="cb191-41"><a href="#cb191-41" aria-hidden="true" tabindex="-1"></a>        reverse<span class="op">(</span>a<span class="op">.</span>begin<span class="op">()+</span><span class="dv">1</span><span class="op">,</span> a<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb191-42"><a href="#cb191-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span><span class="op">&amp;</span> x<span class="op">:</span>a<span class="op">)</span> x<span class="op">/=</span>n<span class="op">;</span></span>
<span id="cb191-43"><a href="#cb191-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-44"><a href="#cb191-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-45"><a href="#cb191-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-46"><a href="#cb191-46" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;</span> multiply<span class="op">(</span><span class="at">const</span> vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;&amp;</span> A<span class="op">,</span> <span class="at">const</span> vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;&amp;</span> B<span class="op">){</span></span>
<span id="cb191-47"><a href="#cb191-47" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-48"><a href="#cb191-48" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> need <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>A<span class="op">.</span>size<span class="op">()</span> <span class="op">+</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>B<span class="op">.</span>size<span class="op">()</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-49"><a href="#cb191-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&lt;</span> need<span class="op">)</span> n <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-50"><a href="#cb191-50" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>cd<span class="op">&gt;</span> fa<span class="op">(</span>n<span class="op">),</span> fb<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb191-51"><a href="#cb191-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">size_t</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>A<span class="op">.</span>size<span class="op">();</span>i<span class="op">++)</span> fa<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb191-52"><a href="#cb191-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">size_t</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>B<span class="op">.</span>size<span class="op">();</span>i<span class="op">++)</span> fb<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> B<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb191-53"><a href="#cb191-53" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>fa<span class="op">,</span><span class="kw">false</span><span class="op">);</span> fft<span class="op">(</span>fb<span class="op">,</span><span class="kw">false</span><span class="op">);</span></span>
<span id="cb191-54"><a href="#cb191-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++)</span> fa<span class="op">[</span>i<span class="op">]</span> <span class="op">*=</span> fb<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb191-55"><a href="#cb191-55" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>fa<span class="op">,</span><span class="kw">true</span><span class="op">);</span></span>
<span id="cb191-56"><a href="#cb191-56" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;</span> C<span class="op">(</span>need<span class="op">);</span></span>
<span id="cb191-57"><a href="#cb191-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>need<span class="op">;</span>i<span class="op">++)</span> C<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> llround<span class="op">(</span>fa<span class="op">[</span>i<span class="op">].</span>real<span class="op">());</span></span>
<span id="cb191-58"><a href="#cb191-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C<span class="op">;</span></span>
<span id="cb191-59"><a href="#cb191-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-60"><a href="#cb191-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-61"><a href="#cb191-61" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb191-62"><a href="#cb191-62" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;</span> a<span class="op">={</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">},</span> b<span class="op">={</span><span class="dv">4</span><span class="op">,</span><span class="dv">5</span><span class="op">};</span></span>
<span id="cb191-63"><a href="#cb191-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> c <span class="op">=</span> multiply<span class="op">(</span>a<span class="op">,</span>b<span class="op">);</span> <span class="co">// 4 13 22 15</span></span>
<span id="cb191-64"><a href="#cb191-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> x<span class="op">:</span>c<span class="op">)</span> cout<span class="op">&lt;&lt;</span>x<span class="op">&lt;&lt;</span><span class="st">" "</span><span class="op">;</span></span>
<span id="cb191-65"><a href="#cb191-65" aria-hidden="true" tabindex="-1"></a>    cout<span class="op">&lt;&lt;</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">;</span></span>
<span id="cb191-66"><a href="#cb191-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-90" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-90">Why It Matters</h4>
<ul>
<li>Reduces polynomial multiplication from quadratic to quasi-linear time.</li>
<li>Backbone for big integer arithmetic, signal processing, string matching via convolution, and combinatorial counting.</li>
<li>Extends to multidimensional convolutions.</li>
</ul>
</section>
<section id="a-gentle-proof-idea-1" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-idea-1">A Gentle Proof Idea</h4>
<p>Choose <span class="math inline">\(N\)</span>-th roots of unity <span class="math inline">\(\omega_N^k\)</span>. The DFT evaluates a degree less than <span class="math inline">\(N\)</span> polynomial at <span class="math inline">\(N\)</span> distinct points: <span class="math display">\[
\hat a_k=\sum_{t=0}^{N-1} a_t \omega_N^{kt}.
\]</span> Pointwise multiplication gives values of <span class="math inline">\(C(x)=A(x)B(x)\)</span> at the same points: <span class="math inline">\(\hat c_k=\hat a_k\hat b_k\)</span>. Since evaluation points are distinct, inverse DFT uniquely reconstructs <span class="math inline">\(c_0,\dots,c_{N-1}\)</span>.</p>
</section>
<section id="practical-tips-1" class="level4">
<h4 class="anchored" data-anchor-id="practical-tips-1">Practical Tips</h4>
<ul>
<li><p>Pick <span class="math inline">\(N\)</span> as a power of two for fastest FFT.</p></li>
<li><p>For integer inputs, rounding after IFFT recovers exact coefficients.</p></li>
<li><p>Large coefficients risk floating error. Two fixes:</p>
<ol type="1">
<li>split coefficients into chunks and use two or three FFTs with Chinese Remainder reconstruction,</li>
<li>use NTT over a prime modulus for exact modular convolution.</li>
</ol></li>
<li><p>Trim trailing zeros.</p></li>
</ul>
</section>
<section id="try-it-yourself-90" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-90">Try It Yourself</h4>
<ol type="1">
<li>Multiply <span class="math inline">\((1+2x+3x^2)\)</span> by <span class="math inline">\((4+5x)\)</span> by hand and compare to FFT result.</li>
<li>Convolve two random length 10 vectors and verify against naive <span class="math inline">\(O(n^2)\)</span>.</li>
<li>Measure runtime vs naive as sizes double.</li>
<li>Implement circular convolution and compare with linear convolution via zero padding.</li>
<li>Explore double-precision limits by scaling inputs.</li>
</ol>
</section>
<section id="test-cases-84" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-84">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input A</th>
<th>Input B</th>
<th>Output C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\([1,2,3]\)</span></td>
<td><span class="math inline">\([4,5]\)</span></td>
<td><span class="math inline">\([4,13,22,15]\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\([1,0,1]\)</span></td>
<td><span class="math inline">\([1,1]\)</span></td>
<td><span class="math inline">\([1,1,1,1]\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\([2,3,4]\)</span></td>
<td><span class="math inline">\([5,6,7]\)</span></td>
<td><span class="math inline">\([10,27,52,45,28]\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-90" class="level4">
<h4 class="anchored" data-anchor-id="complexity-90">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(N\log N)\)</span> for <span class="math inline">\(N\ge n+m-1\)</span></li>
<li>Space: <span class="math inline">\(O(N)\)</span></li>
</ul>
<p>FFT based multiplication is the standard fast path for large polynomial and integer products.</p>
</section>
</section>
<section id="polynomial-inversion-newton-iteration" class="level3">
<h3 class="anchored" data-anchor-id="polynomial-inversion-newton-iteration">592 Polynomial Inversion (Newton Iteration)</h3>
<p>Polynomial inversion finds a series <span class="math inline">\(B(x)\)</span> such that</p>
<p><span class="math display">\[
A(x)B(x)\equiv1\pmod{x^n}.
\]</span></p>
<p>That means multiplying <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> should yield <span class="math inline">\(1\)</span> up to terms of degree <span class="math inline">\(n-1\)</span>. It’s the polynomial version of computing <span class="math inline">\(1/a\)</span> using iterative refinement, built on the same Newton–Raphson principle.</p>
<section id="what-problem-are-we-solving-91" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-91">What Problem Are We Solving?</h4>
<p>Given a formal power series</p>
<p><span class="math display">\[
A(x)=a_0+a_1x+a_2x^2+\dots,
\]</span></p>
<p>we want another series</p>
<p><span class="math display">\[
B(x)=b_0+b_1x+b_2x^2+\dots
\]</span></p>
<p>such that</p>
<p><span class="math display">\[
A(x)B(x)=1.
\]</span></p>
<p>This is only possible if <span class="math inline">\(a_0\ne0\)</span>.</p>
</section>
<section id="newtons-method-for-series" class="level4">
<h4 class="anchored" data-anchor-id="newtons-method-for-series">Newton’s Method for Series</h4>
<p>We use Newton iteration, similar to numerical inversion. Let <span class="math inline">\(B_k(x)\)</span> be our current approximation modulo <span class="math inline">\(x^k\)</span>. Then we refine it using:</p>
<p><span class="math display">\[
B_{2k}(x)=B_k(x),(2-A(x)B_k(x)) \pmod{x^{2k}}.
\]</span></p>
<p>Each iteration doubles the correct number of terms.</p>
</section>
<section id="algorithm-steps-8" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-8">Algorithm Steps</h4>
<ol type="1">
<li><p>Start with <span class="math inline">\(B_1(x)=1/a_0\)</span>.</p></li>
<li><p>For <span class="math inline">\(k=1,2,4,8,\dots\)</span> until <span class="math inline">\(k\ge n\)</span>:</p>
<ul>
<li>Compute <span class="math inline">\(C(x)=A(x)B_k(x)\pmod{x^{2k}}\)</span>.</li>
<li>Update <span class="math inline">\(B_{2k}(x)=B_k(x),(2-C(x))\pmod{x^{2k}}\)</span>.</li>
</ul></li>
<li><p>Truncate <span class="math inline">\(B(x)\)</span> to degree <span class="math inline">\(n-1\)</span>.</p></li>
</ol>
<p>All polynomial multiplications use FFT or NTT for speed.</p>
</section>
<section id="example-38" class="level4">
<h4 class="anchored" data-anchor-id="example-38">Example</h4>
<p>Suppose</p>
<p><span class="math display">\[
A(x)=1+x.
\]</span></p>
<p>We expect</p>
<p><span class="math display">\[
B(x)=1-x+x^2-x^3+\dots.
\]</span></p>
<p>Step 1: <span class="math inline">\(B_1=1\)</span>. Step 2: <span class="math inline">\(A(x)B_1=1+x\)</span>, so</p>
<p><span class="math display">\[
B_2=B_1(2-(1+x))=1-x.
\]</span></p>
<p>Step 3: <span class="math inline">\(A(x)B_2=(1+x)(1-x)=1-x^2\)</span>,</p>
<p><span class="math display">\[
B_4=B_2(2-(1-x^2))=(1-x)(1+x^2)=1-x+x^2-x^3.
\]</span></p>
<p>And so on. Each step doubles precision.</p>
</section>
<section id="tiny-code-12" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-12">Tiny Code</h4>
<p>Python (using NumPy FFT)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly_mul(a, b):</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a) <span class="op">+</span> <span class="bu">len</span>(b) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> (n <span class="op">-</span> <span class="dv">1</span>).bit_length()</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>    fa <span class="op">=</span> np.fft.rfft(a, N)</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>    fb <span class="op">=</span> np.fft.rfft(b, N)</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>    fc <span class="op">=</span> fa <span class="op">*</span> fb</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> np.fft.irfft(fc, N)[:n]</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c</span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly_inv(a, n):</span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.array([<span class="dv">1</span> <span class="op">/</span> a[<span class="dv">0</span>]])</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> k <span class="op">&lt;</span> n:</span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>        k <span class="op">*=</span> <span class="dv">2</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>        ab <span class="op">=</span> poly_mul(a[:k], b)[:k]</span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> (b <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> poly_mul(b, ab)[:k])[:k]</span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> b[:n]</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: invert 1 + x</span></span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> poly_inv(a, <span class="dv">8</span>)</span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">round</span>(b, <span class="dv">3</span>))</span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a><span class="co"># [1. -1. 1. -1. 1. -1. 1. -1.]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-91" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-91">Why It Matters</h4>
<ul>
<li>Used for series division, modular inverses, and polynomial division in FFT-based arithmetic.</li>
<li>Core primitive in formal power series computations.</li>
<li>Appears in combinatorics, symbolic algebra, and computer algebra systems.</li>
</ul>
</section>
<section id="intuition-behind-newton-update" class="level4">
<h4 class="anchored" data-anchor-id="intuition-behind-newton-update">Intuition Behind Newton Update</h4>
<p>If we want <span class="math inline">\(AB=1\)</span>, define <span class="math display">\[
F(B)=A(x)B(x)-1.
\]</span> Newton iteration gives</p>
<p><span class="math display">\[
B_{k+1}=B_k-F(B_k)/A(x)=B_k-(A(x)B_k-1)B_k=B_k(2-A(x)B_k),
\]</span></p>
<p>which matches our polynomial update rule.</p>
</section>
<section id="try-it-yourself-91" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-91">Try It Yourself</h4>
<ol type="1">
<li>Invert <span class="math inline">\(A(x)=1+x+x^2\)</span> up to degree 8.</li>
<li>Verify by multiplying <span class="math inline">\(A(x)B(x)\)</span> and confirming all terms above constant vanish.</li>
<li>Implement with modular arithmetic under prime <span class="math inline">\(p\)</span>.</li>
<li>Compare FFT-based vs naive performance.</li>
</ol>
</section>
<section id="test-cases-85" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-85">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(A(x)\)</span></th>
<th><span class="math inline">\(B(x)\)</span> (first terms)</th>
<th>Verification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(1+x\)</span></td>
<td><span class="math inline">\(1-x+x^2-x^3+\dots\)</span></td>
<td><span class="math inline">\((1+x)(1-x+x^2-\dots)=1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(1-2x\)</span></td>
<td><span class="math inline">\(1+2x+4x^2+8x^3+\dots\)</span></td>
<td><span class="math inline">\((1-2x)(1+2x+4x^2+\dots)=1\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2+x\)</span></td>
<td><span class="math inline">\(0.5-0.25x+0.125x^2-\dots\)</span></td>
<td><span class="math inline">\((2+x)(B)=1\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-91" class="level4">
<h4 class="anchored" data-anchor-id="complexity-91">Complexity</h4>
<ul>
<li>Each iteration doubles precision.</li>
<li>Uses FFT multiplication → <span class="math inline">\(O(n\log n)\)</span>.</li>
<li>Memory: <span class="math inline">\(O(n)\)</span>.</li>
</ul>
<p>Polynomial inversion by Newton iteration is a masterclass in algebraic efficiency, one simple update that doubles accuracy each time.</p>
</section>
</section>
<section id="polynomial-derivative" class="level3">
<h3 class="anchored" data-anchor-id="polynomial-derivative">593 Polynomial Derivative</h3>
<p>Taking the derivative of a polynomial is one of the simplest symbolic operations, yet it appears everywhere in algorithms for optimization, root finding, series manipulation, and numerical analysis.</p>
<p>Given a polynomial <span class="math display">\[
A(x)=a_0+a_1x+a_2x^2+\dots+a_nx^n,
\]</span> its derivative is <span class="math display">\[
A'(x)=a_1+2a_2x+3a_3x^2+\dots+n a_nx^{n-1}.
\]</span></p>
<section id="what-problem-are-we-solving-92" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-92">What Problem Are We Solving?</h4>
<p>We want to compute the derivative coefficients efficiently and represent <span class="math inline">\(A'(x)\)</span> in the same coefficient form as <span class="math inline">\(A(x)\)</span>. If <span class="math display">\[
A(x)=[a_0,a_1,\dots,a_n],
\]</span> then <span class="math display">\[
A'(x)=[a_1,2a_2,3a_3,\dots,n a_n].
\]</span></p>
<p>This operation runs in <span class="math inline">\(O(n)\)</span> time and is a key subroutine in polynomial algebra and calculus of formal power series.</p>
</section>
<section id="algorithm-steps-9" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-steps-9">Algorithm Steps</h4>
<ol type="1">
<li><p>Given coefficients <span class="math inline">\(a_0,\dots,a_n\)</span>.</p></li>
<li><p>For each <span class="math inline">\(i\)</span> from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>:</p>
<ul>
<li>Compute <span class="math inline">\(b_{i-1}=i\times a_i\)</span>.</li>
</ul></li>
<li><p>Return coefficients <span class="math inline">\([b_0,b_1,\dots,b_{n-1}]\)</span> of <span class="math inline">\(A'(x)\)</span>.</p></li>
</ol>
</section>
<section id="example-39" class="level4">
<h4 class="anchored" data-anchor-id="example-39">Example</h4>
<p>Let <span class="math display">\[
A(x)=3+2x+5x^2+4x^3.
\]</span></p>
<p>Then <span class="math display">\[
A'(x)=2+10x+12x^2.
\]</span></p>
<p>In coefficient form:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Term</th>
<th>Coefficient</th>
<th>New Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^0\)</span></td>
<td><span class="math inline">\(3\)</span></td>
<td>,</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^1\)</span></td>
<td><span class="math inline">\(2\)</span></td>
<td><span class="math inline">\(2\times1=2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x^2\)</span></td>
<td><span class="math inline">\(5\)</span></td>
<td><span class="math inline">\(5\times2=10\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^3\)</span></td>
<td><span class="math inline">\(4\)</span></td>
<td><span class="math inline">\(4\times3=12\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-13" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-13">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly_derivative(a):</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [i <span class="op">*</span> a[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n)]</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>]</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(poly_derivative(A))  <span class="co"># [2, 10, 12]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb194"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> a<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">4</span><span class="op">};</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> d<span class="op">[</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>        d<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> i <span class="op">*</span> a<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">%.0f</span><span class="st"> "</span><span class="op">,</span> d<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-92" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-92">Why It Matters</h4>
<ul>
<li>Central in Newton–Raphson root-finding, gradient descent, and optimization.</li>
<li>Appears in polynomial division, Taylor series, differential equations, and symbolic algebra.</li>
<li>Used in automatic differentiation and backpropagation as the algebraic foundation.</li>
</ul>
</section>
<section id="a-gentle-proof" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof">A Gentle Proof</h4>
<p>From calculus: <span class="math display">\[
\frac{d}{dx}(x^i)=i x^{i-1}.
\]</span></p>
<p>Since <span class="math inline">\(A(x)=\sum_i a_i x^i\)</span>, linearity gives <span class="math display">\[
A'(x)=\sum_i a_i i x^{i-1}.
\]</span> Thus the coefficient of <span class="math inline">\(x^{i-1}\)</span> in <span class="math inline">\(A'(x)\)</span> is <span class="math inline">\(i a_i\)</span>.</p>
</section>
<section id="try-it-yourself-92" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-92">Try It Yourself</h4>
<ol type="1">
<li>Differentiate <span class="math inline">\(A(x)=5x^4+2x^3-x^2+3x-7\)</span>.</li>
<li>Compute the derivative twice (second derivative).</li>
<li>Implement derivative modulo <span class="math inline">\(p\)</span> for large integer polynomials.</li>
<li>Use derivative in Newton–Raphson root updates: <span class="math inline">\(x_{k+1}=x_k-\frac{A(x_k)}{A'(x_k)}.\)</span></li>
</ol>
</section>
<section id="test-cases-86" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-86">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Polynomial</th>
<th>Derivative</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(3+2x+5x^2+4x^3\)</span></td>
<td><span class="math inline">\(2+10x+12x^2\)</span></td>
<td><code>[2,10,12]</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^4\)</span></td>
<td><span class="math inline">\(4x^3\)</span></td>
<td><code>[0,0,0,4]</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(1+x+x^2+x^3\)</span></td>
<td><span class="math inline">\(1+2x+3x^2\)</span></td>
<td><code>[1,2,3]</code></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-92" class="level4">
<h4 class="anchored" data-anchor-id="complexity-92">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>Polynomial differentiation is a one-line operation, but it underlies much of algorithmic calculus, the small step that powers big changes.</p>
</section>
</section>
<section id="polynomial-integration" class="level3">
<h3 class="anchored" data-anchor-id="polynomial-integration">594 Polynomial Integration</h3>
<p>Polynomial integration is the reverse of differentiation: we find a polynomial <span class="math inline">\(B(x)\)</span> such that <span class="math inline">\(B'(x)=A(x)\)</span>. It’s a simple yet vital tool in symbolic algebra, numerical integration, and generating functions.</p>
<section id="what-problem-are-we-solving-93" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-93">What Problem Are We Solving?</h4>
<p>Given <span class="math display">\[
A(x)=a_0+a_1x+a_2x^2+\dots+a_{n-1}x^{n-1},
\]</span> we want <span class="math display">\[
B(x)=\int A(x),dx=C+b_1x+b_2x^2+\dots+b_nx^n,
\]</span> where each coefficient satisfies <span class="math display">\[
b_{i+1}=\frac{a_i}{i+1}.
\]</span></p>
<p>Usually, we set the constant of integration <span class="math inline">\(C=0\)</span> for computational purposes.</p>
</section>
<section id="how-it-works" class="level4">
<h4 class="anchored" data-anchor-id="how-it-works">How It Works</h4>
<p>If <span class="math inline">\(A(x)=[a_0,a_1,a_2,\dots,a_{n-1}]\)</span>, then <span class="math display">\[
B(x)=[0,\frac{a_0}{1},\frac{a_1}{2},\frac{a_2}{3},\dots,\frac{a_{n-1}}{n}].
\]</span></p>
<p>Each term is divided by its new exponent index.</p>
</section>
<section id="example-40" class="level4">
<h4 class="anchored" data-anchor-id="example-40">Example</h4>
<p>Let <span class="math display">\[
A(x)=2+10x+12x^2.
\]</span></p>
<p>Then <span class="math display">\[
B(x)=2x+\frac{10}{2}x^2+\frac{12}{3}x^3=2x+5x^2+4x^3.
\]</span></p>
<p>In coefficient form:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Term</th>
<th>Coefficient in A(x)</th>
<th>Integrated Term</th>
<th>Coefficient in B(x)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x^0\)</span></td>
<td>2</td>
<td><span class="math inline">\(2x\)</span></td>
<td>2</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x^1\)</span></td>
<td>10</td>
<td><span class="math inline">\(10x^2/2\)</span></td>
<td>5</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x^2\)</span></td>
<td>12</td>
<td><span class="math inline">\(12x^3/3\)</span></td>
<td>4</td>
</tr>
</tbody>
</table>
<p>So <span class="math inline">\(B(x)=[0,2,5,4]\)</span>.</p>
</section>
<section id="tiny-code-14" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-14">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly_integrate(a):</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="fl">0.0</span>] <span class="op">+</span> [a[i] <span class="op">/</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">12</span>]</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(poly_integrate(A))  <span class="co"># [0.0, 2.0, 5.0, 4.0]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb196"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> a<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">12</span><span class="op">};</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> b<span class="op">[</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>    b<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>        b<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">/</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">%.2f</span><span class="st"> "</span><span class="op">,</span> b<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-93" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-93">Why It Matters</h4>
<ul>
<li>Converts differential equations into integral form.</li>
<li>Core for symbolic calculus and automatic integration.</li>
<li>Used in Taylor series reconstruction, antiderivative computation, and formal power series analysis.</li>
<li>In computational contexts, enables integration modulo p for exact algebraic manipulation.</li>
</ul>
</section>
<section id="a-gentle-proof-1" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-1">A Gentle Proof</h4>
<p>We know from calculus: <span class="math display">\[
\frac{d}{dx}(x^{i+1})=(i+1)x^i.
\]</span></p>
<p>Thus, to “undo” differentiation, each term’s coefficient is divided by <span class="math inline">\((i+1)\)</span>: <span class="math display">\[
\int a_i x^i dx = \frac{a_i}{i+1}x^{i+1}.
\]</span></p>
<p>Linearity of integration guarantees the full polynomial follows the same rule.</p>
</section>
<section id="try-it-yourself-93" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-93">Try It Yourself</h4>
<ol type="1">
<li>Integrate <span class="math inline">\(A(x)=3+4x+5x^2\)</span> with <span class="math inline">\(C=0\)</span>.</li>
<li>Add a nonzero constant of integration <span class="math inline">\(C=7\)</span>.</li>
<li>Verify by differentiating your result.</li>
<li>Implement integration under modulo arithmetic (<span class="math inline">\(\text{mod }p\)</span>).</li>
<li>Use integration to compute area under a polynomial curve from <span class="math inline">\(x=0\)</span> to <span class="math inline">\(x=1\)</span>.</li>
</ol>
</section>
<section id="test-cases-87" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-87">Test Cases</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 44%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(A(x)\)</span></th>
<th><span class="math inline">\(B(x)\)</span></th>
<th>Verification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(2+10x+12x^2\)</span></td>
<td><span class="math inline">\(2x+5x^2+4x^3\)</span></td>
<td><span class="math inline">\(B'(x)=A(x)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(1+x+x^2\)</span></td>
<td><span class="math inline">\(x+\frac{x^2}{2}+\frac{x^3}{3}\)</span></td>
<td>derivative recovers <span class="math inline">\(A(x)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(5x^2\)</span></td>
<td><span class="math inline">\(\frac{5x^3}{3}\)</span></td>
<td>derivative gives <span class="math inline">\(5x^2\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-93" class="level4">
<h4 class="anchored" data-anchor-id="complexity-93">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>Polynomial integration is straightforward but fundamental, turning discrete coefficients into a continuous curve, one fraction at a time.</p>
</section>
</section>
<section id="formal-power-series-composition" class="level3">
<h3 class="anchored" data-anchor-id="formal-power-series-composition">595 Formal Power Series Composition</h3>
<p>Formal power series (FPS) composition is the operation of substituting one series into another, <span class="math display">\[
C(x)=A(B(x)),
\]</span> where both <span class="math inline">\(A(x)\)</span> and <span class="math inline">\(B(x)\)</span> are formal power series with no concern for convergence, we only care about coefficients up to a chosen degree <span class="math inline">\(n\)</span>.</p>
<p>It’s a fundamental operation in algebraic combinatorics, symbolic computation, and generating function analysis.</p>
<section id="what-problem-are-we-solving-94" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-94">What Problem Are We Solving?</h4>
<p>Given <span class="math display">\[
A(x)=a_0+a_1x+a_2x^2+\dots,
\]</span> and <span class="math display">\[
B(x)=b_0+b_1x+b_2x^2+\dots,
\]</span> we want <span class="math display">\[
C(x)=A(B(x))=a_0+a_1B(x)+a_2(B(x))^2+a_3(B(x))^3+\dots.
\]</span></p>
<p>We compute only terms up to degree <span class="math inline">\(n-1\)</span>.</p>
</section>
<section id="key-assumptions" class="level4">
<h4 class="anchored" data-anchor-id="key-assumptions">Key Assumptions</h4>
<ol type="1">
<li>Usually <span class="math inline">\(b_0=0\)</span> (so <span class="math inline">\(B(x)\)</span> has no constant term), otherwise <span class="math inline">\(A(B(x))\)</span> involves a constant shift.</li>
<li>The target degree <span class="math inline">\(n\)</span> limits all computations, truncate at each step.</li>
</ol>
</section>
<section id="how-it-works-1" class="level4">
<h4 class="anchored" data-anchor-id="how-it-works-1">How It Works</h4>
<ol type="1">
<li><p>Initialize <span class="math inline">\(C(x)=[a_0]\)</span>.</p></li>
<li><p>For each <span class="math inline">\(k\ge1\)</span>:</p>
<ul>
<li>Compute <span class="math inline">\((B(x))^k\)</span> using repeated convolution or precomputed powers.</li>
<li>Multiply by <span class="math inline">\(a_k\)</span>.</li>
<li>Add to <span class="math inline">\(C(x)\)</span>, truncating after degree <span class="math inline">\(n-1\)</span>.</li>
</ul></li>
</ol>
<p>Mathematically: <span class="math display">\[
C(x)=\sum_{k=0}^{n-1} a_k (B(x))^k \pmod{x^n}.
\]</span></p>
<p>Efficient algorithms use divide-and-conquer and FFT-based polynomial multiplications.</p>
</section>
<section id="example-41" class="level4">
<h4 class="anchored" data-anchor-id="example-41">Example</h4>
<p>Let <span class="math display">\[
A(x)=1+x+x^2, \quad B(x)=x+x^2.
\]</span></p>
<p>Then: <span class="math display">\[
A(B(x))=1+(x+x^2)+(x+x^2)^2=1+x+x^2+x^2+2x^3+x^4.
\]</span> Simplify: <span class="math display">\[
A(B(x))=1+x+2x^2+2x^3+x^4.
\]</span></p>
<p>Coefficient form: <span class="math inline">\([1,1,2,2,1]\)</span>.</p>
</section>
<section id="tiny-code-15" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-15">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly_mul(a, b, n):</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="bu">len</span>(a) <span class="op">+</span> <span class="bu">len</span>(b) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> (m <span class="op">-</span> <span class="dv">1</span>).bit_length()</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>    fa <span class="op">=</span> np.fft.rfft(a, N)</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>    fb <span class="op">=</span> np.fft.rfft(b, N)</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>    fc <span class="op">=</span> fa <span class="op">*</span> fb</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> np.fft.irfft(fc, N)[:n]</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.rint(c).astype(<span class="bu">int</span>)</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> poly_compose(a, b, n):</span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> np.zeros(n, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>    term <span class="op">=</span> np.ones(<span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(a)):</span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>            term <span class="op">=</span> poly_mul(term, b, n)</span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>        res[:<span class="bu">len</span>(term)] <span class="op">+=</span> a[i] <span class="op">*</span> term[:n]</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res[:n]</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(poly_compose(A, B, <span class="dv">5</span>))  <span class="co"># [1, 1, 2, 2, 1]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-94" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-94">Why It Matters</h4>
<ul>
<li>Composition is central in generating functions for combinatorial classes.</li>
<li>Appears in power series reversion, functional iteration, and differential equations.</li>
<li>Used in Taylor expansion of composite functions and symbolic algebra systems.</li>
<li>Required for constructing exponential generating functions and series transformations.</li>
</ul>
</section>
<section id="a-gentle-proof-2" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-2">A Gentle Proof</h4>
<p>Using the formal definition: <span class="math display">\[
A(x)=\sum_{k=0}^\infty a_kx^k.
\]</span></p>
<p>Then substituting <span class="math inline">\(B(x)\)</span> gives <span class="math display">\[
A(B(x))=\sum_{k=0}^\infty a_k (B(x))^k.
\]</span></p>
<p>Since we only keep coefficients up to <span class="math inline">\(x^{n-1}\)</span>, higher-degree terms vanish modulo <span class="math inline">\(x^n\)</span>. Each <span class="math inline">\((B(x))^k\)</span> contributes terms of degree <span class="math inline">\(\ge k\)</span>, ensuring finite computation.</p>
</section>
<section id="try-it-yourself-94" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-94">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(A(B(x))\)</span> for <span class="math inline">\(A(x)=1+x+x^2\)</span>, <span class="math inline">\(B(x)=x+x^2\)</span>.</li>
<li>Compare against symbolic expansion.</li>
<li>Test <span class="math inline">\(A(x)=\exp(x)\)</span> and <span class="math inline">\(B(x)=\sin(x)\)</span> up to degree 6.</li>
<li>Implement truncated FFT-based composition for large <span class="math inline">\(n\)</span>.</li>
<li>Explore reversion: find <span class="math inline">\(B(x)\)</span> such that <span class="math inline">\(A(B(x))=x\)</span>.</li>
</ol>
</section>
<section id="test-cases-88" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-88">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(A(x)\)</span></th>
<th><span class="math inline">\(B(x)\)</span></th>
<th>Result up to <span class="math inline">\(x^4\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(1+x+x^2\)</span></td>
<td><span class="math inline">\(x+x^2\)</span></td>
<td><span class="math inline">\(1+x+2x^2+2x^3+x^4\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(1+2x\)</span></td>
<td><span class="math inline">\(x+x^2\)</span></td>
<td><span class="math inline">\(1+2x+2x^2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(1+x^2\)</span></td>
<td><span class="math inline">\(x+x^2\)</span></td>
<td><span class="math inline">\(1+x^2+2x^3+x^4\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-94" class="level4">
<h4 class="anchored" data-anchor-id="complexity-94">Complexity</h4>
<ul>
<li>Naive: <span class="math inline">\(O(n^2)\)</span></li>
<li>FFT-based: <span class="math inline">\(O(n\log n)\)</span> for each multiplication</li>
<li>Divide-and-conquer composition: <span class="math inline">\(O(n^{1.5})\)</span> with advanced algorithms</li>
</ul>
<p>Formal power series composition is where algebra meets structure, substituting one infinite series into another to build new functions, patterns, and generating laws.</p>
</section>
</section>
<section id="exponentiation-by-squaring" class="level3">
<h3 class="anchored" data-anchor-id="exponentiation-by-squaring">596 Exponentiation by Squaring</h3>
<p>Exponentiation by squaring is a fast method to compute powers efficiently. Instead of multiplying repeatedly, it halves the exponent at each step, a divide-and-conquer strategy that reduces the time from <span class="math inline">\(O(n)\)</span> to <span class="math inline">\(O(\log n)\)</span> multiplications.</p>
<p>It’s the workhorse behind modular exponentiation, fast matrix powers, and polynomial powering.</p>
<section id="what-problem-are-we-solving-95" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-95">What Problem Are We Solving?</h4>
<p>We want to compute <span class="math display">\[
a^n
\]</span> for integer (or polynomial, matrix) <span class="math inline">\(a\)</span> and nonnegative integer <span class="math inline">\(n\)</span>.</p>
<p>Naively we’d multiply <span class="math inline">\(a\)</span> by itself <span class="math inline">\(n\)</span> times, which is slow. Exponentiation by squaring uses the binary expansion of <span class="math inline">\(n\)</span> to skip unnecessary multiplications.</p>
</section>
<section id="key-idea-1" class="level4">
<h4 class="anchored" data-anchor-id="key-idea-1">Key Idea</h4>
<p>Use these rules:</p>
<p><span class="math display">\[
a^n =
\begin{cases}
1, &amp; n = 0, \\[6pt]
\left(a^{\,n/2}\right)^2, &amp; n \text{ even}, \\[6pt]
a \cdot \left(a^{\,(n-1)/2}\right)^2, &amp; n \text{ odd}.
\end{cases}
\]</span></p>
<p>Each step halves <span class="math inline">\(n\)</span>, so only <span class="math inline">\(\log_2 n\)</span> levels of recursion are needed.</p>
</section>
<section id="example-42" class="level4">
<h4 class="anchored" data-anchor-id="example-42">Example</h4>
<p>Compute <span class="math inline">\(a^9\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>Expression</th>
<th>Simplified</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(a^9\)</span></td>
<td><span class="math inline">\(a\cdot(a^4)^2\)</span></td>
<td>uses odd rule</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a^4\)</span></td>
<td><span class="math inline">\((a^2)^2\)</span></td>
<td>uses even rule</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(a^2\)</span></td>
<td><span class="math inline">\((a^1)^2\)</span></td>
<td>base recursion</td>
</tr>
<tr class="even">
<td><span class="math inline">\(a^1\)</span></td>
<td><span class="math inline">\(a\)</span></td>
<td>base case</td>
</tr>
</tbody>
</table>
<p>Total: 4 multiplications instead of 8.</p>
</section>
<section id="tiny-code-16" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-16">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> power(a, n):</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>        half <span class="op">=</span> power(a, n <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> half <span class="op">*</span> half</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>        half <span class="op">=</span> power(a, (n <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a <span class="op">*</span> half <span class="op">*</span> half</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(power(<span class="dv">3</span>, <span class="dv">9</span>))  <span class="co"># 19683</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb199"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> power<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> half <span class="op">=</span> power<span class="op">(</span>a<span class="op">,</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> half <span class="op">*</span> half<span class="op">;</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> half <span class="op">=</span> power<span class="op">(</span>a<span class="op">,</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a <span class="op">*</span> half <span class="op">*</span> half<span class="op">;</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> power<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">9</span><span class="op">));</span> <span class="co">// 19683</span></span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Modular version (Python)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modpow(a, n, m):</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> n <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> n <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> (res <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (a <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>        n <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modpow(<span class="dv">3</span>, <span class="dv">200</span>, <span class="dv">1000000007</span>))  <span class="co"># fast</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-95" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-95">Why It Matters</h4>
<ul>
<li>Used in modular arithmetic, cryptography, RSA, and discrete exponentiation.</li>
<li>Essential for matrix exponentiation in dynamic programming and Fibonacci computation.</li>
<li>Basis for polynomial powering, fast doubling, and fast modular inverse routines.</li>
</ul>
</section>
<section id="a-gentle-proof-3" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-3">A Gentle Proof</h4>
<p>Each step halves the exponent, maintaining equivalence:</p>
<p>For even <span class="math inline">\(n\)</span>: <span class="math display">\[
a^n=(a^{n/2})^2.
\]</span> For odd <span class="math inline">\(n\)</span>: <span class="math display">\[
a^n=a\cdot(a^{(n-1)/2})^2.
\]</span> Since each recursion uses <span class="math inline">\(n/2\)</span>, total calls are <span class="math inline">\(O(\log n)\)</span>.</p>
</section>
<section id="try-it-yourself-95" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-95">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(2^{31}\)</span> manually using repeated squaring.</li>
<li>Compare multiplication counts with naive <span class="math inline">\(O(n)\)</span> method.</li>
<li>Modify algorithm to work on <span class="math inline">\(2\times2\)</span> matrices.</li>
<li>Extend to polynomials using convolution for multiplication.</li>
<li>Implement an iterative version and benchmark both.</li>
</ol>
</section>
<section id="test-cases-89" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-89">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Base <span class="math inline">\(a\)</span></th>
<th>Exponent <span class="math inline">\(n\)</span></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(3\)</span></td>
<td><span class="math inline">\(9\)</span></td>
<td><span class="math inline">\(19683\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2\)</span></td>
<td><span class="math inline">\(10\)</span></td>
<td><span class="math inline">\(1024\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(5\)</span></td>
<td><span class="math inline">\(0\)</span></td>
<td><span class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(7\)</span></td>
<td><span class="math inline">\(13\)</span></td>
<td><span class="math inline">\(96889010407\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-95" class="level4">
<h4 class="anchored" data-anchor-id="complexity-95">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(\log n)\)</span> multiplications</li>
<li>Space: <span class="math inline">\(O(\log n)\)</span> (recursive) or <span class="math inline">\(O(1)\)</span> (iterative)</li>
</ul>
<p>Exponentiation by squaring is the quintessential divide-and-conquer power trick, a perfect blend of simplicity, speed, and mathematical elegance.</p>
</section>
</section>
<section id="modular-exponentiation-1" class="level3">
<h3 class="anchored" data-anchor-id="modular-exponentiation-1">597 Modular Exponentiation</h3>
<p>Modular exponentiation efficiently computes <span class="math display">\[
a^b \bmod m
\]</span> without overflowing intermediate results. It’s fundamental in cryptography, primality testing, and modular arithmetic systems such as RSA and Diffie–Hellman.</p>
<section id="what-problem-are-we-solving-96" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-96">What Problem Are We Solving?</h4>
<p>We want to compute <span class="math display">\[
r=(a^b)\bmod m,
\]</span> where <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(m\)</span> are integers and <span class="math inline">\(b\)</span> may be very large.</p>
<p>Directly computing <span class="math inline">\(a^b\)</span> is impractical because the intermediate result grows exponentially. We instead apply modular reduction at each multiplication step, using the rule:</p>
<p><span class="math display">\[
(xy)\bmod m=((x\bmod m)(y\bmod m))\bmod m.
\]</span></p>
</section>
<section id="key-idea-2" class="level4">
<h4 class="anchored" data-anchor-id="key-idea-2">Key Idea</h4>
<p>Combine modular arithmetic with exponentiation by squaring:</p>
<p><span class="math display">\[
a^b \bmod m =
\begin{cases}
1, &amp; b = 0, \\[6pt]
\left((a^{\,b/2} \bmod m)^2\right) \bmod m, &amp; b \text{ even}, \\[6pt]
\left(a \times (a^{\,(b-1)/2} \bmod m)^2\right) \bmod m, &amp; b \text{ odd}.
\end{cases}
\]</span></p>
<p>Each step reduces both <span class="math inline">\(b\)</span> and intermediate values modulo <span class="math inline">\(m\)</span>.</p>
</section>
<section id="example-43" class="level4">
<h4 class="anchored" data-anchor-id="example-43">Example</h4>
<p>Compute <span class="math inline">\(3^{13}\bmod 17\)</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 73%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th><span class="math inline">\(b\)</span></th>
<th>Operation</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>13</td>
<td>odd</td>
<td><span class="math inline">\(res=3\)</span></td>
<td><span class="math inline">\(res=3\)</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>even</td>
<td>square <span class="math inline">\(3\to9\)</span></td>
<td><span class="math inline">\(a=9\)</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>odd</td>
<td><span class="math inline">\(res=res*a=3*9=27\Rightarrow27\bmod17=10\)</span></td>
<td><span class="math inline">\(res=10\)</span></td>
</tr>
<tr class="even">
<td>1</td>
<td>odd</td>
<td><span class="math inline">\(res=res*a=10*13=130\Rightarrow130\bmod17=11\)</span></td>
<td>Final</td>
</tr>
</tbody>
</table>
<p>Result: <span class="math inline">\(3^{13}\bmod17=11\)</span></p>
</section>
<section id="tiny-code-17" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-17">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modexp(a, b, m):</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> b <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> b <span class="op">&amp;</span> <span class="dv">1</span>:</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> (res <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> (a <span class="op">*</span> a) <span class="op">%</span> m</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>        b <span class="op">&gt;&gt;=</span> <span class="dv">1</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modexp(<span class="dv">3</span>, <span class="dv">13</span>, <span class="dv">17</span>))  <span class="co"># 11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb202"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> modexp<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m<span class="op">;</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>            res <span class="op">=</span> <span class="op">(</span>res <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="op">(</span>a <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>        b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> modexp<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">17</span><span class="op">));</span> <span class="co">// 11</span></span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-96" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-96">Why It Matters</h4>
<ul>
<li>Core of RSA encryption/decryption, Diffie–Hellman key exchange, and ElGamal systems.</li>
<li>Essential in modular inverses, hashing, and primitive root computations.</li>
<li>Enables large computations like <span class="math inline">\(a^{10^{18}}\bmod m\)</span> to run in microseconds.</li>
<li>Used in Fermat, Miller–Rabin, and Carmichael tests for primality.</li>
</ul>
</section>
<section id="a-gentle-proof-4" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-4">A Gentle Proof</h4>
<p>For any modulus <span class="math inline">\(m\)</span>, <span class="math display">\[
(a\times b)\bmod m=((a\bmod m)(b\bmod m))\bmod m.
\]</span> This property lets us reduce after every multiplication.</p>
<p>Using binary exponentiation, <span class="math display">\[
a^b=\prod_{i=0}^{k-1} a^{2^i\cdot d_i},
\]</span> where <span class="math inline">\(b=\sum_i d_i2^i\)</span>. We only multiply terms where <span class="math inline">\(d_i=1\)</span>, keeping everything modulo <span class="math inline">\(m\)</span> to stay bounded.</p>
</section>
<section id="try-it-yourself-96" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-96">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(5^{117}\bmod19\)</span>.</li>
<li>Compare against built-in <code>pow(5, 117, 19)</code> in Python.</li>
<li>Modify to handle <span class="math inline">\(b&lt;0\)</span> using modular inverses.</li>
<li>Extend to matrices modulo <span class="math inline">\(m\)</span>.</li>
<li>Prove that <span class="math inline">\(a^{p-1}\bmod p=1\)</span> for prime <span class="math inline">\(p\)</span> (Fermat’s Little Theorem).</li>
</ol>
</section>
<section id="test-cases-90" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-90">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(a\)</span></th>
<th><span class="math inline">\(b\)</span></th>
<th><span class="math inline">\(m\)</span></th>
<th><span class="math inline">\(a^b\bmod m\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>13</td>
<td>17</td>
<td>11</td>
</tr>
<tr class="even">
<td>2</td>
<td>10</td>
<td>1000</td>
<td>24</td>
</tr>
<tr class="odd">
<td>7</td>
<td>256</td>
<td>13</td>
<td>9</td>
</tr>
<tr class="even">
<td>5</td>
<td>117</td>
<td>19</td>
<td>1</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-96" class="level4">
<h4 class="anchored" data-anchor-id="complexity-96">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(\log b)\)</span> multiplications</li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
</ul>
<p>Modular exponentiation is one of the most elegant and essential routines in computational number theory, small, exact, and powerful enough to secure the internet.</p>
</section>
</section>
<section id="fast-walshhadamard-transform-fwht" class="level3">
<h3 class="anchored" data-anchor-id="fast-walshhadamard-transform-fwht">598 Fast Walsh–Hadamard Transform (FWHT)</h3>
<p>The Fast Walsh–Hadamard Transform (FWHT) is a divide-and-conquer algorithm for computing pairwise XOR-based convolutions efficiently. It is the discrete analog of the Fast Fourier Transform, but instead of multiplication under addition, it works under the bitwise XOR operation.</p>
<section id="what-problem-are-we-solving-97" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-97">What Problem Are We Solving?</h4>
<p>Given two sequences <span class="math display">\[
A=(a_0,a_1,\dots,a_{n-1}), \quad B=(b_0,b_1,\dots,b_{n-1}),
\]</span> we want their XOR convolution defined as</p>
<p><span class="math display">\[
C[k]=\sum_{i\oplus j=k}a_i b_j,
\]</span> where <span class="math inline">\(\oplus\)</span> is the bitwise XOR.</p>
<p>Naively, this requires <span class="math inline">\(O(n^2)\)</span> work. FWHT reduces it to <span class="math inline">\(O(n\log n)\)</span>.</p>
</section>
<section id="key-idea-3" class="level4">
<h4 class="anchored" data-anchor-id="key-idea-3">Key Idea</h4>
<p>The Walsh–Hadamard Transform (WHT) maps a vector to its XOR-domain form. We can compute XOR convolutions by transforming both sequences, multiplying pointwise, and then inverting the transform.</p>
<p>Let <span class="math inline">\(\text{FWT}\)</span> denote the transform. Then</p>
<p><span class="math display">\[
C=\text{FWT}^{-1}(\text{FWT}(A)\circ\text{FWT}(B)),
\]</span> where <span class="math inline">\(\circ\)</span> is element-wise multiplication.</p>
</section>
<section id="transform-definition" class="level4">
<h4 class="anchored" data-anchor-id="transform-definition">Transform Definition</h4>
<p>For <span class="math inline">\(n=2^k\)</span>, define the fast Walsh–Hadamard transform (FWT) recursively.</p>
<p>Base case: <span class="math display">\[
\text{FWT}([a_0]) = [a_0].
\]</span></p>
<p>Recursive step: split <span class="math inline">\(A\)</span> into <span class="math inline">\(A_1\)</span> (first half) and <span class="math inline">\(A_2\)</span> (second half). After computing <span class="math inline">\(\text{FWT}(A_1)\)</span> and <span class="math inline">\(\text{FWT}(A_2)\)</span>, combine as <span class="math display">\[
\forall\, i=0,\dots,\tfrac{n}{2}-1:\quad
A'[i] = A_1[i] + A_2[i],\qquad
A'[i+\tfrac{n}{2}] = A_1[i] - A_2[i].
\]</span></p>
<p>Inverse transform: <span class="math display">\[
\text{IFWT}(A') = \frac{1}{n}\,\text{FWT}(A').
\]</span></p>
</section>
<section id="example-44" class="level4">
<h4 class="anchored" data-anchor-id="example-44">Example</h4>
<p>Let <span class="math inline">\(A=[1,2,3,4]\)</span>. Split into <span class="math inline">\(A_1=[1,2]\)</span> and <span class="math inline">\(A_2=[3,4]\)</span>, then combine <span class="math display">\[
[\,1+3,\ 2+4,\ 1-3,\ 2-4\,] = [\,4,6,-2,-2\,].
\]</span> For longer vectors, apply the same split–recurse–combine pattern until length <span class="math inline">\(1\)</span>.</p>
</section>
<section id="tiny-code-18" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-18">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fwht(a, inverse<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> h <span class="op">&lt;</span> n:</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, h <span class="op">*</span> <span class="dv">2</span>):</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(h):</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> a[i <span class="op">+</span> j]</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span> a[i <span class="op">+</span> j <span class="op">+</span> h]</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>                a[i <span class="op">+</span> j] <span class="op">=</span> x <span class="op">+</span> y</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>                a[i <span class="op">+</span> j <span class="op">+</span> h] <span class="op">=</span> x <span class="op">-</span> y</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>        h <span class="op">*=</span> <span class="dv">2</span></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> inverse:</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>            a[i] <span class="op">//=</span> n</span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> xor_convolution(a, b):</span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> n <span class="op">&lt;</span> <span class="bu">max</span>(<span class="bu">len</span>(a), <span class="bu">len</span>(b)):</span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a>        n <span class="op">*=</span> <span class="dv">2</span></span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> a <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">-</span> <span class="bu">len</span>(a))</span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> b <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">-</span> <span class="bu">len</span>(b))</span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> fwht(a[:])</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> fwht(b[:])</span>
<span id="cb203-25"><a href="#cb203-25" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [A[i] <span class="op">*</span> B[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb203-26"><a href="#cb203-26" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> fwht(C, inverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb203-27"><a href="#cb203-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C</span>
<span id="cb203-28"><a href="#cb203-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-29"><a href="#cb203-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(xor_convolution([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>],[<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-97" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-97">Why It Matters</h4>
<ul>
<li>XOR convolution appears in subset transforms, bitmask dynamic programming, and Boolean algebra problems.</li>
<li>Used in signal processing, error-correcting codes, and polynomial transforms over GF(2).</li>
<li>Key to fast computations on hypercubes and bitwise domains.</li>
</ul>
</section>
<section id="a-gentle-proof-5" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-5">A Gentle Proof</h4>
<p>Each level of recursion computes pairwise sums and differences — a linear transformation using the Hadamard matrix <span class="math inline">\(H_n\)</span>:</p>
<p><span class="math display">\[
H_n=
\begin{bmatrix}
H_{n/2} &amp; H_{n/2}\
H_{n/2} &amp; -H_{n/2}
\end{bmatrix}.
\]</span></p>
<p>Since <span class="math inline">\(H_nH_n^T=nI\)</span>, its inverse is <span class="math inline">\(\frac{1}{n}H_n^T\)</span>, giving correctness and invertibility.</p>
</section>
<section id="try-it-yourself-97" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-97">Try It Yourself</h4>
<ol type="1">
<li>Compute the FWHT of <span class="math inline">\([1,1,0,0]\)</span>.</li>
<li>Perform XOR convolution of <span class="math inline">\([1,2,3,4]\)</span> and <span class="math inline">\([4,3,2,1]\)</span>.</li>
<li>Modify to handle floating-point or modular arithmetic.</li>
<li>Implement inverse transform explicitly and verify recovery.</li>
<li>Compare timing with naive <span class="math inline">\(O(n^2)\)</span> approach.</li>
</ol>
</section>
<section id="test-cases-91" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-91">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input A</th>
<th>Input B</th>
<th>XOR Convolution Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2]</td>
<td>[3,4]</td>
<td>[10, -2]</td>
</tr>
<tr class="even">
<td>[1,1,0,0]</td>
<td>[0,1,1,0]</td>
<td>[2,0,0,2]</td>
</tr>
<tr class="odd">
<td>[1,2,3,4]</td>
<td>[4,3,2,1]</td>
<td>[20, 0, 0, 0]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-97" class="level4">
<h4 class="anchored" data-anchor-id="complexity-97">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The Fast Walsh–Hadamard Transform is the XOR-world twin of FFT, smaller, sharper, and just as elegant.</p>
</section>
</section>
<section id="fast-walshhadamard-transform-fwht-1" class="level3">
<h3 class="anchored" data-anchor-id="fast-walshhadamard-transform-fwht-1">598 Fast Walsh–Hadamard Transform (FWHT)</h3>
<p>The Fast Walsh–Hadamard Transform (FWHT) is a divide-and-conquer algorithm for computing pairwise XOR-based convolutions efficiently. It is the discrete analog of the Fast Fourier Transform, but instead of multiplication under addition, it works under the bitwise XOR operation.</p>
<section id="what-problem-are-we-solving-98" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-98">What Problem Are We Solving?</h4>
<p>Given two sequences <span class="math display">\[
A=(a_0,a_1,\dots,a_{n-1}), \quad B=(b_0,b_1,\dots,b_{n-1}),
\]</span> we want their XOR convolution defined as</p>
<p><span class="math display">\[
C[k]=\sum_{i\oplus j=k}a_i b_j,
\]</span> where <span class="math inline">\(\oplus\)</span> is the bitwise XOR.</p>
<p>Naively, this requires <span class="math inline">\(O(n^2)\)</span> work. FWHT reduces it to <span class="math inline">\(O(n\log n)\)</span>.</p>
</section>
<section id="key-idea-4" class="level4">
<h4 class="anchored" data-anchor-id="key-idea-4">Key Idea</h4>
<p>The Walsh–Hadamard Transform (WHT) maps a vector to its XOR-domain form. We can compute XOR convolutions by transforming both sequences, multiplying pointwise, and then inverting the transform.</p>
<p>Let <span class="math inline">\(\text{FWT}\)</span> denote the transform. Then</p>
<p><span class="math display">\[
C=\text{FWT}^{-1}(\text{FWT}(A)\circ\text{FWT}(B)),
\]</span> where <span class="math inline">\(\circ\)</span> is element-wise multiplication.</p>
</section>
<section id="transform-definition-1" class="level4">
<h4 class="anchored" data-anchor-id="transform-definition-1">Transform Definition</h4>
<p>For <span class="math inline">\(n = 2^k\)</span>, recursively define:</p>
<p><span class="math display">\[
\text{FWT}(A) =
\begin{cases}
[a_0], &amp; n = 1, \\[6pt]
\text{combine } \text{FWT}(A_1) \text{ and } \text{FWT}(A_2)
&amp; \text{for } n &gt; 1.
\end{cases}
\]</span></p>
<p>The combination step: <span class="math display">\[
A'[i] = A_1[i] + A_2[i], \qquad
A'[i + n/2] = A_1[i] - A_2[i],
\quad i = 0, \dots, n/2 - 1.
\]</span></p>
<p>To invert, divide all results by <span class="math inline">\(n\)</span> after applying the same process.</p>
</section>
<section id="example-45" class="level4">
<h4 class="anchored" data-anchor-id="example-45">Example</h4>
<p>Let <span class="math inline">\(A = [1, 2, 3, 4]\)</span>.</p>
<ol type="1">
<li><p>Split into <span class="math inline">\([1, 2]\)</span> and <span class="math inline">\([3, 4]\)</span><br>
Combine: <span class="math display">\[
[1 + 3,\ 2 + 4,\ 1 - 3,\ 2 - 4] = [4, 6, -2, -2].
\]</span></p></li>
<li><p>Apply recursively for longer vectors.</p></li>
</ol>
</section>
<section id="tiny-code-19" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-19">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fwht(a, inverse<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(a)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> h <span class="op">&lt;</span> n:</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, h <span class="op">*</span> <span class="dv">2</span>):</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(h):</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>                x <span class="op">=</span> a[i <span class="op">+</span> j]</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span> a[i <span class="op">+</span> j <span class="op">+</span> h]</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>                a[i <span class="op">+</span> j] <span class="op">=</span> x <span class="op">+</span> y</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>                a[i <span class="op">+</span> j <span class="op">+</span> h] <span class="op">=</span> x <span class="op">-</span> y</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>        h <span class="op">*=</span> <span class="dv">2</span></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> inverse:</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>            a[i] <span class="op">//=</span> n</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> xor_convolution(a, b):</span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> n <span class="op">&lt;</span> <span class="bu">max</span>(<span class="bu">len</span>(a), <span class="bu">len</span>(b)):</span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>        n <span class="op">*=</span> <span class="dv">2</span></span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> a <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">-</span> <span class="bu">len</span>(a))</span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> b <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">-</span> <span class="bu">len</span>(b))</span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> fwht(a[:])</span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> fwht(b[:])</span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [A[i] <span class="op">*</span> B[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)]</span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> fwht(C, inverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C</span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(xor_convolution([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>],[<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-98" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-98">Why It Matters</h4>
<ul>
<li>XOR convolution appears in subset transforms, bitmask dynamic programming, and Boolean algebra problems.</li>
<li>Used in signal processing, error-correcting codes, and polynomial transforms over GF(2).</li>
<li>Key to fast computations on hypercubes and bitwise domains.</li>
</ul>
</section>
<section id="a-gentle-proof-6" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-6">A Gentle Proof</h4>
<p>Each level of recursion computes pairwise sums and differences — a linear transformation using the Hadamard matrix <span class="math inline">\(H_n\)</span>:</p>
<p><span class="math display">\[
H_n=
\begin{bmatrix}
H_{n/2} &amp; H_{n/2}\
H_{n/2} &amp; -H_{n/2}
\end{bmatrix}.
\]</span></p>
<p>Since <span class="math inline">\(H_nH_n^T=nI\)</span>, its inverse is <span class="math inline">\(\frac{1}{n}H_n^T\)</span>, giving correctness and invertibility.</p>
</section>
<section id="try-it-yourself-98" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-98">Try It Yourself</h4>
<ol type="1">
<li>Compute the FWHT of <span class="math inline">\([1,1,0,0]\)</span>.</li>
<li>Perform XOR convolution of <span class="math inline">\([1,2,3,4]\)</span> and <span class="math inline">\([4,3,2,1]\)</span>.</li>
<li>Modify to handle floating-point or modular arithmetic.</li>
<li>Implement inverse transform explicitly and verify recovery.</li>
<li>Compare timing with naive <span class="math inline">\(O(n^2)\)</span> approach.</li>
</ol>
</section>
<section id="test-cases-92" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-92">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Input A</th>
<th>Input B</th>
<th>XOR Convolution Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2]</td>
<td>[3,4]</td>
<td>[10, -2]</td>
</tr>
<tr class="even">
<td>[1,1,0,0]</td>
<td>[0,1,1,0]</td>
<td>[2,0,0,2]</td>
</tr>
<tr class="odd">
<td>[1,2,3,4]</td>
<td>[4,3,2,1]</td>
<td>[20, 0, 0, 0]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-98" class="level4">
<h4 class="anchored" data-anchor-id="complexity-98">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n\log n)\)</span></li>
<li>Space: <span class="math inline">\(O(n)\)</span></li>
</ul>
<p>The Fast Walsh–Hadamard Transform is the XOR-world twin of FFT, smaller, sharper, and just as elegant.</p>
</section>
</section>
<section id="zeta-transform" class="level3">
<h3 class="anchored" data-anchor-id="zeta-transform">599 Zeta Transform</h3>
<p>The Zeta Transform is a combinatorial transform that accumulates values over subsets or supersets. It is especially useful in subset dynamic programming (DP over bitmasks), inclusion–exclusion, and fast subset convolutions.</p>
<section id="what-problem-are-we-solving-99" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-99">What Problem Are We Solving?</h4>
<p>Given a function <span class="math inline">\(f(S)\)</span> defined over subsets <span class="math inline">\(S\)</span> of a universe <span class="math inline">\(U\)</span> (size <span class="math inline">\(n\)</span>), the <em>Zeta Transform</em> produces a new function <span class="math inline">\(F(S)\)</span> that sums over all subsets (or supersets) of <span class="math inline">\(S\)</span>:</p>
<ul>
<li><p>Subset version <span class="math display">\[
F(S)=\sum_{T\subseteq S}f(T)
\]</span></p></li>
<li><p>Superset version <span class="math display">\[
F(S)=\sum_{T\supseteq S}f(T)
\]</span></p></li>
</ul>
<p>The transform runs in <span class="math inline">\(O(n2^n)\)</span> naively, but can be computed in <span class="math inline">\(O(n2^n)\)</span> efficiently using bit DP.</p>
</section>
<section id="key-idea-5" class="level4">
<h4 class="anchored" data-anchor-id="key-idea-5">Key Idea</h4>
<p>For subset zeta transform over bitmasks of size <span class="math inline">\(n\)</span>:</p>
<p>For each bit <span class="math inline">\(i\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(n-1\)</span>:</p>
<ul>
<li><p>For each mask <span class="math inline">\(m\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(2^n-1\)</span>:</p>
<ul>
<li>If bit <span class="math inline">\(i\)</span> is set in <span class="math inline">\(m\)</span>, then add <span class="math inline">\(f[m\text{ without bit }i]\)</span> to <span class="math inline">\(f[m]\)</span>.</li>
</ul></li>
</ul>
<p>In code: <span class="math display">\[
f[m]+=f[m\setminus{i}].
\]</span></p>
<p>This efficiently accumulates all contributions of subsets.</p>
</section>
<section id="example-46" class="level4">
<h4 class="anchored" data-anchor-id="example-46">Example</h4>
<p>Let <span class="math inline">\(f\)</span> over 3-bit subsets be:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Mask</th>
<th>Subset</th>
<th><span class="math inline">\(f(S)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>000</td>
<td>∅</td>
<td>1</td>
</tr>
<tr class="even">
<td>001</td>
<td>{0}</td>
<td>2</td>
</tr>
<tr class="odd">
<td>010</td>
<td>{1}</td>
<td>3</td>
</tr>
<tr class="even">
<td>011</td>
<td>{0,1}</td>
<td>4</td>
</tr>
<tr class="odd">
<td>100</td>
<td>{2}</td>
<td>5</td>
</tr>
<tr class="even">
<td>101</td>
<td>{0,2}</td>
<td>6</td>
</tr>
<tr class="odd">
<td>110</td>
<td>{1,2}</td>
<td>7</td>
</tr>
<tr class="even">
<td>111</td>
<td>{0,1,2}</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>After subset zeta transform, <span class="math inline">\(F(S)=\sum_{T\subseteq S}f(T)\)</span>.</p>
<p>For <span class="math inline">\(S={0,1}\)</span> (mask 011): <span class="math display">\[
F(011)=f(000)+f(001)+f(010)+f(011)=1+2+3+4=10.
\]</span></p>
</section>
<section id="tiny-code-20" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-20">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> subset_zeta_transform(f):</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(f).bit_length() <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> f[:]</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mask <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span> <span class="op">&lt;&lt;</span> n):</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mask <span class="op">&amp;</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> i):</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>                F[mask] <span class="op">+=</span> F[mask <span class="op">^</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> i)]</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> F</span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: f for subsets of size 3</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>]</span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(subset_zeta_transform(f))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb206"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> subset_zeta_transform<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>f<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> mask <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> mask <span class="op">&lt;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> n<span class="op">);</span> mask<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">))</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>                f<span class="op">[</span>mask<span class="op">]</span> <span class="op">+=</span> f<span class="op">[</span>mask <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">)];</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f<span class="op">[</span><span class="dv">8</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">8</span><span class="op">};</span></span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>    subset_zeta_transform<span class="op">(</span>f<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">8</span><span class="op">;</span> i<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> f<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-99" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-99">Why It Matters</h4>
<ul>
<li>Central in subset DP, SOS DP, and bitmask convolutions.</li>
<li>Used for fast inclusion–exclusion and Möbius inversion.</li>
<li>Appears in counting problems, graph subset enumeration, and Boolean function transforms.</li>
<li>Works hand-in-hand with the Möbius Transform to invert accumulated results.</li>
</ul>
</section>
<section id="a-gentle-proof-7" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-7">A Gentle Proof</h4>
<p>Each iteration over bit <span class="math inline">\(i\)</span> ensures every subset without bit <span class="math inline">\(i\)</span> contributes to the superset with bit <span class="math inline">\(i\)</span>. By induction, all subsets <span class="math inline">\(T\subseteq S\)</span> accumulate into <span class="math inline">\(F(S)\)</span>.</p>
</section>
<section id="try-it-yourself-99" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-99">Try It Yourself</h4>
<ol type="1">
<li>Compute Zeta transform manually for <span class="math inline">\(n=3\)</span>.</li>
<li>Verify inversion using Möbius inversion (next section).</li>
<li>Modify code for superset version (flip the condition).</li>
<li>Implement modulo arithmetic (e.g., <span class="math inline">\(\bmod 10^9+7\)</span>).</li>
<li>Use it to compute number of subsets with a given property.</li>
</ol>
</section>
<section id="test-cases-93" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-93">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(f(S)\)</span></th>
<th>Subset</th>
<th><span class="math inline">\(F(S)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,2,3,4]</td>
<td>2 bits</td>
<td>[1,3,4,10]</td>
</tr>
<tr class="even">
<td>[0,1,1,0,1,0,0,0]</td>
<td>3 bits</td>
<td>[0,1,1,2,1,2,2,4]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-99" class="level4">
<h4 class="anchored" data-anchor-id="complexity-99">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n2^n)\)</span></li>
<li>Space: <span class="math inline">\(O(2^n)\)</span></li>
</ul>
<p>The Zeta Transform is the summation heart of subset DP, a way to see all parts of a set at once, elegantly and efficiently.</p>
</section>
</section>
<section id="möbius-inversion" class="level3">
<h3 class="anchored" data-anchor-id="möbius-inversion">600 Möbius Inversion</h3>
<p>The Möbius Inversion is the mathematical inverse of the Zeta Transform. It allows us to recover a function <span class="math inline">\(f(S)\)</span> from its accumulated form <span class="math inline">\(F(S)\)</span> where <span class="math display">\[F(S)=\sum_{T\subseteq S}f(T).\]</span> It is a cornerstone in combinatorics, number theory, and subset dynamic programming.</p>
<section id="what-problem-are-we-solving-100" class="level4">
<h4 class="anchored" data-anchor-id="what-problem-are-we-solving-100">What Problem Are We Solving?</h4>
<p>Suppose we know <span class="math inline">\(F(S)\)</span>, the total contribution from all subsets <span class="math inline">\(T\subseteq S\)</span>. We want to invert this accumulation and get back the original <span class="math inline">\(f(S)\)</span>.</p>
<p>The inversion formula is:</p>
<p><span class="math display">\[
f(S)=\sum_{T\subseteq S}(-1)^{|S\setminus T|}F(T).
\]</span></p>
<p>This is the combinatorial analog of differentiation for sums over subsets.</p>
</section>
<section id="key-idea-6" class="level4">
<h4 class="anchored" data-anchor-id="key-idea-6">Key Idea</h4>
<p>Möbius inversion reverses the cumulative effect of the subset Zeta transform. In iterative (bitwise) form, we can perform it efficiently by “subtracting contributions” instead of adding them.</p>
<p>For each bit <span class="math inline">\(i\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(n-1\)</span>:</p>
<p>If bit <span class="math inline">\(i\)</span> is set in <span class="math inline">\(S\)</span>, subtract <span class="math inline">\(f[S\setminus{i}]\)</span> from <span class="math inline">\(f[S]\)</span>:</p>
<p><span class="math display">\[
f[S]-=f[S\setminus{i}].
\]</span></p>
<p>This undoes the inclusion steps done in the Zeta transform.</p>
</section>
<section id="example-47" class="level4">
<h4 class="anchored" data-anchor-id="example-47">Example</h4>
<p>Let’s start from <span class="math display">\[
F(S)=\sum_{T\subseteq S}f(T)
\]</span> and we know:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Mask</th>
<th>Subset</th>
<th><span class="math inline">\(F(S)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>00</td>
<td>∅</td>
<td>1</td>
</tr>
<tr class="even">
<td>01</td>
<td>{0}</td>
<td>3</td>
</tr>
<tr class="odd">
<td>10</td>
<td>{1}</td>
<td>4</td>
</tr>
<tr class="even">
<td>11</td>
<td>{0,1}</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>We apply Möbius inversion:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 62%">
<col style="width: 20%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Subset</th>
<th>Computation</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>∅</td>
<td>,</td>
<td><span class="math inline">\(f(∅)=F(∅)=1\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>{0}</td>
<td><span class="math inline">\(f(01)=F(01)-F(00)=3-1\)</span></td>
<td>2</td>
<td></td>
</tr>
<tr class="odd">
<td>{1}</td>
<td><span class="math inline">\(f(10)=F(10)-F(00)=4-1\)</span></td>
<td>3</td>
<td></td>
</tr>
<tr class="even">
<td>{0,1}</td>
<td><span class="math inline">\(f(11)=F(11)-F(01)-F(10)+F(00)=10-3-4+1\)</span></td>
<td>4</td>
<td></td>
</tr>
</tbody>
</table>
<p>So we recovered <span class="math inline">\(f=[1,2,3,4]\)</span>.</p>
</section>
<section id="tiny-code-21" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-21">Tiny Code</h4>
<p>Python</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mobius_inversion(F):</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(F).bit_length() <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> F[:]</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mask <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span> <span class="op">&lt;&lt;</span> n):</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mask <span class="op">&amp;</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> i):</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>                f[mask] <span class="op">-=</span> f[mask <span class="op">^</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> i)]</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>F <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">10</span>]</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mobius_inversion(F))  <span class="co"># [1,2,3,4]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>C</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb208"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> mobius_inversion<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>F<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> mask <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> mask <span class="op">&lt;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> n<span class="op">);</span> mask<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">))</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>                F<span class="op">[</span>mask<span class="op">]</span> <span class="op">-=</span> F<span class="op">[</span>mask <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">)];</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> F<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">10</span><span class="op">};</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>    mobius_inversion<span class="op">(</span>F<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i<span class="op">++)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> F<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-100" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-100">Why It Matters</h4>
<ul>
<li>The backbone of inclusion–exclusion principle and subset DPs.</li>
<li>Used in number-theoretic inversions such as the classic integer Möbius function μ(n).</li>
<li>Pairs perfectly with Zeta transform to toggle between cumulative and pointwise representations.</li>
<li>Appears in fast subset convolution, polynomial transforms, and combinatorial counting.</li>
</ul>
</section>
<section id="a-gentle-proof-8" class="level4">
<h4 class="anchored" data-anchor-id="a-gentle-proof-8">A Gentle Proof</h4>
<p>From <span class="math display">\[
F(S)=\sum_{T\subseteq S}f(T),
\]</span> we can see the system as a triangular matrix with <span class="math inline">\(1\)</span>s for <span class="math inline">\(T\subseteq S\)</span>. Its inverse has entries <span class="math inline">\((-1)^{|S\setminus T|}\)</span> for <span class="math inline">\(T\subseteq S\)</span>, giving</p>
<p><span class="math display">\[
f(S)=\sum_{T\subseteq S}(-1)^{|S\setminus T|}F(T).
\]</span></p>
<p>Thus Möbius inversion exactly cancels the overcounting in the Zeta transform.</p>
</section>
<section id="try-it-yourself-100" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-100">Try It Yourself</h4>
<ol type="1">
<li>Start with <span class="math inline">\(f=[1,2,3,4]\)</span> and compute its <span class="math inline">\(F\)</span> using the Zeta transform.</li>
<li>Apply Möbius inversion to get <span class="math inline">\(f\)</span> back.</li>
<li>Extend to 3-bit subsets (<span class="math inline">\(n=3\)</span>).</li>
<li>Use it to compute inclusion–exclusion counts.</li>
<li>Modify to work modulo <span class="math inline">\(10^9+7\)</span>.</li>
</ol>
</section>
<section id="test-cases-94" class="level4">
<h4 class="anchored" data-anchor-id="test-cases-94">Test Cases</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(F(S)\)</span></th>
<th>Expected <span class="math inline">\(f(S)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1,3,4,10]</td>
<td>[1,2,3,4]</td>
</tr>
<tr class="even">
<td>[0,1,1,2]</td>
<td>[0,1,1,0]</td>
</tr>
<tr class="odd">
<td>[2,4,6,12,8,16,20,40]</td>
<td>[2,2,2,4,2,4,4,8]</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-100" class="level4">
<h4 class="anchored" data-anchor-id="complexity-100">Complexity</h4>
<ul>
<li>Time: <span class="math inline">\(O(n2^n)\)</span></li>
<li>Space: <span class="math inline">\(O(2^n)\)</span></li>
</ul>
<p>Möbius inversion closes the circle of combinatorial transforms, the mirror image of the Zeta transform, turning sums back into their sources.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../books/en-us/list-5.html" class="pagination-link" aria-label="Chapter 5. Dynamic Programming">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Chapter 5. Dynamic Programming</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../books/en-us/list-7.html" class="pagination-link" aria-label="Chapter 7. Strings and Text Algorithms">
        <span class="nav-page-text"><span class="chapter-title">Chapter 7. Strings and Text Algorithms</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>