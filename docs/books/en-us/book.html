<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The Book – The Little Book of Algorithms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../books/en-us/plan.html" rel="next">
<link href="../../index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../books/en-us/book.html"><span class="chapter-title">The Book</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">The Little Book of Algorithms</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Content</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/book.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">The Book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../books/en-us/plan.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">The Plan</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#chapter-1.-foundations-of-algorithms" id="toc-chapter-1.-foundations-of-algorithms" class="nav-link active" data-scroll-target="#chapter-1.-foundations-of-algorithms">Chapter 1. Foundations of algorithms</a>
  <ul class="collapse">
  <li><a href="#what-is-an-algorithm" id="toc-what-is-an-algorithm" class="nav-link" data-scroll-target="#what-is-an-algorithm">1. What Is an Algorithm?</a></li>
  <li><a href="#measuring-time-and-space" id="toc-measuring-time-and-space" class="nav-link" data-scroll-target="#measuring-time-and-space">2. Measuring Time and Space</a></li>
  <li><a href="#big-o-big-theta-big-omega" id="toc-big-o-big-theta-big-omega" class="nav-link" data-scroll-target="#big-o-big-theta-big-omega">3. Big-O, Big-Theta, Big-Omega</a></li>
  <li><a href="#algorithmic-paradigms-greedy-divide-and-conquer-dp" id="toc-algorithmic-paradigms-greedy-divide-and-conquer-dp" class="nav-link" data-scroll-target="#algorithmic-paradigms-greedy-divide-and-conquer-dp">4. Algorithmic Paradigms (Greedy, Divide and Conquer, DP)</a></li>
  <li><a href="#recurrence-relations" id="toc-recurrence-relations" class="nav-link" data-scroll-target="#recurrence-relations">5. Recurrence Relations</a></li>
  <li><a href="#searching-basics" id="toc-searching-basics" class="nav-link" data-scroll-target="#searching-basics">6. Searching Basics</a></li>
  <li><a href="#sorting-basics" id="toc-sorting-basics" class="nav-link" data-scroll-target="#sorting-basics">7. Sorting Basics</a></li>
  <li><a href="#data-structures-overview" id="toc-data-structures-overview" class="nav-link" data-scroll-target="#data-structures-overview">8. Data Structures Overview</a></li>
  <li><a href="#graphs-and-trees-overview" id="toc-graphs-and-trees-overview" class="nav-link" data-scroll-target="#graphs-and-trees-overview">9. Graphs and Trees Overview</a></li>
  <li><a href="#algorithm-design-patterns" id="toc-algorithm-design-patterns" class="nav-link" data-scroll-target="#algorithm-design-patterns">10. Algorithm Design Patterns</a></li>
  </ul></li>
  <li><a href="#chapter-2.-sorting-and-searching" id="toc-chapter-2.-sorting-and-searching" class="nav-link" data-scroll-target="#chapter-2.-sorting-and-searching">Chapter 2. Sorting and Searching</a>
  <ul class="collapse">
  <li><a href="#elementary-sorting-bubble-insertion-selection" id="toc-elementary-sorting-bubble-insertion-selection" class="nav-link" data-scroll-target="#elementary-sorting-bubble-insertion-selection">11. Elementary Sorting (Bubble, Insertion, Selection)</a></li>
  <li><a href="#divide-and-conquer-sorting-merge-quick-heap" id="toc-divide-and-conquer-sorting-merge-quick-heap" class="nav-link" data-scroll-target="#divide-and-conquer-sorting-merge-quick-heap">12. Divide-and-Conquer Sorting (Merge, Quick, Heap)</a></li>
  <li><a href="#counting-and-distribution-sorts-counting-radix-bucket" id="toc-counting-and-distribution-sorts-counting-radix-bucket" class="nav-link" data-scroll-target="#counting-and-distribution-sorts-counting-radix-bucket">13. Counting and Distribution Sorts (Counting, Radix, Bucket)</a></li>
  <li><a href="#hybrid-sorts-introsort-timsort" id="toc-hybrid-sorts-introsort-timsort" class="nav-link" data-scroll-target="#hybrid-sorts-introsort-timsort">14. Hybrid Sorts (IntroSort, Timsort)</a></li>
  <li><a href="#special-sorts-cycle-gnome-comb-pancake" id="toc-special-sorts-cycle-gnome-comb-pancake" class="nav-link" data-scroll-target="#special-sorts-cycle-gnome-comb-pancake">15. Special Sorts (Cycle, Gnome, Comb, Pancake)</a></li>
  <li><a href="#linear-and-binary-search" id="toc-linear-and-binary-search" class="nav-link" data-scroll-target="#linear-and-binary-search">16. Linear and Binary Search</a></li>
  <li><a href="#interpolation-and-exponential-search" id="toc-interpolation-and-exponential-search" class="nav-link" data-scroll-target="#interpolation-and-exponential-search">17. Interpolation and Exponential Search</a></li>
  <li><a href="#selection-algorithms-quickselect-median-of-medians" id="toc-selection-algorithms-quickselect-median-of-medians" class="nav-link" data-scroll-target="#selection-algorithms-quickselect-median-of-medians">18. Selection Algorithms (Quickselect, Median of Medians)</a></li>
  <li><a href="#range-searching-and-nearest-neighbor" id="toc-range-searching-and-nearest-neighbor" class="nav-link" data-scroll-target="#range-searching-and-nearest-neighbor">19. Range Searching and Nearest Neighbor</a></li>
  <li><a href="#search-optimizations-and-variants" id="toc-search-optimizations-and-variants" class="nav-link" data-scroll-target="#search-optimizations-and-variants">20. Search Optimizations and Variants</a></li>
  </ul></li>
  <li><a href="#chapter-3.-data-structures-in-actions" id="toc-chapter-3.-data-structures-in-actions" class="nav-link" data-scroll-target="#chapter-3.-data-structures-in-actions">Chapter 3. Data Structures in Actions</a>
  <ul class="collapse">
  <li><a href="#arrays-linked-lists-stacks-queues" id="toc-arrays-linked-lists-stacks-queues" class="nav-link" data-scroll-target="#arrays-linked-lists-stacks-queues">21. Arrays, Linked Lists, Stacks, Queues</a></li>
  <li><a href="#hash-tables-and-variants-cuckoo-robin-hood-consistent" id="toc-hash-tables-and-variants-cuckoo-robin-hood-consistent" class="nav-link" data-scroll-target="#hash-tables-and-variants-cuckoo-robin-hood-consistent">22. Hash Tables and Variants (Cuckoo, Robin Hood, Consistent)</a></li>
  <li><a href="#heaps-binary-fibonacci-pairing" id="toc-heaps-binary-fibonacci-pairing" class="nav-link" data-scroll-target="#heaps-binary-fibonacci-pairing">23. Heaps (Binary, Fibonacci, Pairing)</a></li>
  <li><a href="#balanced-trees-avl-red-black-splay-treap" id="toc-balanced-trees-avl-red-black-splay-treap" class="nav-link" data-scroll-target="#balanced-trees-avl-red-black-splay-treap">24. Balanced Trees (AVL, Red-Black, Splay, Treap)</a></li>
  <li><a href="#segment-trees-and-fenwick-trees" id="toc-segment-trees-and-fenwick-trees" class="nav-link" data-scroll-target="#segment-trees-and-fenwick-trees">25. Segment Trees and Fenwick Trees</a></li>
  <li><a href="#disjoint-set-union-union-find" id="toc-disjoint-set-union-union-find" class="nav-link" data-scroll-target="#disjoint-set-union-union-find">26. Disjoint Set Union (Union-Find)</a></li>
  <li><a href="#probabilistic-data-structures-bloom-count-min-hyperloglog" id="toc-probabilistic-data-structures-bloom-count-min-hyperloglog" class="nav-link" data-scroll-target="#probabilistic-data-structures-bloom-count-min-hyperloglog">27. Probabilistic Data Structures (Bloom, Count-Min, HyperLogLog)</a></li>
  <li><a href="#skip-lists-and-b-trees" id="toc-skip-lists-and-b-trees" class="nav-link" data-scroll-target="#skip-lists-and-b-trees">28. Skip Lists and B-Trees</a></li>
  <li><a href="#persistent-and-functional-data-structures" id="toc-persistent-and-functional-data-structures" class="nav-link" data-scroll-target="#persistent-and-functional-data-structures">29. Persistent and Functional Data Structures</a></li>
  <li><a href="#advanced-trees-and-range-queries" id="toc-advanced-trees-and-range-queries" class="nav-link" data-scroll-target="#advanced-trees-and-range-queries">30. Advanced Trees and Range Queries</a></li>
  </ul></li>
  <li><a href="#chapter-4.-graph-algorithms" id="toc-chapter-4.-graph-algorithms" class="nav-link" data-scroll-target="#chapter-4.-graph-algorithms">Chapter 4. Graph Algorithms</a>
  <ul class="collapse">
  <li><a href="#traversals-dfs-bfs-iterative-deepening" id="toc-traversals-dfs-bfs-iterative-deepening" class="nav-link" data-scroll-target="#traversals-dfs-bfs-iterative-deepening">31. Traversals (DFS, BFS, Iterative Deepening)</a></li>
  <li><a href="#strongly-connected-components-tarjan-kosaraju" id="toc-strongly-connected-components-tarjan-kosaraju" class="nav-link" data-scroll-target="#strongly-connected-components-tarjan-kosaraju">32. Strongly Connected Components (Tarjan, Kosaraju)</a></li>
  <li><a href="#shortest-paths-dijkstra-bellman-ford-a-johnson" id="toc-shortest-paths-dijkstra-bellman-ford-a-johnson" class="nav-link" data-scroll-target="#shortest-paths-dijkstra-bellman-ford-a-johnson">33. Shortest Paths (Dijkstra, Bellman-Ford, A*, Johnson)</a></li>
  <li><a href="#shortest-path-variants-0-1-bfs-bidirectional-heuristic-a" id="toc-shortest-path-variants-0-1-bfs-bidirectional-heuristic-a" class="nav-link" data-scroll-target="#shortest-path-variants-0-1-bfs-bidirectional-heuristic-a">34. Shortest Path Variants (0-1 BFS, Bidirectional, Heuristic A*)</a></li>
  <li><a href="#minimum-spanning-trees-kruskal-prim-borůvka" id="toc-minimum-spanning-trees-kruskal-prim-borůvka" class="nav-link" data-scroll-target="#minimum-spanning-trees-kruskal-prim-borůvka">35. Minimum Spanning Trees (Kruskal, Prim, Borůvka)</a></li>
  <li><a href="#flows-ford-fulkerson-edmonds-karp-dinic" id="toc-flows-ford-fulkerson-edmonds-karp-dinic" class="nav-link" data-scroll-target="#flows-ford-fulkerson-edmonds-karp-dinic">36. Flows (Ford-Fulkerson, Edmonds-Karp, Dinic)</a></li>
  <li><a href="#cuts-stoer-wagner-karger-gomory-hu" id="toc-cuts-stoer-wagner-karger-gomory-hu" class="nav-link" data-scroll-target="#cuts-stoer-wagner-karger-gomory-hu">37. Cuts (Stoer-Wagner, Karger, Gomory-Hu)</a></li>
  <li><a href="#matchings-hopcroft-karp-hungarian-blossom" id="toc-matchings-hopcroft-karp-hungarian-blossom" class="nav-link" data-scroll-target="#matchings-hopcroft-karp-hungarian-blossom">38. Matchings (Hopcroft-Karp, Hungarian, Blossom)</a></li>
  <li><a href="#tree-algorithms-lca-hld-centroid-decomposition" id="toc-tree-algorithms-lca-hld-centroid-decomposition" class="nav-link" data-scroll-target="#tree-algorithms-lca-hld-centroid-decomposition">39. Tree Algorithms (LCA, HLD, Centroid Decomposition)</a></li>
  <li><a href="#advanced-graph-algorithms-and-tricks" id="toc-advanced-graph-algorithms-and-tricks" class="nav-link" data-scroll-target="#advanced-graph-algorithms-and-tricks">40. Advanced Graph Algorithms and Tricks</a></li>
  </ul></li>
  <li><a href="#chapter-5.-dynamic-programming" id="toc-chapter-5.-dynamic-programming" class="nav-link" data-scroll-target="#chapter-5.-dynamic-programming">Chapter 5. Dynamic Programming</a>
  <ul class="collapse">
  <li><a href="#dp-basics-and-state-transitions" id="toc-dp-basics-and-state-transitions" class="nav-link" data-scroll-target="#dp-basics-and-state-transitions">41. DP Basics and State Transitions</a></li>
  <li><a href="#classic-problems-knapsack-subset-sum-coin-change" id="toc-classic-problems-knapsack-subset-sum-coin-change" class="nav-link" data-scroll-target="#classic-problems-knapsack-subset-sum-coin-change">42. Classic Problems (Knapsack, Subset Sum, Coin Change)</a></li>
  <li><a href="#sequence-problems-lis-lcs-edit-distance" id="toc-sequence-problems-lis-lcs-edit-distance" class="nav-link" data-scroll-target="#sequence-problems-lis-lcs-edit-distance">43. Sequence Problems (LIS, LCS, Edit Distance)</a></li>
  <li><a href="#matrix-and-chain-problems" id="toc-matrix-and-chain-problems" class="nav-link" data-scroll-target="#matrix-and-chain-problems">44. Matrix and Chain Problems</a></li>
  <li><a href="#bitmask-dp-and-traveling-salesman" id="toc-bitmask-dp-and-traveling-salesman" class="nav-link" data-scroll-target="#bitmask-dp-and-traveling-salesman">45. Bitmask DP and Traveling Salesman</a></li>
  <li><a href="#digit-dp-and-sos-dp" id="toc-digit-dp-and-sos-dp" class="nav-link" data-scroll-target="#digit-dp-and-sos-dp">46. Digit DP and SOS DP</a></li>
  <li><a href="#dp-optimizations-divide-conquer-convex-hull-trick-knuth" id="toc-dp-optimizations-divide-conquer-convex-hull-trick-knuth" class="nav-link" data-scroll-target="#dp-optimizations-divide-conquer-convex-hull-trick-knuth">47. DP Optimizations (Divide &amp; Conquer, Convex Hull Trick, Knuth)</a></li>
  <li><a href="#tree-dp-and-rerooting" id="toc-tree-dp-and-rerooting" class="nav-link" data-scroll-target="#tree-dp-and-rerooting">48. Tree DP and Rerooting</a></li>
  <li><a href="#dp-reconstruction-and-traceback" id="toc-dp-reconstruction-and-traceback" class="nav-link" data-scroll-target="#dp-reconstruction-and-traceback">49. DP Reconstruction and Traceback</a></li>
  <li><a href="#meta-dp-and-optimization-templates" id="toc-meta-dp-and-optimization-templates" class="nav-link" data-scroll-target="#meta-dp-and-optimization-templates">50. Meta-DP and Optimization Templates</a></li>
  </ul></li>
  <li><a href="#chapter-6.-strings-and-text-algorithms" id="toc-chapter-6.-strings-and-text-algorithms" class="nav-link" data-scroll-target="#chapter-6.-strings-and-text-algorithms">Chapter 6. Strings and Text Algorithms</a>
  <ul class="collapse">
  <li><a href="#number-theory-gcd-modular-arithmetic-crt" id="toc-number-theory-gcd-modular-arithmetic-crt" class="nav-link" data-scroll-target="#number-theory-gcd-modular-arithmetic-crt">51. Number Theory (GCD, Modular Arithmetic, CRT)</a></li>
  <li><a href="#primality-and-factorization-miller-rabin-pollard-rho" id="toc-primality-and-factorization-miller-rabin-pollard-rho" class="nav-link" data-scroll-target="#primality-and-factorization-miller-rabin-pollard-rho">52. Primality and Factorization (Miller-Rabin, Pollard Rho)</a></li>
  <li><a href="#combinatorics-permutations-combinations-subsets" id="toc-combinatorics-permutations-combinations-subsets" class="nav-link" data-scroll-target="#combinatorics-permutations-combinations-subsets">53. Combinatorics (Permutations, Combinations, Subsets)</a></li>
  <li><a href="#probability-and-randomized-algorithms" id="toc-probability-and-randomized-algorithms" class="nav-link" data-scroll-target="#probability-and-randomized-algorithms">54. Probability and Randomized Algorithms</a></li>
  <li><a href="#sieve-methods-and-modular-math" id="toc-sieve-methods-and-modular-math" class="nav-link" data-scroll-target="#sieve-methods-and-modular-math">55. Sieve Methods and Modular Math</a></li>
  <li><a href="#linear-algebra-gaussian-elimination-lu-svd" id="toc-linear-algebra-gaussian-elimination-lu-svd" class="nav-link" data-scroll-target="#linear-algebra-gaussian-elimination-lu-svd">56. Linear Algebra (Gaussian Elimination, LU, SVD)</a></li>
  <li><a href="#fft-and-ntt-fast-transforms" id="toc-fft-and-ntt-fast-transforms" class="nav-link" data-scroll-target="#fft-and-ntt-fast-transforms">57. FFT and NTT (Fast Transforms)</a></li>
  <li><a href="#numerical-methods-newton-simpson-runge-kutta" id="toc-numerical-methods-newton-simpson-runge-kutta" class="nav-link" data-scroll-target="#numerical-methods-newton-simpson-runge-kutta">58. Numerical Methods (Newton, Simpson, Runge-Kutta)</a></li>
  <li><a href="#mathematical-optimization-simplex-gradient-convex" id="toc-mathematical-optimization-simplex-gradient-convex" class="nav-link" data-scroll-target="#mathematical-optimization-simplex-gradient-convex">59. Mathematical Optimization (Simplex, Gradient, Convex)</a></li>
  <li><a href="#algebraic-tricks-and-transform-techniques" id="toc-algebraic-tricks-and-transform-techniques" class="nav-link" data-scroll-target="#algebraic-tricks-and-transform-techniques">60. Algebraic Tricks and Transform Techniques</a></li>
  </ul></li>
  <li><a href="#chapter-7.-strings-and-text-algorithms" id="toc-chapter-7.-strings-and-text-algorithms" class="nav-link" data-scroll-target="#chapter-7.-strings-and-text-algorithms">Chapter 7. Strings and Text Algorithms</a>
  <ul class="collapse">
  <li><a href="#string-matching-kmp-z-rabin-karp-boyer-moore" id="toc-string-matching-kmp-z-rabin-karp-boyer-moore" class="nav-link" data-scroll-target="#string-matching-kmp-z-rabin-karp-boyer-moore">61. String Matching (KMP, Z, Rabin-Karp, Boyer-Moore)</a></li>
  <li><a href="#multi-pattern-search-aho-corasick" id="toc-multi-pattern-search-aho-corasick" class="nav-link" data-scroll-target="#multi-pattern-search-aho-corasick">62. Multi-Pattern Search (Aho-Corasick)</a></li>
  <li><a href="#suffix-structures-suffix-array-suffix-tree-lcp" id="toc-suffix-structures-suffix-array-suffix-tree-lcp" class="nav-link" data-scroll-target="#suffix-structures-suffix-array-suffix-tree-lcp">63. Suffix Structures (Suffix Array, Suffix Tree, LCP)</a></li>
  <li><a href="#palindromes-and-periodicity-manacher" id="toc-palindromes-and-periodicity-manacher" class="nav-link" data-scroll-target="#palindromes-and-periodicity-manacher">64. Palindromes and Periodicity (Manacher)</a></li>
  <li><a href="#edit-distance-and-alignment" id="toc-edit-distance-and-alignment" class="nav-link" data-scroll-target="#edit-distance-and-alignment">65. Edit Distance and Alignment</a></li>
  <li><a href="#compression-huffman-arithmetic-lz77-bwt" id="toc-compression-huffman-arithmetic-lz77-bwt" class="nav-link" data-scroll-target="#compression-huffman-arithmetic-lz77-bwt">66. Compression (Huffman, Arithmetic, LZ77, BWT)</a></li>
  <li><a href="#cryptographic-hashes-and-checksums" id="toc-cryptographic-hashes-and-checksums" class="nav-link" data-scroll-target="#cryptographic-hashes-and-checksums">67. Cryptographic Hashes and Checksums</a></li>
  <li><a href="#approximate-and-streaming-matching" id="toc-approximate-and-streaming-matching" class="nav-link" data-scroll-target="#approximate-and-streaming-matching">68. Approximate and Streaming Matching</a></li>
  <li><a href="#bioinformatics-alignment-needleman-wunsch-smith-waterman" id="toc-bioinformatics-alignment-needleman-wunsch-smith-waterman" class="nav-link" data-scroll-target="#bioinformatics-alignment-needleman-wunsch-smith-waterman">69. Bioinformatics Alignment (Needleman-Wunsch, Smith-Waterman)</a></li>
  <li><a href="#text-indexing-and-search-structures" id="toc-text-indexing-and-search-structures" class="nav-link" data-scroll-target="#text-indexing-and-search-structures">70. Text Indexing and Search Structures</a></li>
  </ul></li>
  <li><a href="#chapter-8.-geometry-graphics-and-spatial-algorithms" id="toc-chapter-8.-geometry-graphics-and-spatial-algorithms" class="nav-link" data-scroll-target="#chapter-8.-geometry-graphics-and-spatial-algorithms">Chapter 8. Geometry, Graphics, and Spatial Algorithms</a>
  <ul class="collapse">
  <li><a href="#convex-hull-graham-andrew-chan" id="toc-convex-hull-graham-andrew-chan" class="nav-link" data-scroll-target="#convex-hull-graham-andrew-chan">71. Convex Hull (Graham, Andrew, Chan)</a></li>
  <li><a href="#closest-pair-and-segment-intersection" id="toc-closest-pair-and-segment-intersection" class="nav-link" data-scroll-target="#closest-pair-and-segment-intersection">72. Closest Pair and Segment Intersection</a></li>
  <li><a href="#line-sweep-and-plane-sweep-algorithms" id="toc-line-sweep-and-plane-sweep-algorithms" class="nav-link" data-scroll-target="#line-sweep-and-plane-sweep-algorithms">73. Line Sweep and Plane Sweep Algorithms</a></li>
  <li><a href="#delaunay-and-voronoi-diagrams" id="toc-delaunay-and-voronoi-diagrams" class="nav-link" data-scroll-target="#delaunay-and-voronoi-diagrams">74. Delaunay and Voronoi Diagrams</a></li>
  <li><a href="#point-in-polygon-and-polygon-triangulation" id="toc-point-in-polygon-and-polygon-triangulation" class="nav-link" data-scroll-target="#point-in-polygon-and-polygon-triangulation">75. Point in Polygon and Polygon Triangulation</a></li>
  <li><a href="#spatial-data-structures-kd-r-tree" id="toc-spatial-data-structures-kd-r-tree" class="nav-link" data-scroll-target="#spatial-data-structures-kd-r-tree">76. Spatial Data Structures (KD, R-tree)</a></li>
  <li><a href="#rasterization-and-scanline-techniques" id="toc-rasterization-and-scanline-techniques" class="nav-link" data-scroll-target="#rasterization-and-scanline-techniques">77. Rasterization and Scanline Techniques</a></li>
  <li><a href="#computer-vision-canny-hough-sift" id="toc-computer-vision-canny-hough-sift" class="nav-link" data-scroll-target="#computer-vision-canny-hough-sift">78. Computer Vision (Canny, Hough, SIFT)</a></li>
  <li><a href="#pathfinding-in-space-a-rrt-prm" id="toc-pathfinding-in-space-a-rrt-prm" class="nav-link" data-scroll-target="#pathfinding-in-space-a-rrt-prm">79. Pathfinding in Space (A*, RRT, PRM)</a></li>
  <li><a href="#computational-geometry-variants-and-applications" id="toc-computational-geometry-variants-and-applications" class="nav-link" data-scroll-target="#computational-geometry-variants-and-applications">80. Computational Geometry Variants and Applications</a></li>
  </ul></li>
  <li><a href="#chapter-9.-systems-databases-and-distributed-algorithms" id="toc-chapter-9.-systems-databases-and-distributed-algorithms" class="nav-link" data-scroll-target="#chapter-9.-systems-databases-and-distributed-algorithms">Chapter 9. Systems, Databases, and Distributed Algorithms</a>
  <ul class="collapse">
  <li><a href="#concurrency-control-2pl-mvcc-occ" id="toc-concurrency-control-2pl-mvcc-occ" class="nav-link" data-scroll-target="#concurrency-control-2pl-mvcc-occ">81. Concurrency Control (2PL, MVCC, OCC)</a></li>
  <li><a href="#logging-recovery-and-commit-protocols" id="toc-logging-recovery-and-commit-protocols" class="nav-link" data-scroll-target="#logging-recovery-and-commit-protocols">82. Logging, Recovery, and Commit Protocols</a></li>
  <li><a href="#scheduling-round-robin-edf-rate-monotonic" id="toc-scheduling-round-robin-edf-rate-monotonic" class="nav-link" data-scroll-target="#scheduling-round-robin-edf-rate-monotonic">83. Scheduling (Round Robin, EDF, Rate-Monotonic)</a></li>
  <li><a href="#caching-and-replacement-lru-lfu-clock" id="toc-caching-and-replacement-lru-lfu-clock" class="nav-link" data-scroll-target="#caching-and-replacement-lru-lfu-clock">84. Caching and Replacement (LRU, LFU, CLOCK)</a></li>
  <li><a href="#networking-routing-congestion-control" id="toc-networking-routing-congestion-control" class="nav-link" data-scroll-target="#networking-routing-congestion-control">85. Networking (Routing, Congestion Control)</a></li>
  <li><a href="#distributed-consensus-paxos-raft-pbft" id="toc-distributed-consensus-paxos-raft-pbft" class="nav-link" data-scroll-target="#distributed-consensus-paxos-raft-pbft">86. Distributed Consensus (Paxos, Raft, PBFT)</a></li>
  <li><a href="#load-balancing-and-rate-limiting" id="toc-load-balancing-and-rate-limiting" class="nav-link" data-scroll-target="#load-balancing-and-rate-limiting">87. Load Balancing and Rate Limiting</a></li>
  <li><a href="#search-and-indexing-inverted-bm25-wand" id="toc-search-and-indexing-inverted-bm25-wand" class="nav-link" data-scroll-target="#search-and-indexing-inverted-bm25-wand">88. Search and Indexing (Inverted, BM25, WAND)</a></li>
  <li><a href="#compression-and-encoding-in-systems" id="toc-compression-and-encoding-in-systems" class="nav-link" data-scroll-target="#compression-and-encoding-in-systems">89. Compression and Encoding in Systems</a></li>
  <li><a href="#fault-tolerance-and-replication" id="toc-fault-tolerance-and-replication" class="nav-link" data-scroll-target="#fault-tolerance-and-replication">90. Fault Tolerance and Replication</a></li>
  </ul></li>
  <li><a href="#chapter-10.-ai-ml-and-optimization" id="toc-chapter-10.-ai-ml-and-optimization" class="nav-link" data-scroll-target="#chapter-10.-ai-ml-and-optimization">Chapter 10. AI, ML and Optimization</a>
  <ul class="collapse">
  <li><a href="#classical-ml-k-means-naive-bayes-svm-decision-trees" id="toc-classical-ml-k-means-naive-bayes-svm-decision-trees" class="nav-link" data-scroll-target="#classical-ml-k-means-naive-bayes-svm-decision-trees">91. Classical ML (k-means, Naive Bayes, SVM, Decision Trees)</a></li>
  <li><a href="#ensemble-methods-bagging-boosting-random-forests" id="toc-ensemble-methods-bagging-boosting-random-forests" class="nav-link" data-scroll-target="#ensemble-methods-bagging-boosting-random-forests">92. Ensemble Methods (Bagging, Boosting, Random Forests)</a></li>
  <li><a href="#gradient-methods-sgd-adam-rmsprop" id="toc-gradient-methods-sgd-adam-rmsprop" class="nav-link" data-scroll-target="#gradient-methods-sgd-adam-rmsprop">93. Gradient Methods (SGD, Adam, RMSProp)</a></li>
  <li><a href="#deep-learning-backpropagation-dropout-normalization" id="toc-deep-learning-backpropagation-dropout-normalization" class="nav-link" data-scroll-target="#deep-learning-backpropagation-dropout-normalization">94. Deep Learning (Backpropagation, Dropout, Normalization)</a></li>
  <li><a href="#sequence-models-viterbi-beam-search-ctc" id="toc-sequence-models-viterbi-beam-search-ctc" class="nav-link" data-scroll-target="#sequence-models-viterbi-beam-search-ctc">95. Sequence Models (Viterbi, Beam Search, CTC)</a></li>
  <li><a href="#metaheuristics-ga-sa-pso-aco" id="toc-metaheuristics-ga-sa-pso-aco" class="nav-link" data-scroll-target="#metaheuristics-ga-sa-pso-aco">96. Metaheuristics (GA, SA, PSO, ACO)</a></li>
  <li><a href="#reinforcement-learning-q-learning-policy-gradients" id="toc-reinforcement-learning-q-learning-policy-gradients" class="nav-link" data-scroll-target="#reinforcement-learning-q-learning-policy-gradients">97. Reinforcement Learning (Q-learning, Policy Gradients)</a></li>
  <li><a href="#approximation-and-online-algorithms" id="toc-approximation-and-online-algorithms" class="nav-link" data-scroll-target="#approximation-and-online-algorithms">98. Approximation and Online Algorithms</a></li>
  <li><a href="#fairness-causal-inference-and-robust-optimization" id="toc-fairness-causal-inference-and-robust-optimization" class="nav-link" data-scroll-target="#fairness-causal-inference-and-robust-optimization">99. Fairness, Causal Inference, and Robust Optimization</a></li>
  <li><a href="#ai-planning-search-and-learning-systems" id="toc-ai-planning-search-and-learning-systems" class="nav-link" data-scroll-target="#ai-planning-search-and-learning-systems">100. AI Planning, Search, and Learning Systems</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">The Book</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<ul>
<li><a href="https://github.com/little-book-of/algorithms/blob/main/releases/book.pdf">Download PDF</a> - print-ready</li>
<li><a href="https://github.com/little-book-of/algorithms/blob/main/releases/book.epub">Download EPUB</a> - e-reader friendly</li>
<li><a href="https://github.com/little-book-of/algorithms/blob/main/releases/book.tex">View LaTex</a> - <code>.tex</code> source</li>
<li><a href="https://github.com/little-book-of/algorithms">Source code (Github)</a> - Markdown source</li>
<li><a href="https://little-book-of.github.io/algorithms/books/en-US/book.html">Read on GitHub Pages</a> - view online</li>
</ul>
<p>Licensed under CC BY-NC-SA 4.0.</p>
<section id="chapter-1.-foundations-of-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="chapter-1.-foundations-of-algorithms">Chapter 1. Foundations of algorithms</h2>
<section id="what-is-an-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="what-is-an-algorithm">1. What Is an Algorithm?</h3>
<p>Let’s begin at the very heart of computer science. Before we dive into code, data, or performance, we need to understand what an algorithm <em>really is</em>.</p>
<p>An algorithm is a clear, step-by-step procedure to solve a problem. Think of it like a recipe: you have inputs (ingredients), a series of steps (instructions), and an output (the finished dish).</p>
<p>At its core, an algorithm must be:</p>
<ul>
<li>Precise: Every step is well-defined and unambiguous.- Finite: It must finish after a certain number of steps.- Effective: Each step is doable by a machine or human.- Deterministic (usually): Same input, same output. When you write an algorithm, you’re describing <em>how</em> to get from question to answer, not just <em>what</em> the answer is.</li>
</ul>
<section id="example-a-simple-sum" class="level4">
<h4 class="anchored" data-anchor-id="example-a-simple-sum">Example: A Simple Sum</h4>
<p>Suppose you want to find the sum of numbers from 1 to ( n ).</p>
<p>You could describe it like this:</p>
<ol type="1">
<li>Start with total = 0</li>
<li>For i = 1 to n 3. Add i to total</li>
<li>Return total</li>
</ol>
<p>That’s an algorithm! It’s clear, finite, and mechanical.</p>
<p>You can express it in pseudocode:</p>
<pre class="text"><code>Algorithm SumToN(n):
    total ← 0
    for i ← 1 to n:
        total ← total + i
    return total</code></pre>
<p>Or even write it in C:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum_to_n<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> total <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> i<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="tiny-code" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code">Tiny Code</h4>
<p>Let’s run a quick example by hand.</p>
<p>If ( n = 5 ):</p>
<ul>
<li>total = 0- Add 1 → total = 1- Add 2 → total = 3- Add 3 → total = 6- Add 4 → total = 10- Add 5 → total = 15 Output = 15</li>
</ul>
<p>We can even derive a formula later (you’ll see it soon!): <span class="math display">\[
1 + 2 + 3 + \dots + n = \frac{n(n+1)}{2}
\]</span></p>
</section>
<section id="why-it-matters" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters">Why It Matters</h4>
<p>Algorithms are the blueprints of computation. Every software system, from a calculator to an AI model, is built from algorithms.</p>
<p>Without algorithms, computers would be powerless , they’re just fast machines following instructions. Algorithms give them purpose and direction.</p>
<p>Understanding algorithms means you understand how thinking turns into code.</p>
<p>Later, you’ll learn to analyze them (how fast, how big, how smart), but for now, remember:</p>
<blockquote class="blockquote">
<p>Algorithms are the language of problem solving.</p>
</blockquote>
</section>
<section id="try-it-yourself" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself">Try It Yourself</h4>
<ol type="1">
<li>Write a simple algorithm to find the maximum number in a list.</li>
<li>Write an algorithm to reverse a string.</li>
<li>For extra fun, describe your morning routine as an algorithm (inputs, steps, output).</li>
</ol>
<p>The best way to learn is to think algorithmically , break problems into small, clear, executable steps.</p>
</section>
</section>
<section id="measuring-time-and-space" class="level3">
<h3 class="anchored" data-anchor-id="measuring-time-and-space">2. Measuring Time and Space</h3>
<p>Now that you know what an algorithm is, it’s time to ask a deeper question:</p>
<blockquote class="blockquote">
<p>How do we know if one algorithm is <em>better</em> than another?</p>
</blockquote>
<p>It’s not enough for an algorithm to be correct , it should also be <em>efficient</em>. We measure efficiency in two key ways: time and space.</p>
<section id="time-complexity" class="level4">
<h4 class="anchored" data-anchor-id="time-complexity">Time Complexity</h4>
<p>Time means how long an algorithm takes to run, relative to its input size. We don’t measure in seconds, because hardware changes. Instead, we count steps or operations.</p>
<p>For example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Hi</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This loop runs ( n ) times, so we say it has time complexity O(n) , it grows linearly with input size.</p>
<p>Another example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"*"</span><span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This one runs <span class="math inline">\(n \times n = n^2\)</span> times → O(n²).</p>
<p>You’ll see these “Big-O” symbols a lot , they express how runtime grows as inputs grow.</p>
</section>
<section id="space-complexity" class="level4">
<h4 class="anchored" data-anchor-id="space-complexity">Space Complexity</h4>
<p>Space means how much memory the algorithm uses.</p>
<p>Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>        <span class="co">// O(1) space</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Uses a constant amount of memory.</p>
<p>But an array like:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[</span>n<span class="op">];</span>         <span class="co">// O(n) space</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>uses space proportional to the input size.</p>
<p>Sometimes you’ll trade time for space. For example:</p>
<ul>
<li>Using a hash table speeds up lookups (more memory, less time)- Using a streaming algorithm saves memory (less space, more time)</li>
</ul>
</section>
<section id="tiny-code-1" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-1">Tiny Code</h4>
<p>Let’s compare two ways to compute a sum from 1 to n:</p>
<p>Method 1: Loop</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum_loop<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> total <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> total <span class="op">+=</span> i<span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Time: ( O(n) )- Space: ( O(1) ) Method 2: Formula</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum_formula<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n <span class="op">*</span> <span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Time: ( O(1) )- Space: ( O(1) ) Both are correct , but one is <em>faster</em>. That’s why analyzing time and space matters.</li>
</ul>
</section>
<section id="why-it-matters-1" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-1">Why It Matters</h4>
<p>When data grows huge (millions, billions), small inefficiencies explode.</p>
<p>An algorithm that takes ( O<span class="math inline">\(n^2\)</span> ) might seem fine for 10 elements, but impossible for 1,000,000.</p>
<p>Knowing how to measure time and space helps you:</p>
<ul>
<li>Predict performance- Compare solutions- Optimize intelligently It’s your compass for navigating complexity.</li>
</ul>
</section>
<section id="try-it-yourself-1" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-1">Try It Yourself</h4>
<ol type="1">
<li>Write a simple algorithm to find the minimum in an array. Estimate its time and space complexity.</li>
<li>Compare two algorithms that solve the same problem , which one scales better?</li>
<li>Can you think of a task in daily life that’s O(n)? What about O(1)?</li>
</ol>
<p>Understanding these measurements early will make every algorithm you meet more meaningful.</p>
</section>
</section>
<section id="big-o-big-theta-big-omega" class="level3">
<h3 class="anchored" data-anchor-id="big-o-big-theta-big-omega">3. Big-O, Big-Theta, Big-Omega</h3>
<p>Now that you can <em>measure</em> time and space, let’s learn the language used to describe those measurements.</p>
<p>When we say an algorithm is O(n), we’re using asymptotic notation , a way to describe how an algorithm’s running time or memory grows as input size ( n ) increases.</p>
<p>It’s not about exact steps, but how the cost <em>scales</em> for very large ( n ).</p>
<section id="the-big-o-upper-bound" class="level4">
<h4 class="anchored" data-anchor-id="the-big-o-upper-bound">The Big-O (Upper Bound)</h4>
<p>Big-O answers: <em>“How bad can it get?”</em> It gives an upper bound on growth , the worst-case scenario.</p>
<p>If an algorithm takes at most ( 5n + 20 ) steps, we write ( O(n) ). We drop constants and lower-order terms because they don’t matter at scale.</p>
<p>Common Big-O notations:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 25%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Notation</th>
<th>Growth</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Constant</td>
<td>O(1)</td>
<td>Flat</td>
<td>Accessing array element</td>
</tr>
<tr class="even">
<td>Logarithmic</td>
<td>O(log n)</td>
<td>Very slow growth</td>
<td>Binary search</td>
</tr>
<tr class="odd">
<td>Linear</td>
<td>O(n)</td>
<td>Proportional</td>
<td>Single loop</td>
</tr>
<tr class="even">
<td>Quadratic</td>
<td>O(n²)</td>
<td>Grows quickly</td>
<td>Double loop</td>
</tr>
<tr class="odd">
<td>Exponential</td>
<td>O(2ⁿ)</td>
<td>Explodes</td>
<td>Recursive subset generation</td>
</tr>
</tbody>
</table>
<p>So if your algorithm is ( O(n) ), doubling input size doubles runtime. If it’s ( O<span class="math inline">\(n^2\)</span> ), doubling input size makes it four times slower.</p>
</section>
<section id="the-big-theta-tight-bound" class="level4">
<h4 class="anchored" data-anchor-id="the-big-theta-tight-bound">The Big-Theta (Tight Bound)</h4>
<p>Big-Theta (Θ) gives a tight bound , when you know the algorithm’s growth from above and below.</p>
<p>If runtime is roughly ( 3n + 2 ), then ( T(n) = Θ(n) ). That means it’s both ( O(n) ) and ( Ω(n) ).</p>
</section>
<section id="the-big-omega-lower-bound" class="level4">
<h4 class="anchored" data-anchor-id="the-big-omega-lower-bound">The Big-Omega (Lower Bound)</h4>
<p>Big-Omega (Ω) answers: <em>“How fast can it possibly be?”</em> It’s the best-case growth , the lower limit.</p>
<p>Example:</p>
<ul>
<li>Linear search: ( Ω(1) ) if the element is at the start- ( O(n) ) in the worst case if it’s at the end So we might say: <span class="math display">\[
T(n) = Ω(1),\ Θ(n) = O(n)
\]</span></li>
</ul>
</section>
<section id="tiny-code-2" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-2">Tiny Code</h4>
<p>Let’s see Big-O in action.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum_pairs<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> total <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span>        <span class="co">// O(n)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span>    <span class="co">// O(n)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> i <span class="op">+</span> j<span class="op">;</span>            <span class="co">// O(1)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total<span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Total steps ≈ <span class="math inline">\(n \times n = n^2\)</span>. So ( T(n) = O<span class="math inline">\(n^2\)</span> ).</p>
<p>If we added a constant-time operation before or after the loops, it wouldn’t matter. Constants vanish in asymptotic notation.</p>
</section>
<section id="why-it-matters-2" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-2">Why It Matters</h4>
<p>Big-O, Big-Theta, and Big-Omega let you talk precisely about performance. They’re like the grammar of efficiency.</p>
<p>When you can write:</p>
<blockquote class="blockquote">
<p>“Algorithm A runs in O(n log n) time, O(n) space,” you’ve captured its essence clearly and compared it meaningfully.</p>
</blockquote>
<p>They help you:</p>
<ul>
<li>Predict behavior at scale- Choose better data structures- Communicate efficiency in interviews and papers It’s not about exact timing , it’s about growth.</li>
</ul>
</section>
<section id="try-it-yourself-2" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-2">Try It Yourself</h4>
<ol type="1">
<li><p>Analyze this code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">*=</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> i<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>What’s the time complexity?</p></li>
<li><p>Write an algorithm that’s O(n log n) , hint: merge sort!</p></li>
<li><p>Identify the best, worst, and average-case complexities for linear search and binary search.</p></li>
</ol>
<p>Learning Big-O is like learning a new language , once you’re fluent, you can <em>see</em> how code grows before you even run it.</p>
</section>
</section>
<section id="algorithmic-paradigms-greedy-divide-and-conquer-dp" class="level3">
<h3 class="anchored" data-anchor-id="algorithmic-paradigms-greedy-divide-and-conquer-dp">4. Algorithmic Paradigms (Greedy, Divide and Conquer, DP)</h3>
<p>Once you can measure performance, it’s time to explore how algorithms are designed. Behind every clever solution is a guiding paradigm , a way of thinking about problems.</p>
<p>Three of the most powerful are:</p>
<ol type="1">
<li>Greedy Algorithms</li>
<li>Divide and Conquer</li>
<li>Dynamic Programming (DP)</li>
</ol>
<p>Each one represents a different mindset for problem-solving.</p>
<section id="greedy-algorithms" class="level4">
<h4 class="anchored" data-anchor-id="greedy-algorithms">1. Greedy Algorithms</h4>
<p>A greedy algorithm makes the best local choice at each step, hoping it leads to a global optimum.</p>
<p>Think of it like:</p>
<blockquote class="blockquote">
<p>“Take what looks best right now, don’t worry about the future.”</p>
</blockquote>
<p>They’re fast and simple, but not always correct , they only work when the greedy choice property holds.</p>
<p>Example: Coin Change (Greedy version) Suppose you want to make 63 cents using US coins (25, 10, 5, 1). The greedy approach:</p>
<ul>
<li>Take 25 → 38 left- Take 25 → 13 left- Take 10 → 3 left- Take 1 × 3 Works here, but not always (try coins 1, 3, 4 for 6).</li>
</ul>
<p>Simple but not guaranteed optimal.</p>
<p>Common greedy algorithms:</p>
<ul>
<li>Kruskal’s MST- Prim’s MST- Dijkstra’s (non-negative weights)- Huffman coding</li>
</ul>
</section>
<section id="divide-and-conquer" class="level4">
<h4 class="anchored" data-anchor-id="divide-and-conquer">2. Divide and Conquer</h4>
<p>This one’s a classic. You break the problem into smaller subproblems, solve each recursively, and then combine the results.</p>
<p>It’s like splitting a task among friends, then merging the answers.</p>
<p>Formally: <span class="math display">\[
T(n) = aT\left(\frac{n}{b}\right) + f(n)
\]</span></p>
<p>Examples:</p>
<ul>
<li>Merge Sort: divide the array, sort halves, merge- Quick Sort: partition around pivot- Binary Search: halve the range each step Elegant and powerful, but recursion overhead can add cost if poorly structured.</li>
</ul>
</section>
<section id="dynamic-programming-dp" class="level4">
<h4 class="anchored" data-anchor-id="dynamic-programming-dp">3. Dynamic Programming (DP)</h4>
<p>DP is for problems with overlapping subproblems and optimal substructure. You solve smaller subproblems once and store the results to avoid recomputation.</p>
<p>It’s like divide and conquer with memory.</p>
<p>Example: Fibonacci Naive recursion: exponential DP with memoization: linear</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">static</span> <span class="dt">int</span> memo<span class="op">[</span><span class="dv">1000</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>memo<span class="op">[</span>n<span class="op">])</span> <span class="cf">return</span> memo<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    memo<span class="op">[</span>n<span class="op">]</span> <span class="op">=</span> fib<span class="op">(</span>n<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">+</span> fib<span class="op">(</span>n<span class="op">-</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> memo<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Efficient reuse, but requires insight into subproblem structure.</p>
</section>
<section id="tiny-code-3" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-3">Tiny Code</h4>
<p>Here’s a quick comparison using Fibonacci:</p>
<p>Naive (Divide and Conquer)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib_dc<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fib_dc<span class="op">(</span>n<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">+</span> fib_dc<span class="op">(</span>n<span class="op">-</span><span class="dv">2</span><span class="op">);</span>  <span class="co">// exponential</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>DP (Memoization)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib_dp<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> memo<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>memo<span class="op">[</span>n<span class="op">])</span> <span class="cf">return</span> memo<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> memo<span class="op">[</span>n<span class="op">]</span> <span class="op">=</span> fib_dp<span class="op">(</span>n<span class="op">-</span><span class="dv">1</span><span class="op">,</span> memo<span class="op">)</span> <span class="op">+</span> fib_dp<span class="op">(</span>n<span class="op">-</span><span class="dv">2</span><span class="op">,</span> memo<span class="op">);</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-3" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-3">Why It Matters</h4>
<p>Algorithmic paradigms give you patterns for design:</p>
<ul>
<li>Greedy: when local choices lead to global optimum- Divide &amp; Conquer: when the problem splits naturally- Dynamic Programming: when subproblems overlap Once you recognize a problem’s structure, you’ll instantly know which mindset fits best.</li>
</ul>
<p>Think of paradigms as <em>templates for reasoning</em> , not just techniques, but philosophies.</p>
</section>
<section id="try-it-yourself-3" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-3">Try It Yourself</h4>
<ol type="1">
<li>Write a greedy algorithm to make change using coins [1, 3, 4] for amount 6. Does it work?</li>
<li>Implement merge sort using divide and conquer.</li>
<li>Solve Fibonacci both ways (naive vs DP) and compare speeds.</li>
<li>Can you think of a real-life task you solve greedily?</li>
</ol>
<p>Learning paradigms is like learning styles of thought , once you know them, every problem starts to look familiar.</p>
</section>
</section>
<section id="recurrence-relations" class="level3">
<h3 class="anchored" data-anchor-id="recurrence-relations">5. Recurrence Relations</h3>
<p>Every time you break a problem into smaller subproblems, you create a recurrence , a mathematical way to describe how the total cost grows.</p>
<p>Recurrence relations are the backbone of analyzing recursive algorithms. They tell us how much time or space an algorithm uses, based on the cost of its subproblems.</p>
<section id="what-is-a-recurrence" class="level4">
<h4 class="anchored" data-anchor-id="what-is-a-recurrence">What Is a Recurrence?</h4>
<p>A recurrence relation expresses ( T(n) ), the total cost for input size ( n ), in terms of smaller instances.</p>
<p>Example: For merge sort: <span class="math display">\[
T(n) = 2T(n/2) + O(n)
\]</span> That means:</p>
<ul>
<li><p>It divides the problem into 2 halves (2T(n/2))- Merges results in O(n) time You’ll often see recurrences like:</p></li>
<li><p>( T(n) = T(n - 1) + O(1) )- ( T(n) = 2T(n/2) + O(n) )- ( T(n) = T(n/2) + O(1) ) Each one represents a different structure of recursion.</p></li>
</ul>
</section>
<section id="example-1-simple-linear-recurrence" class="level4">
<h4 class="anchored" data-anchor-id="example-1-simple-linear-recurrence">Example 1: Simple Linear Recurrence</h4>
<p>Consider this code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> count_down<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">+</span> count_down<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This calls itself once for each smaller input → <span class="math display">\[
T(n) = T(n - 1) + O(1)
\]</span></p>
<p>Solve it: <span class="math display">\[
T(n) = O(n)
\]</span></p>
<p>Because it runs once per level.</p>
</section>
<section id="example-2-binary-recurrence" class="level4">
<h4 class="anchored" data-anchor-id="example-2-binary-recurrence">Example 2: Binary Recurrence</h4>
<p>For binary recursion:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum_tree<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum_tree<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> sum_tree<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Here we do two subcalls on ( n/2 ) and a constant amount of extra work. <span class="math display">\[
T(n) = 2T(n/2) + O(1)
\]</span> Solve it: ( T(n) = O(n) )</p>
<p>Why? Each level doubles calls, but halves size. There are log n levels, and total work adds up to O(n).</p>
</section>
<section id="solving-recurrences" class="level4">
<h4 class="anchored" data-anchor-id="solving-recurrences">Solving Recurrences</h4>
<p>There are several ways to solve them:</p>
<ol type="1">
<li>Substitution Method Guess the solution, then prove it by induction.</li>
<li>Recursion Tree Method Expand the recurrence into a tree and sum the cost per level.</li>
<li>Master Theorem Use a formula when recurrence matches: <span class="math display">\[
T(n) = aT(n/b) + f(n)
\]</span></li>
</ol>
</section>
<section id="master-theorem-quick-summary" class="level4">
<h4 class="anchored" data-anchor-id="master-theorem-quick-summary">Master Theorem (Quick Summary)</h4>
<p>If ( T(n) = aT(n/b) + f(n) ), then:</p>
<ul>
<li>If ( f(n) = O<span class="math inline">\(n^{\log_b a - \epsilon}\)</span> ), then ( T(n) = Θ<span class="math inline">\(n^{\log_b a}\)</span> )- If ( f(n) = Θ<span class="math inline">\(n^{\log_b a}\)</span> ), then ( T(n) = Θ<span class="math inline">\(n^{\log_b a} \log n\)</span> )- If ( f(n) = Ω<span class="math inline">\(n^{\log_b a + \epsilon}\)</span> ), and regularity condition holds, then ( T(n) = Θ(f(n)) ) Example: Merge Sort → ( a = 2, b = 2, f(n) = O(n) ) <span class="math display">\[
T(n) = 2T(n/2) + O(n) = O(n \log n)
\]</span></li>
</ul>
</section>
<section id="tiny-code-4" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-4">Tiny Code</h4>
<p>Let’s write a quick recursive sum:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum_array<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> r<span class="op">)</span> <span class="cf">return</span> arr<span class="op">[</span>l<span class="op">];</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum_array<span class="op">(</span>arr<span class="op">,</span> l<span class="op">,</span> mid<span class="op">)</span> <span class="op">+</span> sum_array<span class="op">(</span>arr<span class="op">,</span> mid<span class="op">+</span><span class="dv">1</span><span class="op">,</span> r<span class="op">);</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Recurrence: <span class="math display">\[
T(n) = 2T(n/2) + O(1)
\]</span> → ( O(n) )</p>
<p>If you added merging (like in merge sort), you’d get ( +O(n) ), → ( O<span class="math inline">\(n \log n\)</span> )</p>
</section>
<section id="why-it-matters-4" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-4">Why It Matters</h4>
<p>Recurrence relations let you predict the cost of recursive solutions.</p>
<p>Without them, recursion feels like magic , with them, you can quantify efficiency.</p>
<p>They’re key to understanding:</p>
<ul>
<li>Divide and conquer- Dynamic programming- Backtracking Once you can set up a recurrence, solving it becomes a game of algebra and logic.</li>
</ul>
</section>
<section id="try-it-yourself-4" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-4">Try It Yourself</h4>
<ol type="1">
<li><p>Write a recurrence for binary search. Solve it.</p></li>
<li><p>Write a recurrence for merge sort. Solve it.</p></li>
<li><p>Analyze this function:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fun<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    fun<span class="op">(</span>n<span class="op">/</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    fun<span class="op">(</span>n<span class="op">/</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    fun<span class="op">(</span>n<span class="op">/</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>What’s the recurrence? Approximate the complexity.</p></li>
<li><p>Expand ( T(n) = T(n-1) + 1 ) into its explicit sum.</p></li>
</ol>
<p>Learning recurrences helps you <em>see inside</em> recursion , they turn code into equations.</p>
</section>
</section>
<section id="searching-basics" class="level3">
<h3 class="anchored" data-anchor-id="searching-basics">6. Searching Basics</h3>
<p>Before we sort or optimize, we need a way to find things. Searching is one of the most fundamental actions in computing , whether it’s looking up a name, finding a key, or checking if something exists.</p>
<p>A search algorithm takes a collection (array, list, tree, etc.) and a target, and returns whether the target is present (and often its position).</p>
<p>Let’s begin with two foundational techniques: Linear Search and Binary Search.</p>
<section id="linear-search" class="level4">
<h4 class="anchored" data-anchor-id="linear-search">1. Linear Search</h4>
<p>Linear search is the simplest method:</p>
<ul>
<li>Start at the beginning- Check each element in turn- Stop if you find the target It works on any list , sorted or not , but can be slow for large data.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> linear_search<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: If arr = [2, 4, 6, 8, 10] and key = 6, it finds it at index 2.</p>
<p>Complexity:</p>
<ul>
<li>Time: ( O(n) )- Space: ( O(1) ) Linear search is simple and guaranteed to find the target if it exists, but slow when lists are large.</li>
</ul>
</section>
<section id="binary-search" class="level4">
<h4 class="anchored" data-anchor-id="binary-search">2. Binary Search</h4>
<p>When the list is sorted, we can do much better. Binary search repeatedly divides the search space in half.</p>
<p>Steps:</p>
<ol type="1">
<li>Check the middle element.</li>
<li>If it matches, you’re done.</li>
<li>If target &lt; mid, search left half.</li>
<li>Else search right half.</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> binary_search<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> low <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> high <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>low <span class="op">&lt;=</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>low <span class="op">+</span> high<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> mid<span class="op">;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">&lt;</span> key<span class="op">)</span> low <span class="op">=</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> high <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [2, 4, 6, 8, 10], key = 8</p>
<ul>
<li><p>mid = 6 → key &gt; mid → search right half- mid = 8 → found Complexity:</p></li>
<li><p>Time: ( O<span class="math inline">\(\log n\)</span> )- Space: ( O(1) ) Binary search is a massive improvement , doubling input only adds one extra step.</p></li>
</ul>
</section>
<section id="recursive-binary-search" class="level4">
<h4 class="anchored" data-anchor-id="recursive-binary-search">3. Recursive Binary Search</h4>
<p>Binary search can also be written recursively:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> binary_search_rec<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>low <span class="op">&gt;</span> high<span class="op">)</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>low <span class="op">+</span> high<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> mid<span class="op">;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">&gt;</span> key<span class="op">)</span> <span class="cf">return</span> binary_search_rec<span class="op">(</span>arr<span class="op">,</span> low<span class="op">,</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> key<span class="op">);</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">return</span> binary_search_rec<span class="op">(</span>arr<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> high<span class="op">,</span> key<span class="op">);</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Same logic, different structure. Both iterative and recursive forms are equally efficient.</p>
</section>
<section id="choosing-between-them" class="level4">
<h4 class="anchored" data-anchor-id="choosing-between-them">4. Choosing Between Them</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Works On</th>
<th>Time</th>
<th>Space</th>
<th>Needs Sorting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linear Search</td>
<td>Any list</td>
<td>O(n)</td>
<td>O(1)</td>
<td>No</td>
</tr>
<tr class="even">
<td>Binary Search</td>
<td>Sorted list</td>
<td>O(log n)</td>
<td>O(1)</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>If data is unsorted or very small, linear search is fine. If data is sorted and large, binary search is far superior.</p>
</section>
<section id="tiny-code-5" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-5">Tiny Code</h4>
<p>Compare the steps: For n = 16:</p>
<ul>
<li>Linear search → up to 16 comparisons- Binary search → <span class="math inline">\(\log_2 16 = 4\)</span> comparisons That’s a huge difference.</li>
</ul>
</section>
<section id="why-it-matters-5" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-5">Why It Matters</h4>
<p>Searching is the core of information retrieval , every database, compiler, and system relies on it.</p>
<p>Understanding simple searches prepares you for:</p>
<ul>
<li>Hash tables (constant-time lookups)- Tree searches (ordered structures)- Graph traversals (structured exploration) It’s not just about finding values , it’s about learning how data structure and algorithm design fit together.</li>
</ul>
</section>
<section id="try-it-yourself-5" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-5">Try It Yourself</h4>
<ol type="1">
<li>Write a linear search that returns all indices where a target appears.</li>
<li>Modify binary search to return the first occurrence of a target in a sorted array.</li>
<li>Compare runtime on arrays of size 10, 100, 1000.</li>
<li>What happens if you run binary search on an unsorted list?</li>
</ol>
<p>Search is the foundation , once you master it, you’ll recognize its patterns everywhere.</p>
</section>
</section>
<section id="sorting-basics" class="level3">
<h3 class="anchored" data-anchor-id="sorting-basics">7. Sorting Basics</h3>
<p>Sorting is one of the most studied problems in computer science. Why? Because order matters , it makes searching faster, patterns clearer, and data easier to manage.</p>
<p>A sorting algorithm arranges elements in a specific order (usually ascending or descending). Once sorted, many operations (like binary search, merging, or deduplication) become much simpler.</p>
<p>Let’s explore the foundational sorting methods and the principles behind them.</p>
<section id="what-makes-a-sort-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="what-makes-a-sort-algorithm">1. What Makes a Sort Algorithm</h4>
<p>A sorting algorithm should define:</p>
<ul>
<li>Input: A sequence of elements- Output: The same elements, in sorted order- Stability: Keeps equal elements in the same order (important for multi-key sorts)- In-place: Uses only a constant amount of extra space Different algorithms balance speed, memory, and simplicity.</li>
</ul>
</section>
<section id="bubble-sort" class="level4">
<h4 class="anchored" data-anchor-id="bubble-sort">2. Bubble Sort</h4>
<p>Idea: Repeatedly “bubble up” the largest element to the end by swapping adjacent pairs.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> bubble_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&gt;</span> arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                arr<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Each pass moves the largest remaining item to its final position.</p>
<ul>
<li>Time: ( O<span class="math inline">\(n^2\)</span> )- Space: ( O(1) )- Stable: Yes Simple but inefficient for large data.</li>
</ul>
</section>
<section id="selection-sort" class="level4">
<h4 class="anchored" data-anchor-id="selection-sort">3. Selection Sort</h4>
<p>Idea: Repeatedly select the smallest element and put it in the correct position.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> selection_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> min_idx <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> arr<span class="op">[</span>min_idx<span class="op">])</span> min_idx <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>min_idx<span class="op">];</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>min_idx<span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Time: ( O<span class="math inline">\(n^2\)</span> )- Space: ( O(1) )- Stable: No Fewer swaps, but still quadratic.</li>
</ul>
</section>
<section id="insertion-sort" class="level4">
<h4 class="anchored" data-anchor-id="insertion-sort">4. Insertion Sort</h4>
<p>Idea: Build the sorted list one item at a time, inserting each new item in the right place.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> insertion_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> key <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>j <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&gt;</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>            arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>            j<span class="op">--;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Time: ( O<span class="math inline">\(n^2\)</span> ) (best case ( O(n) ) when nearly sorted)- Space: ( O(1) )- Stable: Yes Insertion sort is great for small or nearly sorted datasets , used as a base in hybrid sorts like Timsort.</li>
</ul>
</section>
<section id="comparing-the-basics" class="level4">
<h4 class="anchored" data-anchor-id="comparing-the-basics">5. Comparing the Basics</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Best Case</th>
<th>Average Case</th>
<th>Worst Case</th>
<th>Stable</th>
<th>In-place</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bubble Sort</td>
<td>O(n)</td>
<td>O(n²)</td>
<td>O(n²)</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Selection Sort</td>
<td>O(n²)</td>
<td>O(n²)</td>
<td>O(n²)</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Insertion Sort</td>
<td>O(n)</td>
<td>O(n²)</td>
<td>O(n²)</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>All three are quadratic in time, but Insertion Sort performs best on small, partially sorted data.</p>
</section>
<section id="tiny-code-6" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-6">Tiny Code</h4>
<p>Quick check with <code>arr = [5, 3, 4, 1, 2]</code>:</p>
<p>Insertion Sort (step by step)</p>
<ul>
<li>Insert 3 before 5 → [3, 5, 4, 1, 2]- Insert 4 → [3, 4, 5, 1, 2]- Insert 1 → [1, 3, 4, 5, 2]- Insert 2 → [1, 2, 3, 4, 5] Sorted!</li>
</ul>
</section>
<section id="why-it-matters-6" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-6">Why It Matters</h4>
<p>Sorting is a gateway algorithm , it teaches you about iteration, swapping, and optimization.</p>
<p>Efficient sorting is critical for:</p>
<ul>
<li>Preprocessing data for binary search- Organizing data for analysis- Building indexes and ranking systems It’s the first step toward deeper concepts like divide-and-conquer and hybrid optimization.</li>
</ul>
</section>
<section id="try-it-yourself-6" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-6">Try It Yourself</h4>
<ol type="1">
<li>Implement all three: bubble, selection, insertion.</li>
<li>Test them on arrays of size 10, 100, 1000 , note timing differences.</li>
<li>Try sorting an array that’s already sorted. Which one adapts best?</li>
<li>Modify insertion sort to sort in descending order.</li>
</ol>
<p>Sorting may seem simple, but it’s a cornerstone , mastering it will shape your intuition for almost every other algorithm.</p>
</section>
</section>
<section id="data-structures-overview" class="level3">
<h3 class="anchored" data-anchor-id="data-structures-overview">8. Data Structures Overview</h3>
<p>Algorithms and data structures are two sides of the same coin. An algorithm is how you solve a problem. A data structure is where you store and organize data so that your algorithm can work efficiently.</p>
<p>You can think of data structures as containers , each one shaped for specific access patterns, trade-offs, and performance needs. Choosing the right one is often the <em>key</em> to designing a fast algorithm.</p>
<section id="why-data-structures-matter" class="level4">
<h4 class="anchored" data-anchor-id="why-data-structures-matter">1. Why Data Structures Matter</h4>
<p>Imagine you want to find a book quickly.</p>
<ul>
<li>If all books are piled randomly → you must scan every one (O(n)).- If they’re sorted on a shelf → you can use binary search (O(log n)).- If you have an index or catalog → you can find it instantly (O(1)). Different structures unlock different efficiencies.</li>
</ul>
</section>
<section id="the-core-data-structures" class="level4">
<h4 class="anchored" data-anchor-id="the-core-data-structures">2. The Core Data Structures</h4>
<p>Let’s walk through the most essential ones:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 35%">
<col style="width: 37%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
<th>Key Operations</th>
<th>Typical Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Array</td>
<td>Fixed-size contiguous memory</td>
<td>Access ( O(1) ), Insert/Delete ( O(n) )</td>
<td>Fast index access</td>
</tr>
<tr class="even">
<td>Linked List</td>
<td>Sequence of nodes with pointers</td>
<td>Insert/Delete ( O(1) ), Access ( O(n) )</td>
<td>Dynamic sequences</td>
</tr>
<tr class="odd">
<td>Stack</td>
<td>LIFO (last-in, first-out)</td>
<td>push(), pop() in ( O(1) )</td>
<td>Undo, recursion</td>
</tr>
<tr class="even">
<td>Queue</td>
<td>FIFO (first-in, first-out)</td>
<td>enqueue(), dequeue() in ( O(1) )</td>
<td>Scheduling, buffers</td>
</tr>
<tr class="odd">
<td>Hash Table</td>
<td>Key-value pairs via hashing</td>
<td>Average ( O(1) ), Worst ( O(n) )</td>
<td>Lookup, caching</td>
</tr>
<tr class="even">
<td>Heap</td>
<td>Partially ordered tree</td>
<td>Insert ( O<span class="math inline">\(\log n\)</span> ), Extract-Min ( O<span class="math inline">\(\log n\)</span> )</td>
<td>Priority queues</td>
</tr>
<tr class="odd">
<td>Tree</td>
<td>Hierarchical structure</td>
<td>Access ( O<span class="math inline">\(\log n\)</span> ) (balanced)</td>
<td>Sorted storage</td>
</tr>
<tr class="even">
<td>Graph</td>
<td>Nodes + edges</td>
<td>Traversal ( O(V+E) )</td>
<td>Networks, paths</td>
</tr>
<tr class="odd">
<td>Set / Map</td>
<td>Collections of unique keys or key-value pairs</td>
<td>( O<span class="math inline">\(\log n\)</span> ) or ( O(1) )</td>
<td>Membership tests</td>
</tr>
</tbody>
</table>
<p>Each comes with trade-offs , arrays are fast but rigid, linked lists are flexible but slower to access, and hash tables are lightning-fast but unordered.</p>
</section>
<section id="abstract-data-types-adts" class="level4">
<h4 class="anchored" data-anchor-id="abstract-data-types-adts">3. Abstract Data Types (ADTs)</h4>
<p>An ADT defines what operations you can do, not how they’re implemented. For example, a Stack ADT promises:</p>
<ul>
<li><code>push(x)</code>- <code>pop()</code>- <code>peek()</code> It can be implemented with arrays or linked lists , the <em>behavior</em> stays the same.</li>
</ul>
<p>Common ADTs:</p>
<ul>
<li>Stack- Queue- Deque- Priority Queue- Map / Dictionary This separation of interface and implementation helps design flexible systems.</li>
</ul>
</section>
<section id="the-right-tool-for-the-job" class="level4">
<h4 class="anchored" data-anchor-id="the-right-tool-for-the-job">4. The Right Tool for the Job</h4>
<p>Choosing the correct data structure often decides the performance of your algorithm:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Problem</th>
<th>Good Choice</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Undo feature</td>
<td>Stack</td>
<td>LIFO fits history</td>
</tr>
<tr class="even">
<td>Scheduling tasks</td>
<td>Queue</td>
<td>FIFO order</td>
</tr>
<tr class="odd">
<td>Dijkstra’s algorithm</td>
<td>Priority Queue</td>
<td>Extract smallest distance</td>
</tr>
<tr class="even">
<td>Counting frequencies</td>
<td>Hash Map</td>
<td>Fast key lookup</td>
</tr>
<tr class="odd">
<td>Dynamic median</td>
<td>Heap + Heap</td>
<td>Balance two halves</td>
</tr>
<tr class="even">
<td>Search by prefix</td>
<td>Trie</td>
<td>Fast prefix lookups</td>
</tr>
</tbody>
</table>
<p>Good programmers don’t just write code , they pick the right structure.</p>
</section>
<section id="tiny-code-7" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-7">Tiny Code</h4>
<p>Example: comparing array vs linked list</p>
<p>Array:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">};</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> arr<span class="op">[</span><span class="dv">3</span><span class="op">]);</span> <span class="co">// O(1)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Linked List:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Node <span class="op">{</span> <span class="dt">int</span> val<span class="op">;</span> <span class="kw">struct</span> Node<span class="op">*</span> next<span class="op">;</span> <span class="op">};</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To get the 4th element, you must traverse → ( O(n) )</p>
<p>Different structures, different access costs.</p>
</section>
<section id="why-it-matters-7" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-7">Why It Matters</h4>
<p>Every efficient algorithm depends on the right data structure.</p>
<ul>
<li>Searching, sorting, and storing all rely on structure.- Memory layout affects cache performance.- The wrong choice can turn O(1) into O(n²). Understanding these structures is like knowing the tools in a workshop , once you recognize their shapes, you’ll instinctively know which to grab.</li>
</ul>
</section>
<section id="try-it-yourself-7" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-7">Try It Yourself</h4>
<ol type="1">
<li>Implement a stack using an array. Then implement it using a linked list.</li>
<li>Write a queue using two stacks.</li>
<li>Try storing key-value pairs in a hash table (hint: mod by table size).</li>
<li>Compare access times for arrays vs linked lists experimentally.</li>
</ol>
<p>Data structures aren’t just storage , they are the <em>skeletons</em> your algorithms stand on.</p>
</section>
</section>
<section id="graphs-and-trees-overview" class="level3">
<h3 class="anchored" data-anchor-id="graphs-and-trees-overview">9. Graphs and Trees Overview</h3>
<p>Now that you’ve seen linear structures like arrays and linked lists, it’s time to explore nonlinear structures , graphs and trees. These are the shapes behind networks, hierarchies, and relationships.</p>
<p>They’re everywhere: family trees, file systems, maps, social networks, and knowledge graphs all rely on them.</p>
<section id="trees" class="level4">
<h4 class="anchored" data-anchor-id="trees">1. Trees</h4>
<p>A tree is a connected structure with no cycles. It’s a hierarchy , every node (except the root) has one parent.</p>
<ul>
<li><p>Root: the top node- Child: a node directly connected below- Leaf: a node with no children- Height: the longest path from root to a leaf A binary tree is one where each node has at most two children. A binary search tree (BST) keeps elements ordered:</p></li>
<li><p>Left child &lt; parent &lt; Right child Basic Operations:</p></li>
<li><p>Insert- Search- Delete- Traverse (preorder, inorder, postorder, level-order) Example:</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> val<span class="op">;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>left<span class="op">,</span> <span class="op">*</span>right<span class="op">;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Insert in BST:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Node<span class="op">*</span> insert<span class="op">(</span><span class="kw">struct</span> Node<span class="op">*</span> root<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>root<span class="op">)</span> <span class="cf">return</span> newNode<span class="op">(</span>val<span class="op">);</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>val <span class="op">&lt;</span> root<span class="op">-&gt;</span>val<span class="op">)</span> root<span class="op">-&gt;</span>left <span class="op">=</span> insert<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">,</span> val<span class="op">);</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> root<span class="op">-&gt;</span>right <span class="op">=</span> insert<span class="op">(</span>root<span class="op">-&gt;</span>right<span class="op">,</span> val<span class="op">);</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="common-tree-types" class="level4">
<h4 class="anchored" data-anchor-id="common-tree-types">2. Common Tree Types</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 48%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Binary Tree</td>
<td>Each node has ≤ 2 children</td>
<td>General hierarchy</td>
</tr>
<tr class="even">
<td>Binary Search Tree (BST)</td>
<td>Left &lt; Root &lt; Right</td>
<td>Ordered data</td>
</tr>
<tr class="odd">
<td>AVL / Red-Black Tree</td>
<td>Self-balancing BST</td>
<td>Fast search/insert</td>
</tr>
<tr class="even">
<td>Heap</td>
<td>Complete binary tree, parent ≥ or ≤ children</td>
<td>Priority queues</td>
</tr>
<tr class="odd">
<td>Trie</td>
<td>Tree of characters</td>
<td>Prefix search</td>
</tr>
<tr class="even">
<td>Segment Tree</td>
<td>Tree over ranges</td>
<td>Range queries</td>
</tr>
<tr class="odd">
<td>Fenwick Tree</td>
<td>Tree with prefix sums</td>
<td>Efficient updates</td>
</tr>
</tbody>
</table>
<p>Balanced trees keep height ( O<span class="math inline">\(\log n\)</span> ), guaranteeing fast operations.</p>
</section>
<section id="graphs" class="level4">
<h4 class="anchored" data-anchor-id="graphs">3. Graphs</h4>
<p>A graph generalizes the idea of trees , now, nodes (vertices) can connect freely. A graph is a set of vertices ( V ) and edges ( E ): <span class="math display">\[
G = (V, E)
\]</span></p>
<p>Directed vs Undirected</p>
<ul>
<li><p>Directed: edges have direction (A → B)- Undirected: edges connect both ways (A , B) Weighted vs Unweighted</p></li>
<li><p>Weighted: each edge has a cost- Unweighted: all edges equal Representation:</p></li>
</ul>
<ol type="1">
<li>Adjacency Matrix <span class="math inline">\(n \times n\)</span> matrix; entry (i, j) = 1 if edge exists</li>
<li>Adjacency List Array of lists: each vertex stores neighbors</li>
</ol>
<p>Example adjacency list:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> graph<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>graph<span class="op">[</span><span class="dv">0</span><span class="op">].</span>push_back<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>graph<span class="op">[</span><span class="dv">0</span><span class="op">].</span>push_back<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="common-graph-types" class="level4">
<h4 class="anchored" data-anchor-id="common-graph-types">4. Common Graph Types</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 41%">
<col style="width: 32%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Graph Type</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Undirected</td>
<td>Edges without direction</td>
<td>Friendship network</td>
</tr>
<tr class="even">
<td>Directed</td>
<td>Arrows indicate direction</td>
<td>Web links</td>
</tr>
<tr class="odd">
<td>Weighted</td>
<td>Edges have costs</td>
<td>Road network</td>
</tr>
<tr class="even">
<td>Cyclic</td>
<td>Contains loops</td>
<td>Task dependencies</td>
</tr>
<tr class="odd">
<td>Acyclic</td>
<td>No loops</td>
<td>Family tree</td>
</tr>
<tr class="even">
<td>DAG (Directed Acyclic Graph)</td>
<td>Directed, no cycles</td>
<td>Scheduling, compilers</td>
</tr>
<tr class="odd">
<td>Complete</td>
<td>All pairs connected</td>
<td>Dense networks</td>
</tr>
<tr class="even">
<td>Sparse</td>
<td>Few edges</td>
<td>Real-world graphs</td>
</tr>
</tbody>
</table>
</section>
<section id="basic-graph-operations" class="level4">
<h4 class="anchored" data-anchor-id="basic-graph-operations">5. Basic Graph Operations</h4>
<ul>
<li>Add Vertex / Edge- Traversal: Depth-First Search (DFS), Breadth-First Search (BFS)- Path Finding: Dijkstra, Bellman-Ford- Connectivity: Union-Find, Tarjan (SCC)- Spanning Trees: Kruskal, Prim Each graph problem has its own flavor , from finding shortest paths to detecting cycles.</li>
</ul>
</section>
<section id="tiny-code-8" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-8">Tiny Code</h4>
<p>Breadth-first search (BFS):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> bfs<span class="op">(</span><span class="dt">int</span> start<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> graph<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> visited<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>visited<span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>visited<span class="op">));</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> q<span class="op">;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    visited<span class="op">[</span>start<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    q<span class="op">.</span>push<span class="op">(</span>start<span class="op">);</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> node <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> node<span class="op">);</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> neighbor <span class="op">:</span> graph<span class="op">[</span>node<span class="op">])</span> <span class="op">{</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>visited<span class="op">[</span>neighbor<span class="op">])</span> <span class="op">{</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                visited<span class="op">[</span>neighbor<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                q<span class="op">.</span>push<span class="op">(</span>neighbor<span class="op">);</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This explores level by level , perfect for shortest paths in unweighted graphs.</p>
</section>
<section id="why-it-matters-8" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-8">Why It Matters</h4>
<p>Trees and graphs model relationships and connections, not just sequences. They’re essential for:</p>
<ul>
<li>Search engines (web graph)- Compilers (syntax trees, dependency DAGs)- AI (state spaces, decision trees)- Databases (indexes, joins, relationships) Understanding them unlocks an entire world of algorithms , from DFS and BFS to Dijkstra, Kruskal, and beyond.</li>
</ul>
</section>
<section id="try-it-yourself-8" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-8">Try It Yourself</h4>
<ol type="1">
<li>Build a simple binary search tree and implement inorder traversal.</li>
<li>Represent a graph with adjacency lists and print all edges.</li>
<li>Write a DFS and BFS for a small graph.</li>
<li>Draw a directed graph with a cycle and detect it manually.</li>
</ol>
<p>Graphs and trees move you beyond linear thinking , they let you explore <em>connections</em>, not just collections.</p>
</section>
</section>
<section id="algorithm-design-patterns" class="level3">
<h3 class="anchored" data-anchor-id="algorithm-design-patterns">10. Algorithm Design Patterns</h3>
<p>By now, you’ve seen what algorithms <em>are</em> and how they’re <em>analyzed</em>. You’ve explored searches, sorts, structures, and recursion. The next step is learning patterns , reusable <em>strategies</em> that guide how you build new algorithms from scratch.</p>
<p>Just like design patterns in software architecture, algorithmic design patterns give structure to your thinking. Once you recognize them, many problems suddenly feel familiar.</p>
<section id="brute-force" class="level4">
<h4 class="anchored" data-anchor-id="brute-force">1. Brute Force</h4>
<p>Start simple. Try every possibility, pick the best result. Brute force is often your baseline , clear but inefficient.</p>
<p>Example: Find the maximum subarray sum by checking all subarrays.</p>
<ul>
<li>Time: ( O<span class="math inline">\(n^2\)</span> )- Advantage: easy to reason about- Disadvantage: explodes for large input Sometimes, brute force helps you see the structure needed for a better approach.</li>
</ul>
</section>
<section id="divide-and-conquer-1" class="level4">
<h4 class="anchored" data-anchor-id="divide-and-conquer-1">2. Divide and Conquer</h4>
<p>Split the problem into smaller parts, solve each, and combine. Ideal for problems with self-similarity.</p>
<p>Classic examples:</p>
<ul>
<li>Merge Sort → split and merge- Binary Search → halve the search space- Quick Sort → partition and sort General form: <span class="math display">\[
T(n) = aT(n/b) + f(n)
\]</span></li>
</ul>
<p>Use recurrence relations and the Master Theorem to analyze them.</p>
</section>
<section id="greedy" class="level4">
<h4 class="anchored" data-anchor-id="greedy">3. Greedy</h4>
<p>Make the best local decision at each step. Works only when local optimal choices lead to a global optimum.</p>
<p>Examples:</p>
<ul>
<li>Activity Selection- Huffman Coding- Dijkstra’s (for non-negative weights) Greedy algorithms are simple and fast , when they fit.</li>
</ul>
</section>
<section id="dynamic-programming-dp-1" class="level4">
<h4 class="anchored" data-anchor-id="dynamic-programming-dp-1">4. Dynamic Programming (DP)</h4>
<p>When subproblems overlap, store results and reuse them. Think recursion + memory.</p>
<p>Two main styles:</p>
<ul>
<li><p>Top-Down (Memoization): recursive with caching- Bottom-Up (Tabulation): iterative filling table Used in:</p></li>
<li><p>Fibonacci numbers- Knapsack- Longest Increasing Subsequence (LIS)- Matrix Chain Multiplication DP transforms exponential recursion into polynomial time.</p></li>
</ul>
</section>
<section id="backtracking" class="level4">
<h4 class="anchored" data-anchor-id="backtracking">5. Backtracking</h4>
<p>Explore all possibilities, but prune when constraints fail. It’s brute force with early exits.</p>
<p>Perfect for:</p>
<ul>
<li>N-Queens- Sudoku- Permutation generation- Subset sums Backtracking builds solutions incrementally, abandoning paths that cannot lead to a valid result.</li>
</ul>
</section>
<section id="two-pointers" class="level4">
<h4 class="anchored" data-anchor-id="two-pointers">6. Two Pointers</h4>
<p>Move two indices through a sequence to find patterns or meet conditions.</p>
<p>Common use:</p>
<ul>
<li>Sorted arrays (sum pairs, partitions)- String problems (palindromes, sliding windows)- Linked lists (slow/fast pointers) Simple, but surprisingly powerful.</li>
</ul>
</section>
<section id="sliding-window" class="level4">
<h4 class="anchored" data-anchor-id="sliding-window">7. Sliding Window</h4>
<p>Maintain a window over data, expand or shrink it as needed.</p>
<p>Used for:</p>
<ul>
<li>Maximum sum subarray (Kadane’s algorithm)- Substrings of length k- Longest substring without repeating characters Helps reduce ( O<span class="math inline">\(n^2\)</span> ) to ( O(n) ) in sequence problems.</li>
</ul>
</section>
<section id="binary-search-on-answer" class="level4">
<h4 class="anchored" data-anchor-id="binary-search-on-answer">8. Binary Search on Answer</h4>
<p>Sometimes, the input isn’t sorted , but the answer space is. If you can define a function <code>check(mid)</code> that’s monotonic (true/false changes once), you can apply binary search on possible answers.</p>
<p>Example:</p>
<ul>
<li>Minimum capacity to ship packages in D days- Smallest feasible value satisfying a constraint Powerful for optimization under monotonic conditions.</li>
</ul>
</section>
<section id="graph-based" class="level4">
<h4 class="anchored" data-anchor-id="graph-based">9. Graph-Based</h4>
<p>Think in terms of nodes and edges, paths and flows.</p>
<p>Patterns include:</p>
<ul>
<li>BFS / DFS (exploration)- Topological Sort (ordering)- Dijkstra / Bellman-Ford (shortest paths)- Union-Find (connectivity)- Kruskal / Prim (spanning trees) Graphs often reveal relationships hidden in data.</li>
</ul>
</section>
<section id="meet-in-the-middle" class="level4">
<h4 class="anchored" data-anchor-id="meet-in-the-middle">10. Meet-in-the-Middle</h4>
<p>Split problem into two halves, compute all possibilities for each, and combine efficiently. Used in problems where brute force ( O<span class="math inline">\(2^n\)</span> ) is too large but ( O<span class="math inline">\(2^{n/2}\)</span> ) is manageable.</p>
<p>Example:</p>
<ul>
<li>Subset sum (divide into two halves)- Search problems in combinatorics A clever compromise between brute force and efficiency.</li>
</ul>
</section>
<section id="tiny-code-9" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-9">Tiny Code</h4>
<p>Example: Two Pointers to find pair sum:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find_pair_sum<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> target<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> j <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>i <span class="op">&lt;</span> j<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> sum <span class="op">=</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> arr<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sum <span class="op">==</span> target<span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sum <span class="op">&lt;</span> target<span class="op">)</span> i<span class="op">++;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> j<span class="op">--;</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Works in ( O(n) ) for sorted arrays , elegant and fast.</p>
</section>
<section id="why-it-matters-9" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-9">Why It Matters</h4>
<p>Patterns are mental shortcuts. They turn “blank page” problems into “I’ve seen this shape before.”</p>
<p>Once you recognize the structure, you can choose a suitable pattern and adapt it. This is how top coders solve complex problems under time pressure , not by memorizing algorithms, but by <em>seeing patterns</em>.</p>
</section>
<section id="try-it-yourself-9" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-9">Try It Yourself</h4>
<ol type="1">
<li>Write a brute-force and a divide-and-conquer solution for maximum subarray sum. Compare speed.</li>
<li>Solve the coin change problem using both greedy and DP.</li>
<li>Implement N-Queens with backtracking.</li>
<li>Use two pointers to find the smallest window with a given sum.</li>
<li>Pick a problem you’ve solved before , can you reframe it using a different design pattern?</li>
</ol>
<p>The more patterns you practice, the faster you’ll map new problems to known strategies , and the more powerful your algorithmic intuition will become.</p>
</section>
</section>
</section>
<section id="chapter-2.-sorting-and-searching" class="level2">
<h2 class="anchored" data-anchor-id="chapter-2.-sorting-and-searching">Chapter 2. Sorting and Searching</h2>
<section id="elementary-sorting-bubble-insertion-selection" class="level3">
<h3 class="anchored" data-anchor-id="elementary-sorting-bubble-insertion-selection">11. Elementary Sorting (Bubble, Insertion, Selection)</h3>
<p>Before diving into advanced sorts like mergesort or heapsort, it’s important to understand the elementary sorting algorithms , the building blocks. They’re simple, intuitive, and great for learning how sorting works under the hood.</p>
<p>In this section, we’ll cover three classics:</p>
<ul>
<li>Bubble Sort - swap adjacent out-of-order pairs- Selection Sort - select the smallest element each time- Insertion Sort - insert elements one by one in order These algorithms share ( O<span class="math inline">\(n^2\)</span> ) time complexity but differ in behavior and stability.</li>
</ul>
<section id="bubble-sort-1" class="level4">
<h4 class="anchored" data-anchor-id="bubble-sort-1">1. Bubble Sort</h4>
<p>Idea: Compare adjacent pairs and swap if they’re out of order. Repeat until the array is sorted. Each pass “bubbles” the largest element to the end.</p>
<p>Steps:</p>
<ol type="1">
<li>Compare <code>arr[j]</code> and <code>arr[j+1]</code></li>
<li>Swap if <code>arr[j] &gt; arr[j+1]</code></li>
<li>Continue passes until no swaps are needed</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> bubble_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> swapped <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&gt;</span> arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                arr<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                swapped <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>swapped<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Best: ( O(n) ) (already sorted)- Worst: ( O<span class="math inline">\(n^2\)</span> )- Space: ( O(1) )- Stable: Yes Intuition: Imagine bubbles rising , after each pass, the largest “bubble” settles at the top.</li>
</ul>
</section>
<section id="selection-sort-1" class="level4">
<h4 class="anchored" data-anchor-id="selection-sort-1">2. Selection Sort</h4>
<p>Idea: Find the smallest element and place it at the front.</p>
<p>Steps:</p>
<ol type="1">
<li>For each position <code>i</code>, find the smallest element in the remainder of the array</li>
<li>Swap it with <code>arr[i]</code></li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> selection_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> min_idx <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> arr<span class="op">[</span>min_idx<span class="op">])</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                min_idx <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>min_idx<span class="op">];</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>min_idx<span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Best: ( O<span class="math inline">\(n^2\)</span> )- Worst: ( O<span class="math inline">\(n^2\)</span> )- Space: ( O(1) )- Stable: No Intuition: Selection sort “selects” the next correct element and fixes it. It minimizes swaps but still scans all elements.</li>
</ul>
</section>
<section id="insertion-sort-1" class="level4">
<h4 class="anchored" data-anchor-id="insertion-sort-1">3. Insertion Sort</h4>
<p>Idea: Build a sorted array one element at a time by inserting each new element into its correct position.</p>
<p>Steps:</p>
<ol type="1">
<li>Start from index 1</li>
<li>Compare with previous elements</li>
<li>Shift elements greater than key to the right</li>
<li>Insert key into the correct place</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> insertion_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> key <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>j <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&gt;</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>            arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>            j<span class="op">--;</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Best: ( O(n) ) (nearly sorted)- Worst: ( O<span class="math inline">\(n^2\)</span> )- Space: ( O(1) )- Stable: Yes Intuition: It’s like sorting cards in your hand , take the next card and slide it into the right place.</li>
</ul>
</section>
<section id="comparing-the-three" class="level4">
<h4 class="anchored" data-anchor-id="comparing-the-three">4. Comparing the Three</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Best Case</th>
<th>Average Case</th>
<th>Worst Case</th>
<th>Stable</th>
<th>In-Place</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bubble Sort</td>
<td>O(n)</td>
<td>O(n²)</td>
<td>O(n²)</td>
<td>Yes</td>
<td>Yes</td>
<td>Early exit possible</td>
</tr>
<tr class="even">
<td>Selection Sort</td>
<td>O(n²)</td>
<td>O(n²)</td>
<td>O(n²)</td>
<td>No</td>
<td>Yes</td>
<td>Few swaps</td>
</tr>
<tr class="odd">
<td>Insertion Sort</td>
<td>O(n)</td>
<td>O(n²)</td>
<td>O(n²)</td>
<td>Yes</td>
<td>Yes</td>
<td>Great on small or nearly sorted data</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-10" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-10">Tiny Code</h4>
<p>Let’s see how insertion sort works on <code>[5, 3, 4, 1, 2]</code>:</p>
<ul>
<li>Start with 3 → insert before 5 → <code>[3, 5, 4, 1, 2]</code>- Insert 4 → <code>[3, 4, 5, 1, 2]</code>- Insert 1 → <code>[1, 3, 4, 5, 2]</code>- Insert 2 → <code>[1, 2, 3, 4, 5]</code> Sorted in five passes.</li>
</ul>
</section>
<section id="why-it-matters-10" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-10">Why It Matters</h4>
<p>Elementary sorts teach you:</p>
<ul>
<li>How comparisons and swaps drive order- The trade-off between simplicity and efficiency- How to reason about stability and adaptability While these aren’t used for large datasets in practice, they’re used <em>inside</em> hybrid algorithms like Timsort and IntroSort, which switch to insertion sort for small chunks.</li>
</ul>
</section>
<section id="try-it-yourself-10" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-10">Try It Yourself</h4>
<ol type="1">
<li>Implement all three and print the array after each pass.</li>
<li>Test on arrays: already sorted, reversed, random, partially sorted.</li>
<li>Modify bubble sort to sort descending.</li>
<li>Try insertion sort on 10,000 elements and note its behavior.</li>
<li>Can you detect when the list is already sorted and stop early?</li>
</ol>
<p>Start simple. Master these patterns. They’ll be your foundation for everything from merge sort to radix sort.</p>
</section>
</section>
<section id="divide-and-conquer-sorting-merge-quick-heap" class="level3">
<h3 class="anchored" data-anchor-id="divide-and-conquer-sorting-merge-quick-heap">12. Divide-and-Conquer Sorting (Merge, Quick, Heap)</h3>
<p>Elementary sorts are great for learning, but their (O<span class="math inline">\(n^2\)</span>) runtime quickly becomes a bottleneck. To scale beyond small arrays, we need algorithms that divide problems into smaller parts, sort them independently, and combine the results.</p>
<p>This is the essence of divide and conquer , break it down, solve subproblems, merge solutions. In sorting, this approach yields some of the fastest general-purpose algorithms: Merge Sort, Quick Sort, and Heap Sort.</p>
<section id="merge-sort" class="level4">
<h4 class="anchored" data-anchor-id="merge-sort">1. Merge Sort</h4>
<p>Idea: Split the array in half, sort each half recursively, then merge the two sorted halves.</p>
<p>Merge sort is stable, works well with linked lists, and guarantees (O<span class="math inline">\(n \log n\)</span>) time.</p>
<p>Steps:</p>
<ol type="1">
<li>Divide the array into halves</li>
<li>Recursively sort each half</li>
<li>Merge two sorted halves into one</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> merge<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> m<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n1 <span class="op">=</span> m <span class="op">-</span> l <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n2 <span class="op">=</span> r <span class="op">-</span> m<span class="op">;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> L<span class="op">[</span>n1<span class="op">],</span> R<span class="op">[</span>n2<span class="op">];</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n1<span class="op">;</span> i<span class="op">++)</span> L<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>l <span class="op">+</span> i<span class="op">];</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n2<span class="op">;</span> j<span class="op">++)</span> R<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>m <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> k <span class="op">=</span> l<span class="op">;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>i <span class="op">&lt;</span> n1 <span class="op">&amp;&amp;</span> j <span class="op">&lt;</span> n2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>L<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;=</span> R<span class="op">[</span>j<span class="op">])</span> arr<span class="op">[</span>k<span class="op">++]</span> <span class="op">=</span> L<span class="op">[</span>i<span class="op">++];</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> arr<span class="op">[</span>k<span class="op">++]</span> <span class="op">=</span> R<span class="op">[</span>j<span class="op">++];</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>i <span class="op">&lt;</span> n1<span class="op">)</span> arr<span class="op">[</span>k<span class="op">++]</span> <span class="op">=</span> L<span class="op">[</span>i<span class="op">++];</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>j <span class="op">&lt;</span> n2<span class="op">)</span> arr<span class="op">[</span>k<span class="op">++]</span> <span class="op">=</span> R<span class="op">[</span>j<span class="op">++];</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> merge_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">&lt;</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> m <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        merge_sort<span class="op">(</span>arr<span class="op">,</span> l<span class="op">,</span> m<span class="op">);</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>        merge_sort<span class="op">(</span>arr<span class="op">,</span> m <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">);</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        merge<span class="op">(</span>arr<span class="op">,</span> l<span class="op">,</span> m<span class="op">,</span> r<span class="op">);</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Time: (O<span class="math inline">\(n \log n\)</span>) (always)- Space: (O(n)) (temporary arrays)- Stable: Yes Merge sort is predictable, making it ideal for external sorting (like sorting data on disk).</li>
</ul>
</section>
<section id="quick-sort" class="level4">
<h4 class="anchored" data-anchor-id="quick-sort">2. Quick Sort</h4>
<p>Idea: Pick a pivot, partition the array so smaller elements go left and larger go right, then recursively sort both sides.</p>
<p>Quick sort is usually the fastest in practice due to good cache locality and low constant factors.</p>
<p>Steps:</p>
<ol type="1">
<li>Choose a pivot (often middle or random)</li>
<li>Partition: move smaller elements to left, larger to right</li>
<li>Recursively sort the two partitions</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> partition<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot <span class="op">=</span> arr<span class="op">[</span>high<span class="op">];</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> low <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> low<span class="op">;</span> j <span class="op">&lt;</span> high<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> pivot<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>            i<span class="op">++;</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> tmp <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>j<span class="op">];</span> arr<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tmp <span class="op">=</span> arr<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">];</span> arr<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>high<span class="op">];</span> arr<span class="op">[</span>high<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> quick_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>low <span class="op">&lt;</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> pi <span class="op">=</span> partition<span class="op">(</span>arr<span class="op">,</span> low<span class="op">,</span> high<span class="op">);</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        quick_sort<span class="op">(</span>arr<span class="op">,</span> low<span class="op">,</span> pi <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        quick_sort<span class="op">(</span>arr<span class="op">,</span> pi <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> high<span class="op">);</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Best / Average: (O<span class="math inline">\(n \log n\)</span>)- Worst: (O<span class="math inline">\(n^2\)</span>) (bad pivot, e.g.&nbsp;sorted input with naive pivot)- Space: (O<span class="math inline">\(\log n\)</span>) (recursion)- Stable: No (unless modified) Quick sort is often used in standard libraries due to its efficiency in real-world workloads.</li>
</ul>
</section>
<section id="heap-sort" class="level4">
<h4 class="anchored" data-anchor-id="heap-sort">3. Heap Sort</h4>
<p>Idea: Turn the array into a heap, repeatedly extract the largest element, and place it at the end.</p>
<p>A heap is a binary tree where every parent is ≥ its children (max-heap).</p>
<p>Steps:</p>
<ol type="1">
<li>Build a max-heap</li>
<li>Swap the root (max) with the last element</li>
<li>Reduce heap size, re-heapify</li>
<li>Repeat until sorted</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> heapify<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> largest <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> l <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> r <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> i <span class="op">+</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">&lt;</span> n <span class="op">&amp;&amp;</span> arr<span class="op">[</span>l<span class="op">]</span> <span class="op">&gt;</span> arr<span class="op">[</span>largest<span class="op">])</span> largest <span class="op">=</span> l<span class="op">;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;</span> n <span class="op">&amp;&amp;</span> arr<span class="op">[</span>r<span class="op">]</span> <span class="op">&gt;</span> arr<span class="op">[</span>largest<span class="op">])</span> largest <span class="op">=</span> r<span class="op">;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>largest <span class="op">!=</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tmp <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>largest<span class="op">];</span> arr<span class="op">[</span>largest<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        heapify<span class="op">(</span>arr<span class="op">,</span> n<span class="op">,</span> largest<span class="op">);</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> heap_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        heapify<span class="op">(</span>arr<span class="op">,</span> n<span class="op">,</span> i<span class="op">);</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tmp <span class="op">=</span> arr<span class="op">[</span><span class="dv">0</span><span class="op">];</span> arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        heapify<span class="op">(</span>arr<span class="op">,</span> i<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Time: (O<span class="math inline">\(n \log n\)</span>)- Space: (O(1))- Stable: No Heap sort is reliable and space-efficient but less cache-friendly than quicksort.</li>
</ul>
</section>
<section id="comparison" class="level4">
<h4 class="anchored" data-anchor-id="comparison">4. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Best Case</th>
<th>Average Case</th>
<th>Worst Case</th>
<th>Space</th>
<th>Stable</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Merge Sort</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>O(n)</td>
<td>Yes</td>
<td>Predictable, stable</td>
</tr>
<tr class="even">
<td>Quick Sort</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>O(n²)</td>
<td>O(log n)</td>
<td>No</td>
<td>Fast in practice</td>
</tr>
<tr class="odd">
<td>Heap Sort</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>O(1)</td>
<td>No</td>
<td>In-place, robust</td>
</tr>
</tbody>
</table>
<p>Each one fits a niche:</p>
<ul>
<li>Merge Sort → stability and guarantees- Quick Sort → speed and cache performance- Heap Sort → low memory usage and simplicity</li>
</ul>
</section>
<section id="tiny-code-11" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-11">Tiny Code</h4>
<p>Try sorting <code>[5, 1, 4, 2, 8]</code> with merge sort:</p>
<ol type="1">
<li>Split → <code>[5,1,4]</code>, <code>[2,8]</code></li>
<li>Sort each → <code>[1,4,5]</code>, <code>[2,8]</code></li>
<li>Merge → <code>[1,2,4,5,8]</code></li>
</ol>
<p>Each recursive split halves the problem, yielding (O<span class="math inline">\(\log n\)</span>) depth with (O(n)) work per level.</p>
</section>
<section id="why-it-matters-11" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-11">Why It Matters</h4>
<p>Divide-and-conquer sorting is the foundation for efficient order processing. It introduces ideas you’ll reuse in:</p>
<ul>
<li>Binary search (halving)- Matrix multiplication- Fast Fourier Transform- Dynamic programming These sorts teach how recursion, partitioning, and merging combine into scalable solutions.</li>
</ul>
</section>
<section id="try-it-yourself-11" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-11">Try It Yourself</h4>
<ol type="1">
<li>Implement merge sort, quick sort, and heap sort.</li>
<li>Test all three on the same random array. Compare runtime.</li>
<li>Modify quick sort to use a random pivot.</li>
<li>Build a stable version of heap sort.</li>
<li>Visualize merge sort’s recursion tree and merging process.</li>
</ol>
<p>Mastering these sorts gives you a template for solving any divide-and-conquer problem efficiently.</p>
</section>
</section>
<section id="counting-and-distribution-sorts-counting-radix-bucket" class="level3">
<h3 class="anchored" data-anchor-id="counting-and-distribution-sorts-counting-radix-bucket">13. Counting and Distribution Sorts (Counting, Radix, Bucket)</h3>
<p>So far, we’ve seen comparison-based sorts like merge sort and quicksort. These rely on comparing elements and are bounded by the O(n log n) lower limit for comparisons.</p>
<p>But what if you don’t need to compare elements directly , what if they’re integers or values from a limited range?</p>
<p>That’s where counting and distribution sorts come in. They exploit structure, not just order, to achieve linear-time sorting in the right conditions.</p>
<section id="counting-sort" class="level4">
<h4 class="anchored" data-anchor-id="counting-sort">1. Counting Sort</h4>
<p>Idea: If your elements are integers in a known range ([0, k)), you can count occurrences of each value, then reconstruct the sorted output.</p>
<p>Counting sort doesn’t compare , it counts.</p>
<p>Steps:</p>
<ol type="1">
<li>Find the range of input (max value (k))</li>
<li>Count occurrences in a frequency array</li>
<li>Convert counts to cumulative counts</li>
<li>Place elements into their sorted positions</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> counting_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count<span class="op">[</span>k <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> output<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span> count<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> count<span class="op">[</span>arr<span class="op">[</span>i<span class="op">]]++;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> i<span class="op">++)</span> count<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> count<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        output<span class="op">[</span>count<span class="op">[</span>arr<span class="op">[</span>i<span class="op">]]</span> <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>        count<span class="op">[</span>arr<span class="op">[</span>i<span class="op">]]--;</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> output<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [4, 2, 2, 8, 3, 3, 1], k = 8 → count = [0,1,2,2,1,0,0,0,1] → cumulative = [0,1,3,5,6,6,6,6,7] → sorted = [1,2,2,3,3,4,8]</p>
<p>Complexity:</p>
<ul>
<li><p>Time: (O(n + k))- Space: (O(k))- Stable: Yes When to use:</p></li>
<li><p>Input is integers- Range (k) not much larger than (n)</p></li>
</ul>
</section>
<section id="radix-sort" class="level4">
<h4 class="anchored" data-anchor-id="radix-sort">2. Radix Sort</h4>
<p>Idea: Sort digits one at a time, from least significant (LSD) or most significant (MSD), using a stable sub-sort like counting sort.</p>
<p>Radix sort works best when all elements have fixed-length representations (e.g., integers, strings of equal length).</p>
<p>Steps (LSD method):</p>
<ol type="1">
<li>For each digit position (from rightmost to leftmost)</li>
<li>Sort all elements by that digit using a stable sort (like counting sort)</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> get_max<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mx <span class="op">=</span> arr<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> mx<span class="op">)</span> mx <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mx<span class="op">;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> counting_sort_digit<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> exp<span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> output<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count<span class="op">[</span><span class="dv">10</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        count<span class="op">[(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">/</span> exp<span class="op">)</span> <span class="op">%</span> <span class="dv">10</span><span class="op">]++;</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        count<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> count<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> digit <span class="op">=</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">/</span> exp<span class="op">)</span> <span class="op">%</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        output<span class="op">[</span>count<span class="op">[</span>digit<span class="op">]</span> <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>        count<span class="op">[</span>digit<span class="op">]--;</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> output<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> radix_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> m <span class="op">=</span> get_max<span class="op">(</span>arr<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> exp <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> m <span class="op">/</span> exp <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> exp <span class="op">*=</span> <span class="dv">10</span><span class="op">)</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>        counting_sort_digit<span class="op">(</span>arr<span class="op">,</span> n<span class="op">,</span> exp<span class="op">);</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [170, 45, 75, 90, 802, 24, 2, 66] → sort by 1s → 10s → 100s → final = [2, 24, 45, 66, 75, 90, 170, 802]</p>
<p>Complexity:</p>
<ul>
<li>Time: (O(d (n + b))), where
<ul>
<li>(d): number of digits - (b): base (10 for decimal)- Space: (O(n + b))- Stable: Yes When to use:</li>
</ul></li>
<li>Fixed-length numbers- Bounded digits (e.g., base 10 or 2)</li>
</ul>
</section>
<section id="bucket-sort" class="level4">
<h4 class="anchored" data-anchor-id="bucket-sort">3. Bucket Sort</h4>
<p>Idea: Divide elements into buckets based on value ranges, sort each bucket individually, then concatenate.</p>
<p>Works best when data is uniformly distributed in a known interval.</p>
<p>Steps:</p>
<ol type="1">
<li>Create (k) buckets for value ranges</li>
<li>Distribute elements into buckets</li>
<li>Sort each bucket (often using insertion sort)</li>
<li>Merge buckets</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> bucket_sort<span class="op">(</span><span class="dt">float</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">float</span><span class="op">&gt;</span> buckets<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> idx <span class="op">=</span> n <span class="op">*</span> arr<span class="op">[</span>i<span class="op">];</span> <span class="co">// assuming 0 &lt;= arr[i] &lt; 1</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        buckets<span class="op">[</span>idx<span class="op">].</span>push_back<span class="op">(</span>arr<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        sort<span class="op">(</span>buckets<span class="op">[</span>i<span class="op">].</span>begin<span class="op">(),</span> buckets<span class="op">[</span>i<span class="op">].</span>end<span class="op">());</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">float</span> val <span class="op">:</span> buckets<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>            arr<span class="op">[</span>idx<span class="op">++]</span> <span class="op">=</span> val<span class="op">;</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li><p>Average: (O(n + k))- Worst: (O<span class="math inline">\(n^2\)</span>) (if all fall in one bucket)- Space: (O(n + k))- Stable: Depends on bucket sort method When to use:</p></li>
<li><p>Real numbers uniformly distributed in ([0,1))</p></li>
</ul>
</section>
<section id="comparison-1" class="level4">
<h4 class="anchored" data-anchor-id="comparison-1">4. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 23%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Time</th>
<th>Space</th>
<th>Stable</th>
<th>Type</th>
<th>Best Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Counting Sort</td>
<td>O(n + k)</td>
<td>O(k)</td>
<td>Yes</td>
<td>Non-comparison</td>
<td>Small integer range</td>
</tr>
<tr class="even">
<td>Radix Sort</td>
<td>O(d(n + b))</td>
<td>O(n + b)</td>
<td>Yes</td>
<td>Non-comparison</td>
<td>Fixed-length numbers</td>
</tr>
<tr class="odd">
<td>Bucket Sort</td>
<td>O(n + k) avg</td>
<td>O(n + k)</td>
<td>Often</td>
<td>Distribution-based</td>
<td>Uniform floats</td>
</tr>
</tbody>
</table>
<p>These algorithms achieve O(n) behavior when assumptions hold , they’re specialized but incredibly fast when applicable.</p>
</section>
<section id="tiny-code-12" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-12">Tiny Code</h4>
<p>Let’s walk counting sort on <code>arr = [4, 2, 2, 8, 3, 3, 1]</code>:</p>
<ul>
<li>Count occurrences → [1,2,2,1,0,0,0,1]- Cumulative count → positions- Place elements → [1,2,2,3,3,4,8] Sorted , no comparisons.</li>
</ul>
</section>
<section id="why-it-matters-12" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-12">Why It Matters</h4>
<p>Distribution sorts teach a key insight:</p>
<blockquote class="blockquote">
<p>If you know the structure of your data, you can sort faster than comparison allows.</p>
</blockquote>
<p>They show how data properties , range, distribution, digit length , can drive algorithm design.</p>
<p>You’ll meet these ideas again in:</p>
<ul>
<li>Hashing (bucketing)- Indexing (range partitioning)- Machine learning (binning, histogramming)</li>
</ul>
</section>
<section id="try-it-yourself-12" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-12">Try It Yourself</h4>
<ol type="1">
<li>Implement counting sort for integers from 0 to 100.</li>
<li>Extend radix sort to sort strings by character.</li>
<li>Visualize bucket sort for values between 0 and 1.</li>
<li>What happens if you use counting sort on negative numbers? Fix it.</li>
<li>Compare counting vs quick sort on small integer arrays.</li>
</ol>
<p>These are the first glimpses of linear-time sorting , harnessing knowledge about data to break the (O<span class="math inline">\(n \log n\)</span>) barrier.</p>
</section>
</section>
<section id="hybrid-sorts-introsort-timsort" class="level3">
<h3 class="anchored" data-anchor-id="hybrid-sorts-introsort-timsort">14. Hybrid Sorts (IntroSort, Timsort)</h3>
<p>In practice, no single sorting algorithm is perfect for all cases. Some are fast on average but fail in worst cases (like Quick Sort). Others are consistent but slow due to overhead (like Merge Sort). Hybrid sorting algorithms combine multiple techniques to get the <em>best of all worlds</em> , practical speed, stability, and guaranteed performance.</p>
<p>Two of the most widely used hybrids in modern systems are IntroSort and Timsort , both power the sorting functions in major programming languages.</p>
<section id="the-idea-behind-hybrid-sorting" class="level4">
<h4 class="anchored" data-anchor-id="the-idea-behind-hybrid-sorting">1. The Idea Behind Hybrid Sorting</h4>
<p>Real-world data is messy: sometimes nearly sorted, sometimes random, sometimes pathological. A smart sorting algorithm should adapt to the data.</p>
<p>Hybrids switch between different strategies based on:</p>
<ul>
<li>Input size- Recursion depth- Degree of order- Performance thresholds So, the algorithm “introspects” or “adapts” while running.</li>
</ul>
</section>
<section id="introsort" class="level4">
<h4 class="anchored" data-anchor-id="introsort">2. IntroSort</h4>
<p>IntroSort (short for <em>introspective sort</em>) begins like Quick Sort, but when recursion gets too deep , which means Quick Sort’s worst case may be coming , it switches to Heap Sort to guarantee (O<span class="math inline">\(n \log n\)</span>) time.</p>
<p>Steps:</p>
<ol type="1">
<li>Use Quick Sort as long as recursion depth &lt; <span class="math inline">\(2 \log n\)</span></li>
<li>If depth exceeds limit → switch to Heap Sort</li>
<li>For very small subarrays → switch to Insertion Sort</li>
</ol>
<p>This triple combo ensures:</p>
<ul>
<li>Fast average case (Quick Sort)- Guaranteed upper bound (Heap Sort)- Efficiency on small arrays (Insertion Sort) Code Sketch:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> intro_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> depth_limit <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> log<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    intro_sort_util<span class="op">(</span>arr<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> depth_limit<span class="op">);</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> intro_sort_util<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> begin<span class="op">,</span> <span class="dt">int</span> end<span class="op">,</span> <span class="dt">int</span> depth_limit<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> size <span class="op">=</span> end <span class="op">-</span> begin <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>size <span class="op">&lt;</span> <span class="dv">16</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        insertion_sort<span class="op">(</span>arr <span class="op">+</span> begin<span class="op">,</span> size<span class="op">);</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>depth_limit <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        heap_sort_range<span class="op">(</span>arr<span class="op">,</span> begin<span class="op">,</span> end<span class="op">);</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot <span class="op">=</span> partition<span class="op">(</span>arr<span class="op">,</span> begin<span class="op">,</span> end<span class="op">);</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    intro_sort_util<span class="op">(</span>arr<span class="op">,</span> begin<span class="op">,</span> pivot <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> depth_limit <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    intro_sort_util<span class="op">(</span>arr<span class="op">,</span> pivot <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> end<span class="op">,</span> depth_limit <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li><p>Average: (O<span class="math inline">\(n \log n\)</span>)- Worst: (O<span class="math inline">\(n \log n\)</span>)- Space: (O<span class="math inline">\(\log n\)</span>)- Stable: No (depends on partition scheme) Used in:</p></li>
<li><p>C++ STL’s <code>std::sort</code>- Many systems where performance guarantees matter</p></li>
</ul>
</section>
<section id="timsort" class="level4">
<h4 class="anchored" data-anchor-id="timsort">3. Timsort</h4>
<p>Timsort is a stable hybrid combining Insertion Sort and Merge Sort. It was designed to handle real-world data, which often has runs (already sorted segments).</p>
<p>Developed by Tim Peters (Python core dev), Timsort is now used in:</p>
<ul>
<li><p>Python’s <code>sorted()</code> and <code>.sort()</code>- Java’s <code>Arrays.sort()</code> for objects Idea:</p></li>
<li><p>Identify runs , segments already ascending or descending- Reverse descending runs (to make them ascending)- Sort small runs with Insertion Sort- Merge runs with Merge Sort Timsort adapts beautifully to partially ordered data.</p></li>
</ul>
<p>Steps:</p>
<ol type="1">
<li>Scan array, detect runs (sequences already sorted)</li>
<li>Push runs to a stack</li>
<li>Merge runs using a carefully balanced merge strategy</li>
</ol>
<p>Pseudocode (simplified):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> timsort(arr):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    RUN <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(arr)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 1: sort small chunks</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, RUN):</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        insertion_sort(arr, i, <span class="bu">min</span>((i <span class="op">+</span> RUN <span class="op">-</span> <span class="dv">1</span>), n <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2: merge sorted runs</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    size <span class="op">=</span> RUN</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> size <span class="op">&lt;</span> n:</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n, size <span class="op">*</span> <span class="dv">2</span>):</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>            mid <span class="op">=</span> start <span class="op">+</span> size <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>            end <span class="op">=</span> <span class="bu">min</span>(start <span class="op">+</span> size <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>, n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>            merge(arr, start, mid, end)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        size <span class="op">*=</span> <span class="dv">2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li><p>Best: (O(n)) (already sorted data)- Average: (O<span class="math inline">\(n \log n\)</span>)- Worst: (O<span class="math inline">\(n \log n\)</span>)- Space: (O(n))- Stable: Yes Key Strengths:</p></li>
<li><p>Excellent for real-world, partially sorted data- Stable (keeps equal keys in order)- Optimized merges (adaptive merging)</p></li>
</ul>
</section>
<section id="comparison-2" class="level4">
<h4 class="anchored" data-anchor-id="comparison-2">4. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 28%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Base Methods</th>
<th>Stability</th>
<th>Best</th>
<th>Average</th>
<th>Worst</th>
<th>Real Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>IntroSort</td>
<td>Quick + Heap + Insertion</td>
<td>No</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>C++ STL</td>
</tr>
<tr class="even">
<td>Timsort</td>
<td>Merge + Insertion</td>
<td>Yes</td>
<td>O(n)</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>Python, Java</td>
</tr>
</tbody>
</table>
<p>IntroSort prioritizes performance guarantees. Timsort prioritizes adaptivity and stability.</p>
<p>Both show that “one size fits all” sorting doesn’t exist , great systems detect <em>what’s going on</em> and adapt.</p>
</section>
<section id="tiny-code-13" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-13">Tiny Code</h4>
<p>Suppose we run Timsort on <code>[1, 2, 3, 7, 6, 5, 8, 9]</code>:</p>
<ul>
<li>Detect runs: <code>[1,2,3]</code>, <code>[7,6,5]</code>, <code>[8,9]</code>- Reverse <code>[7,6,5]</code> → <code>[5,6,7]</code>- Merge runs → <code>[1,2,3,5,6,7,8,9]</code> Efficient because it leverages the existing order.</li>
</ul>
</section>
<section id="why-it-matters-13" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-13">Why It Matters</h4>
<p>Hybrid sorts are the real-world heroes , they combine theory with practice. They teach an important principle:</p>
<blockquote class="blockquote">
<p>When one algorithm’s weakness shows up, switch to another’s strength.</p>
</blockquote>
<p>These are not academic curiosities , they’re in your compiler, your browser, your OS, your database. Understanding them means you understand how modern languages optimize fundamental operations.</p>
</section>
<section id="try-it-yourself-13" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-13">Try It Yourself</h4>
<ol type="1">
<li>Implement IntroSort and test on random, sorted, and reverse-sorted arrays.</li>
<li>Simulate Timsort’s run detection on nearly sorted input.</li>
<li>Compare sorting speed of Insertion Sort vs Timsort for small arrays.</li>
<li>Add counters to Quick Sort and see when IntroSort should switch.</li>
<li>Explore Python’s <code>sorted()</code> with different input shapes , guess when it uses merge vs insertion.</li>
</ol>
<p>Hybrid sorts remind us: good algorithms adapt , they’re not rigid, they’re smart.</p>
</section>
</section>
<section id="special-sorts-cycle-gnome-comb-pancake" class="level3">
<h3 class="anchored" data-anchor-id="special-sorts-cycle-gnome-comb-pancake">15. Special Sorts (Cycle, Gnome, Comb, Pancake)</h3>
<p>Not all sorting algorithms follow the mainstream divide-and-conquer or distribution paradigms. Some were designed to solve niche problems, to illustrate elegant ideas, or simply to experiment with different mechanisms of ordering.</p>
<p>These special sorts, Cycle Sort, Gnome Sort, Comb Sort, and Pancake Sort, are fascinating not because they’re the fastest, but because they reveal creative ways to think about permutation, local order, and in-place operations.</p>
<section id="cycle-sort" class="level4">
<h4 class="anchored" data-anchor-id="cycle-sort">1. Cycle Sort</h4>
<p>Idea: Minimize the number of writes. Cycle sort rearranges elements into cycles, placing each value directly in its correct position. It performs exactly as many writes as there are misplaced elements, making it ideal for flash memory or systems where writes are expensive.</p>
<p>Steps:</p>
<ol type="1">
<li>For each position <code>i</code>, find where <code>arr[i]</code> belongs (its rank).</li>
<li>If it’s not already there, swap it into position.</li>
<li>Continue the cycle until the current position is correct.</li>
<li>Move to the next index.</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> cycle_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> cycle_start <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> cycle_start <span class="op">&lt;</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> cycle_start<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> item <span class="op">=</span> arr<span class="op">[</span>cycle_start<span class="op">];</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> pos <span class="op">=</span> cycle_start<span class="op">;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> cycle_start <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;</span> item<span class="op">)</span> pos<span class="op">++;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>pos <span class="op">==</span> cycle_start<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>item <span class="op">==</span> arr<span class="op">[</span>pos<span class="op">])</span> pos<span class="op">++;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>pos<span class="op">]</span> <span class="op">=</span> item<span class="op">;</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        item <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>pos <span class="op">!=</span> cycle_start<span class="op">)</span> <span class="op">{</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>            pos <span class="op">=</span> cycle_start<span class="op">;</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> cycle_start <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;</span> item<span class="op">)</span> pos<span class="op">++;</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="op">(</span>item <span class="op">==</span> arr<span class="op">[</span>pos<span class="op">])</span> pos<span class="op">++;</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>            temp <span class="op">=</span> arr<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>            arr<span class="op">[</span>pos<span class="op">]</span> <span class="op">=</span> item<span class="op">;</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>            item <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Time: (O<span class="math inline">\(n^2\)</span>)- Writes: minimal (exactly n-c, where c = #cycles)- Stable: No Use Case: When minimizing writes is more important than runtime.</li>
</ul>
</section>
<section id="gnome-sort" class="level4">
<h4 class="anchored" data-anchor-id="gnome-sort">2. Gnome Sort</h4>
<p>Idea: A simpler variation of insertion sort. Gnome sort moves back and forth like a “gnome” tidying flower pots: if two adjacent pots are out of order, swap and step back; otherwise, move forward.</p>
<p>Steps:</p>
<ol type="1">
<li>Start at index 1</li>
<li>If <code>arr[i] &gt;= arr[i-1]</code>, move forward</li>
<li>Else, swap and step back (if possible)</li>
<li>Repeat until the end</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> gnome_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>i <span class="op">&lt;</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;=</span> arr<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> i<span class="op">++;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span> arr<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>            i<span class="op">--;</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Time: (O<span class="math inline">\(n^2\)</span>)- Space: (O(1))- Stable: Yes Use Case: Educational simplicity. It’s a readable form of insertion logic without nested loops.</li>
</ul>
</section>
<section id="comb-sort" class="level4">
<h4 class="anchored" data-anchor-id="comb-sort">3. Comb Sort</h4>
<p>Idea: An improvement over Bubble Sort by introducing a gap between compared elements, shrinking it gradually. By jumping farther apart early, Comb Sort helps eliminate small elements that are “stuck” near the end.</p>
<p>Steps:</p>
<ol type="1">
<li>Start with gap = n</li>
<li>On each pass, shrink gap = gap / 1.3</li>
<li>Compare and swap items <code>gap</code> apart</li>
<li>Stop when gap = 1 and no swaps occur</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> comb_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> gap <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> swapped <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>gap <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">||</span> swapped<span class="op">)</span> <span class="op">{</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>        gap <span class="op">=</span> <span class="op">(</span>gap <span class="op">*</span> <span class="dv">10</span><span class="op">)</span> <span class="op">/</span> <span class="dv">13</span><span class="op">;</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>gap <span class="op">==</span> <span class="dv">9</span> <span class="op">||</span> gap <span class="op">==</span> <span class="dv">10</span><span class="op">)</span> gap <span class="op">=</span> <span class="dv">11</span><span class="op">;</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>gap <span class="op">&lt;</span> <span class="dv">1</span><span class="op">)</span> gap <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        swapped <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">+</span> gap <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> arr<span class="op">[</span>i <span class="op">+</span> gap<span class="op">])</span> <span class="op">{</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>i <span class="op">+</span> gap<span class="op">];</span> arr<span class="op">[</span>i <span class="op">+</span> gap<span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                swapped <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Average: (O<span class="math inline">\(n \log n\)</span>)- Worst: (O<span class="math inline">\(n^2\)</span>)- Space: (O(1))- Stable: No Use Case: When a simple, in-place, nearly linear-time alternative to bubble sort is desired.</li>
</ul>
</section>
<section id="pancake-sort" class="level4">
<h4 class="anchored" data-anchor-id="pancake-sort">4. Pancake Sort</h4>
<p>Idea: Sort an array using only one operation: flip (reversing a prefix). It’s like sorting pancakes on a plate, flip the stack so the largest pancake goes to the bottom, then repeat for the rest.</p>
<p>Steps:</p>
<ol type="1">
<li>Find the maximum unsorted element</li>
<li>Flip it to the front</li>
<li>Flip it again to its correct position</li>
<li>Reduce the unsorted portion by one</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> flip<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> start <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>start <span class="op">&lt;</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>start<span class="op">];</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>start<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>        start<span class="op">++;</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        i<span class="op">--;</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> pancake_sort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> curr_size <span class="op">=</span> n<span class="op">;</span> curr_size <span class="op">&gt;</span> <span class="dv">1</span><span class="op">;</span> curr_size<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mi <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> curr_size<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> arr<span class="op">[</span>mi<span class="op">])</span> mi <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mi <span class="op">!=</span> curr_size <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>            flip<span class="op">(</span>arr<span class="op">,</span> mi<span class="op">);</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>            flip<span class="op">(</span>arr<span class="op">,</span> curr_size <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Time: (O<span class="math inline">\(n^2\)</span>)- Space: (O(1))- Stable: No Fun Fact: Pancake sort is the only known algorithm whose operations mimic a kitchen utensil, and inspired the Burnt Pancake Problem in combinatorics and genome rearrangement theory.</li>
</ul>
</section>
<section id="comparison-3" class="level4">
<h4 class="anchored" data-anchor-id="comparison-3">5. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 20%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Time</th>
<th>Space</th>
<th>Stable</th>
<th>Distinctive Trait</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cycle Sort</td>
<td>O(n²)</td>
<td>O(1)</td>
<td>No</td>
<td>Minimal writes</td>
</tr>
<tr class="even">
<td>Gnome Sort</td>
<td>O(n²)</td>
<td>O(1)</td>
<td>Yes</td>
<td>Simple insertion-like behavior</td>
</tr>
<tr class="odd">
<td>Comb Sort</td>
<td>O(n log n) avg</td>
<td>O(1)</td>
<td>No</td>
<td>Shrinking gap, improved bubble</td>
</tr>
<tr class="even">
<td>Pancake Sort</td>
<td>O(n²)</td>
<td>O(1)</td>
<td>No</td>
<td>Prefix reversals only</td>
</tr>
</tbody>
</table>
<p>Each highlights a different design goal:</p>
<ul>
<li>Cycle: minimize writes- Gnome: simplify logic- Comb: optimize comparisons- Pancake: restrict operations</li>
</ul>
</section>
<section id="tiny-code-14" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-14">Tiny Code</h4>
<p>Example (Pancake Sort on <code>[3, 6, 1, 9]</code>):</p>
<ol type="1">
<li>Max = 9 at index 3 → flip(3) → <code>[9,1,6,3]</code></li>
<li>flip(3) → <code>[3,6,1,9]</code> (9 fixed)</li>
<li>Max = 6 → flip(1) → <code>[6,3,1,9]</code></li>
<li>flip(2) → <code>[1,3,6,9]</code></li>
</ol>
<p>Sorted using only flips.</p>
</section>
<section id="why-it-matters-14" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-14">Why It Matters</h4>
<p>Special sorts show there’s more than one way to think about ordering. They’re laboratories for exploring new ideas: minimizing swaps, limiting operations, or optimizing stability. Even if they’re not the go-to in production, they deepen your intuition about sorting mechanics.</p>
</section>
<section id="try-it-yourself-14" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-14">Try It Yourself</h4>
<ol type="1">
<li>Implement each algorithm and visualize their operations step-by-step.</li>
<li>Measure how many writes Cycle Sort performs vs.&nbsp;others.</li>
<li>Compare Gnome and Insertion sort on nearly sorted arrays.</li>
<li>Modify Comb Sort’s shrink factor, how does performance change?</li>
<li>Write Pancake Sort with printouts of every flip to see the “stack” in motion.</li>
</ol>
<p>These quirky algorithms prove that sorting isn’t just science, it’s also art and experimentation.</p>
</section>
</section>
<section id="linear-and-binary-search" class="level3">
<h3 class="anchored" data-anchor-id="linear-and-binary-search">16. Linear and Binary Search</h3>
<p>Searching is the process of finding a target value within a collection of data. Depending on whether the data is sorted or unsorted, you’ll use different strategies.</p>
<p>In this section, we revisit two of the most fundamental searching methods , Linear Search and Binary Search , and see how they underpin many higher-level algorithms and data structures.</p>
<section id="linear-search-1" class="level4">
<h4 class="anchored" data-anchor-id="linear-search-1">1. Linear Search</h4>
<p>Idea: Check each element one by one until you find the target. This is the simplest possible search and works on unsorted data.</p>
<p>Steps:</p>
<ol type="1">
<li>Start from index 0</li>
<li>Compare <code>arr[i]</code> with the target</li>
<li>If match, return index</li>
<li>If end reached, return -1</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> linear_search<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [7, 2, 4, 9, 1], key = 9</p>
<ul>
<li><p>Compare 7, 2, 4, then 9 → found at index 3 Complexity:</p></li>
<li><p>Time: ( O(n) )- Space: ( O(1) )- Best case: ( O(1) ) (first element)- Worst case: ( O(n) ) Pros:</p></li>
<li><p>Works on any data (sorted or unsorted)- Simple to implement Cons:</p></li>
<li><p>Inefficient on large arrays Use it when data is small or unsorted, or when simplicity matters more than speed.</p></li>
</ul>
</section>
<section id="binary-search-1" class="level4">
<h4 class="anchored" data-anchor-id="binary-search-1">2. Binary Search</h4>
<p>Idea: If the array is sorted, you can repeatedly halve the search space. Compare the middle element to the target , if it’s greater, search left; if smaller, search right.</p>
<p>Steps:</p>
<ol type="1">
<li>Find the midpoint</li>
<li>If <code>arr[mid] == key</code>, done</li>
<li>If <code>arr[mid] &gt; key</code>, search left</li>
<li>If <code>arr[mid] &lt; key</code>, search right</li>
<li>Repeat until range is empty</li>
</ol>
<p>Iterative Version:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> binary_search<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> low <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> high <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>low <span class="op">&lt;=</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>low <span class="op">+</span> high<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> mid<span class="op">;</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">&lt;</span> key<span class="op">)</span> low <span class="op">=</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> high <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Recursive Version:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> binary_search_rec<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>low <span class="op">&gt;</span> high<span class="op">)</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>low <span class="op">+</span> high<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> mid<span class="op">;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">&gt;</span> key<span class="op">)</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> binary_search_rec<span class="op">(</span>arr<span class="op">,</span> low<span class="op">,</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> key<span class="op">);</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> binary_search_rec<span class="op">(</span>arr<span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> high<span class="op">,</span> key<span class="op">);</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [1, 3, 5, 7, 9, 11], key = 7</p>
<ul>
<li><p>mid = 5 → key &gt; mid → move right- mid = 7 → found Complexity:</p></li>
<li><p>Time: ( O<span class="math inline">\(\log n\)</span> )- Space: ( O(1) ) (iterative) or ( O<span class="math inline">\(\log n\)</span> ) (recursive)- Best case: ( O(1) ) (middle element) Requirements:</p></li>
<li><p>Must be sorted- Must have random access (array, not linked list) Pros:</p></li>
<li><p>Very fast for large sorted arrays- Foundation for advanced searches (e.g.&nbsp;interpolation, exponential) Cons:</p></li>
<li><p>Needs sorted data- Doesn’t adapt to frequent insertions/deletions</p></li>
</ul>
</section>
<section id="binary-search-variants" class="level4">
<h4 class="anchored" data-anchor-id="binary-search-variants">3. Binary Search Variants</h4>
<p>Binary search is a <em>pattern</em> as much as a single algorithm. You can tweak it to find:</p>
<ul>
<li>First occurrence: move left if <code>arr[mid] == key</code>- Last occurrence: move right if <code>arr[mid] == key</code>- Lower bound: first index ≥ key- Upper bound: first index &gt; key Example (Lower Bound):</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> lower_bound<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> low <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> high <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>low <span class="op">&lt;</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>low <span class="op">+</span> high<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">&lt;</span> key<span class="op">)</span> low <span class="op">=</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> high <span class="op">=</span> mid<span class="op">;</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> low<span class="op">;</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Usage: These variants power functions like <code>std::lower_bound()</code> in C++ and binary search trees’ lookup logic.</p>
</section>
<section id="comparison-4" class="level4">
<h4 class="anchored" data-anchor-id="comparison-4">4. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 23%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Works On</th>
<th>Time</th>
<th>Space</th>
<th>Sorted Data Needed</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linear Search</td>
<td>Any</td>
<td>O(n)</td>
<td>O(1)</td>
<td>No</td>
<td>Best for small/unsorted</td>
</tr>
<tr class="even">
<td>Binary Search</td>
<td>Sorted</td>
<td>O(log n)</td>
<td>O(1)</td>
<td>Yes</td>
<td>Fastest on ordered arrays</td>
</tr>
</tbody>
</table>
<p>Binary search trades simplicity for power , once your data is sorted, you unlock sublinear search.</p>
</section>
<section id="tiny-code-15" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-15">Tiny Code</h4>
<p>Compare on array <code>[2, 4, 6, 8, 10]</code>, key = 8:</p>
<ul>
<li>Linear: 4 steps- Binary: 2 steps This gap grows huge with size , for <span class="math inline">\(n = 10^6\)</span>, linear takes up to a million steps, binary about 20.</li>
</ul>
</section>
<section id="why-it-matters-15" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-15">Why It Matters</h4>
<p>These two searches form the foundation of retrieval. Linear search shows brute-force iteration; binary search shows how structure (sorted order) leads to exponential improvement.</p>
<p>From databases to compiler symbol tables to tree lookups, this principle , <em>divide to search faster</em> , is everywhere.</p>
</section>
<section id="try-it-yourself-15" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-15">Try It Yourself</h4>
<ol type="1">
<li>Implement linear and binary search.</li>
<li>Count comparisons for ( n = 10, 100, 1000 ).</li>
<li>Modify binary search to return the first occurrence of a duplicate.</li>
<li>Try binary search on unsorted data , what happens?</li>
<li>Combine with sorting: sort array, then search.</li>
</ol>
<p>Mastering these searches builds intuition for all lookup operations , they are the gateway to efficient data retrieval.</p>
</section>
</section>
<section id="interpolation-and-exponential-search" class="level3">
<h3 class="anchored" data-anchor-id="interpolation-and-exponential-search">17. Interpolation and Exponential Search</h3>
<p>Linear and binary search work well across many scenarios, but they don’t take into account how data is distributed. When values are uniformly distributed, we can <em>estimate</em> where the target lies, instead of always splitting the range in half. This leads to Interpolation Search, which “jumps” close to where the value should be.</p>
<p>For unbounded or infinite lists, we can’t even know the size of the array up front , that’s where Exponential Search shines, by quickly expanding its search window before switching to binary search.</p>
<p>Let’s dive into both.</p>
<section id="interpolation-search" class="level4">
<h4 class="anchored" data-anchor-id="interpolation-search">1. Interpolation Search</h4>
<p>Idea: If data is sorted and uniformly distributed, you can <em>predict</em> where a key might be using linear interpolation. Instead of splitting at the middle, estimate the position based on the value’s proportion in the range.</p>
<p>Formula: <span class="math display">\[
\text{pos} = \text{low} + \frac{(key - arr[low]) \times (high - low)}{arr[high] - arr[low]}
\]</span></p>
<p>This “guesses” where the key lies. If (key = arr[pos]), we’re done. Otherwise, adjust <code>low</code> or <code>high</code> and repeat.</p>
<p>Steps:</p>
<ol type="1">
<li>Compute estimated position <code>pos</code></li>
<li>Compare <code>arr[pos]</code> with <code>key</code></li>
<li>Narrow range accordingly</li>
<li>Repeat while <code>low &lt;= high</code> and <code>key</code> within range</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> interpolation_search<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> low <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> high <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>low <span class="op">&lt;=</span> high <span class="op">&amp;&amp;</span> key <span class="op">&gt;=</span> arr<span class="op">[</span>low<span class="op">]</span> <span class="op">&amp;&amp;</span> key <span class="op">&lt;=</span> arr<span class="op">[</span>high<span class="op">])</span> <span class="op">{</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>low <span class="op">==</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>low<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> low<span class="op">;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> pos <span class="op">=</span> low <span class="op">+</span> <span class="op">((</span><span class="dt">double</span><span class="op">)(</span>key <span class="op">-</span> arr<span class="op">[</span>low<span class="op">])</span> <span class="op">*</span> <span class="op">(</span>high <span class="op">-</span> low<span class="op">))</span> <span class="op">/</span> <span class="op">(</span>arr<span class="op">[</span>high<span class="op">]</span> <span class="op">-</span> arr<span class="op">[</span>low<span class="op">]);</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> pos<span class="op">;</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>pos<span class="op">]</span> <span class="op">&lt;</span> key<span class="op">)</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>            low <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>            high <span class="op">=</span> pos <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [10, 20, 30, 40, 50], key = 40 pos = 0 + ((40 - 10) * (4 - 0)) / (50 - 10) = 3 → found at index 3</p>
<p>Complexity:</p>
<ul>
<li><p>Best: (O(1))- Average: (O<span class="math inline">\(\log \log n\)</span>) (uniform data)- Worst: (O(n)) (non-uniform or skewed data)- Space: (O(1)) When to Use:</p></li>
<li><p>Data is sorted and nearly uniform- Numeric data where values grow steadily Note: Interpolation search is adaptive , faster when data is predictable, slower when data is irregular.</p></li>
</ul>
</section>
<section id="exponential-search" class="level4">
<h4 class="anchored" data-anchor-id="exponential-search">2. Exponential Search</h4>
<p>Idea: When you don’t know the array size (e.g., infinite streams, linked data, files), you can’t just binary search from 0 to n-1. Exponential search finds a search range dynamically by doubling its step size until it overshoots the target, then does binary search within that range.</p>
<p>Steps:</p>
<ol type="1">
<li>If <code>arr[0] == key</code>, return 0</li>
<li>Find a range <code>[bound/2, bound]</code> such that <code>arr[bound] &gt;= key</code></li>
<li>Perform binary search in that range</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> exponential_search<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bound <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>bound <span class="op">&lt;</span> n <span class="op">&amp;&amp;</span> arr<span class="op">[</span>bound<span class="op">]</span> <span class="op">&lt;</span> key<span class="op">)</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        bound <span class="op">*=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> low <span class="op">=</span> bound <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> high <span class="op">=</span> <span class="op">(</span>bound <span class="op">&lt;</span> n<span class="op">)</span> <span class="op">?</span> bound <span class="op">:</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Binary search in [low, high]</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>low <span class="op">&lt;=</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>low <span class="op">+</span> high<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> mid<span class="op">;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">&lt;</span> key<span class="op">)</span> low <span class="op">=</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> high <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [2, 4, 6, 8, 10, 12, 14, 16], key = 10</p>
<ul>
<li><p>Step: bound = 1 (4), 2 (6), 4 (10 ≥ key)- Binary search [2,4] → found Complexity:</p></li>
<li><p>Time: (O<span class="math inline">\(\log i\)</span>), where (i) is index of the target- Space: (O(1))- Best: (O(1)) When to Use:</p></li>
<li><p>Unbounded or streamed data- Unknown array size but sorted order</p></li>
</ul>
</section>
<section id="comparison-5" class="level4">
<h4 class="anchored" data-anchor-id="comparison-5">3. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 15%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Best Case</th>
<th>Average Case</th>
<th>Worst Case</th>
<th>Data Requirement</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Linear Search</td>
<td>O(1)</td>
<td>O(n)</td>
<td>O(n)</td>
<td>Unsorted</td>
<td>Works everywhere</td>
</tr>
<tr class="even">
<td>Binary Search</td>
<td>O(1)</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>Sorted</td>
<td>Predictable halving</td>
</tr>
<tr class="odd">
<td>Interpolation Search</td>
<td>O(1)</td>
<td>O(log log n)</td>
<td>O(n)</td>
<td>Sorted + Uniform</td>
<td>Adaptive, fast on uniform data</td>
</tr>
<tr class="even">
<td>Exponential Search</td>
<td>O(1)</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>Sorted</td>
<td>Great for unknown size</td>
</tr>
</tbody>
</table>
<p>Interpolation improves on binary <em>if</em> data is smooth. Exponential shines when size is unknown.</p>
</section>
<section id="tiny-code-16" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-16">Tiny Code</h4>
<p>Interpolation intuition: If your data is evenly spaced (10, 20, 30, 40, 50), the value 40 should be roughly 75% along. Instead of halving every time, we jump <em>right near it</em>. It’s data-aware searching.</p>
<p>Exponential intuition: When size is unknown, “expand until you find the wall,” then search within.</p>
</section>
<section id="why-it-matters-16" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-16">Why It Matters</h4>
<p>These two searches show how context shapes algorithm design:</p>
<ul>
<li><em>Distribution</em> (Interpolation Search)- <em>Boundaries</em> (Exponential Search) They teach that performance depends not only on structure (sortedness) but also metadata , how much you know about data spacing or limits.</li>
</ul>
<p>These principles resurface in skip lists, search trees, and probabilistic indexing.</p>
</section>
<section id="try-it-yourself-16" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-16">Try It Yourself</h4>
<ol type="1">
<li>Test interpolation search on [10, 20, 30, 40, 50] , note how few steps it takes.</li>
<li>Try the same on [1, 2, 4, 8, 16, 32, 64] , note slowdown.</li>
<li>Implement exponential search and simulate an “infinite” array by stopping at <code>n</code>.</li>
<li>Compare binary vs interpolation search on random vs uniform data.</li>
<li>Extend exponential search to linked lists , how does complexity change?</li>
</ol>
<p>Understanding these searches helps you tailor lookups to the shape of your data , a key skill in algorithmic thinking.</p>
</section>
</section>
<section id="selection-algorithms-quickselect-median-of-medians" class="level3">
<h3 class="anchored" data-anchor-id="selection-algorithms-quickselect-median-of-medians">18. Selection Algorithms (Quickselect, Median of Medians)</h3>
<p>Sometimes you don’t need to sort an entire array , you just want the k-th smallest (or largest) element. Sorting everything is overkill when you only need one specific rank. Selection algorithms solve this problem efficiently, often in linear time.</p>
<p>They’re the backbone of algorithms for median finding, percentiles, and order statistics, and they underpin operations like <em>pivot selection</em> in Quick Sort.</p>
<section id="the-selection-problem" class="level4">
<h4 class="anchored" data-anchor-id="the-selection-problem">1. The Selection Problem</h4>
<p>Given an unsorted array of ( n ) elements and a number ( k ), find the element that would be at position ( k ) if the array were sorted.</p>
<p>For example: arr = [7, 2, 9, 4, 6], (k = 3) → Sorted = [2, 4, 6, 7, 9] → 3rd smallest = 6</p>
<p>We can solve this without sorting everything.</p>
</section>
<section id="quickselect" class="level4">
<h4 class="anchored" data-anchor-id="quickselect">2. Quickselect</h4>
<p>Idea: Quickselect is a selection variant of Quick Sort. It partitions the array around a pivot, but recurses only on the side that contains the k-th element.</p>
<p>It has average-case O(n) time because each partition roughly halves the search space.</p>
<p>Steps:</p>
<ol type="1">
<li>Choose a pivot (random or last element)</li>
<li>Partition array into elements &lt; pivot and &gt; pivot</li>
<li>Let <code>pos</code> be the pivot’s index after partition</li>
<li>If <code>pos == k-1</code> → done</li>
<li>If <code>pos &gt; k-1</code> → recurse left</li>
<li>If <code>pos &lt; k-1</code> → recurse right</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> partition<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot <span class="op">=</span> arr<span class="op">[</span>high<span class="op">];</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> low<span class="op">;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> low<span class="op">;</span> j <span class="op">&lt;</span> high<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> pivot<span class="op">)</span> <span class="op">{</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>j<span class="op">];</span> arr<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>            i<span class="op">++;</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>high<span class="op">];</span> arr<span class="op">[</span>high<span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> quickselect<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">,</span> <span class="dt">int</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>low <span class="op">==</span> high<span class="op">)</span> <span class="cf">return</span> arr<span class="op">[</span>low<span class="op">];</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pos <span class="op">=</span> partition<span class="op">(</span>arr<span class="op">,</span> low<span class="op">,</span> high<span class="op">);</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rank <span class="op">=</span> pos <span class="op">-</span> low <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>rank <span class="op">==</span> k<span class="op">)</span> <span class="cf">return</span> arr<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>rank <span class="op">&gt;</span> k<span class="op">)</span> <span class="cf">return</span> quickselect<span class="op">(</span>arr<span class="op">,</span> low<span class="op">,</span> pos <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> k<span class="op">);</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> quickselect<span class="op">(</span>arr<span class="op">,</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> high<span class="op">,</span> k <span class="op">-</span> rank<span class="op">);</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [7, 2, 9, 4, 6], ( k = 3 )</p>
<ul>
<li><p>Pivot = 6- Partition → [2, 4, 6, 9, 7], pos = 2- rank = 3 → found (6) Complexity:</p></li>
<li><p>Average: (O(n))- Worst: (O<span class="math inline">\(n^2\)</span>) (bad pivots)- Space: (O(1))- In-place When to Use:</p></li>
<li><p>Fast average case- You don’t need full sorting Quickselect is used in C++’s <code>nth_element()</code> and many median-finding implementations.</p></li>
</ul>
</section>
<section id="median-of-medians" class="level4">
<h4 class="anchored" data-anchor-id="median-of-medians">3. Median of Medians</h4>
<p>Idea: Guarantee worst-case ( O(n) ) time by choosing a good pivot deterministically.</p>
<p>This method ensures the pivot divides the array into reasonably balanced parts every time.</p>
<p>Steps:</p>
<ol type="1">
<li>Divide array into groups of 5</li>
<li>Find the median of each group (using insertion sort)</li>
<li>Recursively find the median of these medians → pivot</li>
<li>Partition array around this pivot</li>
<li>Recurse into the side containing the k-th element</li>
</ol>
<p>This guarantees at least 30% of elements are eliminated each step → linear time in worst case.</p>
<p>Code Sketch:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> select_pivot<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> high <span class="op">-</span> low <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">5</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>        insertion_sort<span class="op">(</span>arr <span class="op">+</span> low<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> low <span class="op">+</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> medians<span class="op">[(</span>n <span class="op">+</span> <span class="dv">4</span><span class="op">)</span> <span class="op">/</span> <span class="dv">5</span><span class="op">];</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n <span class="op">/</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>        insertion_sort<span class="op">(</span>arr <span class="op">+</span> low <span class="op">+</span> i <span class="op">*</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>        medians<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>low <span class="op">+</span> i <span class="op">*</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">2</span><span class="op">];</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>i <span class="op">*</span> <span class="dv">5</span> <span class="op">&lt;</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>        insertion_sort<span class="op">(</span>arr <span class="op">+</span> low <span class="op">+</span> i <span class="op">*</span> <span class="dv">5</span><span class="op">,</span> n <span class="op">%</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>        medians<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>low <span class="op">+</span> i <span class="op">*</span> <span class="dv">5</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">5</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">];</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>        i<span class="op">++;</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> select_pivot<span class="op">(</span>medians<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>You’d then partition around <code>pivot</code> and recurse just like Quickselect.</p>
<p>Complexity:</p>
<ul>
<li>Worst: (O(n))- Space: (O(1)) (in-place version)- Stable: No (doesn’t preserve order) Why It Matters: Median of Medians is slower in practice than Quickselect but provides theoretical guarantees , vital in real-time or critical systems.</li>
</ul>
</section>
<section id="special-cases" class="level4">
<h4 class="anchored" data-anchor-id="special-cases">4. Special Cases</h4>
<ul>
<li>Min / Max: trivial , just scan once ((O(n)))- Median: <span class="math inline">\(k = \lceil n/2 \rceil\)</span> , can use Quickselect or Median of Medians- Top-k Elements: use partial selection or heaps (k smallest/largest) Example: To get top 5 scores from a million entries, use Quickselect to find 5th largest, then filter ≥ threshold.</li>
</ul>
</section>
<section id="comparison-6" class="level4">
<h4 class="anchored" data-anchor-id="comparison-6">5. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Best</th>
<th>Average</th>
<th>Worst</th>
<th>Stable</th>
<th>In-Place</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Quickselect</td>
<td>O(n)</td>
<td>O(n)</td>
<td>O(n²)</td>
<td>No</td>
<td>Yes</td>
<td>Fast in practice</td>
</tr>
<tr class="even">
<td>Median of Medians</td>
<td>O(n)</td>
<td>O(n)</td>
<td>O(n)</td>
<td>No</td>
<td>Yes</td>
<td>Deterministic</td>
</tr>
<tr class="odd">
<td>Sorting</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>O(n log n)</td>
<td>Depends</td>
<td>Depends</td>
<td>Overkill for single element</td>
</tr>
</tbody>
</table>
<p>Quickselect is fast and simple; Median of Medians is safe and predictable.</p>
</section>
<section id="tiny-code-17" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-17">Tiny Code</h4>
<p>Find 4th smallest in [9, 7, 2, 5, 4, 3]:</p>
<ul>
<li>Pivot = 4 → partition [2,3,4,9,7,5]- 4 at position 2 → rank = 3 &lt; 4 → recurse right- New range [9,7,5], ( k = 1 ) → smallest = 5 Result: 5</li>
</ul>
</section>
<section id="why-it-matters-17" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-17">Why It Matters</h4>
<p>Selection algorithms reveal a key insight:</p>
<blockquote class="blockquote">
<p>Sometimes you don’t need everything , just what matters.</p>
</blockquote>
<p>They form the basis for:</p>
<ul>
<li>Median filters in signal processing- Partitioning steps in sorting- k-th order statistics- Robust statistics and quantile computation They embody a “partial work, full answer” philosophy , do exactly enough.</li>
</ul>
</section>
<section id="try-it-yourself-17" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-17">Try It Yourself</h4>
<ol type="1">
<li>Implement Quickselect and find k-th smallest for various k.</li>
<li>Compare runtime vs full sorting.</li>
<li>Modify Quickselect to find k-th largest.</li>
<li>Implement Median of Medians pivot selection.</li>
<li>Use Quickselect to find median of 1,000 random elements.</li>
</ol>
<p>Mastering selection algorithms helps you reason about efficiency , you’ll learn when to stop sorting and start selecting.</p>
</section>
</section>
<section id="range-searching-and-nearest-neighbor" class="level3">
<h3 class="anchored" data-anchor-id="range-searching-and-nearest-neighbor">19. Range Searching and Nearest Neighbor</h3>
<p>Searching isn’t always about finding a single key. Often, you need to find all elements within a given range , or the closest match to a query point.</p>
<p>These problems are central to databases, computational geometry, and machine learning (like k-NN classification). This section introduces algorithms for range queries (e.g.&nbsp;find all values between <code>L</code> and <code>R</code>) and nearest neighbor searches (e.g.&nbsp;find the point closest to query <code>q</code>).</p>
<section id="range-searching" class="level4">
<h4 class="anchored" data-anchor-id="range-searching">1. Range Searching</h4>
<p>Idea: Given a set of data points (1D or multidimensional), quickly report all points within a specified range.</p>
<p>In 1D (simple arrays), range queries can be handled by binary search and prefix sums. In higher dimensions, we need trees designed for efficient spatial querying.</p>
</section>
<section id="a.-1d-range-query-sorted-array" class="level4">
<h4 class="anchored" data-anchor-id="a.-1d-range-query-sorted-array">A. 1D Range Query (Sorted Array)</h4>
<p>Goal: Find all elements in <code>[L, R]</code>.</p>
<p>Steps:</p>
<ol type="1">
<li>Use lower bound to find first element ≥ L</li>
<li>Use upper bound to find first element &gt; R</li>
<li>Output all elements in between</li>
</ol>
<p>Code (C++-style pseudo):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> l <span class="op">=</span> lower_bound<span class="op">(</span>arr<span class="op">,</span> arr <span class="op">+</span> n<span class="op">,</span> L<span class="op">)</span> <span class="op">-</span> arr<span class="op">;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> r <span class="op">=</span> upper_bound<span class="op">(</span>arr<span class="op">,</span> arr <span class="op">+</span> n<span class="op">,</span> R<span class="op">)</span> <span class="op">-</span> arr<span class="op">;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> l<span class="op">;</span> i <span class="op">&lt;</span> r<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> arr<span class="op">[</span>i<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity:</p>
<ul>
<li>Binary search bounds: (O<span class="math inline">\(\log n\)</span>)- Reporting results: (O(k)) where (k) = number of elements in range → Total: (O<span class="math inline">\(\log n + k\)</span>)</li>
</ul>
</section>
<section id="b.-prefix-sum-range-query-for-sums" class="level4">
<h4 class="anchored" data-anchor-id="b.-prefix-sum-range-query-for-sums">B. Prefix Sum Range Query (For sums)</h4>
<p>If you just need the sum (not the actual elements), use prefix sums:</p>
<p><span class="math display">\[
\text{prefix}[i] = a_0 + a_1 + \ldots + a_i
\]</span></p>
<p>Then range sum: <span class="math display">\[
\text{sum}(L, R) = \text{prefix}[R] - \text{prefix}[L - 1]
\]</span></p>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> prefix<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>prefix<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    prefix<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> prefix<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> range_sum<span class="op">(</span><span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix<span class="op">[</span>R<span class="op">]</span> <span class="op">-</span> <span class="op">(</span>L <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> prefix<span class="op">[</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">:</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time: (O(1)) per query after (O(n)) preprocessing.</p>
<p>Used in:</p>
<ul>
<li>Databases for fast range aggregation- Fenwick trees, segment trees</li>
</ul>
</section>
<section id="c.-2d-range-queries-rectangular-regions" class="level4">
<h4 class="anchored" data-anchor-id="c.-2d-range-queries-rectangular-regions">C. 2D Range Queries (Rectangular Regions)</h4>
<p>For points ((x, y)), queries like:</p>
<blockquote class="blockquote">
<p>“Find all points where <span class="math inline">\(L_x ≤ x ≤ R_x\)</span> and <span class="math inline">\(L_y ≤ y ≤ R_y\)</span>”</p>
</blockquote>
<p>Use specialized structures:</p>
<ul>
<li>Range Trees (balanced BSTs per dimension)- Fenwick Trees / Segment Trees (for 2D arrays)- KD-Trees (spatial decomposition) Time: (O<span class="math inline">\(\log^2 n + k\)</span>) typical for 2D Space: (O<span class="math inline">\(n \log n\)</span>)</li>
</ul>
</section>
<section id="nearest-neighbor-search" class="level4">
<h4 class="anchored" data-anchor-id="nearest-neighbor-search">2. Nearest Neighbor Search</h4>
<p>Idea: Given a set of points, find the one closest to query (q). Distance is often Euclidean, but can be any metric.</p>
<p>Brute Force: Check all points → (O(n)) per query. Too slow for large datasets.</p>
<p>We need structures that let us prune far regions fast.</p>
</section>
<section id="a.-kd-tree" class="level4">
<h4 class="anchored" data-anchor-id="a.-kd-tree">A. KD-Tree</h4>
<p>KD-tree = K-dimensional binary tree. Each level splits points by one coordinate, alternating axes. Used for efficient nearest neighbor search in low dimensions (2D-10D).</p>
<p>Construction:</p>
<ol type="1">
<li>Choose axis = depth % k</li>
<li>Sort points by axis</li>
<li>Pick median → root</li>
<li>Recursively build left and right</li>
</ol>
<p>Query (Nearest Neighbor):</p>
<ol type="1">
<li>Traverse down tree based on query position</li>
<li>Backtrack , check whether hypersphere crosses splitting plane</li>
<li>Keep track of best (closest) distance</li>
</ol>
<p>Complexity:</p>
<ul>
<li><p>Build: (O<span class="math inline">\(n \log n\)</span>)- Query: (O<span class="math inline">\(\log n\)</span>) avg, (O(n)) worst Use Cases:</p></li>
<li><p>Nearest city lookup- Image / feature vector matching- Game AI spatial queries Code Sketch (2D Example):</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span> <span class="dt">double</span> x<span class="op">,</span> y<span class="op">;</span> <span class="op">};</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> dist<span class="op">(</span>Point a<span class="op">,</span> Point b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt<span class="op">((</span>a<span class="op">.</span>x <span class="op">-</span> b<span class="op">.</span>x<span class="op">)*(</span>a<span class="op">.</span>x <span class="op">-</span> b<span class="op">.</span>x<span class="op">)</span> <span class="op">+</span> <span class="op">(</span>a<span class="op">.</span>y <span class="op">-</span> b<span class="op">.</span>y<span class="op">)*(</span>a<span class="op">.</span>y <span class="op">-</span> b<span class="op">.</span>y<span class="op">));</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>(Full KD-tree implementation omitted for brevity , idea is recursive partitioning.)</p>
</section>
<section id="b.-ball-tree-vp-tree" class="level4">
<h4 class="anchored" data-anchor-id="b.-ball-tree-vp-tree">B. Ball Tree / VP-Tree</h4>
<p>For high-dimensional data, KD-trees degrade. Alternatives like Ball Trees (split by hyperspheres) or VP-Trees (Vantage Point Trees) perform better.</p>
<p>They split based on distance metrics, not coordinate axes.</p>
</section>
<section id="c.-approximate-nearest-neighbor-ann" class="level4">
<h4 class="anchored" data-anchor-id="c.-approximate-nearest-neighbor-ann">C. Approximate Nearest Neighbor (ANN)</h4>
<p>For large-scale, high-dimensional data (e.g.&nbsp;embeddings, vectors):</p>
<ul>
<li><p>Locality Sensitive Hashing (LSH)- HNSW (Hierarchical Navigable Small World Graphs) These trade exactness for speed, common in:</p></li>
<li><p>Vector databases- Recommendation systems- AI model retrieval</p></li>
</ul>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">3. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>Brute Force</th>
<th>Optimized</th>
<th>Time (Query)</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1D Range Query</td>
<td>Scan O(n)</td>
<td>Binary Search</td>
<td>O(log n + k)</td>
<td>Sorted data</td>
</tr>
<tr class="even">
<td>Range Sum</td>
<td>O(n)</td>
<td>Prefix Sum</td>
<td>O(1)</td>
<td>Static data</td>
</tr>
<tr class="odd">
<td>2D Range Query</td>
<td>O(n)</td>
<td>Range Tree</td>
<td>O(log² n + k)</td>
<td>Spatial filtering</td>
</tr>
<tr class="even">
<td>Nearest Neighbor</td>
<td>O(n)</td>
<td>KD-Tree</td>
<td>O(log n) avg</td>
<td>Exact, low-dim</td>
</tr>
<tr class="odd">
<td>Nearest Neighbor (high-dim)</td>
<td>O(n)</td>
<td>HNSW / LSH</td>
<td>~O(1)</td>
<td>Approximate</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-18" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-18">Tiny Code</h4>
<p>Simple 1D range query:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">11</span><span class="op">};</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> L <span class="op">=</span> <span class="dv">4</span><span class="op">,</span> R <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> l <span class="op">=</span> lower_bound<span class="op">(</span>arr<span class="op">,</span> arr <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> L<span class="op">)</span> <span class="op">-</span> arr<span class="op">;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> r <span class="op">=</span> upper_bound<span class="op">(</span>arr<span class="op">,</span> arr <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> R<span class="op">)</span> <span class="op">-</span> arr<span class="op">;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> l<span class="op">;</span> i <span class="op">&lt;</span> r<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> arr<span class="op">[</span>i<span class="op">]);</span> <span class="co">// 5 7 9</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Output: <code>5 7 9</code></p>
</section>
<section id="why-it-matters-18" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-18">Why It Matters</h4>
<p>Range and nearest-neighbor queries power:</p>
<ul>
<li>Databases (SQL range filters, BETWEEN)- Search engines (spatial indexing)- ML (k-NN classifiers, vector similarity)- Graphics / Games (collision detection, spatial queries) These are not just searches , they’re geometric lookups, linking algorithms to spatial reasoning.</li>
</ul>
</section>
<section id="try-it-yourself-18" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-18">Try It Yourself</h4>
<ol type="1">
<li>Write a function to return all numbers in <code>[L, R]</code> using binary search.</li>
<li>Build a prefix sum array and answer 5 range-sum queries in O(1).</li>
<li>Implement a KD-tree for 2D points and query nearest neighbor.</li>
<li>Compare brute-force vs KD-tree search on 1,000 random points.</li>
<li>Explore Python’s <code>scipy.spatial.KDTree</code> or <code>sklearn.neighbors</code>.</li>
</ol>
<p>These algorithms bridge searching with geometry and analytics, forming the backbone of spatial computation.</p>
</section>
</section>
<section id="search-optimizations-and-variants" class="level3">
<h3 class="anchored" data-anchor-id="search-optimizations-and-variants">20. Search Optimizations and Variants</h3>
<p>We’ve explored the main search families , linear, binary, interpolation, exponential , each fitting a different data shape or constraint. Now let’s move one step further: optimizing search for performance and adapting it to specialized scenarios.</p>
<p>This section introduces practical variants and enhancements used in real systems, databases, and competitive programming, including jump search, fibonacci search, ternary search, and exponential + binary combinations.</p>
<section id="jump-search" class="level4">
<h4 class="anchored" data-anchor-id="jump-search">1. Jump Search</h4>
<p>Idea: If data is sorted, we can “jump” ahead by fixed steps instead of scanning linearly. It’s like hopping through the array in blocks , when you overshoot the target, you step back and linearly search that block.</p>
<p>It strikes a balance between linear and binary search , fewer comparisons without the recursion or halving of binary search.</p>
<p>Steps:</p>
<ol type="1">
<li>Choose jump size = <span class="math inline">\(\sqrt{n}\)</span></li>
<li>Jump by blocks until <code>arr[step] &gt; key</code></li>
<li>Linear search in previous block</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> jump_search<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> step <span class="op">=</span> sqrt<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> prev <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>arr<span class="op">[</span>min<span class="op">(</span>step<span class="op">,</span> n<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">&lt;</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        prev <span class="op">=</span> step<span class="op">;</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>        step <span class="op">+=</span> sqrt<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>prev <span class="op">&gt;=</span> n<span class="op">)</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> prev<span class="op">;</span> i <span class="op">&lt;</span> min<span class="op">(</span>step<span class="op">,</span> n<span class="op">);</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: arr = [1, 3, 5, 7, 9, 11, 13, 15], key = 11</p>
<ul>
<li><p>step = 2- Jump 5, 7, 9, 11 → found Complexity:</p></li>
<li><p>Time: (O<span class="math inline">\(\sqrt{n}\)</span>)- Space: (O(1))- Works on sorted data When to Use: For moderately sized sorted lists when you want fewer comparisons but minimal overhead.</p></li>
</ul>
</section>
<section id="fibonacci-search" class="level4">
<h4 class="anchored" data-anchor-id="fibonacci-search">2. Fibonacci Search</h4>
<p>Idea: Similar to binary search, but it splits the array based on Fibonacci numbers instead of midpoints. This allows using only addition and subtraction (no division), useful on hardware where division is costly.</p>
<p>Also, like binary search, it halves (roughly) the search space each iteration.</p>
<p>Steps:</p>
<ol type="1">
<li>Find the smallest Fibonacci number ≥ n</li>
<li>Use it to compute probe index</li>
<li>Compare and move interval accordingly</li>
</ol>
<p>Code (Sketch):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fibonacci_search<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> fibMMm2 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// (m-2)'th Fibonacci</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> fibMMm1 <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// (m-1)'th Fibonacci</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> fibM <span class="op">=</span> fibMMm2 <span class="op">+</span> fibMMm1<span class="op">;</span> <span class="co">// m'th Fibonacci</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>fibM <span class="op">&lt;</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        fibMMm2 <span class="op">=</span> fibMMm1<span class="op">;</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>        fibMMm1 <span class="op">=</span> fibM<span class="op">;</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>        fibM <span class="op">=</span> fibMMm2 <span class="op">+</span> fibMMm1<span class="op">;</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> offset <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>fibM <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> i <span class="op">=</span> min<span class="op">(</span>offset <span class="op">+</span> fibMMm2<span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>            fibM <span class="op">=</span> fibMMm1<span class="op">;</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>            fibMMm1 <span class="op">=</span> fibMMm2<span class="op">;</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>            fibMMm2 <span class="op">=</span> fibM <span class="op">-</span> fibMMm1<span class="op">;</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>            offset <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>            fibM <span class="op">=</span> fibMMm2<span class="op">;</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>            fibMMm1 <span class="op">=</span> fibMMm1 <span class="op">-</span> fibMMm2<span class="op">;</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>            fibMMm2 <span class="op">=</span> fibM <span class="op">-</span> fibMMm1<span class="op">;</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>fibMMm1 <span class="op">&amp;&amp;</span> arr<span class="op">[</span>offset <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">==</span> key<span class="op">)</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> offset <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Time: (O<span class="math inline">\(\log n\)</span>)- Space: (O(1))- Sorted input required Fun Fact: Fibonacci search was originally designed for tape drives , where random access is expensive, and predictable jumps matter.</li>
</ul>
</section>
<section id="ternary-search" class="level4">
<h4 class="anchored" data-anchor-id="ternary-search">3. Ternary Search</h4>
<p>Idea: When the function or sequence is unimodal (strictly increasing then decreasing), you can locate a maximum or minimum by splitting the range into three parts instead of two.</p>
<p>Used not for discrete lookup but for optimization on sorted functions.</p>
<p>Steps:</p>
<ol type="1">
<li>Divide range into thirds</li>
<li>Evaluate at two midpoints <code>m1</code>, <code>m2</code></li>
<li>Eliminate one-third based on comparison</li>
<li>Repeat until range is small</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> ternary_search<span class="op">(</span><span class="dt">double</span> low<span class="op">,</span> <span class="dt">double</span> high<span class="op">,</span> <span class="dt">double</span> <span class="op">(*</span>f<span class="op">)(</span><span class="dt">double</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">100</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> m1 <span class="op">=</span> low <span class="op">+</span> <span class="op">(</span>high <span class="op">-</span> low<span class="op">)</span> <span class="op">/</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> m2 <span class="op">=</span> high <span class="op">-</span> <span class="op">(</span>high <span class="op">-</span> low<span class="op">)</span> <span class="op">/</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>f<span class="op">(</span>m1<span class="op">)</span> <span class="op">&lt;</span> f<span class="op">(</span>m2<span class="op">))</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>            low <span class="op">=</span> m1<span class="op">;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>            high <span class="op">=</span> m2<span class="op">;</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>low <span class="op">+</span> high<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: Find minimum of ( f(x) = (x-3)^2 ) between [0,10]. After iterations, converges to (x ≈ 3).</p>
<p>Complexity:</p>
<ul>
<li>Time: <span class="math inline">\(O(\log\text{range})\)</span></li>
<li>Space: <span class="math inline">\(O(1)\)</span></li>
<li>Works for unimodal functions</li>
</ul>
<p>Used in:</p>
<ul>
<li>Mathematical optimization</li>
<li>Search-based tuning</li>
<li>Game AI decision models</li>
</ul>
</section>
<section id="binary-search-variants-review" class="level4">
<h4 class="anchored" data-anchor-id="binary-search-variants-review">4. Binary Search Variants (Review)</h4>
<p>Binary search can be tailored to answer richer queries:</p>
<ul>
<li>Lower Bound: first index ≥ key- Upper Bound: first index &gt; key- Equal Range: range of all equal elements- Rotated Arrays: find element in rotated sorted array- Infinite Arrays: use exponential expansion Rotated Example: arr = [6,7,9,1,3,4], key = 3 → Find pivot, then binary search correct side.</li>
</ul>
</section>
<section id="combined-searches" class="level4">
<h4 class="anchored" data-anchor-id="combined-searches">5. Combined Searches</h4>
<p>Real systems often chain algorithms:</p>
<ul>
<li>Exponential + Binary Search → when bounds unknown- Interpolation + Linear Search → when near target- Jump + Linear Search → hybrid iteration These hybrids use context switching , pick a fast search, then fall back to simple scan in a narrowed window.</li>
</ul>
</section>
<section id="summary-1" class="level4">
<h4 class="anchored" data-anchor-id="summary-1">6. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 17%">
<col style="width: 7%">
<col style="width: 23%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Time</th>
<th>Space</th>
<th>Data Requirement</th>
<th>Special Strength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Jump Search</td>
<td>O(√n)</td>
<td>O(1)</td>
<td>Sorted</td>
<td>Fewer comparisons</td>
</tr>
<tr class="even">
<td>Fibonacci Search</td>
<td>O(log n)</td>
<td>O(1)</td>
<td>Sorted</td>
<td>Division-free</td>
</tr>
<tr class="odd">
<td>Ternary Search</td>
<td>O(log range)</td>
<td>O(1)</td>
<td>Unimodal</td>
<td>Optimization</td>
</tr>
<tr class="even">
<td>Binary Variants</td>
<td>O(log n)</td>
<td>O(1)</td>
<td>Sorted</td>
<td>Bound finding</td>
</tr>
<tr class="odd">
<td>Combined Searches</td>
<td>Adaptive</td>
<td>O(1)</td>
<td>Mixed</td>
<td>Practical hybrids</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-19" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-19">Tiny Code</h4>
<p>Jump Search intuition:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Blocks of size sqrt(n)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">15</span><span class="op">]</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>Step<span class="op">:</span> <span class="dv">3</span> → <span class="dv">7</span> <span class="op">&gt;</span> <span class="dv">6</span> → search previous block</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Jumps reduce comparisons dramatically vs linear scan.</p>
</section>
<section id="why-it-matters-19" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-19">Why It Matters</h4>
<p>Search optimization is about adapting structure to context. You don’t always need a fancy data structure , sometimes a tweak like fixed-step jumping or Fibonacci spacing yields massive gains.</p>
<p>These ideas influence:</p>
<ul>
<li>Indexing in databases- Compilers’ symbol resolution- Embedded systems with low-level constraints They embody the principle: search smarter, not harder.</li>
</ul>
</section>
<section id="try-it-yourself-19" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-19">Try It Yourself</h4>
<ol type="1">
<li>Implement Jump Search and test vs Binary Search on 1M elements.</li>
<li>Write a Fibonacci Search , compare steps taken.</li>
<li>Use Ternary Search to find min of a convex function.</li>
<li>Modify binary search to find element in rotated array.</li>
<li>Combine Jump + Linear , how does it behave for small n?</li>
</ol>
<p>Understanding these variants arms you with flexibility , the heart of algorithmic mastery.</p>
</section>
</section>
</section>
<section id="chapter-3.-data-structures-in-actions" class="level2">
<h2 class="anchored" data-anchor-id="chapter-3.-data-structures-in-actions">Chapter 3. Data Structures in Actions</h2>
<section id="arrays-linked-lists-stacks-queues" class="level3">
<h3 class="anchored" data-anchor-id="arrays-linked-lists-stacks-queues">21. Arrays, Linked Lists, Stacks, Queues</h3>
<p>Every data structure is built on top of a few core foundations , the ones that teach you how data is stored, accessed, and moved. In this section, we’ll revisit the essentials: arrays, linked lists, stacks, and queues.</p>
<p>They’re simple, but they show you the most important design trade-offs in algorithms:</p>
<ul>
<li>Contiguity vs.&nbsp;flexibility- Speed vs.&nbsp;dynamic growth- Last-in-first-out vs.&nbsp;first-in-first-out access</li>
</ul>
<section id="arrays" class="level4">
<h4 class="anchored" data-anchor-id="arrays">1. Arrays</h4>
<p>Idea: A contiguous block of memory storing elements of the same type. Access by index in O(1) time , that’s their superpower.</p>
<p>Operations:</p>
<ul>
<li>Access <code>arr[i]</code>: (O(1))- Update <code>arr[i]</code>: (O(1))- Insert at end: (O(1)) (amortized for dynamic arrays)- Insert in middle: (O(n))- Delete: (O(n)) Example:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">50</span><span class="op">};</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> arr<span class="op">[</span><span class="dv">2</span><span class="op">]);</span> <span class="co">// 30</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Strengths:</p>
<ul>
<li><p>Fast random access- Cache-friendly (contiguous memory)- Simple, predictable Weaknesses:</p></li>
<li><p>Fixed size (unless using dynamic array)- Costly inserts/deletes Dynamic Arrays: Languages provide resizable arrays (like <code>vector</code> in C++ or <code>ArrayList</code> in Java) using doubling strategy , when full, allocate new array twice as big and copy. This gives amortized (O(1)) insertion at end.</p></li>
</ul>
</section>
<section id="linked-lists" class="level4">
<h4 class="anchored" data-anchor-id="linked-lists">2. Linked Lists</h4>
<p>Idea: A chain of nodes, where each node stores a value and a pointer to the next. No contiguous memory required.</p>
<p>Operations:</p>
<ul>
<li>Access: (O(n))- Insert/Delete at head: (O(1))- Search: (O(n)) Example:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> data<span class="op">;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node<span class="op">*</span> next<span class="op">;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> head <span class="op">=</span> NULL<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Types:</p>
<ul>
<li><p>Singly Linked List: one pointer (next)- Doubly Linked List: two pointers (next, prev)- Circular Linked List: last node points back to first Strengths:</p></li>
<li><p>Dynamic size- Fast insert/delete (no shifting) Weaknesses:</p></li>
<li><p>Slow access- Extra memory for pointers- Poor cache locality Linked lists shine when memory is fragmented or frequent insertions/deletions are needed.</p></li>
</ul>
</section>
<section id="stack" class="level4">
<h4 class="anchored" data-anchor-id="stack">3. Stack</h4>
<p>Idea: A Last-In-First-Out (LIFO) structure , the most recently added element is the first to be removed.</p>
<p>Used in:</p>
<ul>
<li><p>Function call stacks- Expression evaluation- Undo operations Operations:</p></li>
<li><p><code>push(x)</code>: add element on top- <code>pop()</code>: remove top element- <code>peek()</code>: view top element Example (Array-based Stack):</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAX </span><span class="dv">100</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> stack<span class="op">[</span>MAX<span class="op">],</span> top <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> push<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> stack<span class="op">[++</span>top<span class="op">]</span> <span class="op">=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pop<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> stack<span class="op">[</span>top<span class="op">--];</span> <span class="op">}</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> peek<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> stack<span class="op">[</span>top<span class="op">];</span> <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: All (O(1)): push, pop, peek</p>
<p>Variants:</p>
<ul>
<li>Linked-list-based stack (no fixed size)- Min-stack (tracks minimums) Stacks also appear implicitly , in recursion and backtracking algorithms.</li>
</ul>
</section>
<section id="queue" class="level4">
<h4 class="anchored" data-anchor-id="queue">4. Queue</h4>
<p>Idea: A First-In-First-Out (FIFO) structure , the first added element leaves first.</p>
<p>Used in:</p>
<ul>
<li><p>Task scheduling- BFS traversal- Producer-consumer pipelines Operations:</p></li>
<li><p><code>enqueue(x)</code>: add to rear- <code>dequeue()</code>: remove from front- <code>front()</code>: view front Example (Array-based Queue):</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAX </span><span class="dv">100</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> queue<span class="op">[</span>MAX<span class="op">],</span> front <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> rear <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> enqueue<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> queue<span class="op">[</span>rear<span class="op">++]</span> <span class="op">=</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dequeue<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> queue<span class="op">[</span>front<span class="op">++];</span> <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This simple implementation can waste space. A circular queue fixes that by wrapping indices modulo <code>MAX</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>rear <span class="op">=</span> <span class="op">(</span>rear <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> MAX<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: All (O(1)): enqueue, dequeue</p>
<p>Variants:</p>
<ul>
<li>Deque (double-ended queue): push/pop from both ends- Priority Queue: dequeue highest priority (not strictly FIFO)</li>
</ul>
</section>
<section id="comparison-7" class="level4">
<h4 class="anchored" data-anchor-id="comparison-7">5. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Structure</th>
<th>Access</th>
<th>Insert</th>
<th>Delete</th>
<th>Order</th>
<th>Memory</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Array</td>
<td>O(1)</td>
<td>O(n)</td>
<td>O(n)</td>
<td>Indexed</td>
<td>Contiguous</td>
<td>Fast access</td>
</tr>
<tr class="even">
<td>Linked List</td>
<td>O(n)</td>
<td>O(1)*</td>
<td>O(1)*</td>
<td>Sequential</td>
<td>Pointers</td>
<td>Flexible size</td>
</tr>
<tr class="odd">
<td>Stack</td>
<td>O(1)</td>
<td>O(1)</td>
<td>O(1)</td>
<td>LIFO</td>
<td>Minimal</td>
<td>Call stack, parsing</td>
</tr>
<tr class="even">
<td>Queue</td>
<td>O(1)</td>
<td>O(1)</td>
<td>O(1)</td>
<td>FIFO</td>
<td>Minimal</td>
<td>Scheduling, BFS</td>
</tr>
</tbody>
</table>
<p>(* at head or tail with pointer)</p>
</section>
<section id="tiny-code-20" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-20">Tiny Code</h4>
<p>Simple stack example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>push<span class="op">(</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>push<span class="op">(</span><span class="dv">20</span><span class="op">);</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> pop<span class="op">());</span> <span class="co">// 20</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Simple queue example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb68"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>enqueue<span class="op">(</span><span class="dv">5</span><span class="op">);</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>enqueue<span class="op">(</span><span class="dv">8</span><span class="op">);</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> dequeue<span class="op">());</span> <span class="co">// 5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>These short routines appear in almost every algorithm , from recursion stacks to graph traversals.</p>
</section>
<section id="why-it-matters-20" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-20">Why It Matters</h4>
<p>These four structures form the spine of data structures:</p>
<ul>
<li>Arrays teach indexing and memory- Linked lists teach pointers and dynamic allocation- Stacks teach recursion and reversal- Queues teach scheduling and order maintenance Every complex structure (trees, heaps, graphs) builds on these.</li>
</ul>
<p>Master them, and every algorithm will feel more natural.</p>
</section>
<section id="try-it-yourself-20" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-20">Try It Yourself</h4>
<ol type="1">
<li>Implement a linked list with <code>insert_front</code> and <code>delete_value</code>.</li>
<li>Build a stack and use it to reverse an array.</li>
<li>Implement a queue for a round-robin scheduler.</li>
<li>Convert infix expression to postfix using a stack.</li>
<li>Compare time taken to insert 1000 elements in array vs linked list.</li>
</ol>
<p>Understanding these foundations gives you the vocabulary of structure , the way algorithms organize their thoughts in memory.</p>
</section>
</section>
<section id="hash-tables-and-variants-cuckoo-robin-hood-consistent" class="level3">
<h3 class="anchored" data-anchor-id="hash-tables-and-variants-cuckoo-robin-hood-consistent">22. Hash Tables and Variants (Cuckoo, Robin Hood, Consistent)</h3>
<p>When you need lightning-fast lookups, insertions, and deletions, few data structures match the raw efficiency of a hash table. They’re everywhere , from symbol tables and caches to compilers and databases , powering average-case O(1) access.</p>
<p>In this section, we’ll unpack how hash tables work, their collision strategies, and explore modern variants like Cuckoo Hashing, Robin Hood Hashing, and Consistent Hashing, each designed to handle different real-world needs.</p>
<section id="the-core-idea" class="level4">
<h4 class="anchored" data-anchor-id="the-core-idea">1. The Core Idea</h4>
<p>A hash table maps keys to values using a hash function that transforms the key into an index in an array.</p>
<p><span class="math display">\[
\text{index} = h(\text{key}) \bmod \text{table\_size}
\]</span></p>
<p>If no two keys hash to the same index, all operations are (O(1)). But in practice, collisions happen , two keys may map to the same slot , and we must handle them smartly.</p>
</section>
<section id="collision-resolution-strategies" class="level4">
<h4 class="anchored" data-anchor-id="collision-resolution-strategies">2. Collision Resolution Strategies</h4>
<p>A. Separate Chaining Each table slot holds a linked list (or dynamic array) of entries with the same hash.</p>
<p>Pros: Simple, handles load factor &gt; 1 Cons: Extra pointers, memory overhead</p>
<p>Code Sketch:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">,</span> value<span class="op">;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node<span class="op">*</span> next<span class="op">;</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> table<span class="op">[</span>SIZE<span class="op">];</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> hash<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> key <span class="op">%</span> SIZE<span class="op">;</span> <span class="op">}</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> insert<span class="op">(</span><span class="dt">int</span> key<span class="op">,</span> <span class="dt">int</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx <span class="op">=</span> hash<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> node <span class="op">=</span> malloc<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>Node<span class="op">));</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    node<span class="op">-&gt;</span>key <span class="op">=</span> key<span class="op">;</span> node<span class="op">-&gt;</span>value <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    node<span class="op">-&gt;</span>next <span class="op">=</span> table<span class="op">[</span>idx<span class="op">];</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    table<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> node<span class="op">;</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>B. Open Addressing All keys live directly in the table. On collision, find another slot.</p>
<p>Three main strategies:</p>
<ul>
<li>Linear probing: try next slot (+1)- Quadratic probing: step size increases quadratically- Double hashing: second hash decides step size Example (Linear Probing):</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> hash<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> key <span class="op">%</span> SIZE<span class="op">;</span> <span class="op">}</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> insert<span class="op">(</span><span class="dt">int</span> key<span class="op">,</span> <span class="dt">int</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx <span class="op">=</span> hash<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>table<span class="op">[</span>idx<span class="op">].</span>used<span class="op">)</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> <span class="op">(</span>idx <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> SIZE<span class="op">;</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    table<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>Entry<span class="op">){</span>key<span class="op">,</span> value<span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Load Factor <span class="math inline">\(\alpha = \frac{n}{m}\)</span> affects performance , when too high, rehash to larger size.</p>
</section>
<section id="modern-variants" class="level4">
<h4 class="anchored" data-anchor-id="modern-variants">3. Modern Variants</h4>
<p>Classic hash tables can degrade under heavy collisions. Modern variants reduce probe chains and balance load more evenly.</p>
</section>
<section id="a.-cuckoo-hashing" class="level4">
<h4 class="anchored" data-anchor-id="a.-cuckoo-hashing">A. Cuckoo Hashing</h4>
<p>Idea: Each key has two possible locations , if both full, evict one (“kick out the cuckoo”) and reinsert. Ensures constant lookup , at most two probes.</p>
<p>Steps:</p>
<ol type="1">
<li>Compute two hashes (h_1(key)), (h_2(key))</li>
<li>If slot 1 empty → place</li>
<li>Else evict occupant, reinsert it using alternate hash</li>
<li>Repeat until placed or cycle detected (rehash if needed)</li>
</ol>
<p>Code Sketch (Conceptual):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> h1<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> key <span class="op">%</span> SIZE<span class="op">;</span> <span class="op">}</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> h2<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>key <span class="op">/</span> SIZE<span class="op">)</span> <span class="op">%</span> SIZE<span class="op">;</span> <span class="op">}</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> insert<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pos1 <span class="op">=</span> h1<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>table1<span class="op">[</span>pos1<span class="op">])</span> <span class="op">{</span> table1<span class="op">[</span>pos1<span class="op">]</span> <span class="op">=</span> key<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> displaced <span class="op">=</span> table1<span class="op">[</span>pos1<span class="op">];</span> table1<span class="op">[</span>pos1<span class="op">]</span> <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pos2 <span class="op">=</span> h2<span class="op">(</span>displaced<span class="op">);</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>table2<span class="op">[</span>pos2<span class="op">])</span> <span class="op">{</span> table2<span class="op">[</span>pos2<span class="op">]</span> <span class="op">=</span> displaced<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// continue evicting if needed</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Pros:</p>
<ul>
<li><p>Worst-case O(1) lookup (constant probes)- Predictable latency Cons:</p></li>
<li><p>Rehash needed on insertion failure- More complex logic Used in high-performance caches and real-time systems.</p></li>
</ul>
</section>
<section id="b.-robin-hood-hashing" class="level4">
<h4 class="anchored" data-anchor-id="b.-robin-hood-hashing">B. Robin Hood Hashing</h4>
<p>Idea: Steal slots from richer (closer) keys to ensure fairness. When inserting, if you find someone with smaller probe distance, swap , “steal from the rich, give to the poor.”</p>
<p>This balances probe lengths and improves variance and average lookup time.</p>
<p>Key Principle: <span class="math display">\[
\text{If new\_probe\_distance} &gt; \text{existing\_probe\_distance} \Rightarrow \text{swap}
\]</span></p>
<p>Code Sketch:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb72"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> insert<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx <span class="op">=</span> hash<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dist <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>table<span class="op">[</span>idx<span class="op">].</span>used<span class="op">)</span> <span class="op">{</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>table<span class="op">[</span>idx<span class="op">].</span>dist <span class="op">&lt;</span> dist<span class="op">)</span> <span class="op">{</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>            <span class="co">// swap entries</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>            Entry tmp <span class="op">=</span> table<span class="op">[</span>idx<span class="op">];</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>            table<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>Entry<span class="op">){</span>key<span class="op">,</span> dist<span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>            key <span class="op">=</span> tmp<span class="op">.</span>key<span class="op">;</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>            dist <span class="op">=</span> tmp<span class="op">.</span>dist<span class="op">;</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> <span class="op">(</span>idx <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> SIZE<span class="op">;</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>        dist<span class="op">++;</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>    table<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>Entry<span class="op">){</span>key<span class="op">,</span> dist<span class="op">,</span> <span class="dv">1</span><span class="op">};</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Pros:</p>
<ul>
<li><p>Reduced variance- Better performance under high load Cons:</p></li>
<li><p>Slightly slower insertion Used in modern languages like Rust (<code>hashbrown</code>) and Swift.</p></li>
</ul>
</section>
<section id="c.-consistent-hashing" class="level4">
<h4 class="anchored" data-anchor-id="c.-consistent-hashing">C. Consistent Hashing</h4>
<p>Idea: When distributing keys across multiple nodes, you want minimal movement when adding/removing a node. Consistent hashing maps both keys and nodes onto a circular hash ring.</p>
<p>Steps:</p>
<ol type="1">
<li>Hash nodes into a ring</li>
<li>Hash keys into same ring</li>
<li>Each key belongs to the next node clockwise</li>
</ol>
<p>When a node is added or removed, only nearby keys move.</p>
<p>Used in:</p>
<ul>
<li>Distributed caches (Memcached, DynamoDB)- Load balancing- Sharding in databases Code (Conceptual):</li>
</ul>
<pre class="text"><code>Ring: 0 -------------------------------- 2^32
Nodes: N1 at hash("A"), N2 at hash("B")
Key: hash("User42") → assign to next node clockwise</code></pre>
<p>Pros:</p>
<ul>
<li><p>Minimal rebalancing- Scalable Cons:</p></li>
<li><p>More complex setup- Requires virtual nodes for even distribution</p></li>
</ul>
</section>
<section id="complexity-overview" class="level4">
<h4 class="anchored" data-anchor-id="complexity-overview">4. Complexity Overview</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Variant</th>
<th>Insert</th>
<th>Search</th>
<th>Delete</th>
<th>Memory</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Chaining</td>
<td>O(1) avg</td>
<td>O(1) avg</td>
<td>O(1) avg</td>
<td>High</td>
<td>Simple, dynamic</td>
</tr>
<tr class="even">
<td>Linear Probing</td>
<td>O(1) avg</td>
<td>O(1) avg</td>
<td>O(1) avg</td>
<td>Low</td>
<td>Clustering risk</td>
</tr>
<tr class="odd">
<td>Cuckoo</td>
<td>O(1)</td>
<td>O(1)</td>
<td>O(1)</td>
<td>Medium</td>
<td>Two tables, predictable</td>
</tr>
<tr class="even">
<td>Robin Hood</td>
<td>O(1)</td>
<td>O(1)</td>
<td>O(1)</td>
<td>Low</td>
<td>Balanced probes</td>
</tr>
<tr class="odd">
<td>Consistent</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>Depends</td>
<td>Distributed keys</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-21" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-21">Tiny Code</h4>
<p>Simple hash table with linear probing:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SIZE </span><span class="dv">10</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> keys<span class="op">[</span>SIZE<span class="op">],</span> values<span class="op">[</span>SIZE<span class="op">],</span> used<span class="op">[</span>SIZE<span class="op">];</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> hash<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> key <span class="op">%</span> SIZE<span class="op">;</span> <span class="op">}</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> insert<span class="op">(</span><span class="dt">int</span> key<span class="op">,</span> <span class="dt">int</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx <span class="op">=</span> hash<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>used<span class="op">[</span>idx<span class="op">])</span> idx <span class="op">=</span> <span class="op">(</span>idx <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> SIZE<span class="op">;</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    keys<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> key<span class="op">;</span> values<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> value<span class="op">;</span> used<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Lookup:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb75"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> get<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx <span class="op">=</span> hash<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>used<span class="op">[</span>idx<span class="op">])</span> <span class="op">{</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>keys<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> values<span class="op">[</span>idx<span class="op">];</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> <span class="op">(</span>idx <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> SIZE<span class="op">;</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-21" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-21">Why It Matters</h4>
<p>Hash tables show how structure and randomness combine for speed. They embody the idea that a good hash function + smart collision handling = near-constant performance.</p>
<p>Variants like Cuckoo and Robin Hood are examples of modern engineering trade-offs , balancing performance, memory, and predictability. Consistent hashing extends these ideas to distributed systems.</p>
</section>
<section id="try-it-yourself-21" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-21">Try It Yourself</h4>
<ol type="1">
<li>Implement a hash table with chaining and test collision handling.</li>
<li>Modify it to use linear probing , measure probe lengths.</li>
<li>Simulate Cuckoo hashing with random inserts.</li>
<li>Implement Robin Hood swapping logic , observe fairness.</li>
<li>Draw a consistent hash ring with 3 nodes and 10 keys , track movement when adding one node.</li>
</ol>
<p>Once you master these, you’ll see hashing everywhere , from dictionaries to distributed databases.</p>
</section>
</section>
<section id="heaps-binary-fibonacci-pairing" class="level3">
<h3 class="anchored" data-anchor-id="heaps-binary-fibonacci-pairing">23. Heaps (Binary, Fibonacci, Pairing)</h3>
<p>Heaps are priority-driven data structures , they always give you fast access to the most important element, typically the minimum or maximum. They’re essential for priority queues, scheduling, graph algorithms (like Dijkstra), and streaming analytics.</p>
<p>In this section, we’ll start from the basic binary heap and then explore more advanced ones like Fibonacci and pairing heaps, which trade off simplicity, speed, and amortized guarantees.</p>
<section id="the-heap-property" class="level4">
<h4 class="anchored" data-anchor-id="the-heap-property">1. The Heap Property</h4>
<p>A heap is a tree-based structure (often represented as an array) that satisfies:</p>
<ul>
<li>Min-Heap: Every node ≤ its children- Max-Heap: Every node ≥ its children This ensures the root always holds the smallest (or largest) element.</li>
</ul>
<p>Complete Binary Tree: All levels filled except possibly the last, which is filled left to right.</p>
<p>Example (Min-Heap):</p>
<pre><code>        2
      /   \
     4     5
    / \   /
   9  10 15</code></pre>
<p>Here, the smallest element (2) is at the root.</p>
</section>
<section id="binary-heap" class="level4">
<h4 class="anchored" data-anchor-id="binary-heap">2. Binary Heap</h4>
<p>Storage: Stored compactly in an array. For index <code>i</code> (0-based):</p>
<ul>
<li>Parent = <code>(i - 1) / 2</code>- Left child = <code>2i + 1</code>- Right child = <code>2i + 2</code> Operations:</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Description</th>
<th>Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>push(x)</code></td>
<td>Insert element</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
</tr>
<tr class="even">
<td><code>pop()</code></td>
<td>Remove root</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
</tr>
<tr class="odd">
<td><code>peek()</code></td>
<td>Get root</td>
<td>(O(1))</td>
</tr>
<tr class="even">
<td><code>heapify()</code></td>
<td>Build heap</td>
<td>(O(n))</td>
</tr>
</tbody>
</table>
</section>
<section id="a.-insertion-push" class="level4">
<h4 class="anchored" data-anchor-id="a.-insertion-push">A. Insertion (Push)</h4>
<p>Insert at the end, then bubble up until heap property is restored.</p>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb77"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> push<span class="op">(</span><span class="dt">int</span> heap<span class="op">[],</span> <span class="dt">int</span> <span class="op">*</span>n<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="op">(*</span>n<span class="op">)++;</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    heap<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>i <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> heap<span class="op">[(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)/</span><span class="dv">2</span><span class="op">]</span> <span class="op">&gt;</span> heap<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tmp <span class="op">=</span> heap<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>        heap<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> heap<span class="op">[(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)/</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>        heap<span class="op">[(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)/</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> <span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-removal-pop" class="level4">
<h4 class="anchored" data-anchor-id="b.-removal-pop">B. Removal (Pop)</h4>
<p>Replace root with last element, then bubble down (heapify).</p>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb78"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> heapify<span class="op">(</span><span class="dt">int</span> heap<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> smallest <span class="op">=</span> i<span class="op">,</span> l <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>i <span class="op">+</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">&lt;</span> n <span class="op">&amp;&amp;</span> heap<span class="op">[</span>l<span class="op">]</span> <span class="op">&lt;</span> heap<span class="op">[</span>smallest<span class="op">])</span> smallest <span class="op">=</span> l<span class="op">;</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;</span> n <span class="op">&amp;&amp;</span> heap<span class="op">[</span>r<span class="op">]</span> <span class="op">&lt;</span> heap<span class="op">[</span>smallest<span class="op">])</span> smallest <span class="op">=</span> r<span class="op">;</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>smallest <span class="op">!=</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> tmp <span class="op">=</span> heap<span class="op">[</span>i<span class="op">];</span> heap<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> heap<span class="op">[</span>smallest<span class="op">];</span> heap<span class="op">[</span>smallest<span class="op">]</span> <span class="op">=</span> tmp<span class="op">;</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>        heapify<span class="op">(</span>heap<span class="op">,</span> n<span class="op">,</span> smallest<span class="op">);</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Pop:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb79"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pop<span class="op">(</span><span class="dt">int</span> heap<span class="op">[],</span> <span class="dt">int</span> <span class="op">*</span>n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> root <span class="op">=</span> heap<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    heap<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> heap<span class="op">[--(*</span>n<span class="op">)];</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    heapify<span class="op">(</span>heap<span class="op">,</span> <span class="op">*</span>n<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-building-a-heap" class="level4">
<h4 class="anchored" data-anchor-id="c.-building-a-heap">C. Building a Heap</h4>
<p>Heapify bottom-up from last non-leaf: (O(n))</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb80"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    heapify<span class="op">(</span>heap<span class="op">,</span> n<span class="op">,</span> i<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="d.-applications" class="level4">
<h4 class="anchored" data-anchor-id="d.-applications">D. Applications</h4>
<ul>
<li>Heapsort: Repeatedly pop min (O(n log n))- Priority Queue: Fast access to smallest/largest- Graph Algorithms: Dijkstra, Prim- Streaming: Median finding using two heaps</li>
</ul>
</section>
<section id="fibonacci-heap" class="level4">
<h4 class="anchored" data-anchor-id="fibonacci-heap">3. Fibonacci Heap</h4>
<p>Idea: A heap optimized for algorithms that do many decrease-key operations (like Dijkstra’s). It stores a collection of trees with lazy merging, giving amortized bounds:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Amortized Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Insert</td>
<td>(O(1))</td>
</tr>
<tr class="even">
<td>Find-Min</td>
<td>(O(1))</td>
</tr>
<tr class="odd">
<td>Extract-Min</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
</tr>
<tr class="even">
<td>Decrease-Key</td>
<td>(O(1))</td>
</tr>
<tr class="odd">
<td>Merge</td>
<td>(O(1))</td>
</tr>
</tbody>
</table>
<p>It achieves this by delaying structural fixes until absolutely necessary (using potential method in amortized analysis).</p>
<p>Structure:</p>
<ul>
<li>A circular linked list of roots- Each node can have multiple children- Consolidation on extract-min ensures minimal degree duplication Used in theoretical optimizations where asymptotic complexity matters (e.g.&nbsp;Dijkstra in (O<span class="math inline">\(E + V \log V\)</span>) vs (O<span class="math inline">\(E \log V\)</span>)).</li>
</ul>
</section>
<section id="pairing-heap" class="level4">
<h4 class="anchored" data-anchor-id="pairing-heap">4. Pairing Heap</h4>
<p>Idea: A simpler, practical alternative to Fibonacci heaps. Self-adjusting structure using a tree with multiple children.</p>
<p>Operations:</p>
<ul>
<li><p>Insert: (O(1))- Extract-Min: (O<span class="math inline">\(\log n\)</span>) amortized- Decrease-Key: (O<span class="math inline">\(\log n\)</span>) amortized Steps:</p></li>
<li><p><code>merge</code> two heaps: attach one as child of the other- <code>extract-min</code>: remove root, merge children in pairs, then merge all results Why It’s Popular:</p></li>
<li><p>Easier to implement- Great real-world performance- Used in functional programming and priority schedulers</p></li>
</ul>
</section>
<section id="comparison-8" class="level4">
<h4 class="anchored" data-anchor-id="comparison-8">5. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Heap Type</th>
<th>Insert</th>
<th>Extract-Min</th>
<th>Decrease-Key</th>
<th>Merge</th>
<th>Simplicity</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Binary Heap</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>O(n)</td>
<td>Easy</td>
<td>General-purpose</td>
</tr>
<tr class="even">
<td>Fibonacci Heap</td>
<td>O(1)</td>
<td>O(log n)</td>
<td>O(1)</td>
<td>O(1)</td>
<td>Complex</td>
<td>Theoretical optimality</td>
</tr>
<tr class="odd">
<td>Pairing Heap</td>
<td>O(1)</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>O(1)</td>
<td>Moderate</td>
<td>Practical alternative</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-22" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-22">Tiny Code</h4>
<p>Binary Heap Demo:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb81"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> heap<span class="op">[</span><span class="dv">100</span><span class="op">],</span> n <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>push<span class="op">(</span>heap<span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>push<span class="op">(</span>heap<span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>push<span class="op">(</span>heap<span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> pop<span class="op">(</span>heap<span class="op">,</span> <span class="op">&amp;</span>n<span class="op">));</span> <span class="co">// 4</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Output: <code>4</code></p>
</section>
<section id="why-it-matters-22" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-22">Why It Matters</h4>
<p>Heaps show how to prioritize elements dynamically. From sorting to scheduling, they’re the backbone of many “choose the best next” algorithms. Variants like Fibonacci and Pairing Heaps demonstrate how amortized analysis can unlock deeper efficiency , crucial in graph theory and large-scale optimization.</p>
</section>
<section id="try-it-yourself-22" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-22">Try It Yourself</h4>
<ol type="1">
<li>Implement a binary min-heap with <code>push</code>, <code>pop</code>, and <code>peek</code>.</li>
<li>Use a heap to sort a list (Heapsort).</li>
<li>Build a priority queue for task scheduling.</li>
<li>Study how Dijkstra changes when replacing arrays with heaps.</li>
<li>Explore Fibonacci heap pseudo-code , trace <code>decrease-key</code>.</li>
</ol>
<p>Mastering heaps gives you a deep sense of priority-driven design , how to keep “the best” element always within reach.</p>
</section>
</section>
<section id="balanced-trees-avl-red-black-splay-treap" class="level3">
<h3 class="anchored" data-anchor-id="balanced-trees-avl-red-black-splay-treap">24. Balanced Trees (AVL, Red-Black, Splay, Treap)</h3>
<p>Unbalanced trees can degrade into linear lists, turning your beautiful (O<span class="math inline">\(\log n\)</span>) search into a sad (O(n)) crawl. Balanced trees solve this , they keep the height logarithmic, guaranteeing fast lookups, insertions, and deletions.</p>
<p>In this section, you’ll learn how different balancing philosophies work , AVL (strict balance), Red-Black (relaxed balance), Splay (self-adjusting), and Treap (randomized balance).</p>
<section id="the-idea-of-balance" class="level4">
<h4 class="anchored" data-anchor-id="the-idea-of-balance">1. The Idea of Balance</h4>
<p>For a binary search tree (BST):</p>
<p><span class="math display">\[
\text{height} = O(\log n)
\]</span></p>
<p>only if it’s balanced , meaning the number of nodes in left and right subtrees differ by a small factor.</p>
<p>Unbalanced BST (bad):</p>
<pre><code>1
 \
  2
   \
    3</code></pre>
<p>Balanced BST (good):</p>
<pre><code>  2
 / \
1   3</code></pre>
<p>Balance ensures efficient:</p>
<ul>
<li><code>search(x)</code> → (O<span class="math inline">\(\log n\)</span>)- <code>insert(x)</code> → (O<span class="math inline">\(\log n\)</span>)- <code>delete(x)</code> → (O<span class="math inline">\(\log n\)</span>)</li>
</ul>
</section>
<section id="avl-tree-adelson-velsky-landis" class="level4">
<h4 class="anchored" data-anchor-id="avl-tree-adelson-velsky-landis">2. AVL Tree (Adelson-Velsky &amp; Landis)</h4>
<p>Invented in 1962, AVL is the first self-balancing BST. It enforces strict balance: <span class="math display">\[
| \text{height(left)} - \text{height(right)} | \le 1
\]</span></p>
<p>Whenever this condition breaks, rotations fix it.</p>
<p>Rotations:</p>
<ul>
<li>LL (Right Rotation): imbalance on left-left- RR (Left Rotation): imbalance on right-right- LR / RL: double rotation cases Code (Rotation Example):</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb84"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> rotateRight<span class="op">(</span>Node<span class="op">*</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> x <span class="op">=</span> y<span class="op">-&gt;</span>left<span class="op">;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> T <span class="op">=</span> x<span class="op">-&gt;</span>right<span class="op">;</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    x<span class="op">-&gt;</span>right <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    y<span class="op">-&gt;</span>left <span class="op">=</span> T<span class="op">;</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Height &amp; Balance Factor:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb85"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> height<span class="op">(</span>Node<span class="op">*</span> n<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> n <span class="op">?</span> n<span class="op">-&gt;</span>h <span class="op">:</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> balance<span class="op">(</span>Node<span class="op">*</span> n<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> height<span class="op">(</span>n<span class="op">-&gt;</span>left<span class="op">)</span> <span class="op">-</span> height<span class="op">(</span>n<span class="op">-&gt;</span>right<span class="op">);</span> <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Properties:</p>
<ul>
<li>Strict height bound: (O<span class="math inline">\(\log n\)</span>)- More rotations (slower insertions)- Excellent lookup speed Used when lookups &gt; updates (databases, indexing).</li>
</ul>
</section>
<section id="red-black-tree" class="level4">
<h4 class="anchored" data-anchor-id="red-black-tree">3. Red-Black Tree</h4>
<p>Idea: A slightly looser balance for faster insertions. Each node has a color (Red/Black) with these rules:</p>
<ol type="1">
<li>Root is black</li>
<li>Red node’s children are black</li>
<li>Every path has same number of black nodes</li>
<li>Null nodes are black</li>
</ol>
<p>Balance through color flips + rotations</p>
<p>Compared to AVL:</p>
<ul>
<li><p>Fewer rotations (faster insert/delete)- Slightly taller (slower lookup)- Simpler amortized balance Used in:</p></li>
<li><p>C++ <code>std::map</code>, <code>std::set</code>- Java <code>TreeMap</code>, Linux scheduler Complexity: All major operations (O<span class="math inline">\(\log n\)</span>)</p></li>
</ul>
</section>
<section id="splay-tree" class="level4">
<h4 class="anchored" data-anchor-id="splay-tree">4. Splay Tree</h4>
<p>Idea: Bring recently accessed node to root via splaying (rotations). It adapts to access patterns , the more you access a key, the faster it becomes.</p>
<p>Splaying Steps:</p>
<ul>
<li>Zig: one rotation (root child)- Zig-Zig: two rotations (same side)- Zig-Zag: two rotations (different sides) Code (Conceptual):</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb86"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> splay<span class="op">(</span>Node<span class="op">*</span> root<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>root <span class="op">||</span> root<span class="op">-&gt;</span>key <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&lt;</span> root<span class="op">-&gt;</span>key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>root<span class="op">-&gt;</span>left<span class="op">)</span> <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// splay in left subtree</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">&lt;</span> root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>key<span class="op">)</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>            root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>left <span class="op">=</span> splay<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>left<span class="op">,</span> key<span class="op">),</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>            root <span class="op">=</span> rotateRight<span class="op">(</span>root<span class="op">);</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;</span> root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>key<span class="op">)</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>            root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>right <span class="op">=</span> splay<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>right<span class="op">,</span> key<span class="op">),</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>            root<span class="op">-&gt;</span>left <span class="op">=</span> rotateLeft<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">);</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> rotateRight<span class="op">(</span>root<span class="op">);</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>root<span class="op">-&gt;</span>right<span class="op">)</span> <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">// symmetric</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Why It’s Cool: No strict balance, but amortized (O<span class="math inline">\(\log n\)</span>). Frequently accessed elements stay near top.</p>
<p>Used in self-adjusting caches, rope data structures, memory allocators.</p>
</section>
<section id="treap-tree-heap" class="level4">
<h4 class="anchored" data-anchor-id="treap-tree-heap">5. Treap (Tree + Heap)</h4>
<p>Idea: Each node has two keys:</p>
<ul>
<li>BST key → order property- Priority → heap property Insertion = normal BST insert + heap fix via rotation.</li>
</ul>
<p>Balance comes from randomization , random priorities ensure expected (O<span class="math inline">\(\log n\)</span>) height.</p>
<p>Code Sketch:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb87"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">,</span> priority<span class="op">;</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>left<span class="op">,</span> <span class="op">*</span>right<span class="op">;</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> insert<span class="op">(</span>Node<span class="op">*</span> root<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>root<span class="op">)</span> <span class="cf">return</span> newNode<span class="op">(</span>key<span class="op">,</span> rand<span class="op">());</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&lt;</span> root<span class="op">-&gt;</span>key<span class="op">)</span> root<span class="op">-&gt;</span>left <span class="op">=</span> insert<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">,</span> key<span class="op">);</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> root<span class="op">-&gt;</span>right <span class="op">=</span> insert<span class="op">(</span>root<span class="op">-&gt;</span>right<span class="op">,</span> key<span class="op">);</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>root<span class="op">-&gt;</span>left <span class="op">&amp;&amp;</span> root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>priority <span class="op">&gt;</span> root<span class="op">-&gt;</span>priority<span class="op">)</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>        root <span class="op">=</span> rotateRight<span class="op">(</span>root<span class="op">);</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>root<span class="op">-&gt;</span>right <span class="op">&amp;&amp;</span> root<span class="op">-&gt;</span>right<span class="op">-&gt;</span>priority <span class="op">&gt;</span> root<span class="op">-&gt;</span>priority<span class="op">)</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>        root <span class="op">=</span> rotateLeft<span class="op">(</span>root<span class="op">);</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Advantages:</p>
<ul>
<li>Simple logic- Random balancing- Expected (O<span class="math inline">\(\log n\)</span>) Used in randomized algorithms and functional programming.</li>
</ul>
</section>
<section id="comparison-9" class="level4">
<h4 class="anchored" data-anchor-id="comparison-9">6. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 22%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Tree</th>
<th>Balance Type</th>
<th>Rotations</th>
<th>Height</th>
<th>Insert/Delete</th>
<th>Lookup</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AVL</td>
<td>Strict</td>
<td>More</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
<td>Medium</td>
<td>Fast</td>
<td>Lookup-heavy</td>
</tr>
<tr class="even">
<td>Red-Black</td>
<td>Relaxed</td>
<td>Fewer</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
<td>Fast</td>
<td>Medium</td>
<td>Library std</td>
</tr>
<tr class="odd">
<td>Splay</td>
<td>Adaptive</td>
<td>Variable</td>
<td>Amortized (O<span class="math inline">\(\log n\)</span>)</td>
<td>Fast</td>
<td>Fast (amortized)</td>
<td>Access patterns</td>
</tr>
<tr class="even">
<td>Treap</td>
<td>Randomized</td>
<td>Avg few</td>
<td>(O<span class="math inline">\(\log n\)</span>) expected</td>
<td>Simple</td>
<td>Simple</td>
<td>Probabilistic</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-23" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-23">Tiny Code</h4>
<p>AVL Insert (Skeleton):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb88"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> insert<span class="op">(</span>Node<span class="op">*</span> root<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>root<span class="op">)</span> <span class="cf">return</span> newNode<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&lt;</span> root<span class="op">-&gt;</span>key<span class="op">)</span> root<span class="op">-&gt;</span>left <span class="op">=</span> insert<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">,</span> key<span class="op">);</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> root<span class="op">-&gt;</span>right <span class="op">=</span> insert<span class="op">(</span>root<span class="op">-&gt;</span>right<span class="op">,</span> key<span class="op">);</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    root<span class="op">-&gt;</span>h <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> max<span class="op">(</span>height<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">),</span> height<span class="op">(</span>root<span class="op">-&gt;</span>right<span class="op">));</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> balance<span class="op">(</span>root<span class="op">);</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> key <span class="op">&lt;</span> root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>key<span class="op">)</span> <span class="cf">return</span> rotateRight<span class="op">(</span>root<span class="op">);</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">&lt;</span> <span class="op">-</span><span class="dv">1</span> <span class="op">&amp;&amp;</span> key <span class="op">&gt;</span> root<span class="op">-&gt;</span>right<span class="op">-&gt;</span>key<span class="op">)</span> <span class="cf">return</span> rotateLeft<span class="op">(</span>root<span class="op">);</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// other cases...</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-23" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-23">Why It Matters</h4>
<p>Balanced trees guarantee predictable performance under dynamic updates. Each variant represents a philosophy:</p>
<ul>
<li>AVL: precision- Red-Black: practicality- Splay: adaptability- Treap: randomness Together, they teach one core idea , keep height in check, no matter the operations.</li>
</ul>
</section>
<section id="try-it-yourself-23" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-23">Try It Yourself</h4>
<ol type="1">
<li>Implement an AVL tree and visualize rotations.</li>
<li>Insert keys [10, 20, 30, 40, 50] and trace Red-Black color changes.</li>
<li>Splay after each access , see which keys stay near top.</li>
<li>Build a Treap with random priorities , measure average height.</li>
<li>Compare performance of BST vs AVL on sorted input.</li>
</ol>
<p>Balanced trees are the architects of order , always keeping chaos one rotation away.</p>
</section>
</section>
<section id="segment-trees-and-fenwick-trees" class="level3">
<h3 class="anchored" data-anchor-id="segment-trees-and-fenwick-trees">25. Segment Trees and Fenwick Trees</h3>
<p>When you need to answer range queries quickly (like sum, min, max) and support updates to individual elements, simple prefix sums won’t cut it anymore.</p>
<p>You need something smarter , data structures that can divide and conquer over ranges, updating and combining results efficiently.</p>
<p>That’s exactly what Segment Trees and Fenwick Trees (Binary Indexed Trees) do:</p>
<ul>
<li>Query over a range in (O<span class="math inline">\(\log n\)</span>)- Update elements in (O<span class="math inline">\(\log n\)</span>) They’re the backbone of competitive programming, signal processing, and database analytics.</li>
</ul>
<section id="the-problem" class="level4">
<h4 class="anchored" data-anchor-id="the-problem">1. The Problem</h4>
<p>Given an array <code>A[0..n-1]</code>, support:</p>
<ol type="1">
<li><code>update(i, x)</code> → change <code>A[i]</code> to <code>x</code></li>
<li><code>query(L, R)</code> → compute sum (or min, max) of <code>A[L..R]</code></li>
</ol>
<p>Naive approach:</p>
<ul>
<li>Update: (O(1))- Query: (O(n)) Prefix sums fix one but not both. Segment and Fenwick trees fix both.</li>
</ul>
</section>
<section id="segment-tree" class="level4">
<h4 class="anchored" data-anchor-id="segment-tree">2. Segment Tree</h4>
<p>Idea: Divide the array into segments (intervals) recursively. Each node stores an aggregate (sum, min, max) of its range. You can combine child nodes to get any range result.</p>
<p>Structure (Sum Example):</p>
<pre><code>           [0,7] sum=36
         /           \
   [0,3]=10         [4,7]=26
   /     \           /      \
[0,1]=3 [2,3]=7  [4,5]=11  [6,7]=15</code></pre>
<p>Each node represents a range [L,R]. Leaf nodes = single elements.</p>
</section>
<section id="a.-build" class="level4">
<h4 class="anchored" data-anchor-id="a.-build">A. Build</h4>
<p>Recursive Construction: Time: (O(n))</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb90"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> build<span class="op">(</span><span class="dt">int</span> node<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> tree<span class="op">[</span>node<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>L<span class="op">];</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span><span class="dv">2</span><span class="op">*</span>node<span class="op">,</span> L<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span><span class="dv">2</span><span class="op">*</span>node<span class="op">+</span><span class="dv">1</span><span class="op">,</span> mid<span class="op">+</span><span class="dv">1</span><span class="op">,</span> R<span class="op">);</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        tree<span class="op">[</span>node<span class="op">]</span> <span class="op">=</span> tree<span class="op">[</span><span class="dv">2</span><span class="op">*</span>node<span class="op">]</span> <span class="op">+</span> tree<span class="op">[</span><span class="dv">2</span><span class="op">*</span>node<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-query-range-sum" class="level4">
<h4 class="anchored" data-anchor-id="b.-query-range-sum">B. Query (Range Sum)</h4>
<p>Query [l, r] recursively:</p>
<ul>
<li>If current range [L, R] fully inside [l, r], return node value- If disjoint, return 0- Else combine children</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb91"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> node<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;</span> L <span class="op">||</span> R <span class="op">&lt;</span> l<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">&lt;=</span> L <span class="op">&amp;&amp;</span> R <span class="op">&lt;=</span> r<span class="op">)</span> <span class="cf">return</span> tree<span class="op">[</span>node<span class="op">];</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> query<span class="op">(</span><span class="dv">2</span><span class="op">*</span>node<span class="op">,</span> L<span class="op">,</span> mid<span class="op">,</span> l<span class="op">,</span> r<span class="op">)</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>         <span class="op">+</span> query<span class="op">(</span><span class="dv">2</span><span class="op">*</span>node<span class="op">+</span><span class="dv">1</span><span class="op">,</span> mid<span class="op">+</span><span class="dv">1</span><span class="op">,</span> R<span class="op">,</span> l<span class="op">,</span> r<span class="op">);</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-update" class="level4">
<h4 class="anchored" data-anchor-id="c.-update">C. Update</h4>
<p>Change <code>arr[i] = x</code> and update tree nodes covering <code>i</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb92"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> update<span class="op">(</span><span class="dt">int</span> node<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> i<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> tree<span class="op">[</span>node<span class="op">]</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L <span class="op">+</span> R<span class="op">)/</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">&lt;=</span> mid<span class="op">)</span> update<span class="op">(</span><span class="dv">2</span><span class="op">*</span>node<span class="op">,</span> L<span class="op">,</span> mid<span class="op">,</span> i<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> update<span class="op">(</span><span class="dv">2</span><span class="op">*</span>node<span class="op">+</span><span class="dv">1</span><span class="op">,</span> mid<span class="op">+</span><span class="dv">1</span><span class="op">,</span> R<span class="op">,</span> i<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>        tree<span class="op">[</span>node<span class="op">]</span> <span class="op">=</span> tree<span class="op">[</span><span class="dv">2</span><span class="op">*</span>node<span class="op">]</span> <span class="op">+</span> tree<span class="op">[</span><span class="dv">2</span><span class="op">*</span>node<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexities:</p>
<ul>
<li>Build: (O(n))- Query: (O<span class="math inline">\(\log n\)</span>)- Update: (O<span class="math inline">\(\log n\)</span>)- Space: (O(4n))</li>
</ul>
</section>
<section id="d.-variants" class="level4">
<h4 class="anchored" data-anchor-id="d.-variants">D. Variants</h4>
<p>Segment trees are flexible:</p>
<ul>
<li>Range minimum/maximum- Range GCD- Lazy propagation → range updates- 2D segment tree for grids</li>
</ul>
</section>
<section id="fenwick-tree-binary-indexed-tree" class="level4">
<h4 class="anchored" data-anchor-id="fenwick-tree-binary-indexed-tree">3. Fenwick Tree (Binary Indexed Tree)</h4>
<p>Idea: Stores cumulative frequencies using bit manipulation. Each node covers a range size = LSB(index).</p>
<p>Simpler, smaller, but supports only associative ops (sum, xor, etc.)</p>
<p>Indexing:</p>
<ul>
<li>Parent: <code>i + (i &amp; -i)</code>- Child: <code>i - (i &amp; -i)</code> Build: Initialize with zero, then add elements one by one.</li>
</ul>
<p>Add / Update:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb93"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> i<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">+=</span> i <span class="op">&amp;</span> <span class="op">-</span>i<span class="op">)</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>        bit<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> x<span class="op">;</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Prefix Sum:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum<span class="op">(</span><span class="dt">int</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> res <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">-=</span> i <span class="op">&amp;</span> <span class="op">-</span>i<span class="op">)</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>        res <span class="op">+=</span> bit<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Range Sum [L, R]: <span class="math display">\[
\text{sum}(R) - \text{sum}(L-1)
\]</span></p>
<p>Complexities:</p>
<ul>
<li>Build: (O<span class="math inline">\(n \log n\)</span>)- Query: (O<span class="math inline">\(\log n\)</span>)- Update: (O<span class="math inline">\(\log n\)</span>)- Space: (O(n))</li>
</ul>
</section>
<section id="comparison-10" class="level4">
<h4 class="anchored" data-anchor-id="comparison-10">4. Comparison</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>Segment Tree</th>
<th>Fenwick Tree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Space</td>
<td>O(4n)</td>
<td>O(n)</td>
</tr>
<tr class="even">
<td>Build</td>
<td>O(n)</td>
<td>O(n log n)</td>
</tr>
<tr class="odd">
<td>Query</td>
<td>O(log n)</td>
<td>O(log n)</td>
</tr>
<tr class="even">
<td>Update</td>
<td>O(log n)</td>
<td>O(log n)</td>
</tr>
<tr class="odd">
<td>Range Update</td>
<td>With Lazy</td>
<td>Tricky</td>
</tr>
<tr class="even">
<td>Range Query</td>
<td>Flexible</td>
<td>Sum/XOR only</td>
</tr>
<tr class="odd">
<td>Implementation</td>
<td>Moderate</td>
<td>Simple</td>
</tr>
</tbody>
</table>
</section>
<section id="applications" class="level4">
<h4 class="anchored" data-anchor-id="applications">5. Applications</h4>
<ul>
<li><p>Sum / Min / Max / XOR queries- Frequency counts- Inversions counting- Order statistics- Online problems where array updates over time Used in:</p></li>
<li><p>Competitive programming- Databases (analytics on changing data)- Time series queries- Games (damage/range updates)</p></li>
</ul>
</section>
<section id="tiny-code-24" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-24">Tiny Code</h4>
<p>Fenwick Tree Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb95"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bit<span class="op">[</span><span class="dv">1001</span><span class="op">],</span> n<span class="op">;</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> update<span class="op">(</span><span class="dt">int</span> i<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">+=</span> i <span class="op">&amp;</span> <span class="op">-</span>i<span class="op">)</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>        bit<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> val<span class="op">;</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> res <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">-=</span> i <span class="op">&amp;</span> <span class="op">-</span>i<span class="op">)</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>        res <span class="op">+=</span> bit<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="co">// range sum</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> range_sum<span class="op">(</span><span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> query<span class="op">(</span>R<span class="op">)</span> <span class="op">-</span> query<span class="op">(</span>L <span class="op">-</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-24" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-24">Why It Matters</h4>
<p>Segment and Fenwick trees embody divide-and-conquer over data , balancing dynamic updates with range queries. They’re how modern systems aggregate live data efficiently.</p>
<p>They teach a powerful mindset:</p>
<blockquote class="blockquote">
<p>“If you can split a problem, you can solve it fast.”</p>
</blockquote>
</section>
<section id="try-it-yourself-24" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-24">Try It Yourself</h4>
<ol type="1">
<li>Build a segment tree for sum queries.</li>
<li>Add range minimum queries (RMQ).</li>
<li>Implement a Fenwick tree , test with prefix sums.</li>
<li>Solve: number of inversions in array using Fenwick tree.</li>
<li>Add lazy propagation to segment tree for range updates.</li>
</ol>
<p>Once you master these, range queries will never scare you again , you’ll slice through them in logarithmic time.</p>
</section>
</section>
<section id="disjoint-set-union-union-find" class="level3">
<h3 class="anchored" data-anchor-id="disjoint-set-union-union-find">26. Disjoint Set Union (Union-Find)</h3>
<p>Many problems involve grouping elements into sets and efficiently checking whether two elements belong to the same group , like connected components in a graph, network connectivity, Kruskal’s MST, or even social network clustering.</p>
<p>For these, the go-to structure is the Disjoint Set Union (DSU), also called Union-Find. It efficiently supports two operations:</p>
<ol type="1">
<li><code>find(x)</code> → which set does <code>x</code> belong to?</li>
<li><code>union(x, y)</code> → merge the sets containing <code>x</code> and <code>y</code>.</li>
</ol>
<p>With path compression and union by rank, both operations run in near-constant time, specifically (O((n))), where <span class="math inline">\(\alpha\)</span> is the inverse Ackermann function (practically ≤ 4).</p>
<section id="the-problem-1" class="level4">
<h4 class="anchored" data-anchor-id="the-problem-1">1. The Problem</h4>
<p>Suppose you have (n) elements initially in separate sets. Over time, you want to:</p>
<ul>
<li>Merge two sets- Check if two elements share the same set Example:</li>
</ul>
<pre class="text"><code>Sets: {1}, {2}, {3}, {4}, {5}
Union(1,2) → {1,2}, {3}, {4}, {5}
Union(3,4) → {1,2}, {3,4}, {5}
Find(2) == Find(1)? Yes
Find(5) == Find(3)? No</code></pre>
</section>
<section id="basic-implementation" class="level4">
<h4 class="anchored" data-anchor-id="basic-implementation">2. Basic Implementation</h4>
<p>Each element has a parent pointer. Initially, every node is its own parent.</p>
<p>Parent array representation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb97"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parent<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> make_set<span class="op">(</span><span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    parent<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find<span class="op">(</span><span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> parent<span class="op">[</span>v<span class="op">])</span> <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> find<span class="op">(</span>parent<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> union_sets<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> find<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> find<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">!=</span> b<span class="op">)</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This works, but deep trees can form , making <code>find</code> slow. We fix that with path compression.</p>
</section>
<section id="path-compression" class="level4">
<h4 class="anchored" data-anchor-id="path-compression">3. Path Compression</h4>
<p>Every time we call <code>find(v)</code>, we make all nodes along the path point directly to the root. This flattens the tree dramatically.</p>
<p>Optimized Find:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb98"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find<span class="op">(</span><span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> parent<span class="op">[</span>v<span class="op">])</span> <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parent<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> find<span class="op">(</span>parent<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>So next time, lookups will be (O(1)) for those nodes.</p>
</section>
<section id="union-by-rank-size" class="level4">
<h4 class="anchored" data-anchor-id="union-by-rank-size">4. Union by Rank / Size</h4>
<p>When merging, always attach the smaller tree to the larger to keep depth small.</p>
<p>Union by Rank:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb99"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parent<span class="op">[</span>N<span class="op">],</span> rank<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> make_set<span class="op">(</span><span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    parent<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    rank<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> union_sets<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> find<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> find<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">!=</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>rank<span class="op">[</span>a<span class="op">]</span> <span class="op">&lt;</span> rank<span class="op">[</span>b<span class="op">])</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>            swap<span class="op">(</span>a<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>rank<span class="op">[</span>a<span class="op">]</span> <span class="op">==</span> rank<span class="op">[</span>b<span class="op">])</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>            rank<span class="op">[</span>a<span class="op">]++;</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Union by Size (Alternative): Track size of each set and attach smaller to larger.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb100"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> size<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> union_sets<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> find<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> find<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">!=</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>size<span class="op">[</span>a<span class="op">]</span> <span class="op">&lt;</span> size<span class="op">[</span>b<span class="op">])</span> swap<span class="op">(</span>a<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>        size<span class="op">[</span>a<span class="op">]</span> <span class="op">+=</span> size<span class="op">[</span>b<span class="op">];</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="complexity" class="level4">
<h4 class="anchored" data-anchor-id="complexity">5. Complexity</h4>
<p>With both path compression and union by rank, all operations are effectively constant time: <span class="math display">\[
O(\alpha(n)) \approx O(1)
\]</span></p>
<p>For all practical (n), ((n) ).</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Make set</td>
<td>O(1)</td>
</tr>
<tr class="even">
<td>Find</td>
<td>O(α(n))</td>
</tr>
<tr class="odd">
<td>Union</td>
<td>O(α(n))</td>
</tr>
</tbody>
</table>
</section>
<section id="applications-1" class="level4">
<h4 class="anchored" data-anchor-id="applications-1">6. Applications</h4>
<ul>
<li>Graph Connectivity: determine connected components- Kruskal’s MST: add edges, avoid cycles- Dynamic connectivity- Image segmentation- Network clustering- Cycle detection in undirected graphs Example: Kruskal’s Algorithm</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb101"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>sort<span class="op">(</span>edges<span class="op">.</span>begin<span class="op">(),</span> edges<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>edge e <span class="op">:</span> edges<span class="op">)</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>find<span class="op">(</span>e<span class="op">.</span>u<span class="op">)</span> <span class="op">!=</span> find<span class="op">(</span>e<span class="op">.</span>v<span class="op">))</span> <span class="op">{</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>        union_sets<span class="op">(</span>e<span class="op">.</span>u<span class="op">,</span> e<span class="op">.</span>v<span class="op">);</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>        mst_weight <span class="op">+=</span> e<span class="op">.</span>w<span class="op">;</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">7. Example</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb102"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parent<span class="op">[</span><span class="dv">6</span><span class="op">],</span> rank<span class="op">[</span><span class="dv">6</span><span class="op">];</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> init<span class="op">()</span> <span class="op">{</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>        rank<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    init<span class="op">();</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    union_sets<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>    union_sets<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>    union_sets<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> find<span class="op">(</span><span class="dv">4</span><span class="op">));</span> <span class="co">// prints representative of {1,2,3,4}</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Result: <code>{1,2,3,4}</code>, <code>{5}</code></p>
</section>
<section id="visualization" class="level4">
<h4 class="anchored" data-anchor-id="visualization">8. Visualization</h4>
<pre><code>Before compression:
1
 \
  2
   \
    3

After compression:
1
├─2
└─3</code></pre>
<p>Every <code>find</code> call makes future queries faster.</p>
</section>
<section id="comparison-11" class="level4">
<h4 class="anchored" data-anchor-id="comparison-11">9. Comparison</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variant</th>
<th>Find</th>
<th>Union</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Basic</td>
<td>O(n)</td>
<td>O(n)</td>
<td>Deep trees</td>
</tr>
<tr class="even">
<td>Path Compression</td>
<td>O(α(n))</td>
<td>O(α(n))</td>
<td>Very fast</td>
</tr>
<tr class="odd">
<td>+ Rank / Size</td>
<td>O(α(n))</td>
<td>O(α(n))</td>
<td>Balanced</td>
</tr>
<tr class="even">
<td>Persistent DSU</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>Undo/rollback support</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-25" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-25">Tiny Code</h4>
<p>Full DSU with path compression + rank:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb104"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parent<span class="op">[</span><span class="dv">1000</span><span class="op">],</span> rank<span class="op">[</span><span class="dv">1000</span><span class="op">];</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> make_set<span class="op">(</span><span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    parent<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    rank<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find<span class="op">(</span><span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> parent<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> find<span class="op">(</span>parent<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parent<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> union_sets<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> find<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> find<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">!=</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>rank<span class="op">[</span>a<span class="op">]</span> <span class="op">&lt;</span> rank<span class="op">[</span>b<span class="op">])</span> swap<span class="op">(</span>a<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>rank<span class="op">[</span>a<span class="op">]</span> <span class="op">==</span> rank<span class="op">[</span>b<span class="op">])</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>            rank<span class="op">[</span>a<span class="op">]++;</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-25" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-25">Why It Matters</h4>
<p>Union-Find embodies structural sharing and lazy optimization , you don’t balance eagerly, but just enough. It’s one of the most elegant demonstrations of how constant-time algorithms are possible through clever organization.</p>
<p>It teaches a key algorithmic lesson:</p>
<blockquote class="blockquote">
<p>“Work only when necessary, and fix structure as you go.”</p>
</blockquote>
</section>
<section id="try-it-yourself-25" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-25">Try It Yourself</h4>
<ol type="1">
<li>Implement DSU and test <code>find</code>/<code>union</code>.</li>
<li>Build a program that counts connected components.</li>
<li>Solve Kruskal’s MST using DSU.</li>
<li>Add <code>get_size(v)</code> to return component size.</li>
<li>Try rollback DSU (keep stack of changes).</li>
</ol>
<p>Union-Find is the quiet powerhouse behind many graph and connectivity algorithms , simple, fast, and deeply elegant.</p>
</section>
</section>
<section id="probabilistic-data-structures-bloom-count-min-hyperloglog" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic-data-structures-bloom-count-min-hyperloglog">27. Probabilistic Data Structures (Bloom, Count-Min, HyperLogLog)</h3>
<p>When you work with massive data streams , billions of elements, too big for memory , you can’t store everything. But what if you don’t need <em>perfect</em> answers, just <em>fast and tiny approximate ones</em>?</p>
<p>That’s where probabilistic data structures shine. They trade a bit of accuracy for huge space savings and constant-time operations.</p>
<p>In this section, we’ll explore three of the most famous:</p>
<ul>
<li>Bloom Filters → membership queries- Count-Min Sketch → frequency estimation- HyperLogLog → cardinality estimation Each of them answers “How likely is X?” or “How many?” efficiently , perfect for modern analytics, caching, and streaming systems.</li>
</ul>
<section id="bloom-filter-is-this-element-probably-in-the-set" class="level4">
<h4 class="anchored" data-anchor-id="bloom-filter-is-this-element-probably-in-the-set">1. Bloom Filter , “Is this element probably in the set?”</h4>
<p>A Bloom filter answers:</p>
<blockquote class="blockquote">
<p>“Is <code>x</code> in the set?” with either maybe yes or definitely no.</p>
</blockquote>
<p>No false negatives, but <em>some</em> false positives.</p>
</section>
<section id="a.-idea" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea">A. Idea</h4>
<p>Use an array of bits (size <code>m</code>), all initialized to 0. Use k different hash functions.</p>
<p>To insert an element:</p>
<ol type="1">
<li>Compute k hashes: ( h_1(x), h_2(x), , h_k(x) )</li>
<li>Set each bit position <span class="math inline">\(b_i = 1\)</span></li>
</ol>
<p>To query an element:</p>
<ol type="1">
<li>Compute same k hashes</li>
<li>If all bits are 1 → maybe yes</li>
<li>If any bit is 0 → definitely no</li>
</ol>
</section>
<section id="b.-example" class="level4">
<h4 class="anchored" data-anchor-id="b.-example">B. Example</h4>
<p>Insert <code>dog</code>:</p>
<ul>
<li>(h_1(dog)=2, h_2(dog)=5, h_3(dog)=9) Set bits 2, 5, 9 → 1</li>
</ul>
<p>Check <code>cat</code>:</p>
<ul>
<li>If any hash bit = 0 → not present</li>
</ul>
</section>
<section id="c.-complexity" class="level4">
<h4 class="anchored" data-anchor-id="c.-complexity">C. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Time</th>
<th>Space</th>
<th>Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Insert</td>
<td>O(k)</td>
<td>O(m)</td>
<td>Tunable</td>
</tr>
<tr class="even">
<td>Query</td>
<td>O(k)</td>
<td>O(m)</td>
<td>False positives</td>
</tr>
</tbody>
</table>
<p>False positive rate ≈ ( <span class="math inline">\(1 - e^{-kn/m}\)</span>^k )</p>
<p>Choose <code>m</code> and <code>k</code> based on expected <code>n</code> and acceptable error.</p>
</section>
<section id="d.-code" class="level4">
<h4 class="anchored" data-anchor-id="d.-code">D. Code</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb105"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define M </span><span class="dv">1000</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bitset<span class="op">[</span>M<span class="op">];</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> hash1<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>x <span class="op">*</span> <span class="dv">17</span><span class="op">)</span> <span class="op">%</span> M<span class="op">;</span> <span class="op">}</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> hash2<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>x <span class="op">*</span> <span class="dv">31</span> <span class="op">+</span> <span class="dv">7</span><span class="op">)</span> <span class="op">%</span> M<span class="op">;</span> <span class="op">}</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    bitset<span class="op">[</span>hash1<span class="op">(</span>x<span class="op">)]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    bitset<span class="op">[</span>hash2<span class="op">(</span>x<span class="op">)]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> contains<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bitset<span class="op">[</span>hash1<span class="op">(</span>x<span class="op">)]</span> <span class="op">&amp;&amp;</span> bitset<span class="op">[</span>hash2<span class="op">(</span>x<span class="op">)];</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Used in:</p>
<ul>
<li>Caches (check before disk lookup)- Spam filters- Databases (join filtering)- Blockchain and peer-to-peer networks</li>
</ul>
</section>
<section id="count-min-sketch-how-often-has-this-appeared" class="level4">
<h4 class="anchored" data-anchor-id="count-min-sketch-how-often-has-this-appeared">2. Count-Min Sketch , “How often has this appeared?”</h4>
<p>Tracks frequency counts in a stream, using sub-linear memory.</p>
<p>Instead of a full table, it uses a 2D array of counters, each row hashed with a different hash function.</p>
</section>
<section id="a.-insert" class="level4">
<h4 class="anchored" data-anchor-id="a.-insert">A. Insert</h4>
<p>For each row <code>i</code>:</p>
<ul>
<li>Compute hash (h_i(x))- Increment <code>count[i][h_i(x)]++</code> #### B. Query</li>
</ul>
<p>For element <code>x</code>:</p>
<ul>
<li>Compute all (h_i(x))- Take <code>min(count[i][h_i(x)])</code> across rows → gives an upper-bounded estimate of true frequency</li>
</ul>
</section>
<section id="c.-code" class="level4">
<h4 class="anchored" data-anchor-id="c.-code">C. Code</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb106"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define W </span><span class="dv">1000</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define D </span><span class="dv">5</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> count<span class="op">[</span>D<span class="op">][</span>W<span class="op">];</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> hash<span class="op">(</span><span class="dt">int</span> i<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>x <span class="op">*</span> <span class="op">(</span><span class="dv">17</span><span class="op">*</span>i <span class="op">+</span> <span class="dv">3</span><span class="op">))</span> <span class="op">%</span> W<span class="op">;</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> D<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>        count<span class="op">[</span>i<span class="op">][</span>hash<span class="op">(</span>i<span class="op">,</span> x<span class="op">)]++;</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> query<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> res <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> D<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> min<span class="op">(</span>res<span class="op">,</span> count<span class="op">[</span>i<span class="op">][</span>hash<span class="op">(</span>i<span class="op">,</span> x<span class="op">)]);</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="d.-complexity" class="level4">
<h4 class="anchored" data-anchor-id="d.-complexity">D. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Time</th>
<th>Space</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Insert</td>
<td>O(D)</td>
<td>O(W×D)</td>
</tr>
<tr class="even">
<td>Query</td>
<td>O(D)</td>
<td>O(W×D)</td>
</tr>
</tbody>
</table>
<p>Error controlled by: <span class="math display">\[
\varepsilon = \frac{1}{W}, \quad \delta = 1 - e^{-D}
\]</span></p>
<p>Used in:</p>
<ul>
<li>Frequency counting in streams- Hot-key detection- Network flow analysis- Trending topics</li>
</ul>
</section>
<section id="hyperloglog-how-many-unique-items" class="level4">
<h4 class="anchored" data-anchor-id="hyperloglog-how-many-unique-items">3. HyperLogLog , “How many unique items?”</h4>
<p>Estimates cardinality (number of distinct elements) with very small memory (~1.5 KB for millions).</p>
</section>
<section id="a.-idea-1" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-1">A. Idea</h4>
<p>Hash each element uniformly → 32-bit value. Split hash into:</p>
<ul>
<li>Prefix bits → bucket index- Suffix bits → count leading zeros Each bucket stores the max leading zero count seen. At the end, use harmonic mean of counts to estimate distinct values.</li>
</ul>
</section>
<section id="b.-formula" class="level4">
<h4 class="anchored" data-anchor-id="b.-formula">B. Formula</h4>
<p><span class="math display">\[
E = \alpha_m \cdot m^2 \cdot \Big(\sum_{i=1}^m 2^{-M[i]}\Big)^{-1}
\]</span></p>
<p>where <code>M[i]</code> is the zero count in bucket <code>i</code>, and <span class="math inline">\(\alpha_m\)</span> is a correction constant.</p>
<p>Accuracy: ~1.04 / √m</p>
</section>
<section id="c.-complexity-1" class="level4">
<h4 class="anchored" data-anchor-id="c.-complexity-1">C. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Time</th>
<th>Space</th>
<th>Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Add</td>
<td>O(1)</td>
<td>O(m)</td>
<td>~1.04/√m</td>
</tr>
<tr class="even">
<td>Merge</td>
<td>O(m)</td>
<td>O(m)</td>
<td>,</td>
</tr>
</tbody>
</table>
<p>Used in:</p>
<ul>
<li>Web analytics (unique visitors)- Databases (<code>COUNT DISTINCT</code>)- Distributed systems (mergeable estimates)</li>
</ul>
</section>
<section id="comparison-12" class="level4">
<h4 class="anchored" data-anchor-id="comparison-12">4. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 7%">
<col style="width: 14%">
<col style="width: 22%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Structure</th>
<th>Purpose</th>
<th>Query</th>
<th>Memory</th>
<th>Error</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bloom</td>
<td>Membership</td>
<td>O(k)</td>
<td>Tiny</td>
<td>False positives</td>
<td>No deletions</td>
</tr>
<tr class="even">
<td>Count-Min</td>
<td>Frequency</td>
<td>O(D)</td>
<td>Small</td>
<td>Overestimate</td>
<td>Streaming counts</td>
</tr>
<tr class="odd">
<td>HyperLogLog</td>
<td>Cardinality</td>
<td>O(1)</td>
<td>Very small</td>
<td>~1%</td>
<td>Mergeable</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-26" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-26">Tiny Code</h4>
<p>Bloom Filter Demo:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb107"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>add<span class="op">(</span><span class="dv">42</span><span class="op">);</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>add<span class="op">(</span><span class="dv">17</span><span class="op">);</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> contains<span class="op">(</span><span class="dv">42</span><span class="op">));</span> <span class="co">// 1 (maybe yes)</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> contains<span class="op">(</span><span class="dv">99</span><span class="op">));</span> <span class="co">// 0 (definitely no)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-26" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-26">Why It Matters</h4>
<p>Probabilistic data structures show how approximation beats impossibility when resources are tight. They make it feasible to process massive streams in real time, when storing everything is impossible.</p>
<p>They teach a deeper algorithmic truth:</p>
<blockquote class="blockquote">
<p>“A bit of uncertainty can buy you a world of scalability.”</p>
</blockquote>
</section>
<section id="try-it-yourself-26" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-26">Try It Yourself</h4>
<ol type="1">
<li>Implement a Bloom filter with 3 hash functions.</li>
<li>Measure false positive rate for 10K elements.</li>
<li>Build a Count-Min Sketch and test frequency estimation.</li>
<li>Approximate unique elements using HyperLogLog logic.</li>
<li>Explore real-world systems: Redis (Bloom/CM Sketch), PostgreSQL (HyperLogLog).</li>
</ol>
<p>These tiny probabilistic tools are how big data becomes tractable.</p>
</section>
</section>
<section id="skip-lists-and-b-trees" class="level3">
<h3 class="anchored" data-anchor-id="skip-lists-and-b-trees">28. Skip Lists and B-Trees</h3>
<p>When you want fast search, insert, and delete but need a structure that’s easier to code than trees or optimized for disk and memory blocks, two clever ideas step in:</p>
<ul>
<li>Skip Lists → randomized, layered linked lists that behave like balanced BSTs- B-Trees → multi-way trees that minimize disk I/O and organize large data blocks Both guarantee (O<span class="math inline">\(\log n\)</span>) operations, but they shine in very different environments , Skip Lists in-memory, B-Trees on disk.</li>
</ul>
<section id="skip-lists" class="level4">
<h4 class="anchored" data-anchor-id="skip-lists">1. Skip Lists</h4>
<p>Invented by: William Pugh (1990) Goal: Simulate binary search using linked lists with probabilistic shortcuts.</p>
</section>
<section id="a.-idea-2" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-2">A. Idea</h4>
<p>A skip list is a stack of linked lists, each level skipping over more elements.</p>
<p>Example:</p>
<pre><code>Level 3:        ┌───────&gt; 50 ───────┐
Level 2:   ┌──&gt; 10 ─────&gt; 30 ─────&gt; 50 ───┐
Level 1:  5 ──&gt; 10 ──&gt; 20 ──&gt; 30 ──&gt; 40 ──&gt; 50</code></pre>
<p>Higher levels are sparser and let you “skip” large chunks of the list.</p>
<p>You search top-down:</p>
<ul>
<li>Move right while next ≤ target- Drop down when you can’t go further This mimics binary search , logarithmic layers, logarithmic hops.</li>
</ul>
</section>
<section id="b.-construction" class="level4">
<h4 class="anchored" data-anchor-id="b.-construction">B. Construction</h4>
<p>Each inserted element is given a random height, with geometric distribution:</p>
<ul>
<li>Level 1 (base) always exists- Level 2 with probability ½- Level 3 with ¼, etc. Expected total nodes = 2n, Expected height = (O<span class="math inline">\(\log n\)</span>)</li>
</ul>
</section>
<section id="c.-operations" class="level4">
<h4 class="anchored" data-anchor-id="c.-operations">C. Operations</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Time</th>
<th>Space</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Search</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
<td>O(n)</td>
<td>Randomized balance</td>
</tr>
<tr class="even">
<td>Insert</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
<td>O(n)</td>
<td>Rebuild towers</td>
</tr>
<tr class="odd">
<td>Delete</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
<td>O(n)</td>
<td>Rewire pointers</td>
</tr>
</tbody>
</table>
<p>Search Algorithm:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb109"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> search<span class="op">(</span>SkipList<span class="op">*</span> sl<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> cur <span class="op">=</span> sl<span class="op">-&gt;</span>head<span class="op">;</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> lvl <span class="op">=</span> sl<span class="op">-&gt;</span>level<span class="op">;</span> lvl <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> lvl<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>cur<span class="op">-&gt;</span>forward<span class="op">[</span>lvl<span class="op">]</span> <span class="op">&amp;&amp;</span> cur<span class="op">-&gt;</span>forward<span class="op">[</span>lvl<span class="op">]-&gt;</span>key <span class="op">&lt;</span> key<span class="op">)</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>            cur <span class="op">=</span> cur<span class="op">-&gt;</span>forward<span class="op">[</span>lvl<span class="op">];</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>    cur <span class="op">=</span> cur<span class="op">-&gt;</span>forward<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>cur <span class="op">&amp;&amp;</span> cur<span class="op">-&gt;</span>key <span class="op">==</span> key<span class="op">)</span> <span class="cf">return</span> cur<span class="op">;</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> NULL<span class="op">;</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Skip Lists are simple, fast, and probabilistically balanced , no rotations, no rebalancing.</p>
</section>
<section id="d.-why-use-skip-lists" class="level4">
<h4 class="anchored" data-anchor-id="d.-why-use-skip-lists">D. Why Use Skip Lists?</h4>
<ul>
<li><p>Easier to implement than balanced trees- Support concurrent access well- Randomized, not deterministic , but highly reliable Used in:</p></li>
<li><p>Redis (sorted sets)- LevelDB / RocksDB internals- Concurrent maps</p></li>
</ul>
</section>
<section id="b-trees" class="level4">
<h4 class="anchored" data-anchor-id="b-trees">2. B-Trees</h4>
<p>Invented by: Rudolf Bayer &amp; Ed McCreight (1972) Goal: Reduce disk access by grouping data in blocks.</p>
<p>A B-Tree is a generalization of a BST:</p>
<ul>
<li>Each node holds multiple keys and children- Keys are kept sorted- Child subtrees span ranges between keys</li>
</ul>
</section>
<section id="a.-structure" class="level4">
<h4 class="anchored" data-anchor-id="a.-structure">A. Structure</h4>
<p>A B-Tree of order <code>m</code>:</p>
<ul>
<li>Each node has ≤ <code>m</code> children- Each internal node has <code>k-1</code> keys if it has <code>k</code> children- All leaves at the same depth Example (order 3):</li>
</ul>
<pre><code>        [17 | 35]
       /    |     \
 [5 10] [20 25 30] [40 45 50]</code></pre>
</section>
<section id="b.-operations" class="level4">
<h4 class="anchored" data-anchor-id="b.-operations">B. Operations</h4>
<ol type="1">
<li><p>Search</p>
<ul>
<li>Traverse from root - Binary search in each node’s key array - Follow appropriate child → (O<span class="math inline">\(\log_m n\)</span>)</li>
</ul></li>
<li><p>Insert</p>
<ul>
<li>Insert in leaf - If overflow → split node - Promote median key to parent</li>
</ul></li>
<li><p>Delete</p>
<ul>
<li>Borrow or merge if node underflows Each split or merge keeps height minimal.</li>
</ul></li>
</ol>
</section>
<section id="c.-complexity-2" class="level4">
<h4 class="anchored" data-anchor-id="c.-complexity-2">C. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Time</th>
<th>Disk Accesses</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Search</td>
<td>(O<span class="math inline">\(\log_m n\)</span>)</td>
<td>(O<span class="math inline">\(\log_m n\)</span>)</td>
<td>m = branching factor</td>
</tr>
<tr class="even">
<td>Insert</td>
<td>(O<span class="math inline">\(\log_m n\)</span>)</td>
<td>(O(1)) splits</td>
<td>Balanced</td>
</tr>
<tr class="odd">
<td>Delete</td>
<td>(O<span class="math inline">\(\log_m n\)</span>)</td>
<td>(O(1)) merges</td>
<td>Balanced</td>
</tr>
</tbody>
</table>
<p>Height ≈ <span class="math inline">\(\log_m n\)</span> → very shallow when (m) large (e.g.&nbsp;100).</p>
</section>
<section id="d.-b-tree-variant" class="level4">
<h4 class="anchored" data-anchor-id="d.-b-tree-variant">D. B+ Tree Variant</h4>
<p>In B+ Trees:</p>
<ul>
<li><p>All data in leaves (internal nodes = indexes)- Leaves linked → efficient range queries Used in:</p></li>
<li><p>Databases (MySQL, PostgreSQL)- File systems (NTFS, HFS+)- Key-value stores</p></li>
</ul>
</section>
<section id="e.-example-flow" class="level4">
<h4 class="anchored" data-anchor-id="e.-example-flow">E. Example Flow</h4>
<p>Insert 25:</p>
<pre><code>[10 | 20 | 30] → overflow
Split → [10] [30]
Promote 20
Root: [20]</code></pre>
</section>
<section id="comparison-13" class="level4">
<h4 class="anchored" data-anchor-id="comparison-13">3. Comparison</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>Skip List</th>
<th>B-Tree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Balancing</td>
<td>Randomized</td>
<td>Deterministic</td>
</tr>
<tr class="even">
<td>Fanout</td>
<td>2 (linked)</td>
<td>m-way</td>
</tr>
<tr class="odd">
<td>Environment</td>
<td>In-memory</td>
<td>Disk-based</td>
</tr>
<tr class="even">
<td>Search</td>
<td>O(log n)</td>
<td>O<span class="math inline">\(log_m n\)</span></td>
</tr>
<tr class="odd">
<td>Insert/Delete</td>
<td>O(log n)</td>
<td>O<span class="math inline">\(log_m n\)</span></td>
</tr>
<tr class="even">
<td>Concurrency</td>
<td>Easy</td>
<td>Complex</td>
</tr>
<tr class="odd">
<td>Range Queries</td>
<td>Sequential scan</td>
<td>Linked leaves (B+)</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-27" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-27">Tiny Code</h4>
<p>Skip List Search (Conceptual):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb112"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> search<span class="op">(</span>SkipList<span class="op">*</span> list<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> cur <span class="op">=</span> list<span class="op">-&gt;</span>head<span class="op">;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> lvl <span class="op">=</span> list<span class="op">-&gt;</span>level<span class="op">;</span> lvl <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> lvl<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>cur<span class="op">-&gt;</span>next<span class="op">[</span>lvl<span class="op">]</span> <span class="op">&amp;&amp;</span> cur<span class="op">-&gt;</span>next<span class="op">[</span>lvl<span class="op">]-&gt;</span>key <span class="op">&lt;</span> key<span class="op">)</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>            cur <span class="op">=</span> cur<span class="op">-&gt;</span>next<span class="op">[</span>lvl<span class="op">];</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    cur <span class="op">=</span> cur<span class="op">-&gt;</span>next<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>cur <span class="op">&amp;&amp;</span> cur<span class="op">-&gt;</span>key <span class="op">==</span> key<span class="op">)</span> <span class="op">?</span> cur <span class="op">:</span> NULL<span class="op">;</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>B-Tree Node (Skeleton):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb113"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define M </span><span class="dv">4</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> keys<span class="op">[</span>M<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> child<span class="op">[</span>M<span class="op">];</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-27" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-27">Why It Matters</h4>
<p>Skip Lists and B-Trees show two paths to balance:</p>
<ul>
<li>Randomized simplicity (Skip List)- Block-based order (B-Tree) Both offer logarithmic guarantees, but one optimizes pointer chasing, the other I/O.</li>
</ul>
<p>They’re fundamental to:</p>
<ul>
<li>In-memory caches (Skip List)- On-disk indexes (B-Tree, B+ Tree)- Sorted data structures across systems</li>
</ul>
</section>
<section id="try-it-yourself-27" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-27">Try It Yourself</h4>
<ol type="1">
<li>Build a basic skip list and insert random keys.</li>
<li>Trace a search path across levels.</li>
<li>Implement B-Tree insert and split logic.</li>
<li>Compare height of BST vs B-Tree for 1,000 keys.</li>
<li>Explore how Redis and MySQL use these internally.</li>
</ol>
<p>Together, they form the bridge between linked lists and balanced trees, uniting speed, structure, and scalability.</p>
</section>
</section>
<section id="persistent-and-functional-data-structures" class="level3">
<h3 class="anchored" data-anchor-id="persistent-and-functional-data-structures">29. Persistent and Functional Data Structures</h3>
<p>Most data structures are ephemeral , when you update them, the old version disappears. But sometimes, you want to keep all past versions, so you can go back in time, undo operations, or run concurrent reads safely.</p>
<p>That’s the magic of persistent data structures: every update creates a new version while sharing most of the old structure.</p>
<p>This section introduces the idea of persistence, explores how to make classic structures like arrays and trees persistent, and explains why functional programming loves them.</p>
<section id="what-is-persistence" class="level4">
<h4 class="anchored" data-anchor-id="what-is-persistence">1. What Is Persistence?</h4>
<p>A persistent data structure preserves previous versions after updates. You can access any version , past or present , without side effects.</p>
<p>Three levels:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 68%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Partial</td>
<td>Can access past versions, but only modify the latest</td>
<td>Undo stack</td>
</tr>
<tr class="even">
<td>Full</td>
<td>Can access and modify any version</td>
<td>Immutable map</td>
</tr>
<tr class="odd">
<td>Confluent</td>
<td>Can combine different versions</td>
<td>Git-like merges</td>
</tr>
</tbody>
</table>
<p>This is essential in functional programming, undo systems, version control, persistent segment trees, and immutable databases.</p>
</section>
<section id="ephemeral-vs-persistent" class="level4">
<h4 class="anchored" data-anchor-id="ephemeral-vs-persistent">2. Ephemeral vs Persistent</h4>
<p>Ephemeral:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb114"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">7</span><span class="op">;</span> <span class="co">// old value lost forever</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Persistent:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb115"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>new_arr <span class="op">=</span> update<span class="op">(</span>arr<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> <span class="co">// old_arr still exists</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Persistent structures use structural sharing , unchanged parts are reused, not copied.</p>
</section>
<section id="persistent-linked-list" class="level4">
<h4 class="anchored" data-anchor-id="persistent-linked-list">3. Persistent Linked List</h4>
<p>Easiest example: each update creates a new head, reusing the tail.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb116"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Node <span class="op">{</span> <span class="dt">int</span> val<span class="op">;</span> Node<span class="op">*</span> next<span class="op">;</span> <span class="op">};</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> push<span class="op">(</span>Node<span class="op">*</span> head<span class="op">,</span> <span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> newHead <span class="op">=</span> malloc<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>Node<span class="op">));</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    newHead<span class="op">-&gt;</span>val <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    newHead<span class="op">-&gt;</span>next <span class="op">=</span> head<span class="op">;</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> newHead<span class="op">;</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Now both <code>old_head</code> and <code>new_head</code> coexist. Each version is immutable , you never change existing nodes.</p>
<p>Access: old and new lists share most of their structure:</p>
<pre><code>v0: 1 → 2 → 3
v1: 0 → 1 → 2 → 3</code></pre>
<p>Only one new node was created.</p>
</section>
<section id="persistent-binary-tree" class="level4">
<h4 class="anchored" data-anchor-id="persistent-binary-tree">4. Persistent Binary Tree</h4>
<p>For trees, updates create new paths from the root to the modified node, reusing the rest.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb118"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>left<span class="op">,</span> <span class="op">*</span>right<span class="op">;</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> update<span class="op">(</span>Node<span class="op">*</span> root<span class="op">,</span> <span class="dt">int</span> pos<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>root<span class="op">)</span> <span class="cf">return</span> newNode<span class="op">(</span>val<span class="op">);</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> node <span class="op">=</span> malloc<span class="op">(</span><span class="kw">sizeof</span><span class="op">(</span>Node<span class="op">));</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>node <span class="op">=</span> <span class="op">*</span>root<span class="op">;</span> <span class="co">// copy</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>pos <span class="op">&lt;</span> root<span class="op">-&gt;</span>key<span class="op">)</span> node<span class="op">-&gt;</span>left <span class="op">=</span> update<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">,</span> pos<span class="op">,</span> val<span class="op">);</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> node<span class="op">-&gt;</span>right <span class="op">=</span> update<span class="op">(</span>root<span class="op">-&gt;</span>right<span class="op">,</span> pos<span class="op">,</span> val<span class="op">);</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node<span class="op">;</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Each <code>update</code> creates a new version , only (O<span class="math inline">\(\log n\)</span>) new nodes per change.</p>
<p>This is the core of persistent segment trees used in competitive programming.</p>
</section>
<section id="persistent-array-functional-trick" class="level4">
<h4 class="anchored" data-anchor-id="persistent-array-functional-trick">5. Persistent Array (Functional Trick)</h4>
<p>Arrays are trickier because of random access. Solutions:</p>
<ul>
<li><p>Use balanced binary trees as array replacements- Each update replaces one node- Persistent vector = tree of small arrays (used in Clojure, Scala) This gives:</p></li>
<li><p>Access: (O<span class="math inline">\(\log n\)</span>)- Update: (O<span class="math inline">\(\log n\)</span>)- Space: (O<span class="math inline">\(\log n\)</span>) per update</p></li>
</ul>
</section>
<section id="persistent-segment-tree" class="level4">
<h4 class="anchored" data-anchor-id="persistent-segment-tree">6. Persistent Segment Tree</h4>
<p>Used for versioned range queries:</p>
<ul>
<li>Each update = new root- Each version = snapshot of history Example: Track how array changes over time, query “sum in range [L,R] at version t”.</li>
</ul>
<p>Build:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb119"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> build<span class="op">(</span><span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">)</span> <span class="op">{</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> <span class="cf">return</span> newNode<span class="op">(</span>arr<span class="op">[</span>L<span class="op">]);</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L<span class="op">+</span>R<span class="op">)/</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> newNode<span class="op">(</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>L<span class="op">,</span> mid<span class="op">),</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>        build<span class="op">(</span>mid<span class="op">+</span><span class="dv">1</span><span class="op">,</span> R<span class="op">),</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>        sum</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Update: only (O<span class="math inline">\(\log n\)</span>) new nodes</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb120"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> update<span class="op">(</span>Node<span class="op">*</span> prev<span class="op">,</span> <span class="dt">int</span> L<span class="op">,</span> <span class="dt">int</span> R<span class="op">,</span> <span class="dt">int</span> pos<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>L <span class="op">==</span> R<span class="op">)</span> <span class="cf">return</span> newNode<span class="op">(</span>val<span class="op">);</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>L<span class="op">+</span>R<span class="op">)/</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>pos <span class="op">&lt;=</span> mid<span class="op">)</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> newNode<span class="op">(</span>update<span class="op">(</span>prev<span class="op">-&gt;</span>left<span class="op">,</span> L<span class="op">,</span> mid<span class="op">,</span> pos<span class="op">,</span> val<span class="op">),</span> prev<span class="op">-&gt;</span>right<span class="op">);</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> newNode<span class="op">(</span>prev<span class="op">-&gt;</span>left<span class="op">,</span> update<span class="op">(</span>prev<span class="op">-&gt;</span>right<span class="op">,</span> mid<span class="op">+</span><span class="dv">1</span><span class="op">,</span> R<span class="op">,</span> pos<span class="op">,</span> val<span class="op">));</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Each version = new root; old ones still valid.</p>
</section>
<section id="functional-perspective" class="level4">
<h4 class="anchored" data-anchor-id="functional-perspective">7. Functional Perspective</h4>
<p>In functional programming, data is immutable by default. Instead of mutating, you create a new version.</p>
<p>This allows:</p>
<ul>
<li>Thread-safety (no races)- Time-travel debugging- Undo/redo systems- Concurrency without locks Languages like Haskell, Clojure, and Elm build everything this way.</li>
</ul>
<p>For example, Clojure’s <code>persistent vector</code> uses path copying and branching factor 32 for (O<span class="math inline">\(\log_{32} n\)</span>) access.</p>
</section>
<section id="applications-2" class="level4">
<h4 class="anchored" data-anchor-id="applications-2">8. Applications</h4>
<ul>
<li>Undo / Redo stacks (text editors, IDEs)- Version control (Git trees)- Immutable databases (Datomic)- Segment trees over time (competitive programming)- Snapshots in memory allocators or games</li>
</ul>
</section>
<section id="complexity-1" class="level4">
<h4 class="anchored" data-anchor-id="complexity-1">9. Complexity</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 22%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Structure</th>
<th>Update</th>
<th>Access</th>
<th>Space per Update</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Persistent Linked List</td>
<td>O(1)</td>
<td>O(1)</td>
<td>O(1)</td>
<td>Simple sharing</td>
</tr>
<tr class="even">
<td>Persistent Tree</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>Path copying</td>
</tr>
<tr class="odd">
<td>Persistent Array</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>Tree-backed</td>
</tr>
<tr class="even">
<td>Persistent Segment Tree</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>Versioned queries</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-28" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-28">Tiny Code</h4>
<p>Persistent Linked List Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb121"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> v0 <span class="op">=</span> NULL<span class="op">;</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>v0 <span class="op">=</span> push<span class="op">(</span>v0<span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>v0 <span class="op">=</span> push<span class="op">(</span>v0<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> v1 <span class="op">=</span> push<span class="op">(</span>v0<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co">// v0 = [2,3], v1 = [1,2,3]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-28" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-28">Why It Matters</h4>
<p>Persistence is about time as a first-class citizen. It lets you:</p>
<ul>
<li>Roll back- Compare versions- Work immutably and safely It’s the algorithmic foundation behind functional programming, time-travel debugging, and immutable data systems.</li>
</ul>
<p>It teaches this powerful idea:</p>
<blockquote class="blockquote">
<p>“Never destroy , always build upon what was.”</p>
</blockquote>
</section>
<section id="try-it-yourself-28" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-28">Try It Yourself</h4>
<ol type="1">
<li>Implement a persistent stack using linked lists.</li>
<li>Write a persistent segment tree for range sums.</li>
<li>Track array versions after each update and query old states.</li>
<li>Compare space/time with an ephemeral one.</li>
<li>Explore persistent structures in Clojure (<code>conj</code>, <code>assoc</code>) or Rust (<code>im</code> crate).</li>
</ol>
<p>Persistence transforms data from fleeting state into a history you can navigate , a timeline of structure and meaning.</p>
</section>
</section>
<section id="advanced-trees-and-range-queries" class="level3">
<h3 class="anchored" data-anchor-id="advanced-trees-and-range-queries">30. Advanced Trees and Range Queries</h3>
<p>So far, you’ve seen balanced trees (AVL, Red-Black, Treap) and segment-based structures (Segment Trees, Fenwick Trees). Now it’s time to combine those ideas and step into advanced trees , data structures that handle dynamic sets, order statistics, intervals, ranges, and geometry-like queries in logarithmic time.</p>
<p>This chapter is about trees that go beyond search , they store order, track ranges, and answer complex queries efficiently.</p>
<p>We’ll explore:</p>
<ul>
<li>Order Statistic Trees (k-th element, rank queries)- Interval Trees (range overlaps)- Range Trees (multi-dimensional search)- KD-Trees (spatial partitioning)- Merge Sort Trees (offline range queries)</li>
</ul>
<section id="order-statistic-tree" class="level4">
<h4 class="anchored" data-anchor-id="order-statistic-tree">1. Order Statistic Tree</h4>
<p>Goal: find the k-th smallest element, or the rank of an element, in (O<span class="math inline">\(\log n\)</span>).</p>
<p>Built on top of a balanced BST (e.g.&nbsp;Red-Black) by storing subtree sizes.</p>
</section>
<section id="a.-augmented-tree-nodes" class="level4">
<h4 class="anchored" data-anchor-id="a.-augmented-tree-nodes">A. Augmented Tree Nodes</h4>
<p>Each node keeps:</p>
<ul>
<li><code>key</code>: element value- <code>left</code>, <code>right</code>: children- <code>size</code>: number of nodes in subtree</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb122"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">,</span> size<span class="op">;</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>left<span class="op">,</span> <span class="op">*</span>right<span class="op">;</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Whenever you rotate or insert, update <code>size</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb123"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> get_size<span class="op">(</span>Node<span class="op">*</span> n<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> n <span class="op">?</span> n<span class="op">-&gt;</span>size <span class="op">:</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> update_size<span class="op">(</span>Node<span class="op">*</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n<span class="op">)</span> n<span class="op">-&gt;</span>size <span class="op">=</span> get_size<span class="op">(</span>n<span class="op">-&gt;</span>left<span class="op">)</span> <span class="op">+</span> get_size<span class="op">(</span>n<span class="op">-&gt;</span>right<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-find-k-th-element" class="level4">
<h4 class="anchored" data-anchor-id="b.-find-k-th-element">B. Find k-th Element</h4>
<p>Recursively use subtree sizes:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb124"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> kth<span class="op">(</span>Node<span class="op">*</span> root<span class="op">,</span> <span class="dt">int</span> k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> left <span class="op">=</span> get_size<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">);</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">==</span> left <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>k <span class="op">&lt;=</span> left<span class="op">)</span> <span class="cf">return</span> kth<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">,</span> k<span class="op">);</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">return</span> kth<span class="op">(</span>root<span class="op">-&gt;</span>right<span class="op">,</span> k <span class="op">-</span> left <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time: (O<span class="math inline">\(\log n\)</span>)</p>
</section>
<section id="c.-find-rank" class="level4">
<h4 class="anchored" data-anchor-id="c.-find-rank">C. Find Rank</h4>
<p>Find position of a key (number of smaller elements):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb125"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> rank<span class="op">(</span>Node<span class="op">*</span> root<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>root<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&lt;</span> root<span class="op">-&gt;</span>key<span class="op">)</span> <span class="cf">return</span> rank<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">,</span> key<span class="op">);</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;</span> root<span class="op">-&gt;</span>key<span class="op">)</span> <span class="cf">return</span> get_size<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> rank<span class="op">(</span>root<span class="op">-&gt;</span>right<span class="op">,</span> key<span class="op">);</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> get_size<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Used in:</p>
<ul>
<li>Databases (ORDER BY, pagination)- Quantile queries- Online median maintenance</li>
</ul>
</section>
<section id="interval-tree" class="level4">
<h4 class="anchored" data-anchor-id="interval-tree">2. Interval Tree</h4>
<p>Goal: find all intervals overlapping with a given point or range.</p>
<p>Used in computational geometry, scheduling, and genomic data.</p>
</section>
<section id="a.-structure-1" class="level4">
<h4 class="anchored" data-anchor-id="a.-structure-1">A. Structure</h4>
<p>BST ordered by interval low endpoint. Each node stores:</p>
<ul>
<li><code>low</code>, <code>high</code>: interval bounds- <code>max</code>: maximum <code>high</code> in its subtree</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb126"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> low<span class="op">,</span> high<span class="op">,</span> max<span class="op">;</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>left<span class="op">,</span> <span class="op">*</span>right<span class="op">;</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-query-overlap" class="level4">
<h4 class="anchored" data-anchor-id="b.-query-overlap">B. Query Overlap</h4>
<p>Check if <code>x</code> overlaps <code>node-&gt;interval</code>: If not, go left or right based on <code>max</code> values.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb127"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> overlap<span class="op">(</span>Interval a<span class="op">,</span> Interval b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">.</span>low <span class="op">&lt;=</span> b<span class="op">.</span>high <span class="op">&amp;&amp;</span> b<span class="op">.</span>low <span class="op">&lt;=</span> a<span class="op">.</span>high<span class="op">;</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> overlap_search<span class="op">(</span>Node<span class="op">*</span> root<span class="op">,</span> Interval q<span class="op">)</span> <span class="op">{</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>root<span class="op">)</span> <span class="cf">return</span> NULL<span class="op">;</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>overlap<span class="op">(</span>root<span class="op">-&gt;</span>interval<span class="op">,</span> q<span class="op">))</span> <span class="cf">return</span> root<span class="op">;</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>root<span class="op">-&gt;</span>left <span class="op">&amp;&amp;</span> root<span class="op">-&gt;</span>left<span class="op">-&gt;</span>max <span class="op">&gt;=</span> q<span class="op">.</span>low<span class="op">)</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> overlap_search<span class="op">(</span>root<span class="op">-&gt;</span>left<span class="op">,</span> q<span class="op">);</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> overlap_search<span class="op">(</span>root<span class="op">-&gt;</span>right<span class="op">,</span> q<span class="op">);</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time: (O<span class="math inline">\(\log n\)</span>) average</p>
</section>
<section id="c.-use-cases" class="level4">
<h4 class="anchored" data-anchor-id="c.-use-cases">C. Use Cases</h4>
<ul>
<li>Calendar/schedule conflict detection- Collision detection- Genome region lookup- Segment intersection</li>
</ul>
</section>
<section id="range-tree" class="level4">
<h4 class="anchored" data-anchor-id="range-tree">3. Range Tree</h4>
<p>Goal: multi-dimensional queries like</p>
<blockquote class="blockquote">
<p>“How many points fall inside rectangle [x1, x2] × [y1, y2]?”</p>
</blockquote>
<p>Structure:</p>
<ul>
<li>Primary BST on x- Each node stores secondary BST on y Query time: (O<span class="math inline">\(\log^2 n\)</span>) Space: (O<span class="math inline">\(n \log n\)</span>)</li>
</ul>
<p>Used in:</p>
<ul>
<li>2D search- Computational geometry- Databases (spatial joins)</li>
</ul>
</section>
<section id="kd-tree" class="level4">
<h4 class="anchored" data-anchor-id="kd-tree">4. KD-Tree</h4>
<p>Goal: efficiently search points in k-dimensional space.</p>
<p>Alternate splitting dimensions at each level:</p>
<ul>
<li><p>Level 0 → split by x- Level 1 → split by y- Level 2 → split by z Each node stores:</p></li>
<li><p>Point (vector)- Split axis Used for:</p></li>
<li><p>Nearest neighbor search- Range queries- ML (k-NN classifiers) Time:</p></li>
<li><p>Build: (O<span class="math inline">\(n \log n\)</span>)- Query: (O<span class="math inline">\(\sqrt{n}\)</span>) average in 2D</p></li>
</ul>
</section>
<section id="merge-sort-tree" class="level4">
<h4 class="anchored" data-anchor-id="merge-sort-tree">5. Merge Sort Tree</h4>
<p>Goal: query “number of elements ≤ k in range [L, R]”</p>
<p>Built like a segment tree, but each node stores a sorted list of its range.</p>
<p>Build: merge children lists Query: binary search in node lists</p>
<p>Time:</p>
<ul>
<li>Build: (O<span class="math inline">\(n \log n\)</span>)- Query: (O<span class="math inline">\(\log^2 n\)</span>) Used in offline queries and order-statistics over ranges.</li>
</ul>
</section>
<section id="comparison-14" class="level4">
<h4 class="anchored" data-anchor-id="comparison-14">6. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>Tree Type</th>
<th>Use Case</th>
<th>Query</th>
<th>Update</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Order Statistic</td>
<td>k-th, rank</td>
<td>O(log n)</td>
<td>O(log n)</td>
<td>Augmented BST</td>
</tr>
<tr class="even">
<td>Interval</td>
<td>Overlaps</td>
<td>O(log n + k)</td>
<td>O(log n)</td>
<td>Store intervals</td>
</tr>
<tr class="odd">
<td>Range Tree</td>
<td>2D range</td>
<td>O(log² n + k)</td>
<td>O(log² n)</td>
<td>Multi-dim</td>
</tr>
<tr class="even">
<td>KD-Tree</td>
<td>Spatial</td>
<td>O(√n) avg</td>
<td>O(log n)</td>
<td>Nearest neighbor</td>
</tr>
<tr class="odd">
<td>Merge Sort Tree</td>
<td>Offline rank</td>
<td>O(log² n)</td>
<td>Static</td>
<td>Built from sorted segments</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-29" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-29">Tiny Code</h4>
<p>Order Statistic Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb128"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> root <span class="op">=</span> NULL<span class="op">;</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> insert<span class="op">(</span>root<span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> insert<span class="op">(</span>root<span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> insert<span class="op">(</span>root<span class="op">,</span> <span class="dv">30</span><span class="op">);</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> kth<span class="op">(</span>root<span class="op">,</span> <span class="dv">2</span><span class="op">)-&gt;</span>key<span class="op">);</span> <span class="co">// 20</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Interval Query:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb129"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>Interval q <span class="op">=</span> <span class="op">{</span><span class="dv">15</span><span class="op">,</span> <span class="dv">17</span><span class="op">};</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> res <span class="op">=</span> overlap_search<span class="op">(</span>root<span class="op">,</span> q<span class="op">);</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>res<span class="op">)</span> printf<span class="op">(</span><span class="st">"Overlap: [</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d</span><span class="st">]</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> res<span class="op">-&gt;</span>low<span class="op">,</span> res<span class="op">-&gt;</span>high<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-29" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-29">Why It Matters</h4>
<p>These trees extend balance into dimensions and ranges. They let you query ordered data efficiently: “How many?”, “Which overlaps?”, “Where is k-th smallest?”.</p>
<p>They teach a deeper design principle:</p>
<blockquote class="blockquote">
<p>“Augment structure with knowledge , balance plus metadata equals power.”</p>
</blockquote>
</section>
<section id="try-it-yourself-29" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-29">Try It Yourself</h4>
<ol type="1">
<li>Implement an order statistic tree , test rank/k-th queries.</li>
<li>Insert intervals and test overlap detection.</li>
<li>Build a simple KD-tree for 2D points.</li>
<li>Solve rectangle counting with a range tree.</li>
<li>Precompute a merge sort tree for offline queries.</li>
</ol>
<p>These advanced trees form the final evolution of structured queries , blending geometry, order, and logarithmic precision.</p>
</section>
</section>
</section>
<section id="chapter-4.-graph-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="chapter-4.-graph-algorithms">Chapter 4. Graph Algorithms</h2>
<section id="traversals-dfs-bfs-iterative-deepening" class="level3">
<h3 class="anchored" data-anchor-id="traversals-dfs-bfs-iterative-deepening">31. Traversals (DFS, BFS, Iterative Deepening)</h3>
<p>Graphs are everywhere , maps, networks, dependencies, state spaces. Before you can analyze them, you need a way to visit their vertices , systematically, without getting lost or looping forever.</p>
<p>That’s where graph traversals come in. They’re the foundation for everything that follows: connected components, shortest paths, spanning trees, topological sorts, and more.</p>
<p>This section walks through the three pillars:</p>
<ul>
<li>DFS (Depth-First Search) , explore deeply before backtracking- BFS (Breadth-First Search) , explore level by level- Iterative Deepening , a memory-friendly hybrid</li>
</ul>
<section id="representing-graphs" class="level4">
<h4 class="anchored" data-anchor-id="representing-graphs">1. Representing Graphs</h4>
<p>Before traversal, you need a good structure.</p>
<p>Adjacency List (most common):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb130"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAX </span><span class="dv">1000</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> adj<span class="op">[</span>MAX<span class="op">];</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Add edges:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb131"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add_edge<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    adj<span class="op">[</span>u<span class="op">].</span>push_back<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    adj<span class="op">[</span>v<span class="op">].</span>push_back<span class="op">(</span>u<span class="op">);</span> <span class="co">// omit if directed</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Track visited vertices:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb132"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> visited<span class="op">[</span>MAX<span class="op">];</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="depth-first-search-dfs" class="level4">
<h4 class="anchored" data-anchor-id="depth-first-search-dfs">2. Depth-First Search (DFS)</h4>
<p>DFS dives deep, following one branch fully before exploring others. It’s recursive, like exploring a maze by always turning left until you hit a wall.</p>
</section>
<section id="a.-recursive-form" class="level4">
<h4 class="anchored" data-anchor-id="a.-recursive-form">A. Recursive Form</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb133"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span> <span class="op">{</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    visited<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>visited<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Start it:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb134"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>dfs<span class="op">(</span>start_node<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-iterative-form-with-stack" class="level4">
<h4 class="anchored" data-anchor-id="b.-iterative-form-with-stack">B. Iterative Form (with Stack)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb135"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs_iter<span class="op">(</span><span class="dt">int</span> start<span class="op">)</span> <span class="op">{</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    stack<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> s<span class="op">;</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    s<span class="op">.</span>push<span class="op">(</span>start<span class="op">);</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>s<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> s<span class="op">.</span>top<span class="op">();</span> s<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>visited<span class="op">[</span>u<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>        visited<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> s<span class="op">.</span>push<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-complexity-3" class="level4">
<h4 class="anchored" data-anchor-id="c.-complexity-3">C. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Graph Type</th>
<th>Time</th>
<th>Space</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adjacency List</td>
<td>O(V + E)</td>
<td>O(V)</td>
</tr>
</tbody>
</table>
<p>DFS is used in:</p>
<ul>
<li>Connected components- Cycle detection- Topological sort- Backtracking &amp; search- Articulation points / bridges</li>
</ul>
</section>
<section id="breadth-first-search-bfs" class="level4">
<h4 class="anchored" data-anchor-id="breadth-first-search-bfs">3. Breadth-First Search (BFS)</h4>
<p>BFS explores neighbors first , it’s like expanding in waves. This guarantees shortest path in unweighted graphs.</p>
</section>
<section id="a.-bfs-with-queue" class="level4">
<h4 class="anchored" data-anchor-id="a.-bfs-with-queue">A. BFS with Queue</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb136"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> bfs<span class="op">(</span><span class="dt">int</span> start<span class="op">)</span> <span class="op">{</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> q<span class="op">;</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    q<span class="op">.</span>push<span class="op">(</span>start<span class="op">);</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    visited<span class="op">[</span>start<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>visited<span class="op">[</span>v<span class="op">])</span> <span class="op">{</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>                visited<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>                q<span class="op">.</span>push<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-track-distance" class="level4">
<h4 class="anchored" data-anchor-id="b.-track-distance">B. Track Distance</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb137"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dist<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> bfs_dist<span class="op">(</span><span class="dt">int</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">(</span>dist<span class="op">,</span> dist <span class="op">+</span> MAX<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    dist<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> q<span class="op">;</span> q<span class="op">.</span>push<span class="op">(</span>s<span class="op">);</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>v<span class="op">]</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>                dist<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>                q<span class="op">.</span>push<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Now <code>dist[v]</code> gives shortest distance from <code>s</code>.</p>
</section>
<section id="c.-complexity-4" class="level4">
<h4 class="anchored" data-anchor-id="c.-complexity-4">C. Complexity</h4>
<p>Same as DFS:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Time</th>
<th>Space</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>O(V + E)</td>
<td>O(V)</td>
</tr>
</tbody>
</table>
<p>Used in:</p>
<ul>
<li>Shortest paths (unweighted)- Level-order traversal- Bipartite check- Connected components</li>
</ul>
</section>
<section id="iterative-deepening-search-ids" class="level4">
<h4 class="anchored" data-anchor-id="iterative-deepening-search-ids">4. Iterative Deepening Search (IDS)</h4>
<p>DFS is memory-light but might go too deep. BFS is optimal but can use a lot of memory. Iterative Deepening Search (IDS) combines both.</p>
<p>It performs DFS with increasing depth limits:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb138"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> dls<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> target<span class="op">,</span> <span class="dt">int</span> depth<span class="op">)</span> <span class="op">{</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>u <span class="op">==</span> target<span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>depth <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>dls<span class="op">(</span>v<span class="op">,</span> target<span class="op">,</span> depth <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> ids<span class="op">(</span><span class="dt">int</span> start<span class="op">,</span> <span class="dt">int</span> target<span class="op">,</span> <span class="dt">int</span> max_depth<span class="op">)</span> <span class="op">{</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> d <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> d <span class="op">&lt;=</span> max_depth<span class="op">;</span> d<span class="op">++)</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>dls<span class="op">(</span>start<span class="op">,</span> target<span class="op">,</span> d<span class="op">))</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Used in:</p>
<ul>
<li>AI search problems (state spaces)- Game trees (chess, puzzles)</li>
</ul>
</section>
<section id="traversal-order-examples" class="level4">
<h4 class="anchored" data-anchor-id="traversal-order-examples">5. Traversal Order Examples</h4>
<p>For a graph:</p>
<pre><code>1 - 2 - 3
|   |
4 - 5</code></pre>
<p>DFS (starting at 1): 1 → 2 → 3 → 5 → 4 BFS (starting at 1): 1 → 2 → 4 → 3 → 5</p>
</section>
<section id="directed-vs-undirected" class="level4">
<h4 class="anchored" data-anchor-id="directed-vs-undirected">6. Directed vs Undirected</h4>
<ul>
<li><p>Undirected: mark both directions- Directed: follow edge direction only DFS on directed graphs is core to:</p></li>
<li><p>SCC (Strongly Connected Components)- Topological Sorting- Reachability analysis</p></li>
</ul>
</section>
<section id="traversal-trees" class="level4">
<h4 class="anchored" data-anchor-id="traversal-trees">7. Traversal Trees</h4>
<p>Each traversal implicitly builds a spanning tree:</p>
<ul>
<li><p>DFS Tree: based on recursion- BFS Tree: based on levels Use them to:</p></li>
<li><p>Detect cross edges, back edges- Classify edges (important for algorithms like Tarjan’s)</p></li>
</ul>
</section>
<section id="comparison-15" class="level4">
<h4 class="anchored" data-anchor-id="comparison-15">8. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 41%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>DFS</th>
<th>BFS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Strategy</td>
<td>Deep first</td>
<td>Level-wise</td>
</tr>
<tr class="even">
<td>Space</td>
<td>O(V) (stack)</td>
<td>O(V) (queue)</td>
</tr>
<tr class="odd">
<td>Path Optimality</td>
<td>Not guaranteed</td>
<td>Yes (unweighted)</td>
</tr>
<tr class="even">
<td>Applications</td>
<td>Cycle detection, backtracking</td>
<td>Shortest path, level order</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-30" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-30">Tiny Code</h4>
<p>DFS + BFS Combo:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb140"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> traverse<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> visited<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    dfs<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> visited<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    bfs<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-30" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-30">Why It Matters</h4>
<p>DFS and BFS are the roots of graph theory in practice. Every algorithm you’ll meet later , shortest paths, flows, SCCs , builds upon them.</p>
<p>They teach you how to navigate structure, how to systematically explore unknowns, and how search lies at the heart of computation.</p>
</section>
<section id="try-it-yourself-30" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-30">Try It Yourself</h4>
<ol type="1">
<li>Build an adjacency list and run DFS/BFS from vertex 1.</li>
<li>Track discovery and finish times in DFS.</li>
<li>Use BFS to compute shortest paths in an unweighted graph.</li>
<li>Modify DFS to count connected components.</li>
<li>Implement IDS for a puzzle like the 8-puzzle.</li>
</ol>
<p>Graph traversal is the art of exploration , once you master it, the rest of graph theory falls into place.</p>
</section>
</section>
<section id="strongly-connected-components-tarjan-kosaraju" class="level3">
<h3 class="anchored" data-anchor-id="strongly-connected-components-tarjan-kosaraju">32. Strongly Connected Components (Tarjan, Kosaraju)</h3>
<p>In directed graphs, edges have direction, so connectivity gets tricky. It’s not enough for vertices to be reachable , you need mutual reachability.</p>
<p>That’s the essence of a strongly connected component (SCC):</p>
<blockquote class="blockquote">
<p>A set of vertices where every vertex can reach every other vertex.</p>
</blockquote>
<p>Think of SCCs as islands of mutual connectivity , inside, you can go anywhere; outside, you can’t. They’re the building blocks for simplifying directed graphs into condensation DAGs (no cycles).</p>
<p>We’ll explore two classic algorithms:</p>
<ul>
<li>Kosaraju’s Algorithm , clean, intuitive, two-pass- Tarjan’s Algorithm , one-pass, stack-based elegance</li>
</ul>
<section id="definition" class="level4">
<h4 class="anchored" data-anchor-id="definition">1. Definition</h4>
<p>A Strongly Connected Component (SCC) in a directed graph ( G = (V, E) ) is a maximal subset of vertices <span class="math inline">\(C \subseteq V\)</span> such that for every pair ( (u, v) C ): <span class="math inline">\(u \to v\)</span> and <span class="math inline">\(v \to u\)</span>.</p>
<p>In other words, every node in (C) is reachable from every other node in (C).</p>
<p>Example:</p>
<pre><code>1 → 2 → 3 → 1   forms an SCC  
4 → 5           separate SCCs</code></pre>
</section>
<section id="applications-3" class="level4">
<h4 class="anchored" data-anchor-id="applications-3">2. Applications</h4>
<ul>
<li>Condensation DAG: compress SCCs into single nodes , no cycles remain.- Component-based reasoning: topological sorting on DAG of SCCs.- Program analysis: detecting cycles, dependencies.- Web graphs: find clusters of mutually linked pages.- Control-flow: loops and strongly connected subroutines.</li>
</ul>
</section>
<section id="kosarajus-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="kosarajus-algorithm">3. Kosaraju’s Algorithm</h4>
<p>A simple two-pass algorithm using DFS and graph reversal.</p>
<p>Steps:</p>
<ol type="1">
<li>Run DFS and push nodes onto a stack in finish-time order.</li>
<li>Reverse the graph (edges flipped).</li>
<li>Pop nodes from stack; DFS on reversed graph; each DFS = one SCC.</li>
</ol>
</section>
<section id="a.-implementation" class="level4">
<h4 class="anchored" data-anchor-id="a.-implementation">A. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb142"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> adj<span class="op">[</span>MAX<span class="op">],</span> rev<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> visited<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>stack<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> st<span class="op">;</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;</span> sccs<span class="op">;</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs1<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span> <span class="op">{</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>    visited<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>visited<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>            dfs1<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>    st<span class="op">.</span>push<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs2<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&amp;</span> comp<span class="op">)</span> <span class="op">{</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>    visited<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>    comp<span class="op">.</span>push_back<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> rev<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>visited<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>            dfs2<span class="op">(</span>v<span class="op">,</span> comp<span class="op">);</span></span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> kosaraju<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Pass 1: order by finish time</span></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>visited<span class="op">[</span>i<span class="op">])</span> dfs1<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Reverse graph</span></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> u <span class="op">&lt;=</span> n<span class="op">;</span> u<span class="op">++)</span></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a>            rev<span class="op">[</span>v<span class="op">].</span>push_back<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Pass 2: collect SCCs</span></span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">(</span>visited<span class="op">,</span> visited <span class="op">+</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>st<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> st<span class="op">.</span>top<span class="op">();</span> st<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>visited<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a>            vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> comp<span class="op">;</span></span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a>            dfs2<span class="op">(</span>u<span class="op">,</span> comp<span class="op">);</span></span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a>            sccs<span class="op">.</span>push_back<span class="op">(</span>comp<span class="op">);</span></span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: (O(V + E)) , two DFS passes.</p>
<p>Space Complexity: (O(V + E))</p>
</section>
<section id="b.-example-1" class="level4">
<h4 class="anchored" data-anchor-id="b.-example-1">B. Example</h4>
<p>Graph:</p>
<pre><code>1 → 2 → 3  
↑   ↓   ↓  
5 ← 4 ← 6</code></pre>
<p>SCCs:</p>
<ul>
<li>{1,2,4,5}- {3,6}</li>
</ul>
</section>
<section id="tarjans-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="tarjans-algorithm">4. Tarjan’s Algorithm</h4>
<p>More elegant: one DFS pass, no reversal, stack-based. It uses discovery times and low-link values to detect SCC roots.</p>
</section>
<section id="a.-idea-3" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-3">A. Idea</h4>
<ul>
<li><code>disc[u]</code>: discovery time of node <code>u</code>- <code>low[u]</code>: smallest discovery time reachable from <code>u</code>- A node is root of an SCC if <code>disc[u] == low[u]</code> Maintain a stack of active nodes (in current DFS path).</li>
</ul>
</section>
<section id="b.-implementation" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb144"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> adj<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> disc<span class="op">[</span>MAX<span class="op">],</span> low<span class="op">[</span>MAX<span class="op">],</span> timer<span class="op">;</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> inStack<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>stack<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> st<span class="op">;</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;</span> sccs<span class="op">;</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs_tarjan<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span> <span class="op">{</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>    disc<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>timer<span class="op">;</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>    st<span class="op">.</span>push<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>    inStack<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>disc<span class="op">[</span>v<span class="op">])</span> <span class="op">{</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>            dfs_tarjan<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span> low<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>inStack<span class="op">[</span>v<span class="op">])</span> <span class="op">{</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span> disc<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>disc<span class="op">[</span>u<span class="op">]</span> <span class="op">==</span> low<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>        vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> comp<span class="op">;</span></span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span><span class="kw">true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> v <span class="op">=</span> st<span class="op">.</span>top<span class="op">();</span> st<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>            inStack<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>            comp<span class="op">.</span>push_back<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> u<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>        sccs<span class="op">.</span>push_back<span class="op">(</span>comp<span class="op">);</span></span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> tarjan<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>disc<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a>            dfs_tarjan<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: (O(V + E))</p>
<p>Space Complexity: (O(V))</p>
</section>
<section id="c.-walkthrough" class="level4">
<h4 class="anchored" data-anchor-id="c.-walkthrough">C. Walkthrough</h4>
<p>Graph:</p>
<pre><code>1 → 2 → 3  
↑   ↓   ↓  
5 ← 4 ← 6</code></pre>
<p>DFS visits nodes in order; when it finds a node whose <code>disc == low</code>, it pops from the stack to form an SCC.</p>
<p>Result:</p>
<pre><code>SCC1: 1 2 4 5
SCC2: 3 6</code></pre>
</section>
<section id="comparison-16" class="level4">
<h4 class="anchored" data-anchor-id="comparison-16">5. Comparison</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>Kosaraju</th>
<th>Tarjan</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DFS Passes</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<td>Reversal Needed</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="odd">
<td>Stack</td>
<td>Yes (finish order)</td>
<td>Yes (active path)</td>
</tr>
<tr class="even">
<td>Implementation</td>
<td>Simple conceptually</td>
<td>Compact, efficient</td>
</tr>
<tr class="odd">
<td>Time</td>
<td>O(V + E)</td>
<td>O(V + E)</td>
</tr>
</tbody>
</table>
</section>
<section id="condensation-graph" class="level4">
<h4 class="anchored" data-anchor-id="condensation-graph">6. Condensation Graph</h4>
<p>Once SCCs are found, you can build a DAG: Each SCC becomes a node, edges represent cross-SCC connections. Topological sorting now applies.</p>
<p>Used in:</p>
<ul>
<li>Dependency analysis- Strong component compression- DAG dynamic programming</li>
</ul>
</section>
<section id="tiny-code-31" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-31">Tiny Code</h4>
<p>Print SCCs (Tarjan):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb147"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>tarjan<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>comp <span class="op">:</span> sccs<span class="op">)</span> <span class="op">{</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> x <span class="op">:</span> comp<span class="op">)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span><span class="op">);</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-31" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-31">Why It Matters</h4>
<p>SCC algorithms turn chaotic directed graphs into structured DAGs. They’re the key to reasoning about cycles, dependencies, and modularity.</p>
<p>Understanding them reveals a powerful truth:</p>
<blockquote class="blockquote">
<p>“Every complex graph can be reduced to a simple hierarchy , once you find its strongly connected core.”</p>
</blockquote>
</section>
<section id="try-it-yourself-31" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-31">Try It Yourself</h4>
<ol type="1">
<li>Implement both Kosaraju and Tarjan , verify they match.</li>
<li>Build SCC DAG and run topological sort on it.</li>
<li>Detect cycles via SCC size &gt; 1.</li>
<li>Use SCCs to solve 2-SAT (boolean satisfiability).</li>
<li>Visualize condensation of a graph with 6 nodes.</li>
</ol>
<p>Once you can find SCCs, you can tame directionality , transforming messy networks into ordered systems.</p>
</section>
</section>
<section id="shortest-paths-dijkstra-bellman-ford-a-johnson" class="level3">
<h3 class="anchored" data-anchor-id="shortest-paths-dijkstra-bellman-ford-a-johnson">33. Shortest Paths (Dijkstra, Bellman-Ford, A*, Johnson)</h3>
<p>Once you can traverse a graph, the next natural question is:</p>
<blockquote class="blockquote">
<p>“What is the shortest path between two vertices?”</p>
</blockquote>
<p>Shortest path algorithms are the heart of routing, navigation, planning, and optimization. They compute minimal cost paths , whether distance, time, or weight , and adapt to different edge conditions (non-negative, negative, heuristic).</p>
<p>This section covers the most essential algorithms:</p>
<ul>
<li>Dijkstra’s Algorithm , efficient for non-negative weights- Bellman-Ford Algorithm , handles negative edges- A* , best-first with heuristics- Johnson’s Algorithm , all-pairs shortest paths in sparse graphs</li>
</ul>
<section id="the-shortest-path-problem" class="level4">
<h4 class="anchored" data-anchor-id="the-shortest-path-problem">1. The Shortest Path Problem</h4>
<p>Given a weighted graph ( G = (V, E) ) and a source ( s ), find <span class="math inline">\(\text{dist}[v]\)</span>, the minimum total weight to reach every vertex ( v ).</p>
<p>Variants:</p>
<ul>
<li>Single-source shortest path (SSSP) , one source to all- Single-pair , one source to one target- All-pairs shortest path (APSP) , every pair- Dynamic shortest path , with updates</li>
</ul>
</section>
<section id="dijkstras-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="dijkstras-algorithm">2. Dijkstra’s Algorithm</h4>
<p>Best for non-negative weights. Idea: explore vertices in increasing distance order, like water spreading.</p>
</section>
<section id="a.-steps" class="level4">
<h4 class="anchored" data-anchor-id="a.-steps">A. Steps</h4>
<ol type="1">
<li>Initialize all distances to infinity.</li>
<li>Set source distance = 0.</li>
<li>Use a priority queue to always pick the node with smallest tentative distance.</li>
<li>Relax all outgoing edges.</li>
</ol>
</section>
<section id="b.-implementation-adjacency-list" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-adjacency-list">B. Implementation (Adjacency List)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb148"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>using namespace std<span class="op">;</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> INF <span class="op">=</span> <span class="fl">1e9</span><span class="op">;</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;</span> adj<span class="op">[</span><span class="dv">1000</span><span class="op">];</span> <span class="co">// (neighbor, weight)</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dist<span class="op">[</span><span class="dv">1000</span><span class="op">];</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dijkstra<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">(</span>dist<span class="op">,</span> dist <span class="op">+</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> INF<span class="op">);</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>    dist<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>    priority_queue<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;,</span> vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;,</span> greater<span class="op">&lt;&gt;&gt;</span> pq<span class="op">;</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>    pq<span class="op">.</span>push<span class="op">({</span><span class="dv">0</span><span class="op">,</span> s<span class="op">});</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>pq<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="op">[</span>d<span class="op">,</span> u<span class="op">]</span> <span class="op">=</span> pq<span class="op">.</span>top<span class="op">();</span> pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> dist<span class="op">[</span>u<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w<span class="op">]</span> <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>v<span class="op">]</span> <span class="op">&gt;</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">)</span> <span class="op">{</span></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>                dist<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">;</span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>                pq<span class="op">.</span>push<span class="op">({</span>dist<span class="op">[</span>v<span class="op">],</span> v<span class="op">});</span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Using priority queue (binary heap): <span class="math inline">\(O((V + E)\log V)\)</span></li>
<li>Space: <span class="math inline">\(O(V + E)\)</span></li>
</ul>
</section>
<section id="c.-example" class="level4">
<h4 class="anchored" data-anchor-id="c.-example">C. Example</h4>
<p>Graph:</p>
<pre><code>1 →(2) 2 →(3) 3
↓(4)       ↑(1)
4 →(2)─────┘</code></pre>
<p><code>dijkstra(1)</code> gives shortest distances:</p>
<pre><code>dist[1] = 0  
dist[2] = 2  
dist[3] = 5  
dist[4] = 4</code></pre>
</section>
<section id="d.-properties" class="level4">
<h4 class="anchored" data-anchor-id="d.-properties">D. Properties</h4>
<ul>
<li>Works only if all edges <span class="math inline">\(w \ge 0\)</span>- Can reconstruct path via <code>parent[v]</code>- Used in:
<ul>
<li>GPS and routing systems - Network optimization - Scheduling with positive costs</li>
</ul></li>
</ul>
</section>
<section id="bellman-ford-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="bellman-ford-algorithm">3. Bellman-Ford Algorithm</h4>
<p>Handles negative edge weights, and detects negative cycles.</p>
</section>
<section id="a.-idea-4" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-4">A. Idea</h4>
<p>Relax all edges (V-1) times. If on (V)-th iteration you can still relax → negative cycle exists.</p>
</section>
<section id="b.-implementation-1" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-1">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb151"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Edge <span class="op">{</span> <span class="dt">int</span> u<span class="op">,</span> v<span class="op">,</span> w<span class="op">;</span> <span class="op">};</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>Edge<span class="op">&gt;</span> edges<span class="op">;</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dist<span class="op">[</span><span class="dv">1000</span><span class="op">];</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> bellman_ford<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">(</span>dist<span class="op">,</span> dist <span class="op">+</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> INF<span class="op">);</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>    dist<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> e <span class="op">:</span> edges<span class="op">)</span> <span class="op">{</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>e<span class="op">.</span>u<span class="op">]</span> <span class="op">+</span> e<span class="op">.</span>w <span class="op">&lt;</span> dist<span class="op">[</span>e<span class="op">.</span>v<span class="op">])</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>                dist<span class="op">[</span>e<span class="op">.</span>v<span class="op">]</span> <span class="op">=</span> dist<span class="op">[</span>e<span class="op">.</span>u<span class="op">]</span> <span class="op">+</span> e<span class="op">.</span>w<span class="op">;</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Check for negative cycle</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> e <span class="op">:</span> edges<span class="op">)</span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>e<span class="op">.</span>u<span class="op">]</span> <span class="op">+</span> e<span class="op">.</span>w <span class="op">&lt;</span> dist<span class="op">[</span>e<span class="op">.</span>v<span class="op">])</span></span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> <span class="co">// negative cycle</span></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O(VE)) Works even when (w &lt; 0).</p>
</section>
<section id="c.-example-1" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-1">C. Example</h4>
<p>Graph:</p>
<pre><code>1 →(2) 2 →(-5) 3 →(2) 4</code></pre>
<p>Bellman-Ford finds path 1→2→3→4 with total cost (-1).</p>
<p>If a cycle reduces total weight indefinitely, algorithm detects it.</p>
</section>
<section id="d.-use-cases" class="level4">
<h4 class="anchored" data-anchor-id="d.-use-cases">D. Use Cases</h4>
<ul>
<li>Currency exchange arbitrage- Game graphs with penalties- Detecting impossible constraints</li>
</ul>
</section>
<section id="a-search-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="a-search-algorithm">4. A* Search Algorithm</h4>
<p>Heuristic-guided shortest path, perfect for pathfinding (AI, maps, games).</p>
<p>It combines actual cost and estimated cost: <span class="math display">\[
f(v) = g(v) + h(v)
\]</span> where</p>
<ul>
<li>(g(v)): known cost so far- (h(v)): heuristic estimate (must be admissible)</li>
</ul>
</section>
<section id="a.-pseudocode" class="level4">
<h4 class="anchored" data-anchor-id="a.-pseudocode">A. Pseudocode</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb153"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>priority_queue<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;,</span> vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;,</span> greater<span class="op">&lt;&gt;&gt;</span> pq<span class="op">;</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>g<span class="op">[</span>start<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>pq<span class="op">.</span>push<span class="op">({</span>h<span class="op">[</span>start<span class="op">],</span> start<span class="op">});</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(!</span>pq<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> <span class="op">[</span>f<span class="op">,</span> u<span class="op">]</span> <span class="op">=</span> pq<span class="op">.</span>top<span class="op">();</span> pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>u <span class="op">==</span> goal<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w<span class="op">]</span> <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> new_g <span class="op">=</span> g<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">;</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>new_g <span class="op">&lt;</span> g<span class="op">[</span>v<span class="op">])</span> <span class="op">{</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>            g<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> new_g<span class="op">;</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>            pq<span class="op">.</span>push<span class="op">({</span>g<span class="op">[</span>v<span class="op">]</span> <span class="op">+</span> h<span class="op">[</span>v<span class="op">],</span> v<span class="op">});</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Heuristic Example:</p>
<ul>
<li>Euclidean distance (for grids)- Manhattan distance (for 4-direction movement)</li>
</ul>
</section>
<section id="b.-use-cases" class="level4">
<h4 class="anchored" data-anchor-id="b.-use-cases">B. Use Cases</h4>
<ul>
<li>Game AI (pathfinding)- Robot motion planning- Map navigation Complexity: (O(E)) in best case, depends on heuristic quality.</li>
</ul>
</section>
<section id="johnsons-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="johnsons-algorithm">5. Johnson’s Algorithm</h4>
<p>Goal: All-Pairs Shortest Path in sparse graphs with negative edges (no negative cycles).</p>
<p>Idea:</p>
<ol type="1">
<li>Add new vertex <code>q</code> connected to all others with edge weight 0</li>
<li>Run Bellman-Ford from <code>q</code> to get potential <code>h(v)</code></li>
<li>Reweight edges: (w’(u, v) = w(u, v) + h(u) - h(v)) (now all weights ≥ 0)</li>
<li>Run Dijkstra from each vertex</li>
</ol>
<p>Complexity: (O<span class="math inline">\(VE + V^2 \log V\)</span>)</p>
</section>
<section id="summary-2" class="level4">
<h4 class="anchored" data-anchor-id="summary-2">6. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 23%">
<col style="width: 21%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Handles Negative Weights</th>
<th>Detects Negative Cycle</th>
<th>Heuristic</th>
<th>Complexity</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dijkstra</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>O((V+E) log V)</td>
<td>Non-negative weights</td>
</tr>
<tr class="even">
<td>Bellman-Ford</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
<td>O(VE)</td>
<td>Negative edges</td>
</tr>
<tr class="odd">
<td>A*</td>
<td>No (unless careful)</td>
<td>No</td>
<td>Yes</td>
<td>Depends</td>
<td>Pathfinding</td>
</tr>
<tr class="even">
<td>Johnson</td>
<td>Yes (no neg. cycles)</td>
<td>Yes</td>
<td>No</td>
<td>O(VE + V log V)</td>
<td>All-pairs, sparse</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-32" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-32">Tiny Code</h4>
<p>Dijkstra Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb154"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>dijkstra<span class="op">(</span>n<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"dist[</span><span class="sc">%d</span><span class="st">] = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">,</span> dist<span class="op">[</span>i<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-32" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-32">Why It Matters</h4>
<p>Shortest paths are the essence of optimization , not just in graphs, but in reasoning: finding minimal cost, minimal distance, minimal risk.</p>
<p>These algorithms teach:</p>
<blockquote class="blockquote">
<p>“The path to a goal isn’t random , it’s guided by structure, weight, and knowledge.”</p>
</blockquote>
</section>
<section id="try-it-yourself-32" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-32">Try It Yourself</h4>
<ol type="1">
<li>Build a weighted graph and compare Dijkstra vs Bellman-Ford.</li>
<li>Introduce a negative edge and observe Bellman-Ford detecting it.</li>
<li>Implement A* on a grid with obstacles.</li>
<li>Use Dijkstra to plan routes in a city map dataset.</li>
<li>Try Johnson’s algorithm for all-pairs shortest paths.</li>
</ol>
<p>Master these, and you master direction + cost = intelligence in motion.</p>
</section>
</section>
<section id="shortest-path-variants-0-1-bfs-bidirectional-heuristic-a" class="level3">
<h3 class="anchored" data-anchor-id="shortest-path-variants-0-1-bfs-bidirectional-heuristic-a">34. Shortest Path Variants (0-1 BFS, Bidirectional, Heuristic A*)</h3>
<p>Sometimes the classic shortest path algorithms aren’t enough. You might have special edge weights (only 0 or 1), a need for faster searches, or extra structure you can exploit.</p>
<p>That’s where shortest path variants come in , they’re optimized adaptations of the big three (BFS, Dijkstra, A*) for specific scenarios.</p>
<p>In this section, we’ll explore:</p>
<ul>
<li>0-1 BFS → when edge weights are only 0 or 1- Bidirectional Search → meet-in-the-middle for speed- Heuristic A* → smarter exploration guided by estimates Each shows how structure in your problem can yield speed-ups.</li>
</ul>
<section id="bfs" class="level4">
<h4 class="anchored" data-anchor-id="bfs">1. 0-1 BFS</h4>
<p>If all edge weights are either 0 or 1, you don’t need a priority queue. A deque (double-ended queue) is enough for (O(V + E)) time.</p>
<p>Why? Because edges with weight 0 should be processed immediately, while edges with weight 1 can wait one step longer.</p>
</section>
<section id="a.-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="a.-algorithm">A. Algorithm</h4>
<p>Use a deque.</p>
<ul>
<li>When relaxing an edge with weight 0, push to front.- When relaxing an edge with weight 1, push to back.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb155"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> INF <span class="op">=</span> <span class="fl">1e9</span><span class="op">;</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;</span> adj<span class="op">[</span><span class="dv">1000</span><span class="op">];</span> <span class="co">// (v, w)</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dist<span class="op">[</span><span class="dv">1000</span><span class="op">];</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> zero_one_bfs<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">(</span>dist<span class="op">,</span> dist <span class="op">+</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> INF<span class="op">);</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>    deque<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> dq<span class="op">;</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>    dist<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>    dq<span class="op">.</span>push_front<span class="op">(</span>s<span class="op">);</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>dq<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> dq<span class="op">.</span>front<span class="op">();</span> dq<span class="op">.</span>pop_front<span class="op">();</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w<span class="op">]</span> <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>v<span class="op">]</span> <span class="op">&gt;</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">)</span> <span class="op">{</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>                dist<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">;</span></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>w <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> dq<span class="op">.</span>push_front<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> dq<span class="op">.</span>push_back<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-example-2" class="level4">
<h4 class="anchored" data-anchor-id="b.-example-2">B. Example</h4>
<p>Graph:</p>
<pre><code>1 -0-&gt; 2 -1-&gt; 3  
|              ^  
1              |  
+--------------+</code></pre>
<p>Shortest path from 1 to 3 = 1 (via edge 1-2-3). Deque ensures weight-0 edges don’t get delayed.</p>
</section>
<section id="c.-complexity-5" class="level4">
<h4 class="anchored" data-anchor-id="c.-complexity-5">C. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Time</th>
<th>Space</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>O(V + E)</td>
<td>O(V)</td>
<td>Optimal for binary weights</td>
</tr>
</tbody>
</table>
<p>Used in:</p>
<ul>
<li>Layered BFS- Grid problems with binary costs- BFS with teleportation (weight 0 edges)</li>
</ul>
</section>
<section id="bidirectional-search" class="level4">
<h4 class="anchored" data-anchor-id="bidirectional-search">2. Bidirectional Search</h4>
<p>Sometimes you just need one path , from source to target , in an unweighted graph. Instead of expanding from one side, expand from both ends and stop when they meet.</p>
<p>This reduces search depth from (O<span class="math inline">\(b^d\)</span>) to (O<span class="math inline">\(b^{d/2}\)</span>) (huge gain for large graphs).</p>
</section>
<section id="a.-idea-5" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-5">A. Idea</h4>
<p>Run BFS from both source and target simultaneously. When their frontiers intersect, you’ve found the shortest path.</p>
</section>
<section id="b.-implementation-2" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-2">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb157"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> visited_from_s<span class="op">[</span>MAX<span class="op">],</span> visited_from_t<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> qs<span class="op">,</span> qt<span class="op">;</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bidirectional_bfs<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">)</span> <span class="op">{</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>    qs<span class="op">.</span>push<span class="op">(</span>s<span class="op">);</span> visited_from_s<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    qt<span class="op">.</span>push<span class="op">(</span>t<span class="op">);</span> visited_from_t<span class="op">[</span>t<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>qs<span class="op">.</span>empty<span class="op">()</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>qt<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>step<span class="op">(</span>qs<span class="op">,</span> visited_from_s<span class="op">,</span> visited_from_t<span class="op">))</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>step<span class="op">(</span>qt<span class="op">,</span> visited_from_t<span class="op">,</span> visited_from_s<span class="op">))</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> step<span class="op">(</span>queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&amp;</span> q<span class="op">,</span> <span class="dt">bool</span> vis<span class="op">[],</span> <span class="dt">bool</span> other<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> size <span class="op">=</span> q<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>size<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>other<span class="op">[</span>u<span class="op">])</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>vis<span class="op">[</span>v<span class="op">])</span> <span class="op">{</span></span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>                vis<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a>                q<span class="op">.</span>push<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-complexity-6" class="level4">
<h4 class="anchored" data-anchor-id="c.-complexity-6">C. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Time</th>
<th>Space</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>O<span class="math inline">\(b^{d/2}\)</span></td>
<td>O<span class="math inline">\(b^{d/2}\)</span></td>
<td>Doubly fast in practice</td>
</tr>
</tbody>
</table>
<p>Used in:</p>
<ul>
<li>Maze solvers- Shortest paths in large sparse graphs- Social network “degrees of separation”</li>
</ul>
</section>
<section id="heuristic-a-revisited" class="level4">
<h4 class="anchored" data-anchor-id="heuristic-a-revisited">3. Heuristic A* (Revisited)</h4>
<p>A* generalizes Dijkstra with goal-directed search using heuristics. We revisit it here to show how heuristics change exploration order.</p>
</section>
<section id="a.-cost-function" class="level4">
<h4 class="anchored" data-anchor-id="a.-cost-function">A. Cost Function</h4>
<p><span class="math display">\[
f(v) = g(v) + h(v)
\]</span></p>
<ul>
<li>(g(v)): cost so far- (h(v)): estimated cost to goal- (h(v)) must be admissible ((h(v) ))</li>
</ul>
</section>
<section id="b.-implementation-3" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-3">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb158"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v<span class="op">;</span> <span class="dt">int</span> f<span class="op">,</span> g<span class="op">;</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> operator<span class="op">&gt;(</span><span class="dt">const</span> Node<span class="op">&amp;</span> o<span class="op">)</span> <span class="dt">const</span> <span class="op">{</span> <span class="cf">return</span> f <span class="op">&gt;</span> o<span class="op">.</span>f<span class="op">;</span> <span class="op">}</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>priority_queue<span class="op">&lt;</span>Node<span class="op">,</span> vector<span class="op">&lt;</span>Node<span class="op">&gt;,</span> greater<span class="op">&lt;</span>Node<span class="op">&gt;&gt;</span> pq<span class="op">;</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> astar<span class="op">(</span><span class="dt">int</span> start<span class="op">,</span> <span class="dt">int</span> goal<span class="op">)</span> <span class="op">{</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    g<span class="op">[</span>start<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>    h<span class="op">[</span>start<span class="op">]</span> <span class="op">=</span> heuristic<span class="op">(</span>start<span class="op">,</span> goal<span class="op">);</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    pq<span class="op">.</span>push<span class="op">({</span>start<span class="op">,</span> g<span class="op">[</span>start<span class="op">]</span> <span class="op">+</span> h<span class="op">[</span>start<span class="op">],</span> g<span class="op">[</span>start<span class="op">]});</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>pq<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="op">[</span>u<span class="op">,</span> f_u<span class="op">,</span> g_u<span class="op">]</span> <span class="op">=</span> pq<span class="op">.</span>top<span class="op">();</span> pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>u <span class="op">==</span> goal<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w<span class="op">]</span> <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> new_g <span class="op">=</span> g<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">;</span></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>new_g <span class="op">&lt;</span> g<span class="op">[</span>v<span class="op">])</span> <span class="op">{</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>                g<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> new_g<span class="op">;</span></span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> f_v <span class="op">=</span> new_g <span class="op">+</span> heuristic<span class="op">(</span>v<span class="op">,</span> goal<span class="op">);</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>                pq<span class="op">.</span>push<span class="op">({</span>v<span class="op">,</span> f_v<span class="op">,</span> new_g<span class="op">});</span></span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-example-heuristics" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-heuristics">C. Example Heuristics</h4>
<ul>
<li>Grid map: Manhattan distance (h(x, y) = |x - x_g| + |y - y_g|)</li>
<li>Navigation: straight-line (Euclidean)- Game tree: evaluation function</li>
</ul>
</section>
<section id="d.-performance" class="level4">
<h4 class="anchored" data-anchor-id="d.-performance">D. Performance</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Heuristic</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Perfect (h = true cost)</td>
<td>Optimal, visits minimal nodes</td>
</tr>
<tr class="even">
<td>Admissible but weak</td>
<td>Still correct, more nodes</td>
</tr>
<tr class="odd">
<td>Overestimate</td>
<td>May fail (non-admissible)</td>
</tr>
</tbody>
</table>
</section>
<section id="comparison-17" class="level4">
<h4 class="anchored" data-anchor-id="comparison-17">4. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Weight Type</th>
<th>Strategy</th>
<th>Time</th>
<th>Space</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0-1 BFS</td>
<td>0 or 1</td>
<td>Deque-based</td>
<td>O(V+E)</td>
<td>O(V)</td>
<td>No heap</td>
</tr>
<tr class="even">
<td>Bidirectional BFS</td>
<td>Unweighted</td>
<td>Two-way search</td>
<td>O<span class="math inline">\(b^{d/2}\)</span></td>
<td>O<span class="math inline">\(b^{d/2}\)</span></td>
<td>Meets in middle</td>
</tr>
<tr class="odd">
<td>A*</td>
<td>Non-negative</td>
<td>Heuristic search</td>
<td>Depends</td>
<td>O(V)</td>
<td>Guided</td>
</tr>
</tbody>
</table>
</section>
<section id="example-scenario" class="level4">
<h4 class="anchored" data-anchor-id="example-scenario">5. Example Scenario</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 59%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>Variant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Grid with teleport (cost 0)</td>
<td>0-1 BFS</td>
</tr>
<tr class="even">
<td>Huge social graph (find shortest chain)</td>
<td>Bidirectional BFS</td>
</tr>
<tr class="odd">
<td>Game AI pathfinding</td>
<td>A* with Manhattan heuristic</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-33" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-33">Tiny Code</h4>
<p>0-1 BFS Quick Demo:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb159"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>add_edge<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>add_edge<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>zero_one_bfs<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> dist<span class="op">[</span><span class="dv">3</span><span class="op">]);</span> <span class="co">// shortest = 1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-33" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-33">Why It Matters</h4>
<p>Special cases deserve special tools. These variants show that understanding structure (like edge weights or symmetry) can yield huge gains.</p>
<p>They embody a principle:</p>
<blockquote class="blockquote">
<p>“Don’t just run faster , run smarter, guided by what you know.”</p>
</blockquote>
</section>
<section id="try-it-yourself-33" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-33">Try It Yourself</h4>
<ol type="1">
<li>Implement 0-1 BFS for a grid with cost 0 teleports.</li>
<li>Compare BFS vs Bidirectional BFS on a large maze.</li>
<li>Write A* for an 8x8 chessboard knight’s move puzzle.</li>
<li>Tune heuristics , see how overestimating breaks A*.</li>
<li>Combine A* and 0-1 BFS for hybrid search.</li>
</ol>
<p>With these in hand, you can bend shortest path search to the shape of your problem , efficient, elegant, and exact.</p>
</section>
</section>
<section id="minimum-spanning-trees-kruskal-prim-borůvka" class="level3">
<h3 class="anchored" data-anchor-id="minimum-spanning-trees-kruskal-prim-borůvka">35. Minimum Spanning Trees (Kruskal, Prim, Borůvka)</h3>
<p>When a graph connects multiple points with weighted edges, sometimes you don’t want the <em>shortest path</em>, but the <em>cheapest network</em> that connects everything.</p>
<p>That’s the Minimum Spanning Tree (MST) problem:</p>
<blockquote class="blockquote">
<p>Given a connected, weighted, undirected graph, find a subset of edges that connects all vertices with minimum total weight and no cycles.</p>
</blockquote>
<p>MSTs are everywhere , from building networks and designing circuits to clustering and approximation algorithms.</p>
<p>Three cornerstone algorithms solve it beautifully:</p>
<ul>
<li>Kruskal’s , edge-based, union-find- Prim’s , vertex-based, greedy expansion- Borůvka’s , component merging in parallel</li>
</ul>
<section id="what-is-a-spanning-tree" class="level4">
<h4 class="anchored" data-anchor-id="what-is-a-spanning-tree">1. What Is a Spanning Tree?</h4>
<p>A spanning tree connects all vertices with exactly (V-1) edges. Among all spanning trees, the one with minimum total weight is the MST.</p>
<p>Properties:</p>
<ul>
<li>Contains no cycles- Connects all vertices- Edge count = (V - 1)- Unique if all weights distinct</li>
</ul>
</section>
<section id="mst-applications" class="level4">
<h4 class="anchored" data-anchor-id="mst-applications">2. MST Applications</h4>
<ul>
<li>Network design (roads, cables, pipelines)- Clustering (e.g., hierarchical clustering)- Image segmentation- Approximation (e.g., TSP ~ 2 × MST)- Graph simplification</li>
</ul>
</section>
<section id="kruskals-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="kruskals-algorithm">3. Kruskal’s Algorithm</h4>
<p>Build the MST edge-by-edge, in order of increasing weight. Use Union-Find (Disjoint Set Union) to avoid cycles.</p>
</section>
<section id="a.-steps-1" class="level4">
<h4 class="anchored" data-anchor-id="a.-steps-1">A. Steps</h4>
<ol type="1">
<li><p>Sort all edges by weight.</p></li>
<li><p>Initialize each vertex as its own component.</p></li>
<li><p>For each edge (u, v):</p>
<ul>
<li>If <code>u</code> and <code>v</code> are in different components → include edge - Union their sets Stop when (V-1) edges chosen.</li>
</ul></li>
</ol>
</section>
<section id="b.-implementation-4" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-4">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb160"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Edge <span class="op">{</span> <span class="dt">int</span> u<span class="op">,</span> v<span class="op">,</span> w<span class="op">;</span> <span class="op">};</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>Edge<span class="op">&gt;</span> edges<span class="op">;</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parent<span class="op">[</span>MAX<span class="op">],</span> rank_<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parent<span class="op">[</span>x<span class="op">]</span> <span class="op">==</span> x <span class="op">?</span> x <span class="op">:</span> parent<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> find<span class="op">(</span>parent<span class="op">[</span>x<span class="op">]);</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> unite<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> find<span class="op">(</span>a<span class="op">);</span> b <span class="op">=</span> find<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">==</span> b<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>rank_<span class="op">[</span>a<span class="op">]</span> <span class="op">&lt;</span> rank_<span class="op">[</span>b<span class="op">])</span> swap<span class="op">(</span>a<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>    parent<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>rank_<span class="op">[</span>a<span class="op">]</span> <span class="op">==</span> rank_<span class="op">[</span>b<span class="op">])</span> rank_<span class="op">[</span>a<span class="op">]++;</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> kruskal<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a>    iota<span class="op">(</span>parent<span class="op">,</span> parent <span class="op">+</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a>    sort<span class="op">(</span>edges<span class="op">.</span>begin<span class="op">(),</span> edges<span class="op">.</span>end<span class="op">(),</span> <span class="op">[](</span>Edge a<span class="op">,</span> Edge b<span class="op">){</span> <span class="cf">return</span> a<span class="op">.</span>w <span class="op">&lt;</span> b<span class="op">.</span>w<span class="op">;</span> <span class="op">});</span></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> total <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">&amp;</span>e <span class="op">:</span> edges<span class="op">)</span></span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>unite<span class="op">(</span>e<span class="op">.</span>u<span class="op">,</span> e<span class="op">.</span>v<span class="op">))</span></span>
<span id="cb160-23"><a href="#cb160-23" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> e<span class="op">.</span>w<span class="op">;</span></span>
<span id="cb160-24"><a href="#cb160-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total<span class="op">;</span></span>
<span id="cb160-25"><a href="#cb160-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Sorting edges: (O<span class="math inline">\(E \log E\)</span>)- Union-Find operations: (O((V))) (almost constant)- Total: (O<span class="math inline">\(E \log E\)</span>)</li>
</ul>
</section>
<section id="c.-example-2" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-2">C. Example</h4>
<p>Graph:</p>
<pre><code>1 -4- 2  
|     |  
2     3  
 \-1-/</code></pre>
<p>Edges sorted: (1-3,1), (1-2,4), (2-3,3)</p>
<p>Pick 1-3, 2-3 → MST weight = 1 + 3 = 4</p>
</section>
<section id="prims-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="prims-algorithm">4. Prim’s Algorithm</h4>
<p>Grow MST from a starting vertex, adding the smallest outgoing edge each step.</p>
<p>Similar to Dijkstra , but pick edges, not distances.</p>
</section>
<section id="a.-steps-2" class="level4">
<h4 class="anchored" data-anchor-id="a.-steps-2">A. Steps</h4>
<ol type="1">
<li>Start with one vertex, mark as visited.</li>
<li>Use priority queue for candidate edges.</li>
<li>Pick smallest edge that connects to an unvisited vertex.</li>
<li>Add vertex to MST, repeat until all visited.</li>
</ol>
</section>
<section id="b.-implementation-5" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-5">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb162"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;</span> adj<span class="op">[</span>MAX<span class="op">];</span> <span class="co">// (v, w)</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> used<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> prim<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> start<span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>    priority_queue<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;,</span> vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;,</span> greater<span class="op">&lt;&gt;&gt;</span> pq<span class="op">;</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>    pq<span class="op">.</span>push<span class="op">({</span><span class="dv">0</span><span class="op">,</span> start<span class="op">});</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> total <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>pq<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="op">[</span>w<span class="op">,</span> u<span class="op">]</span> <span class="op">=</span> pq<span class="op">.</span>top<span class="op">();</span> pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>used<span class="op">[</span>u<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>        used<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> w<span class="op">;</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w2<span class="op">]</span> <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>used<span class="op">[</span>v<span class="op">])</span> pq<span class="op">.</span>push<span class="op">({</span>w2<span class="op">,</span> v<span class="op">});</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total<span class="op">;</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li><span class="math inline">\(O((V+E) \log V)\)</span> with binary heap</li>
</ul>
<p>Used when:</p>
<ul>
<li>Graph is dense</li>
<li>Easier to grow tree than sort all edges</li>
</ul>
</section>
<section id="c.-example-3" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-3">C. Example</h4>
<p>Graph:</p>
<pre><code>1 -2- 2  
|     |  
4     1  
 \-3-/</code></pre>
<p>Start at 1 → choose (1-2), (1-3) → MST weight = 2 + 3 = 5</p>
</section>
<section id="borůvkas-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="borůvkas-algorithm">5. Borůvka’s Algorithm</h4>
<p>Less famous, but elegant , merges cheapest outgoing edge per component in parallel.</p>
<p>Each component picks one cheapest outgoing edge, adds it, merges components. Repeat until one component left.</p>
<p>Complexity: (O<span class="math inline">\(E \log V\)</span>)</p>
<p>Used in parallel/distributed MST computations.</p>
</section>
<section id="comparison-18" class="level4">
<h4 class="anchored" data-anchor-id="comparison-18">6. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 40%">
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Strategy</th>
<th>Time</th>
<th>Space</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Kruskal</td>
<td>Edge-based, sort all edges</td>
<td>O(E log E)</td>
<td>O(E)</td>
<td>Sparse graphs</td>
</tr>
<tr class="even">
<td>Prim</td>
<td>Vertex-based, grow tree</td>
<td>O(E log V)</td>
<td>O(V+E)</td>
<td>Dense graphs</td>
</tr>
<tr class="odd">
<td>Borůvka</td>
<td>Component merging</td>
<td>O(E log V)</td>
<td>O(E)</td>
<td>Parallel MST</td>
</tr>
</tbody>
</table>
</section>
<section id="mst-properties" class="level4">
<h4 class="anchored" data-anchor-id="mst-properties">7. MST Properties</h4>
<ul>
<li>Cut Property: For any cut, smallest crossing edge ∈ MST.- Cycle Property: For any cycle, largest edge not ∈ MST.- MST may not be unique if equal weights.</li>
</ul>
</section>
<section id="building-the-tree" class="level4">
<h4 class="anchored" data-anchor-id="building-the-tree">8. Building the Tree</h4>
<p>Store MST edges:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb164"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>Edge<span class="op">&gt;</span> mst_edges<span class="op">;</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>unite<span class="op">(</span>e<span class="op">.</span>u<span class="op">,</span> e<span class="op">.</span>v<span class="op">))</span> mst_edges<span class="op">.</span>push_back<span class="op">(</span>e<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then use MST for:</p>
<ul>
<li>Path queries- Clustering (remove largest edge)- Approximation TSP (preorder traversal)</li>
</ul>
</section>
<section id="tiny-code-34" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-34">Tiny Code</h4>
<p>Kruskal Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb165"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>edges<span class="op">.</span>push_back<span class="op">({</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">4</span><span class="op">});</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>edges<span class="op">.</span>push_back<span class="op">({</span><span class="dv">1</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">1</span><span class="op">});</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>edges<span class="op">.</span>push_back<span class="op">({</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">3</span><span class="op">});</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"MST = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> kruskal<span class="op">(</span><span class="dv">3</span><span class="op">));</span> <span class="co">// 4</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-34" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-34">Why It Matters</h4>
<p>MSTs model connection without redundancy. They’re about efficiency , connecting everything at minimal cost, a principle that appears in infrastructure, data, and even ideas.</p>
<p>They teach:</p>
<blockquote class="blockquote">
<p>“You can connect the whole with less , if you choose wisely.”</p>
</blockquote>
</section>
<section id="try-it-yourself-34" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-34">Try It Yourself</h4>
<ol type="1">
<li>Implement Kruskal’s algorithm using union-find.</li>
<li>Run Prim’s algorithm and compare output.</li>
<li>Build MST on random weighted graph , visualize tree.</li>
<li>Remove heaviest edge from MST to form two clusters.</li>
<li>Explore Borůvka for parallel execution.</li>
</ol>
<p>MSTs are how you span complexity with minimal effort , a tree of balance, economy, and order.</p>
</section>
</section>
<section id="flows-ford-fulkerson-edmonds-karp-dinic" class="level3">
<h3 class="anchored" data-anchor-id="flows-ford-fulkerson-edmonds-karp-dinic">36. Flows (Ford-Fulkerson, Edmonds-Karp, Dinic)</h3>
<p>Some graphs don’t just connect , they <em>carry</em> something. Imagine water flowing through pipes, traffic through roads, data through a network. Each edge has a capacity, and you want to know:</p>
<blockquote class="blockquote">
<p>“How much can I send from source to sink before the system clogs?”</p>
</blockquote>
<p>That’s the Maximum Flow problem , a cornerstone of combinatorial optimization, powering algorithms for matching, cuts, scheduling, and more.</p>
<p>This section covers the big three:</p>
<ul>
<li>Ford-Fulkerson , the primal idea- Edmonds-Karp , BFS-based implementation- Dinic’s Algorithm , layered speed</li>
</ul>
<section id="problem-definition" class="level4">
<h4 class="anchored" data-anchor-id="problem-definition">1. Problem Definition</h4>
<p>Given a directed graph ( G = (V, E) ), each edge ( (u, v) ) has a capacity ( c(u, v) ).</p>
<p>We have:</p>
<ul>
<li>Source ( s )- Sink ( t ) We want the maximum flow from ( s ) to ( t ): a function ( f(u, v) ) that satisfies:</li>
</ul>
<ol type="1">
<li>Capacity constraint: ( 0 f(u, v) c(u, v) )</li>
<li>Flow conservation: For every vertex <span class="math inline">\(v \neq s, t\)</span>: (f(u, v) = f(v, w))</li>
</ol>
<p>Total flow = (f(s, v))</p>
</section>
<section id="the-big-picture" class="level4">
<h4 class="anchored" data-anchor-id="the-big-picture">2. The Big Picture</h4>
<p>Max Flow - Min Cut Theorem:</p>
<blockquote class="blockquote">
<p>The value of the maximum flow equals the capacity of the minimum cut.</p>
</blockquote>
<p>So finding a max flow is equivalent to finding the bottleneck.</p>
</section>
<section id="ford-fulkerson-method" class="level4">
<h4 class="anchored" data-anchor-id="ford-fulkerson-method">3. Ford-Fulkerson Method</h4>
<p>The idea:</p>
<ul>
<li>While there exists a path from (s) to (t) with available capacity, push flow along it.</li>
</ul>
<p>Each step:</p>
<ol type="1">
<li>Find augmenting path</li>
<li>Send flow = min residual capacity along it</li>
<li>Update residual capacities</li>
</ol>
<p>Repeat until no augmenting path.</p>
</section>
<section id="a.-residual-graph" class="level4">
<h4 class="anchored" data-anchor-id="a.-residual-graph">A. Residual Graph</h4>
<p>Residual capacity: <span class="math display">\[
r(u, v) = c(u, v) - f(u, v)
\]</span> If ( f(u, v) &gt; 0 ), then add reverse edge ( (v, u) ) with capacity ( f(u, v) ).</p>
<p>This allows undoing flow if needed.</p>
</section>
<section id="b.-implementation-dfs-style" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-dfs-style">B. Implementation (DFS-style)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb166"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> INF <span class="op">=</span> <span class="fl">1e9</span><span class="op">;</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;</span> adj<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cap<span class="op">[</span>MAX<span class="op">][</span>MAX<span class="op">];</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> flow<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&amp;</span> vis<span class="op">)</span> <span class="op">{</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>u <span class="op">==</span> t<span class="op">)</span> <span class="cf">return</span> flow<span class="op">;</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>    vis<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> _<span class="op">]</span> <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>vis<span class="op">[</span>v<span class="op">]</span> <span class="op">&amp;&amp;</span> cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> pushed <span class="op">=</span> dfs<span class="op">(</span>v<span class="op">,</span> t<span class="op">,</span> min<span class="op">(</span>flow<span class="op">,</span> cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]),</span> vis<span class="op">);</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>pushed <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>                cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]</span> <span class="op">-=</span> pushed<span class="op">;</span></span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>                cap<span class="op">[</span>v<span class="op">][</span>u<span class="op">]</span> <span class="op">+=</span> pushed<span class="op">;</span></span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> pushed<span class="op">;</span></span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ford_fulkerson<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> flow <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb166-23"><a href="#cb166-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="kw">true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb166-24"><a href="#cb166-24" aria-hidden="true" tabindex="-1"></a>        vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> vis<span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb166-25"><a href="#cb166-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> pushed <span class="op">=</span> dfs<span class="op">(</span>s<span class="op">,</span> t<span class="op">,</span> INF<span class="op">,</span> vis<span class="op">);</span></span>
<span id="cb166-26"><a href="#cb166-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>pushed <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb166-27"><a href="#cb166-27" aria-hidden="true" tabindex="-1"></a>        flow <span class="op">+=</span> pushed<span class="op">;</span></span>
<span id="cb166-28"><a href="#cb166-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb166-29"><a href="#cb166-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> flow<span class="op">;</span></span>
<span id="cb166-30"><a href="#cb166-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(E \cdot \text{max flow}\)</span>) , depends on flow magnitude.</p>
</section>
<section id="edmonds-karp-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="edmonds-karp-algorithm">4. Edmonds-Karp Algorithm</h4>
<p>A refinement:</p>
<blockquote class="blockquote">
<p>Always choose shortest augmenting path (by edges) using BFS.</p>
</blockquote>
<p>Guarantees polynomial time.</p>
</section>
<section id="a.-implementation-bfs-parent-tracking" class="level4">
<h4 class="anchored" data-anchor-id="a.-implementation-bfs-parent-tracking">A. Implementation (BFS + parent tracking)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb167"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bfs<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&amp;</span> parent<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">(</span>parent<span class="op">.</span>begin<span class="op">(),</span> parent<span class="op">.</span>end<span class="op">(),</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>    queue<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;</span> q<span class="op">;</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    q<span class="op">.</span>push<span class="op">({</span>s<span class="op">,</span> INF<span class="op">});</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>    parent<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> <span class="op">[</span>u<span class="op">,</span> flow<span class="op">]</span> <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> _<span class="op">]</span> <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>parent<span class="op">[</span>v<span class="op">]</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="op">&amp;&amp;</span> cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> new_flow <span class="op">=</span> min<span class="op">(</span>flow<span class="op">,</span> cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]);</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>                parent<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> u<span class="op">;</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> t<span class="op">)</span> <span class="cf">return</span> new_flow<span class="op">;</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>                q<span class="op">.</span>push<span class="op">({</span>v<span class="op">,</span> new_flow<span class="op">});</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> edmonds_karp<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> flow <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> parent<span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> new_flow<span class="op">;</span></span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">((</span>new_flow <span class="op">=</span> bfs<span class="op">(</span>s<span class="op">,</span> t<span class="op">,</span> parent<span class="op">,</span> n<span class="op">)))</span> <span class="op">{</span></span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>        flow <span class="op">+=</span> new_flow<span class="op">;</span></span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>v <span class="op">!=</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> u <span class="op">=</span> parent<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>            cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]</span> <span class="op">-=</span> new_flow<span class="op">;</span></span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>            cap<span class="op">[</span>v<span class="op">][</span>u<span class="op">]</span> <span class="op">+=</span> new_flow<span class="op">;</span></span>
<span id="cb167-31"><a href="#cb167-31" aria-hidden="true" tabindex="-1"></a>            v <span class="op">=</span> u<span class="op">;</span></span>
<span id="cb167-32"><a href="#cb167-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb167-33"><a href="#cb167-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-34"><a href="#cb167-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> flow<span class="op">;</span></span>
<span id="cb167-35"><a href="#cb167-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(VE^2\)</span>) Always terminates (no dependence on flow values).</p>
</section>
<section id="dinics-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="dinics-algorithm">5. Dinic’s Algorithm</h4>
<p>A modern classic , uses BFS to build level graph, and DFS to send blocking flow.</p>
<p>It works layer-by-layer, avoiding useless exploration.</p>
</section>
<section id="a.-steps-3" class="level4">
<h4 class="anchored" data-anchor-id="a.-steps-3">A. Steps</h4>
<ol type="1">
<li>Build level graph via BFS (assign levels to reachable nodes).</li>
<li>DFS sends flow along level-respecting paths.</li>
<li>Repeat until no path remains.</li>
</ol>
</section>
<section id="b.-implementation-6" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-6">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb168"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> level<span class="op">,</span> ptr<span class="op">;</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> bfs_level<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">(</span>level<span class="op">.</span>begin<span class="op">(),</span> level<span class="op">.</span>end<span class="op">(),</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>    queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> q<span class="op">;</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>    q<span class="op">.</span>push<span class="op">(</span>s<span class="op">);</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>    level<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> _<span class="op">]</span> <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>level<span class="op">[</span>v<span class="op">]</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="op">&amp;&amp;</span> cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>                level<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> level<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>                q<span class="op">.</span>push<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> level<span class="op">[</span>t<span class="op">]</span> <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfs_flow<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> pushed<span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>u <span class="op">==</span> t <span class="op">||</span> pushed <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> pushed<span class="op">;</span></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> <span class="op">&amp;</span>cid <span class="op">=</span> ptr<span class="op">[</span>u<span class="op">];</span> cid <span class="op">&lt;</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>adj<span class="op">[</span>u<span class="op">].</span>size<span class="op">();</span> cid<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> adj<span class="op">[</span>u<span class="op">][</span>cid<span class="op">].</span>first<span class="op">;</span></span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>level<span class="op">[</span>v<span class="op">]</span> <span class="op">==</span> level<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> tr <span class="op">=</span> dfs_flow<span class="op">(</span>v<span class="op">,</span> t<span class="op">,</span> min<span class="op">(</span>pushed<span class="op">,</span> cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]));</span></span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>tr <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a>                cap<span class="op">[</span>u<span class="op">][</span>v<span class="op">]</span> <span class="op">-=</span> tr<span class="op">;</span></span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>                cap<span class="op">[</span>v<span class="op">][</span>u<span class="op">]</span> <span class="op">+=</span> tr<span class="op">;</span></span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> tr<span class="op">;</span></span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb168-30"><a href="#cb168-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb168-31"><a href="#cb168-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb168-32"><a href="#cb168-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-33"><a href="#cb168-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb168-34"><a href="#cb168-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-35"><a href="#cb168-35" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dinic<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> t<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-36"><a href="#cb168-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> flow <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-37"><a href="#cb168-37" aria-hidden="true" tabindex="-1"></a>    level<span class="op">.</span>resize<span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb168-38"><a href="#cb168-38" aria-hidden="true" tabindex="-1"></a>    ptr<span class="op">.</span>resize<span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb168-39"><a href="#cb168-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>bfs_level<span class="op">(</span>s<span class="op">,</span> t<span class="op">,</span> n<span class="op">))</span> <span class="op">{</span></span>
<span id="cb168-40"><a href="#cb168-40" aria-hidden="true" tabindex="-1"></a>        fill<span class="op">(</span>ptr<span class="op">.</span>begin<span class="op">(),</span> ptr<span class="op">.</span>end<span class="op">(),</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb168-41"><a href="#cb168-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span><span class="dt">int</span> pushed <span class="op">=</span> dfs_flow<span class="op">(</span>s<span class="op">,</span> t<span class="op">,</span> INF<span class="op">))</span></span>
<span id="cb168-42"><a href="#cb168-42" aria-hidden="true" tabindex="-1"></a>            flow <span class="op">+=</span> pushed<span class="op">;</span></span>
<span id="cb168-43"><a href="#cb168-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb168-44"><a href="#cb168-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> flow<span class="op">;</span></span>
<span id="cb168-45"><a href="#cb168-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(EV^2\)</span>) worst case, (O<span class="math inline">\(E \sqrt{V}\)</span>) in practice.</p>
</section>
<section id="comparison-19" class="level4">
<h4 class="anchored" data-anchor-id="comparison-19">6. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 21%">
<col style="width: 20%">
<col style="width: 16%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Strategy</th>
<th>Handles</th>
<th>Time</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ford-Fulkerson</td>
<td>DFS augmenting paths</td>
<td>Integral capacities</td>
<td>O<span class="math inline">\(E × max_flow\)</span></td>
<td>Simple, may loop on reals</td>
</tr>
<tr class="even">
<td>Edmonds-Karp</td>
<td>BFS augmenting paths</td>
<td>All capacities</td>
<td>O(VE²)</td>
<td>Always terminates</td>
</tr>
<tr class="odd">
<td>Dinic</td>
<td>Level graph + DFS</td>
<td>All capacities</td>
<td>O(V²E)</td>
<td>Fast in practice</td>
</tr>
</tbody>
</table>
</section>
<section id="applications-4" class="level4">
<h4 class="anchored" data-anchor-id="applications-4">7. Applications</h4>
<ul>
<li>Network routing- Bipartite matching- Task assignment (flows = people → jobs)- Image segmentation (min-cut)- Circulation with demands- Data pipelines, max throughput systems</li>
</ul>
</section>
<section id="tiny-code-35" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-35">Tiny Code</h4>
<p>Ford-Fulkerson Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb169"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>add_edge<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>add_edge<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>add_edge<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>add_edge<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>add_edge<span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"Max flow = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> ford_fulkerson<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">4</span><span class="op">));</span> <span class="co">// 5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-35" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-35">Why It Matters</h4>
<p>Flow algorithms transform capacity constraints into solvable systems. They reveal the deep unity between optimization and structure: every maximum flow defines a minimum bottleneck cut.</p>
<p>They embody a timeless truth:</p>
<blockquote class="blockquote">
<p>“To understand limits, follow the flow.”</p>
</blockquote>
</section>
<section id="try-it-yourself-35" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-35">Try It Yourself</h4>
<ol type="1">
<li>Implement Ford-Fulkerson using DFS.</li>
<li>Switch to Edmonds-Karp and observe performance gain.</li>
<li>Build Dinic’s level graph and visualize layers.</li>
<li>Model job assignment as bipartite flow.</li>
<li>Verify Max Flow = Min Cut on small examples.</li>
</ol>
<p>Once you master flows, you’ll see them hidden in everything that moves , from data to decisions.</p>
</section>
</section>
<section id="cuts-stoer-wagner-karger-gomory-hu" class="level3">
<h3 class="anchored" data-anchor-id="cuts-stoer-wagner-karger-gomory-hu">37. Cuts (Stoer-Wagner, Karger, Gomory-Hu)</h3>
<p>Where flow problems ask <em>“How much can we send?”</em>, cut problems ask <em>“Where does it break?”</em></p>
<p>A cut splits a graph into two disjoint sets. The minimum cut is the smallest set of edges whose removal disconnects the graph , the tightest “bottleneck” holding it together.</p>
<p>This chapter explores three major algorithms:</p>
<ul>
<li>Stoer-Wagner , deterministic min-cut for undirected graphs- Karger’s Randomized Algorithm , fast, probabilistic- Gomory-Hu Tree , compress all-pairs min-cuts into one tree Cuts reveal hidden structure , clusters, vulnerabilities, boundaries , and form the dual to flows via the Max-Flow Min-Cut Theorem.</li>
</ul>
<section id="the-min-cut-problem" class="level4">
<h4 class="anchored" data-anchor-id="the-min-cut-problem">1. The Min-Cut Problem</h4>
<p>Given a weighted undirected graph ( G = (V, E) ): Find the minimum total weight of edges whose removal disconnects the graph.</p>
<p>Equivalent to:</p>
<blockquote class="blockquote">
<p>The smallest sum of edge weights crossing any partition ( <span class="math inline">\(S, V \setminus S\)</span> ).</p>
</blockquote>
<p>For directed graphs, you use max-flow methods; For undirected graphs, specialized algorithms exist.</p>
</section>
<section id="applications-5" class="level4">
<h4 class="anchored" data-anchor-id="applications-5">2. Applications</h4>
<ul>
<li>Network reliability , weakest link detection- Clustering , partition graph by minimal interconnection- Circuit design , splitting components- Image segmentation , separating regions- Community detection , sparse connections between groups</li>
</ul>
</section>
<section id="stoer-wagner-algorithm-deterministic" class="level4">
<h4 class="anchored" data-anchor-id="stoer-wagner-algorithm-deterministic">3. Stoer-Wagner Algorithm (Deterministic)</h4>
<p>A clean, deterministic method for global minimum cut in undirected graphs.</p>
</section>
<section id="a.-idea-6" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-6">A. Idea</h4>
<ol type="1">
<li><p>Start with the full vertex set ( V ).</p></li>
<li><p>Repeatedly run Maximum Adjacency Search:</p>
<ul>
<li>Start from a vertex - Grow a set by adding the most tightly connected vertex - The last added vertex defines a cut3. Contract the last two added vertices into one.</li>
</ul></li>
<li><p>Keep track of smallest cut seen.</p></li>
</ol>
<p>Repeat until one vertex remains.</p>
</section>
<section id="b.-implementation-adjacency-matrix" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-adjacency-matrix">B. Implementation (Adjacency Matrix)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb170"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> INF <span class="op">=</span> <span class="fl">1e9</span><span class="op">;</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> g<span class="op">[</span>MAX<span class="op">][</span>MAX<span class="op">],</span> w<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> added<span class="op">[</span>MAX<span class="op">],</span> exist<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> stoer_wagner<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> best <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> v<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>    iota<span class="op">(</span>v<span class="op">.</span>begin<span class="op">(),</span> v<span class="op">.</span>end<span class="op">(),</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>        fill<span class="op">(</span>w<span class="op">,</span> w <span class="op">+</span> n<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>        fill<span class="op">(</span>added<span class="op">,</span> added <span class="op">+</span> n<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> prev <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> sel <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(!</span>added<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> <span class="op">(</span>sel <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="op">||</span> w<span class="op">[</span>j<span class="op">]</span> <span class="op">&gt;</span> w<span class="op">[</span>sel<span class="op">]))</span> sel <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>                best <span class="op">=</span> min<span class="op">(</span>best<span class="op">,</span> w<span class="op">[</span>sel<span class="op">]);</span></span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>                    g<span class="op">[</span>prev<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> g<span class="op">[</span>j<span class="op">][</span>prev<span class="op">]</span> <span class="op">+=</span> g<span class="op">[</span>sel<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>                v<span class="op">.</span>erase<span class="op">(</span>v<span class="op">.</span>begin<span class="op">()</span> <span class="op">+</span> sel<span class="op">);</span></span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>                n<span class="op">--;</span></span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>            added<span class="op">[</span>sel<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span> w<span class="op">[</span>j<span class="op">]</span> <span class="op">+=</span> g<span class="op">[</span>sel<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a>            prev <span class="op">=</span> sel<span class="op">;</span></span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best<span class="op">;</span></span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(V^3\)</span>), or (O<span class="math inline">\(VE + V^2 \log V\)</span>) with heaps Input: weighted undirected graph Output: global min cut value</p>
</section>
<section id="c.-example-4" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-4">C. Example</h4>
<p>Graph:</p>
<pre><code>1 -3- 2  
|     |  
4     2  
 \-5-/</code></pre>
<p>Cuts:</p>
<ul>
<li>{1,2}|{3} → 7- {1,3}|{2} → 5 Min cut = 5</li>
</ul>
</section>
<section id="kargers-algorithm-randomized" class="level4">
<h4 class="anchored" data-anchor-id="kargers-algorithm-randomized">4. Karger’s Algorithm (Randomized)</h4>
<p>A simple, elegant probabilistic method. Repeatedly contract random edges until two vertices remain; the remaining crossing edges form a cut.</p>
<p>Run multiple times → high probability of finding min cut.</p>
</section>
<section id="a.-algorithm-1" class="level4">
<h4 class="anchored" data-anchor-id="a.-algorithm-1">A. Algorithm</h4>
<ol type="1">
<li><p>While ( |V| &gt; 2 ):</p>
<ul>
<li>Choose random edge ((u, v)) - Contract (u, v) into one node - Remove self-loops2. Return number of edges between remaining nodes</li>
</ul></li>
</ol>
<p>Repeat (O<span class="math inline">\(n^2 \log n\)</span>) times for high confidence.</p>
</section>
<section id="b.-implementation-sketch" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-sketch">B. Implementation Sketch</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb172"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Edge <span class="op">{</span> <span class="dt">int</span> u<span class="op">,</span> v<span class="op">;</span> <span class="op">};</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>Edge<span class="op">&gt;</span> edges<span class="op">;</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parent<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> parent<span class="op">[</span>x<span class="op">]</span> <span class="op">==</span> x <span class="op">?</span> x <span class="op">:</span> parent<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> find<span class="op">(</span>parent<span class="op">[</span>x<span class="op">]);</span> <span class="op">}</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> unite<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span> parent<span class="op">[</span>find<span class="op">(</span>b<span class="op">)]</span> <span class="op">=</span> find<span class="op">(</span>a<span class="op">);</span> <span class="op">}</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> karger<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> m <span class="op">=</span> edges<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>    iota<span class="op">(</span>parent<span class="op">,</span> parent <span class="op">+</span> n<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> vertices <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>vertices <span class="op">&gt;</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> i <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> find<span class="op">(</span>edges<span class="op">[</span>i<span class="op">].</span>u<span class="op">),</span> v <span class="op">=</span> find<span class="op">(</span>edges<span class="op">[</span>i<span class="op">].</span>v<span class="op">);</span></span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>u <span class="op">==</span> v<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>        unite<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>        vertices<span class="op">--;</span></span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> cuts <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> e <span class="op">:</span> edges<span class="op">)</span></span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>find<span class="op">(</span>e<span class="op">.</span>u<span class="op">)</span> <span class="op">!=</span> find<span class="op">(</span>e<span class="op">.</span>v<span class="op">))</span> cuts<span class="op">++;</span></span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cuts<span class="op">;</span></span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Expected Time: (O<span class="math inline">\(n^2\)</span>) per run Probability of success: (2 / (n(n-1))) per run Run multiple trials and take minimum.</p>
</section>
<section id="c.-use-case" class="level4">
<h4 class="anchored" data-anchor-id="c.-use-case">C. Use Case</h4>
<p>Great for large sparse graphs, or when approximate solutions are acceptable. Intuitive: the min cut survives random contractions if chosen carefully enough.</p>
</section>
<section id="gomory-hu-tree" class="level4">
<h4 class="anchored" data-anchor-id="gomory-hu-tree">5. Gomory-Hu Tree</h4>
<p>A compact way to store all-pairs min-cuts. It compresses (O<span class="math inline">\(V^2\)</span>) flow computations into V-1 cuts.</p>
</section>
<section id="a.-idea-7" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-7">A. Idea</h4>
<ul>
<li>Build a tree where the min cut between any two vertices = the minimum edge weight on their path in the tree.</li>
</ul>
</section>
<section id="b.-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="b.-algorithm">B. Algorithm</h4>
<ol type="1">
<li><p>Pick vertex (s).</p></li>
<li><p>For each vertex <span class="math inline">\(t \neq s\)</span>,</p>
<ul>
<li>Run max flow to find min cut between (s, t). - Partition vertices accordingly.3. Connect partitions to form a tree.</li>
</ul></li>
</ol>
<p>Result: Gomory-Hu tree (V-1 edges).</p>
<p>Now any pair’s min cut = smallest edge on path between them.</p>
<p>Complexity: (O(V)) max flow runs.</p>
</section>
<section id="c.-uses" class="level4">
<h4 class="anchored" data-anchor-id="c.-uses">C. Uses</h4>
<ul>
<li>Quickly answer all-pairs cut queries- Network reliability- Hierarchical clustering</li>
</ul>
</section>
<section id="comparison-20" class="level4">
<h4 class="anchored" data-anchor-id="comparison-20">6. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 25%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Type</th>
<th>Randomized</th>
<th>Graph</th>
<th>Complexity</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Stoer-Wagner</td>
<td>Deterministic</td>
<td>No</td>
<td>Undirected</td>
<td>O(V³)</td>
<td>Global min cut</td>
</tr>
<tr class="even">
<td>Karger</td>
<td>Randomized</td>
<td>Yes</td>
<td>Undirected</td>
<td>O(n² log n) (multi-run)</td>
<td>Probabilistic min cut</td>
</tr>
<tr class="odd">
<td>Gomory-Hu</td>
<td>Deterministic</td>
<td>No</td>
<td>Undirected</td>
<td>O(V × MaxFlow)</td>
<td>All-pairs min cuts</td>
</tr>
</tbody>
</table>
</section>
<section id="relationship-to-flows" class="level4">
<h4 class="anchored" data-anchor-id="relationship-to-flows">7. Relationship to Flows</h4>
<p>By Max-Flow Min-Cut, min-cut capacity = max-flow value.</p>
<p>So you can find:</p>
<ul>
<li>s-t min cut = via max flow- global min cut = min over all (s, t) pairs Specialized algorithms just make it faster.</li>
</ul>
</section>
<section id="tiny-code-36" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-36">Tiny Code</h4>
<p>Stoer-Wagner Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb173"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"Global Min Cut = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> stoer_wagner<span class="op">(</span>n<span class="op">));</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Karger Multi-Run:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb174"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ans <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">100</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> min<span class="op">(</span>ans<span class="op">,</span> karger<span class="op">(</span>n<span class="op">));</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"Approx Min Cut = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> ans<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-36" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-36">Why It Matters</h4>
<p>Cuts show you fragility , the weak seams of connection. While flows tell you <em>how much can pass</em>, cuts reveal <em>where it breaks first</em>.</p>
<p>They teach:</p>
<blockquote class="blockquote">
<p>“To understand strength, study what happens when you pull things apart.”</p>
</blockquote>
</section>
<section id="try-it-yourself-36" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-36">Try It Yourself</h4>
<ol type="1">
<li>Implement Stoer-Wagner and test on small graphs.</li>
<li>Run Karger 100 times and track success rate.</li>
<li>Build a Gomory-Hu tree and answer random pair queries.</li>
<li>Verify Max-Flow = Min-Cut equivalence on examples.</li>
<li>Use cuts for community detection in social graphs.</li>
</ol>
<p>Mastering cuts gives you both grip and insight , where systems hold, and where they give way.</p>
</section>
</section>
<section id="matchings-hopcroft-karp-hungarian-blossom" class="level3">
<h3 class="anchored" data-anchor-id="matchings-hopcroft-karp-hungarian-blossom">38. Matchings (Hopcroft-Karp, Hungarian, Blossom)</h3>
<p>In many problems, we need to pair up elements efficiently: students to schools, jobs to workers, tasks to machines.</p>
<p>These are matching problems , find sets of edges with no shared endpoints that maximize cardinality or weight.</p>
<p>Depending on graph type, different algorithms apply:</p>
<ul>
<li>Hopcroft-Karp , fast matching in bipartite graphs- Hungarian Algorithm , optimal weighted assignment- Edmonds’ Blossom Algorithm , general graphs (non-bipartite) Matching is a fundamental combinatorial structure, appearing in scheduling, flow networks, and resource allocation.</li>
</ul>
<section id="terminology" class="level4">
<h4 class="anchored" data-anchor-id="terminology">1. Terminology</h4>
<ul>
<li><p>Matching: set of edges with no shared vertices- Maximum Matching: matching with largest number of edges- Perfect Matching: covers all vertices (each vertex matched once)- Maximum Weight Matching: matching with largest total edge weight Graph Types:</p></li>
<li><p>Bipartite: vertices split into two sets (L, R); edges only between sets- General: arbitrary connections (may contain odd cycles)</p></li>
</ul>
</section>
<section id="applications-6" class="level4">
<h4 class="anchored" data-anchor-id="applications-6">2. Applications</h4>
<ul>
<li>Job assignment- Network flows- Resource allocation- Student-project pairing- Stable marriages (with preferences)- Computer vision (feature correspondence)</li>
</ul>
</section>
<section id="hopcroft-karp-algorithm-bipartite-matching" class="level4">
<h4 class="anchored" data-anchor-id="hopcroft-karp-algorithm-bipartite-matching">3. Hopcroft-Karp Algorithm (Bipartite Matching)</h4>
<p>A highly efficient algorithm for maximum cardinality matching in bipartite graphs.</p>
<p>It uses layered BFS + DFS to find multiple augmenting paths simultaneously.</p>
</section>
<section id="a.-idea-8" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-8">A. Idea</h4>
<ol type="1">
<li><p>Initialize matching empty.</p></li>
<li><p>While augmenting paths exist:</p>
<ul>
<li>BFS builds layer graph (shortest augmenting paths). - DFS finds all augmenting paths along those layers. Each phase increases matching size significantly.</li>
</ul></li>
</ol>
</section>
<section id="b.-complexity" class="level4">
<h4 class="anchored" data-anchor-id="b.-complexity">B. Complexity</h4>
<p><span class="math display">\[
O(E \sqrt{V})
\]</span></p>
<p>Much faster than augmenting one path at a time (like Ford-Fulkerson).</p>
</section>
<section id="c.-implementation" class="level4">
<h4 class="anchored" data-anchor-id="c.-implementation">C. Implementation</h4>
<p>Let <code>pairU[u]</code> = matched vertex in R, or 0 if unmatched <code>pairV[v]</code> = matched vertex in L, or 0 if unmatched</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb175"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> adjL<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pairU<span class="op">[</span>MAX<span class="op">],</span> pairV<span class="op">[</span>MAX<span class="op">],</span> dist<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> nL<span class="op">,</span> nR<span class="op">;</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> bfs<span class="op">()</span> <span class="op">{</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>    queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> q<span class="op">;</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> u <span class="op">&lt;=</span> nL<span class="op">;</span> u<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>pairU<span class="op">[</span>u<span class="op">])</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> q<span class="op">.</span>push<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> found <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>u<span class="op">]</span> <span class="op">&lt;</span> found<span class="op">)</span> <span class="op">{</span></span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adjL<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(!</span>pairV<span class="op">[</span>v<span class="op">])</span> found <span class="op">=</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>pairV<span class="op">[</span>v<span class="op">]]</span> <span class="op">==</span> INF<span class="op">)</span> <span class="op">{</span></span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>                    dist<span class="op">[</span>pairV<span class="op">[</span>v<span class="op">]]</span> <span class="op">=</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>                    q<span class="op">.</span>push<span class="op">(</span>pairV<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> found <span class="op">!=</span> INF<span class="op">;</span></span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb175-26"><a href="#cb175-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-27"><a href="#cb175-27" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span> <span class="op">{</span></span>
<span id="cb175-28"><a href="#cb175-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adjL<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb175-29"><a href="#cb175-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>pairV<span class="op">[</span>v<span class="op">]</span> <span class="op">||</span> <span class="op">(</span>dist<span class="op">[</span>pairV<span class="op">[</span>v<span class="op">]]</span> <span class="op">==</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> dfs<span class="op">(</span>pairV<span class="op">[</span>v<span class="op">])))</span> <span class="op">{</span></span>
<span id="cb175-30"><a href="#cb175-30" aria-hidden="true" tabindex="-1"></a>            pairU<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb175-31"><a href="#cb175-31" aria-hidden="true" tabindex="-1"></a>            pairV<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> u<span class="op">;</span></span>
<span id="cb175-32"><a href="#cb175-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb175-33"><a href="#cb175-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb175-34"><a href="#cb175-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb175-35"><a href="#cb175-35" aria-hidden="true" tabindex="-1"></a>    dist<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb175-36"><a href="#cb175-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb175-37"><a href="#cb175-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb175-38"><a href="#cb175-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-39"><a href="#cb175-39" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> hopcroft_karp<span class="op">()</span> <span class="op">{</span></span>
<span id="cb175-40"><a href="#cb175-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> matching <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb175-41"><a href="#cb175-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>bfs<span class="op">())</span> <span class="op">{</span></span>
<span id="cb175-42"><a href="#cb175-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> u <span class="op">&lt;=</span> nL<span class="op">;</span> u<span class="op">++)</span></span>
<span id="cb175-43"><a href="#cb175-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>pairU<span class="op">[</span>u<span class="op">]</span> <span class="op">&amp;&amp;</span> dfs<span class="op">(</span>u<span class="op">))</span> matching<span class="op">++;</span></span>
<span id="cb175-44"><a href="#cb175-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb175-45"><a href="#cb175-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> matching<span class="op">;</span></span>
<span id="cb175-46"><a href="#cb175-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="d.-example" class="level4">
<h4 class="anchored" data-anchor-id="d.-example">D. Example</h4>
<p>Graph:</p>
<pre><code>U = {1,2,3}, V = {a,b}
Edges: 1–a, 2–a, 3–b</code></pre>
<p>Matching: {1-a, 3-b} (size 2)</p>
</section>
<section id="hungarian-algorithm-weighted-bipartite-matching" class="level4">
<h4 class="anchored" data-anchor-id="hungarian-algorithm-weighted-bipartite-matching">4. Hungarian Algorithm (Weighted Bipartite Matching)</h4>
<p>Solves assignment problem , given cost matrix <span class="math inline">\(c_{ij}\)</span>, assign each (i) to one (j) minimizing total cost (or maximizing profit).</p>
</section>
<section id="a.-idea-9" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-9">A. Idea</h4>
<p>Subtract minimums row- and column-wise → expose zeros → find minimal zero-cover → adjust matrix → repeat.</p>
<p>Equivalent to solving min-cost perfect matching on a bipartite graph.</p>
</section>
<section id="b.-complexity-1" class="level4">
<h4 class="anchored" data-anchor-id="b.-complexity-1">B. Complexity</h4>
<p><span class="math display">\[
O(V^3)
\]</span></p>
<p>Works for dense graphs, moderate sizes.</p>
</section>
<section id="c.-implementation-sketch-matrix-form" class="level4">
<h4 class="anchored" data-anchor-id="c.-implementation-sketch-matrix-form">C. Implementation Sketch (Matrix Form)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb177"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> hungarian<span class="op">(</span><span class="dt">const</span> vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&gt;&amp;</span> cost<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> cost<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> u<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">),</span> v<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">),</span> p<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">),</span> way<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>        p<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> i<span class="op">;</span> <span class="dt">int</span> j0 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>        vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> minv<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">,</span> INF<span class="op">);</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>        vector<span class="op">&lt;</span><span class="dt">char</span><span class="op">&gt;</span> used<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">do</span> <span class="op">{</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>            used<span class="op">[</span>j0<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> i0 <span class="op">=</span> p<span class="op">[</span>j0<span class="op">],</span> delta <span class="op">=</span> INF<span class="op">,</span> j1<span class="op">;</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> n<span class="op">;</span> j<span class="op">++)</span> <span class="cf">if</span> <span class="op">(!</span>used<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> cur <span class="op">=</span> cost<span class="op">[</span>i0<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">-</span> u<span class="op">[</span>i0<span class="op">]</span> <span class="op">-</span> v<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>cur <span class="op">&lt;</span> minv<span class="op">[</span>j<span class="op">])</span> minv<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> cur<span class="op">,</span> way<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> j0<span class="op">;</span></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>minv<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> delta<span class="op">)</span> delta <span class="op">=</span> minv<span class="op">[</span>j<span class="op">],</span> j1 <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> n<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>used<span class="op">[</span>j<span class="op">])</span> u<span class="op">[</span>p<span class="op">[</span>j<span class="op">]]</span> <span class="op">+=</span> delta<span class="op">,</span> v<span class="op">[</span>j<span class="op">]</span> <span class="op">-=</span> delta<span class="op">;</span></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> minv<span class="op">[</span>j<span class="op">]</span> <span class="op">-=</span> delta<span class="op">;</span></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a>            j0 <span class="op">=</span> j1<span class="op">;</span></span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">while</span> <span class="op">(</span>p<span class="op">[</span>j0<span class="op">]);</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">do</span> <span class="op">{</span> <span class="dt">int</span> j1 <span class="op">=</span> way<span class="op">[</span>j0<span class="op">];</span> p<span class="op">[</span>j0<span class="op">]</span> <span class="op">=</span> p<span class="op">[</span>j1<span class="op">];</span> j0 <span class="op">=</span> j1<span class="op">;</span> <span class="op">}</span> <span class="cf">while</span> <span class="op">(</span>j0<span class="op">);</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>v<span class="op">[</span><span class="dv">0</span><span class="op">];</span> <span class="co">// minimal cost</span></span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="d.-example-1" class="level4">
<h4 class="anchored" data-anchor-id="d.-example-1">D. Example</h4>
<p>Cost matrix:</p>
<pre><code>  a  b  c
1 3  2  1
2 2  3  2
3 3  2  3</code></pre>
<p>Optimal assignment = 1-c, 2-a, 3-b Cost = 1 + 2 + 2 = 5</p>
</section>
<section id="edmonds-blossom-algorithm-general-graphs" class="level4">
<h4 class="anchored" data-anchor-id="edmonds-blossom-algorithm-general-graphs">5. Edmonds’ Blossom Algorithm (General Graphs)</h4>
<p>For non-bipartite graphs, simple augmenting path logic breaks down (odd cycles). Blossom algorithm handles this via contraction of blossoms (odd cycles).</p>
</section>
<section id="a.-idea-10" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-10">A. Idea</h4>
<ul>
<li>Find augmenting paths- When odd cycle encountered (blossom), shrink it into one vertex- Continue search- Expand blossoms at end</li>
</ul>
</section>
<section id="b.-complexity-2" class="level4">
<h4 class="anchored" data-anchor-id="b.-complexity-2">B. Complexity</h4>
<p><span class="math display">\[
O(V^3)
\]</span></p>
<p>Though complex to implement, it’s the general-purpose solution for matchings.</p>
</section>
<section id="c.-use-cases-1" class="level4">
<h4 class="anchored" data-anchor-id="c.-use-cases-1">C. Use Cases</h4>
<ul>
<li>Non-bipartite job/task assignments- General pairing problems- Network design</li>
</ul>
</section>
<section id="comparison-21" class="level4">
<h4 class="anchored" data-anchor-id="comparison-21">6. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Graph Type</th>
<th>Weighted</th>
<th>Complexity</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hopcroft-Karp</td>
<td>Bipartite</td>
<td>No</td>
<td>O(E√V)</td>
<td>Max cardinality</td>
</tr>
<tr class="even">
<td>Hungarian</td>
<td>Bipartite</td>
<td>Yes</td>
<td>O(V³)</td>
<td>Min/Max cost matching</td>
</tr>
<tr class="odd">
<td>Blossom</td>
<td>General</td>
<td>Yes</td>
<td>O(V³)</td>
<td>Max cardinality or weight</td>
</tr>
</tbody>
</table>
</section>
<section id="relation-to-flows" class="level4">
<h4 class="anchored" data-anchor-id="relation-to-flows">7. Relation to Flows</h4>
<p>Bipartite matching = max flow on network:</p>
<ul>
<li>Left → Source edges (capacity 1)- Right → Sink edges (capacity 1)- Between sets → edges (capacity 1) Matching size = flow value</li>
</ul>
</section>
<section id="tiny-code-37" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-37">Tiny Code</h4>
<p>Hopcroft-Karp Demo:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb179"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>nL <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> nR <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>adjL<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>adjL<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>adjL<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">2</span><span class="op">};</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"Max Matching = </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> hopcroft_karp<span class="op">());</span> <span class="co">// 2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-37" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-37">Why It Matters</h4>
<p>Matchings are the language of pairing and assignment. They express cooperation without overlap , a structure of balance.</p>
<p>They reveal a deep duality:</p>
<blockquote class="blockquote">
<p>“Every match is a flow, every assignment an optimization.”</p>
</blockquote>
</section>
<section id="try-it-yourself-37" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-37">Try It Yourself</h4>
<ol type="1">
<li>Build a bipartite graph and run Hopcroft-Karp.</li>
<li>Solve an assignment problem with Hungarian algorithm.</li>
<li>Explore Blossom’s contraction idea conceptually.</li>
<li>Compare max-flow vs matching approach.</li>
<li>Use matching to model scheduling (people ↔︎ tasks).</li>
</ol>
<p>Matching teaches how to pair without conflict, a lesson both mathematical and universal.</p>
</section>
</section>
<section id="tree-algorithms-lca-hld-centroid-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="tree-algorithms-lca-hld-centroid-decomposition">39. Tree Algorithms (LCA, HLD, Centroid Decomposition)</h3>
<p>Trees are the backbone of many algorithms , they are connected, acyclic, and wonderfully structured.</p>
<p>Because of their simplicity, they allow elegant divide-and-conquer, dynamic programming, and query techniques. This section covers three fundamental patterns:</p>
<ul>
<li>Lowest Common Ancestor (LCA) , answer ancestor queries fast- Heavy-Light Decomposition (HLD) , break trees into chains for segment trees / path queries- Centroid Decomposition , recursively split tree by balance for divide-and-conquer Each reveals a different way to reason about trees , by depth, by chains, or by balance.</li>
</ul>
<section id="lowest-common-ancestor-lca" class="level4">
<h4 class="anchored" data-anchor-id="lowest-common-ancestor-lca">1. Lowest Common Ancestor (LCA)</h4>
<p>Given a tree, two nodes (u, v). The LCA is the lowest node (farthest from root) that is an ancestor of both.</p>
<p>Applications:</p>
<ul>
<li>Distance queries- Path decomposition- RMQ / binary lifting- Tree DP and rerooting</li>
</ul>
</section>
<section id="a.-naive-approach" class="level4">
<h4 class="anchored" data-anchor-id="a.-naive-approach">A. Naive Approach</h4>
<p>Climb ancestors until they meet. But this is (O(n)) per query , too slow for many queries.</p>
</section>
<section id="b.-binary-lifting" class="level4">
<h4 class="anchored" data-anchor-id="b.-binary-lifting">B. Binary Lifting</h4>
<p>Precompute ancestors at powers of 2. Then jump up by powers to align depths.</p>
<p>Preprocessing:</p>
<ol type="1">
<li>DFS to record depth</li>
<li><code>up[v][k]</code> = 2^k-th ancestor of v</li>
</ol>
<p>Answering query:</p>
<ol type="1">
<li>Lift deeper node up to same depth</li>
<li>Lift both together while <code>up[u][k] != up[v][k]</code></li>
<li>Return parent</li>
</ol>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb180"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> LOG <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> adj<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> up<span class="op">[</span>MAX<span class="op">][</span>LOG<span class="op">],</span> depth<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>    up<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> p<span class="op">;</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;</span> LOG<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>        up<span class="op">[</span>u<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> up<span class="op">[</span>up<span class="op">[</span>u<span class="op">][</span>k<span class="op">-</span><span class="dv">1</span><span class="op">]][</span>k<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>        depth<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> depth<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> lca<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> v<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>depth<span class="op">[</span>u<span class="op">]</span> <span class="op">&lt;</span> depth<span class="op">[</span>v<span class="op">])</span> swap<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> diff <span class="op">=</span> depth<span class="op">[</span>u<span class="op">]</span> <span class="op">-</span> depth<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> LOG<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>diff <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> k<span class="op">))</span> u <span class="op">=</span> up<span class="op">[</span>u<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>u <span class="op">==</span> v<span class="op">)</span> <span class="cf">return</span> u<span class="op">;</span></span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> LOG<span class="op">-</span><span class="dv">1</span><span class="op">;</span> k <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> k<span class="op">--)</span></span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>up<span class="op">[</span>u<span class="op">][</span>k<span class="op">]</span> <span class="op">!=</span> up<span class="op">[</span>v<span class="op">][</span>k<span class="op">])</span></span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a>            u <span class="op">=</span> up<span class="op">[</span>u<span class="op">][</span>k<span class="op">],</span> v <span class="op">=</span> up<span class="op">[</span>v<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> up<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Preprocess: (O<span class="math inline">\(n \log n\)</span>)- Query: (O<span class="math inline">\(\log n\)</span>)</li>
</ul>
</section>
<section id="c.-example-5" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-5">C. Example</h4>
<p>Tree:</p>
<pre><code>    1
   / \
  2   3
 / \
4   5</code></pre>
<ul>
<li>LCA(4,5) = 2- LCA(4,3) = 1</li>
</ul>
</section>
<section id="heavy-light-decomposition-hld" class="level4">
<h4 class="anchored" data-anchor-id="heavy-light-decomposition-hld">2. Heavy-Light Decomposition (HLD)</h4>
<p>When you need to query paths (sum, max, min, etc.) on trees efficiently, you can use Heavy-Light Decomposition.</p>
</section>
<section id="a.-idea-11" class="level4">
<h4 class="anchored" data-anchor-id="a.-idea-11">A. Idea</h4>
<p>Decompose the tree into chains:</p>
<ul>
<li>Heavy edge = edge to child with largest subtree- Light edges = others Result: Every path from root to leaf crosses at most (O<span class="math inline">\(\log n\)</span>) light edges.</li>
</ul>
<p>So, a path query can be broken into (O<span class="math inline">\(\log^2 n\)</span>) segment tree queries.</p>
</section>
<section id="b.-steps" class="level4">
<h4 class="anchored" data-anchor-id="b.-steps">B. Steps</h4>
<ol type="1">
<li>DFS to compute subtree sizes and identify heavy child</li>
<li>Decompose into chains</li>
<li>Assign IDs for segment tree</li>
<li>Use Segment Tree / BIT on linearized array</li>
</ol>
<p>Key functions:</p>
<ul>
<li><code>dfs_sz(u)</code> → compute subtree sizes- <code>decompose(u, head)</code> → assign chain heads Code (core):</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb182"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parent<span class="op">[</span>MAX<span class="op">],</span> depth<span class="op">[</span>MAX<span class="op">],</span> heavy<span class="op">[</span>MAX<span class="op">],</span> head<span class="op">[</span>MAX<span class="op">],</span> pos<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cur_pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfs_sz<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span> <span class="op">{</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> size <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> max_sz <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> parent<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> u<span class="op">;</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>        depth<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> depth<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> sz <span class="op">=</span> dfs_sz<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sz <span class="op">&gt;</span> max_sz<span class="op">)</span> max_sz <span class="op">=</span> sz<span class="op">,</span> heavy<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>        size <span class="op">+=</span> sz<span class="op">;</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> size<span class="op">;</span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> decompose<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>    head<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> h<span class="op">;</span></span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>    pos<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> cur_pos<span class="op">++;</span></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>heavy<span class="op">[</span>u<span class="op">]</span> <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> decompose<span class="op">(</span>heavy<span class="op">[</span>u<span class="op">],</span> h<span class="op">);</span></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> parent<span class="op">[</span>u<span class="op">]</span> <span class="op">&amp;&amp;</span> v <span class="op">!=</span> heavy<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>            decompose<span class="op">(</span>v<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Query path(u, v):</p>
<ul>
<li><p>While heads differ, move up chain by chain- Query segment tree in <code>[pos[head[u]], pos[u]]</code>- When in same chain, query segment <code>[pos[v], pos[u]]</code> Complexity:</p></li>
<li><p>Build: (O(n))- Query/Update: (O<span class="math inline">\(\log^2 n\)</span>)</p></li>
</ul>
</section>
<section id="c.-use-cases-2" class="level4">
<h4 class="anchored" data-anchor-id="c.-use-cases-2">C. Use Cases</h4>
<ul>
<li>Path sums- Path maximums- Edge updates- Subtree queries</li>
</ul>
</section>
<section id="centroid-decomposition" class="level4">
<h4 class="anchored" data-anchor-id="centroid-decomposition">3. Centroid Decomposition</h4>
<p>Centroid = node that splits tree into subtrees ≤ n/2 each. By removing centroids recursively, we form a centroid tree.</p>
<p>Used for divide-and-conquer on trees.</p>
</section>
<section id="a.-steps-4" class="level4">
<h4 class="anchored" data-anchor-id="a.-steps-4">A. Steps</h4>
<ol type="1">
<li><p>Find centroid</p>
<ul>
<li><p>DFS to compute subtree sizes - Choose node where largest subtree ≤ n/22. Decompose:</p></li>
<li><p>Remove centroid - Recurse on subtrees Code (core):</p></li>
</ul></li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb183"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> subtree<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> removed<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> adj<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfs_size<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>    subtree<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> p <span class="op">&amp;&amp;</span> <span class="op">!</span>removed<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>            subtree<span class="op">[</span>u<span class="op">]</span> <span class="op">+=</span> dfs_size<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> subtree<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find_centroid<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> p <span class="op">&amp;&amp;</span> <span class="op">!</span>removed<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>subtree<span class="op">[</span>v<span class="op">]</span> <span class="op">&gt;</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> find_centroid<span class="op">(</span>v<span class="op">,</span> u<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> u<span class="op">;</span></span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-21"><a href="#cb183-21" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> decompose<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-22"><a href="#cb183-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> dfs_size<span class="op">(</span>u<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb183-23"><a href="#cb183-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> c <span class="op">=</span> find_centroid<span class="op">(</span>u<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb183-24"><a href="#cb183-24" aria-hidden="true" tabindex="-1"></a>    removed<span class="op">[</span>c<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb183-25"><a href="#cb183-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// process centroid here</span></span>
<span id="cb183-26"><a href="#cb183-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>c<span class="op">])</span></span>
<span id="cb183-27"><a href="#cb183-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>removed<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb183-28"><a href="#cb183-28" aria-hidden="true" tabindex="-1"></a>            decompose<span class="op">(</span>v<span class="op">,</span> c<span class="op">);</span></span>
<span id="cb183-29"><a href="#cb183-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(n \log n\)</span>)</p>
</section>
<section id="b.-applications" class="level4">
<h4 class="anchored" data-anchor-id="b.-applications">B. Applications</h4>
<ul>
<li>Distance queries (decompose + store distance to centroid)- Tree problems solvable by divide-and-conquer- Dynamic queries (add/remove nodes)</li>
</ul>
</section>
<section id="comparison-22" class="level4">
<h4 class="anchored" data-anchor-id="comparison-22">4. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 23%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Purpose</th>
<th>Query</th>
<th>Preprocess</th>
<th>Complexity</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LCA</td>
<td>Ancestor query</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
<td>(O<span class="math inline">\(n \log n\)</span>)</td>
<td>Fast ancestor lookup</td>
<td></td>
</tr>
<tr class="even">
<td>HLD</td>
<td>Path queries</td>
<td>(O<span class="math inline">\(\log^2 n\)</span>)</td>
<td>(O(n))</td>
<td>Segment tree-friendly</td>
<td></td>
</tr>
<tr class="odd">
<td>Centroid Decomposition</td>
<td>Divide tree</td>
<td>-</td>
<td>(O<span class="math inline">\(n \log n\)</span>)</td>
<td>Balanced splits</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="interconnections" class="level4">
<h4 class="anchored" data-anchor-id="interconnections">5. Interconnections</h4>
<ul>
<li>HLD often uses LCA internally.- Centroid decomposition may use distance to ancestor (via LCA).- All exploit tree structure to achieve sublinear queries.</li>
</ul>
</section>
<section id="tiny-code-38" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-38">Tiny Code</h4>
<p>LCA(4,5):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb184"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>dfs<span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> lca<span class="op">(</span><span class="dv">4</span><span class="op">,</span><span class="dv">5</span><span class="op">));</span> <span class="co">// 2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>HLD Path Sum: Build segment tree on <code>pos[u]</code> order, query along chains.</p>
<p>Centroid: <code>decompose(1, -1);</code></p>
</section>
<section id="why-it-matters-38" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-38">Why It Matters</h4>
<p>Tree algorithms show how structure unlocks efficiency. They transform naive traversals into fast, layered, or recursive solutions.</p>
<p>To master data structures, you must learn to “climb” and “cut” trees intelligently.</p>
<blockquote class="blockquote">
<p>“Every rooted path hides a logarithm.”</p>
</blockquote>
</section>
<section id="try-it-yourself-38" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-38">Try It Yourself</h4>
<ol type="1">
<li>Implement binary lifting LCA and test queries.</li>
<li>Add segment tree over HLD and run path sums.</li>
<li>Decompose tree by centroid and count nodes at distance k.</li>
<li>Combine LCA + HLD for path min/max.</li>
<li>Draw centroid tree of a simple graph.</li>
</ol>
<p>Master these, and trees will stop being “just graphs” , they’ll become <em>tools</em>.</p>
</section>
</section>
<section id="advanced-graph-algorithms-and-tricks" class="level3">
<h3 class="anchored" data-anchor-id="advanced-graph-algorithms-and-tricks">40. Advanced Graph Algorithms and Tricks</h3>
<p>By now you’ve seen the big families , traversals, shortest paths, flows, matchings, cuts, and trees. But real-world graphs often bring extra constraints: dynamic updates, multiple sources, layered structures, or special properties (planar, DAG, sparse).</p>
<p>This section gathers powerful advanced graph techniques , tricks and patterns that appear across problems once you’ve mastered the basics.</p>
<p>We’ll explore:</p>
<ul>
<li>Topological Sorting &amp; DAG DP- Strongly Connected Components (Condensation Graphs)- Articulation Points &amp; Bridges (2-Edge/Vertex Connectivity)- Eulerian &amp; Hamiltonian Paths- Graph Coloring &amp; Bipartiteness Tests- Cycle Detection &amp; Directed Acyclic Reasoning- Small-to-Large Merging, DSU on Tree, Mo’s Algorithm on Trees- Bitmask DP on Graphs- Dynamic Graphs (Incremental/Decremental BFS/DFS)- Special Graphs (Planar, Sparse, Dense) These aren’t just algorithms , they’re patterns that let you attack harder graph problems with insight.</li>
</ul>
<section id="topological-sorting-dag-dp" class="level4">
<h4 class="anchored" data-anchor-id="topological-sorting-dag-dp">1. Topological Sorting &amp; DAG DP</h4>
<p>In a DAG (Directed Acyclic Graph), edges always point forward. This makes it possible to order vertices linearly so all edges go from left to right , a topological order.</p>
<p>Use cases:</p>
<ul>
<li>Task scheduling- Dependency resolution- DP on DAG (longest/shortest path, counting paths) Algorithm (Kahn’s):</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb185"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> topo_sort<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> indeg<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">),</span> res<span class="op">;</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>    queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> q<span class="op">;</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> u <span class="op">&lt;=</span> n<span class="op">;</span> u<span class="op">++)</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> indeg<span class="op">[</span>v<span class="op">]++;</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> u <span class="op">&lt;=</span> n<span class="op">;</span> u<span class="op">++)</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>indeg<span class="op">[</span>u<span class="op">])</span> q<span class="op">.</span>push<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>        res<span class="op">.</span>push_back<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(--</span>indeg<span class="op">[</span>v<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> q<span class="op">.</span>push<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>DAG DP:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb186"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> dp<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">:</span> topo_order<span class="op">)</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>v<span class="op">],</span> dp<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> weight<span class="op">(</span>u<span class="op">,</span>v<span class="op">));</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: O(V + E)</p>
</section>
<section id="strongly-connected-components-condensation" class="level4">
<h4 class="anchored" data-anchor-id="strongly-connected-components-condensation">2. Strongly Connected Components (Condensation)</h4>
<p>In directed graphs, vertices may form SCCs (mutually reachable components). Condensing SCCs yields a DAG, often easier to reason about.</p>
<p>Use:</p>
<ul>
<li>Component compression- Meta-graph reasoning- Cycle condensation Tarjan’s Algorithm: DFS with low-link values, single pass.</li>
</ul>
<p>Kosaraju’s Algorithm: Two passes , DFS on graph and reversed graph.</p>
<p>Complexity: O(V + E)</p>
<p>Once SCCs are built, you can run DP or topological sort on the condensed DAG.</p>
</section>
<section id="articulation-points-bridges" class="level4">
<h4 class="anchored" data-anchor-id="articulation-points-bridges">3. Articulation Points &amp; Bridges</h4>
<p>Find critical vertices/edges whose removal disconnects the graph.</p>
<ul>
<li>Articulation point: vertex whose removal increases component count- Bridge: edge whose removal increases component count Algorithm: Tarjan’s DFS Track discovery time <code>tin[u]</code> and lowest reachable ancestor <code>low[u]</code>.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb187"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>    tin<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>timer<span class="op">;</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> p<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>tin<span class="op">[</span>v<span class="op">])</span> <span class="op">{</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>            low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span> low<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>low<span class="op">[</span>v<span class="op">]</span> <span class="op">&gt;</span> tin<span class="op">[</span>u<span class="op">])</span> bridge<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>low<span class="op">[</span>v<span class="op">]</span> <span class="op">&gt;=</span> tin<span class="op">[</span>u<span class="op">]</span> <span class="op">&amp;&amp;</span> p <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> cut_vertex<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> low<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>low<span class="op">[</span>u<span class="op">],</span> tin<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Applications:</p>
<ul>
<li>Network reliability- Biconnected components- 2-edge/vertex connectivity tests</li>
</ul>
</section>
<section id="eulerian-hamiltonian-paths" class="level4">
<h4 class="anchored" data-anchor-id="eulerian-hamiltonian-paths">4. Eulerian &amp; Hamiltonian Paths</h4>
<ul>
<li>Eulerian Path: visits every edge exactly once
<ul>
<li>Exists if graph is connected and 0 or 2 vertices have odd degree- Hamiltonian Path: visits every vertex exactly once (NP-hard) Euler Tour Construction: Hierholzer’s algorithm (O(E))</li>
</ul></li>
</ul>
<p>Applications:</p>
<ul>
<li>Route reconstruction (e.g., word chains)- Postman problems</li>
</ul>
</section>
<section id="graph-coloring-bipartiteness" class="level4">
<h4 class="anchored" data-anchor-id="graph-coloring-bipartiteness">5. Graph Coloring &amp; Bipartiteness</h4>
<p>Bipartite Check: DFS/ BFS alternating colors Fails if odd cycle found.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb188"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> bipartite<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> color<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="cf">if</span> <span class="op">(</span>color<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>        queue<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> q<span class="op">;</span> q<span class="op">.</span>push<span class="op">(</span>i<span class="op">);</span> color<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> u <span class="op">=</span> q<span class="op">.</span>front<span class="op">();</span> q<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>color<span class="op">[</span>v<span class="op">]</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> color<span class="op">[</span>u<span class="op">]</span> <span class="op">^</span> <span class="dv">1</span><span class="op">,</span> q<span class="op">.</span>push<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>color<span class="op">[</span>v<span class="op">]</span> <span class="op">==</span> color<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Applications:</p>
<ul>
<li>2-SAT reduction- Planar graph coloring- Conflict-free assignment</li>
</ul>
</section>
<section id="cycle-detection" class="level4">
<h4 class="anchored" data-anchor-id="cycle-detection">6. Cycle Detection</h4>
<ul>
<li>DFS + recursion stack for directed graphs- Union-Find for undirected graphs Used to test acyclicity, detect back edges, or find cycles for rollback or consistency checks.</li>
</ul>
</section>
<section id="dsu-on-tree-small-to-large-merging" class="level4">
<h4 class="anchored" data-anchor-id="dsu-on-tree-small-to-large-merging">7. DSU on Tree (Small-to-Large Merging)</h4>
<p>For queries like “count distinct colors in subtree,” merge results from smaller to larger subtrees to maintain O(n log n).</p>
<p>Pattern:</p>
<ol type="1">
<li>DFS through children</li>
<li>Keep large child’s data structure</li>
<li>Merge small child’s data in</li>
</ol>
<p>Applications:</p>
<ul>
<li>Offline subtree queries- Heavy subproblem caching</li>
</ul>
</section>
<section id="mos-algorithm-on-trees" class="level4">
<h4 class="anchored" data-anchor-id="mos-algorithm-on-trees">8. Mo’s Algorithm on Trees</h4>
<p>Offline algorithm to answer path queries efficiently:</p>
<ul>
<li>Convert path queries to ranges via Euler Tour- Use Mo’s ordering to process in O((N + Q)√N) Useful when online updates aren’t required.</li>
</ul>
</section>
<section id="bitmask-dp-on-graphs" class="level4">
<h4 class="anchored" data-anchor-id="bitmask-dp-on-graphs">9. Bitmask DP on Graphs</h4>
<p>For small graphs (n ≤ 20): State = subset of vertices e.g., Traveling Salesman Problem (TSP)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb189"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span>mask<span class="op">][</span>u<span class="op">]</span> <span class="op">=</span> min cost to visit mask<span class="op">,</span> end at u</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Transition:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb190"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span>mask <span class="op">|</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>v<span class="op">)][</span>v<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>mask<span class="op">][</span>u<span class="op">]</span> <span class="op">+</span> cost<span class="op">[</span>u<span class="op">][</span>v<span class="op">])</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: O(n² 2ⁿ)</p>
</section>
<section id="dynamic-graphs" class="level4">
<h4 class="anchored" data-anchor-id="dynamic-graphs">10. Dynamic Graphs</h4>
<p>Graphs that change:</p>
<ul>
<li>Incremental BFS: maintain distances as edges added- Decremental connectivity: union-find rollback or dynamic trees Used in online queries, evolving networks, or real-time systems.</li>
</ul>
</section>
<section id="special-graph-classes" class="level4">
<h4 class="anchored" data-anchor-id="special-graph-classes">11. Special Graph Classes</h4>
<ul>
<li>Planar graphs: ≤ 3V-6E; use face counting- Sparse graphs: adjacency lists best- Dense graphs: adjacency matrix / bitset Optimizations often hinge on density.</li>
</ul>
</section>
<section id="tiny-code-39" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-39">Tiny Code</h4>
<p>Topological Order:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb191"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> order <span class="op">=</span> topo_sort<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">:</span> order<span class="op">)</span> printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st"> "</span><span class="op">,</span> u<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Bridge Check: <code>if (low[v] &gt; tin[u])</code> edge is a bridge.</p>
<p>Euler Path Check: Count odd-degree nodes == 0 or 2.</p>
</section>
<section id="why-it-matters-39" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-39">Why It Matters</h4>
<p>These advanced techniques complete your toolkit. They’re not isolated , they combine to solve real-world puzzles: dependency graphs, robust networks, optimized paths, compressed states.</p>
<p>They teach a mindset:</p>
<blockquote class="blockquote">
<p>“Graphs are not obstacles , they’re shapes of possibility.”</p>
</blockquote>
</section>
<section id="try-it-yourself-39" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-39">Try It Yourself</h4>
<ol type="1">
<li>Implement topological sort and DAG DP.</li>
<li>Find SCCs and build condensation graph.</li>
<li>Detect articulation points and bridges.</li>
<li>Check Euler path conditions on random graphs.</li>
<li>Try DSU on tree for subtree statistics.</li>
<li>Solve TSP via bitmask DP for n ≤ 15.</li>
</ol>
<p>Once you can mix and match these tools, you’re no longer just navigating graphs , you’re shaping them.</p>
</section>
</section>
</section>
<section id="chapter-5.-dynamic-programming" class="level2">
<h2 class="anchored" data-anchor-id="chapter-5.-dynamic-programming">Chapter 5. Dynamic Programming</h2>
<section id="dp-basics-and-state-transitions" class="level3">
<h3 class="anchored" data-anchor-id="dp-basics-and-state-transitions">41. DP Basics and State Transitions</h3>
<p>Dynamic Programming (DP) is one of the most powerful ideas in algorithm design. It’s about breaking a big problem into smaller overlapping subproblems, solving each once, and reusing their answers.</p>
<p>When brute force explodes exponentially, DP brings it back under control. This section introduces the mindset, the mechanics, and the math behind DP.</p>
<section id="the-core-idea-1" class="level4">
<h4 class="anchored" data-anchor-id="the-core-idea-1">1. The Core Idea</h4>
<p>Many problems have two key properties:</p>
<ul>
<li><p>Overlapping subproblems: The same smaller computations repeat many times.</p></li>
<li><p>Optimal substructure: The optimal solution to a problem can be built from optimal solutions to its subproblems.</p></li>
</ul>
<p>DP solves each subproblem once, stores the result, and reuses it. This saves exponential time , often reducing ( O<span class="math inline">\(2^n\)</span> ) to ( O<span class="math inline">\(n^2\)</span> ) or ( O(n) ).</p>
</section>
<section id="the-recipe" class="level4">
<h4 class="anchored" data-anchor-id="the-recipe">2. The Recipe</h4>
<p>When approaching a DP problem, follow this pattern:</p>
<ol type="1">
<li><p>Define the state. Decide what subproblems you’ll solve. Example: <code>dp[i] = best answer for first i elements</code>.</p></li>
<li><p>Write the recurrence. Express each state in terms of smaller ones. Example: <code>dp[i] = dp[i-1] + cost(i)</code></p></li>
<li><p>Set the base cases. Where does the recursion start? Example: <code>dp[0] = 0</code></p></li>
<li><p>Decide the order. Bottom-up (iterative) or top-down (recursive with memoization).</p></li>
<li><p>Return the final answer. Often <code>dp[n]</code> or <code>max(dp[i])</code>.</p></li>
</ol>
</section>
<section id="example-fibonacci-numbers" class="level4">
<h4 class="anchored" data-anchor-id="example-fibonacci-numbers">3. Example: Fibonacci Numbers</h4>
<p>Let’s begin with a classic , the nth Fibonacci number ( F(n) = F(n-1) + F(n-2) ).</p>
<p>Recursive (slow):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb192"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fib<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> fib<span class="op">(</span>n <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This recomputes the same values over and over , exponential time.</p>
<p>Top-Down DP (Memoization):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb193"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>dp<span class="op">[</span>n<span class="op">]</span> <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">]</span> <span class="op">=</span> fib<span class="op">(</span>n<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">+</span> fib<span class="op">(</span>n<span class="op">-</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Bottom-Up DP (Tabulation):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb194"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> dp<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Space Optimized:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb195"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> b <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> c<span class="op">;</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>        c <span class="op">=</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> c<span class="op">;</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> b<span class="op">;</span></span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="states-transitions-and-dependencies" class="level4">
<h4 class="anchored" data-anchor-id="states-transitions-and-dependencies">4. States, Transitions, and Dependencies</h4>
<p>A DP table is a map from states to answers. Each state depends on others via a transition function.</p>
<p>Think of it like a graph , each edge represents a recurrence relation.</p>
<p>Example:</p>
<ul>
<li>State: <code>dp[i] = number of ways to reach step i</code>- Transition: <code>dp[i] = dp[i-1] + dp[i-2]</code> (like stairs)- Base: <code>dp[0] = 1</code></li>
</ul>
</section>
<section id="common-dp-patterns" class="level4">
<h4 class="anchored" data-anchor-id="common-dp-patterns">5. Common DP Patterns</h4>
<ol type="1">
<li><p>1D Linear DP</p>
<ul>
<li>Problems like Fibonacci, climbing stairs, LIS.</li>
</ul></li>
<li><p>2D DP</p>
<ul>
<li>Grids, sequences, or combinations (LCS, knapsack).</li>
</ul></li>
<li><p>Bitmask DP</p>
<ul>
<li>Subsets, TSP, combinatorial optimization.</li>
</ul></li>
<li><p>DP on Trees</p>
<ul>
<li>Subtree computations (sum, diameter).</li>
</ul></li>
<li><p>Digit DP</p>
<ul>
<li>Counting numbers with properties in a range.</li>
</ul></li>
<li><p>Segment DP</p>
<ul>
<li>Matrix chain multiplication, interval merges.</li>
</ul></li>
</ol>
</section>
<section id="top-down-vs-bottom-up" class="level4">
<h4 class="anchored" data-anchor-id="top-down-vs-bottom-up">6. Top-Down vs Bottom-Up</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 28%">
<col style="width: 29%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Approach</th>
<th>Method</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Top-Down</td>
<td>Recursion + Memoization</td>
<td>Easy to write, intuitive</td>
<td>Stack overhead, needs memo</td>
</tr>
<tr class="even">
<td>Bottom-Up</td>
<td>Iteration</td>
<td>Fast, space-optimizable</td>
<td>Harder to derive order</td>
</tr>
</tbody>
</table>
<p>When dependencies are simple and acyclic, bottom-up shines. When they’re complex, top-down is easier.</p>
</section>
<section id="example-2-climbing-stairs" class="level4">
<h4 class="anchored" data-anchor-id="example-2-climbing-stairs">7. Example 2: Climbing Stairs</h4>
<p>You can climb 1 or 2 steps at a time. How many distinct ways to reach step ( n )?</p>
<p>State: <code>dp[i] = ways to reach step i</code> Transition: <code>dp[i] = dp[i-1] + dp[i-2]</code> Base: <code>dp[0] = 1, dp[1] = 1</code></p>
<p>Code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb196"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> climb<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="debugging-dp" class="level4">
<h4 class="anchored" data-anchor-id="debugging-dp">8. Debugging DP</h4>
<p>To debug DP:</p>
<ul>
<li>Print intermediate states.- Visualize table (especially 2D).- Check base cases.- Trace one small example by hand.</li>
</ul>
</section>
<section id="complexity-2" class="level4">
<h4 class="anchored" data-anchor-id="complexity-2">9. Complexity</h4>
<p>Most DP algorithms are linear or quadratic in number of states:</p>
<ul>
<li>Time = (#states) × (work per transition)- Space = (#states) Example: Fibonacci: ( O(n) ) time, ( O(1) ) space Knapsack: ( O<span class="math inline">\(n \times W\)</span> ) LCS: ( O<span class="math inline">\(n \times m\)</span> )</li>
</ul>
</section>
<section id="tiny-code-40" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-40">Tiny Code</h4>
<p>Fibonacci (tabulated):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb197"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> dp<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d</span><span class="st">"</span><span class="op">,</span> dp<span class="op">[</span>n<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-40" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-40">Why It Matters</h4>
<p>DP is the art of remembering. It transforms recursion into iteration, chaos into order.</p>
<p>From optimization to counting, from paths to sequences , once you see substructure, DP becomes your hammer.</p>
<blockquote class="blockquote">
<p>“Every repetition hides a recurrence.”</p>
</blockquote>
</section>
<section id="try-it-yourself-40" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-40">Try It Yourself</h4>
<ol type="1">
<li>Write top-down and bottom-up Fibonacci.</li>
<li>Count ways to climb stairs with steps {1,2,3}.</li>
<li>Compute number of paths in an n×m grid.</li>
<li>Try to spot state, recurrence, base in each problem.</li>
<li>Draw dependency graphs to visualize transitions.</li>
</ol>
<p>DP isn’t a formula , it’s a mindset: break problems into parts, remember the past, and build from it.</p>
</section>
</section>
<section id="classic-problems-knapsack-subset-sum-coin-change" class="level3">
<h3 class="anchored" data-anchor-id="classic-problems-knapsack-subset-sum-coin-change">42. Classic Problems (Knapsack, Subset Sum, Coin Change)</h3>
<p>Now that you know what dynamic programming <em>is</em>, let’s dive into the classic trio , problems that every programmer meets early on:</p>
<ul>
<li>Knapsack (maximize value under weight constraint)- Subset Sum (can we form a given sum?)- Coin Change (how many ways or fewest coins to reach a total) These are the training grounds of DP: each shows how to define states, transitions, and base cases clearly.</li>
</ul>
<section id="knapsack-problem" class="level4">
<h4 class="anchored" data-anchor-id="knapsack-problem">1. 0/1 Knapsack Problem</h4>
<p>Problem: You have <code>n</code> items, each with weight <code>w[i]</code> and value <code>v[i]</code>. A knapsack with capacity <code>W</code>. Pick items (each at most once) to maximize total value, without exceeding weight.</p>
</section>
<section id="a.-state" class="level4">
<h4 class="anchored" data-anchor-id="a.-state">A. State</h4>
<p><code>dp[i][w]</code> = max value using first <code>i</code> items with capacity <code>w</code></p>
</section>
<section id="b.-recurrence" class="level4">
<h4 class="anchored" data-anchor-id="b.-recurrence">B. Recurrence</h4>
<p>For item <code>i</code>:</p>
<ul>
<li>If we don’t take it: <code>dp[i-1][w]</code>- If we take it (if <code>w[i] ≤ w</code>): <code>dp[i-1][w - w[i]] + v[i]</code> So, <span class="math display">\[
dp[i][w] = \max(dp[i-1][w], dp[i-1][w - w[i]] + v[i])
\]</span></li>
</ul>
</section>
<section id="c.-base-case" class="level4">
<h4 class="anchored" data-anchor-id="c.-base-case">C. Base Case</h4>
<p><code>dp[0][w] = 0</code> for all w (no items = no value)</p>
</section>
<section id="d.-implementation" class="level4">
<h4 class="anchored" data-anchor-id="d.-implementation">D. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb198"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> knapsack<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> W<span class="op">,</span> <span class="dt">int</span> w<span class="op">[],</span> <span class="dt">int</span> v<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">][</span>W<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> W<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> j <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>w<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">&lt;=</span> j<span class="op">)</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> w<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]]</span> <span class="op">+</span> v<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">];</span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>W<span class="op">];</span></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: Time: (O(nW)) Space: (O(nW)) (can be optimized to 1D (O(W)))</p>
</section>
<section id="e.-space-optimization-1d-dp" class="level4">
<h4 class="anchored" data-anchor-id="e.-space-optimization-1d-dp">E. Space Optimization (1D DP)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb199"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>W<span class="op">+</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> w <span class="op">=</span> W<span class="op">;</span> w <span class="op">&gt;=</span> weight<span class="op">[</span>i<span class="op">];</span> w<span class="op">--)</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>w<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>w<span class="op">],</span> dp<span class="op">[</span>w <span class="op">-</span> weight<span class="op">[</span>i<span class="op">]]</span> <span class="op">+</span> value<span class="op">[</span>i<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="f.-example" class="level4">
<h4 class="anchored" data-anchor-id="f.-example">F. Example</h4>
<p>Items:</p>
<pre><code>w = [2, 3, 4, 5]
v = [3, 4, 5, 6]
W = 5</code></pre>
<p>Best: take items 1 + 2 → value 7</p>
</section>
<section id="subset-sum" class="level4">
<h4 class="anchored" data-anchor-id="subset-sum">2. Subset Sum</h4>
<p>Problem: Given a set <code>S</code> of integers, can we pick some to sum to <code>target</code>?</p>
</section>
<section id="a.-state-1" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-1">A. State</h4>
<p><code>dp[i][sum] = true</code> if we can form sum <code>sum</code> using first <code>i</code> elements.</p>
</section>
<section id="b.-recurrence-1" class="level4">
<h4 class="anchored" data-anchor-id="b.-recurrence-1">B. Recurrence</h4>
<ul>
<li>Don’t take: <code>dp[i-1][sum]</code>- Take (if <code>a[i] ≤ sum</code>): <code>dp[i-1][sum - a[i]]</code> So, <span class="math display">\[
dp[i][sum] = dp[i-1][sum] ; || ; dp[i-1][sum - a[i]]
\]</span></li>
</ul>
</section>
<section id="c.-base-case-1" class="level4">
<h4 class="anchored" data-anchor-id="c.-base-case-1">C. Base Case</h4>
<p><code>dp[0][0] = true</code> (sum 0 possible with no elements) <code>dp[0][sum] = false</code> for sum &gt; 0</p>
</section>
<section id="d.-implementation-1" class="level4">
<h4 class="anchored" data-anchor-id="d.-implementation-1">D. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb201"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> subset_sum<span class="op">(</span><span class="dt">int</span> a<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> target<span class="op">)</span> <span class="op">{</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">][</span>target<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> dp<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> target<span class="op">;</span> j<span class="op">++)</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> target<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">&gt;</span> j<span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">];</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">||</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j <span class="op">-</span> a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]];</span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>target<span class="op">];</span></span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: Time: (O<span class="math inline">\(n \cdot target\)</span>)</p>
</section>
<section id="e.-example" class="level4">
<h4 class="anchored" data-anchor-id="e.-example">E. Example</h4>
<p>S = [3, 34, 4, 12, 5, 2], target = 9 Yes → 4 + 5</p>
</section>
<section id="coin-change" class="level4">
<h4 class="anchored" data-anchor-id="coin-change">3. Coin Change</h4>
<p>Two variants:</p>
</section>
<section id="a-count-ways-unbounded-coins" class="level4">
<h4 class="anchored" data-anchor-id="a-count-ways-unbounded-coins">(a) Count Ways (Unbounded Coins)</h4>
<p>“How many ways to make total <code>T</code> with coins <code>c[]</code>?”</p>
<p>Order doesn’t matter.</p>
<p>State: <code>dp[i][t] = ways using first i coins for total t</code></p>
<p>Recurrence:</p>
<ul>
<li>Skip coin: <code>dp[i-1][t]</code>- Take coin (unlimited): <code>dp[i][t - c[i]]</code> <span class="math display">\[
dp[i][t] = dp[i-1][t] + dp[i][t - c[i]]
\]</span></li>
</ul>
<p>Base: <code>dp[0][0] = 1</code></p>
<p>1D Simplified:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb202"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>T<span class="op">+</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span><span class="dv">0</span><span class="op">};</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> coin <span class="op">:</span> coins<span class="op">)</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> coin<span class="op">;</span> t <span class="op">&lt;=</span> T<span class="op">;</span> t<span class="op">++)</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>t<span class="op">]</span> <span class="op">+=</span> dp<span class="op">[</span>t <span class="op">-</span> coin<span class="op">];</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b-min-coins-fewest-coins-to-reach-total" class="level4">
<h4 class="anchored" data-anchor-id="b-min-coins-fewest-coins-to-reach-total">(b) Min Coins (Fewest Coins to Reach Total)</h4>
<p>State: <code>dp[t] = min coins to reach t</code></p>
<p>Recurrence: <span class="math display">\[
dp[t] = \min_{c_i \le t}(dp[t - c_i] + 1)
\]</span></p>
<p>Base: <code>dp[0] = 0</code>, rest = INF</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb203"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>T<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>fill<span class="op">(</span>dp<span class="op">,</span> dp<span class="op">+</span>T<span class="op">+</span><span class="dv">1</span><span class="op">,</span> INF<span class="op">);</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> t <span class="op">&lt;=</span> T<span class="op">;</span> t<span class="op">++)</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">:</span> coins<span class="op">)</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>t <span class="op">&gt;=</span> c<span class="op">)</span> dp<span class="op">[</span>t<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>t<span class="op">],</span> dp<span class="op">[</span>t <span class="op">-</span> c<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-1" class="level4">
<h4 class="anchored" data-anchor-id="example-1">Example</h4>
<p>Coins = [1,2,5], Total = 5</p>
<ul>
<li>Ways: 4 (5; 2+2+1; 2+1+1+1; 1+1+1+1+1)- Min Coins: 1 (5)</li>
</ul>
</section>
<section id="summary-3" class="level4">
<h4 class="anchored" data-anchor-id="summary-3">4. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 29%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>Type</th>
<th>State</th>
<th>Transition</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0/1 Knapsack</td>
<td>Max value</td>
<td>dp[i][w]</td>
<td>max(take, skip)</td>
<td>O(nW)</td>
</tr>
<tr class="even">
<td>Subset Sum</td>
<td>Feasibility</td>
<td>dp[i][sum]</td>
<td>OR of include/exclude</td>
<td>O(n * sum)</td>
</tr>
<tr class="odd">
<td>Coin Change (ways)</td>
<td>Counting</td>
<td>dp[t]</td>
<td>dp[t] + dp[t - coin]</td>
<td>O(nT)</td>
</tr>
<tr class="even">
<td>Coin Change (min)</td>
<td>Optimization</td>
<td>dp[t]</td>
<td>min(dp[t - coin] + 1)</td>
<td>O(nT)</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-41" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-41">Tiny Code</h4>
<p>Min Coin Change (1D):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb204"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>T<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>fill<span class="op">(</span>dp<span class="op">,</span> dp<span class="op">+</span>T<span class="op">+</span><span class="dv">1</span><span class="op">,</span> INF<span class="op">);</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">:</span> coins<span class="op">)</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> c<span class="op">;</span> t <span class="op">&lt;=</span> T<span class="op">;</span> t<span class="op">++)</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>t<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>t<span class="op">],</span> dp<span class="op">[</span>t <span class="op">-</span> c<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> dp<span class="op">[</span>T<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-41" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-41">Why It Matters</h4>
<p>These three are archetypes:</p>
<ul>
<li>Knapsack: optimize under constraint- Subset Sum: choose feasibility- Coin Change: count or minimize Once you master them, you can spot their patterns in harder problems , from resource allocation to pathfinding.</li>
</ul>
<blockquote class="blockquote">
<p>“Every constraint hides a choice; every choice hides a state.”</p>
</blockquote>
</section>
<section id="try-it-yourself-41" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-41">Try It Yourself</h4>
<ol type="1">
<li>Implement 0/1 Knapsack (2D and 1D).</li>
<li>Solve Subset Sum for target 30 with random list.</li>
<li>Count coin combinations for amount 10.</li>
<li>Compare “min coins” vs “ways to form.”</li>
<li>Write down state-transition diagram for each.</li>
</ol>
<p>These three form your DP foundation , the grammar for building more complex algorithms.</p>
</section>
</section>
<section id="sequence-problems-lis-lcs-edit-distance" class="level3">
<h3 class="anchored" data-anchor-id="sequence-problems-lis-lcs-edit-distance">43. Sequence Problems (LIS, LCS, Edit Distance)</h3>
<p>Sequence problems form the <em>heart</em> of dynamic programming. They appear in strings, arrays, genomes, text comparison, and version control. Their power comes from comparing prefixes , building large answers from aligned smaller ones.</p>
<p>This section explores three cornerstones:</p>
<ul>
<li>LIS (Longest Increasing Subsequence)- LCS (Longest Common Subsequence)- Edit Distance (Levenshtein Distance) Each teaches a new way to think about subproblems, transitions, and structure.</li>
</ul>
<section id="longest-increasing-subsequence-lis" class="level4">
<h4 class="anchored" data-anchor-id="longest-increasing-subsequence-lis">1. Longest Increasing Subsequence (LIS)</h4>
<p>Problem: Given an array, find the length of the longest subsequence that is <em>strictly increasing</em>.</p>
<p>A subsequence isn’t necessarily contiguous , you can skip elements.</p>
<p>Example: <code>[10, 9, 2, 5, 3, 7, 101, 18]</code> → LIS is <code>[2, 3, 7, 18]</code> → length 4</p>
</section>
<section id="a.-state-2" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-2">A. State</h4>
<p><code>dp[i]</code> = length of LIS ending at index <code>i</code></p>
</section>
<section id="b.-recurrence-2" class="level4">
<h4 class="anchored" data-anchor-id="b.-recurrence-2">B. Recurrence</h4>
<p><span class="math display">\[
dp[i] = 1 + \max_{j &lt; i \land a[j] &lt; a[i]} dp[j]
\]</span></p>
<p>If no smaller <code>a[j]</code>, then <code>dp[i] = 1</code>.</p>
</section>
<section id="c.-base" class="level4">
<h4 class="anchored" data-anchor-id="c.-base">C. Base</h4>
<p><code>dp[i] = 1</code> for all i (each element alone is an LIS)</p>
</section>
<section id="d.-implementation-2" class="level4">
<h4 class="anchored" data-anchor-id="d.-implementation-2">D. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb205"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> lis<span class="op">(</span><span class="dt">int</span> a<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">],</span> best <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> a<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>i<span class="op">],</span> dp<span class="op">[</span>j<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>        best <span class="op">=</span> max<span class="op">(</span>best<span class="op">,</span> dp<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best<span class="op">;</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(n^2\)</span>)</p>
</section>
<section id="e.-binary-search-optimization" class="level4">
<h4 class="anchored" data-anchor-id="e.-binary-search-optimization">E. Binary Search Optimization</h4>
<p>Use a tail array:</p>
<ul>
<li><p><code>tail[len] = min possible ending value of LIS of length len</code> For each <code>x</code>:</p></li>
<li><p>Replace <code>tail[idx]</code> via lower_bound</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb206"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> lis_fast<span class="op">(</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;&amp;</span> a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> tail<span class="op">;</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> x <span class="op">:</span> a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">auto</span> it <span class="op">=</span> lower_bound<span class="op">(</span>tail<span class="op">.</span>begin<span class="op">(),</span> tail<span class="op">.</span>end<span class="op">(),</span> x<span class="op">);</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>it <span class="op">==</span> tail<span class="op">.</span>end<span class="op">())</span> tail<span class="op">.</span>push_back<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="op">*</span>it <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tail<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(n \log n\)</span>)</p>
</section>
<section id="longest-common-subsequence-lcs" class="level4">
<h4 class="anchored" data-anchor-id="longest-common-subsequence-lcs">2. Longest Common Subsequence (LCS)</h4>
<p>Problem: Given two strings, find the longest subsequence present in both.</p>
<p>Example: <code>s1 = "ABCBDAB"</code>, <code>s2 = "BDCABA"</code> LCS = “BCBA” → length 4</p>
</section>
<section id="a.-state-3" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-3">A. State</h4>
<p><code>dp[i][j]</code> = LCS length between <code>s1[0..i-1]</code> and <code>s2[0..j-1]</code></p>
</section>
<section id="b.-recurrence-3" class="level4">
<h4 class="anchored" data-anchor-id="b.-recurrence-3">B. Recurrence</h4>
<p><span class="math display">\[
dp[i][j] =
\begin{cases}
dp[i-1][j-1] + 1, &amp; \text{if } s_1[i-1] = s_2[j-1], \\
\max(dp[i-1][j],\, dp[i][j-1]), &amp; \text{otherwise.}
\end{cases}
\]</span></p>
</section>
<section id="c.-base-1" class="level4">
<h4 class="anchored" data-anchor-id="c.-base-1">C. Base</h4>
<p><code>dp[0][*] = dp[*][0] = 0</code> (empty string)</p>
</section>
<section id="d.-implementation-3" class="level4">
<h4 class="anchored" data-anchor-id="d.-implementation-3">D. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb207"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> lcs<span class="op">(</span>string a<span class="op">,</span> string b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> a<span class="op">.</span>size<span class="op">(),</span> m <span class="op">=</span> b<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">][</span>m<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> j <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>m<span class="op">];</span></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O(nm))</p>
</section>
<section id="e.-reconstruct-lcs" class="level4">
<h4 class="anchored" data-anchor-id="e.-reconstruct-lcs">E. Reconstruct LCS</h4>
<p>Trace back from <code>dp[n][m]</code>:</p>
<ul>
<li>If chars equal → take it and move diagonally- Else move toward larger neighbor</li>
</ul>
</section>
<section id="f.-example-1" class="level4">
<h4 class="anchored" data-anchor-id="f.-example-1">F. Example</h4>
<p>a = “AGGTAB”, b = “GXTXAYB” LCS = “GTAB” → 4</p>
</section>
<section id="edit-distance-levenshtein-distance" class="level4">
<h4 class="anchored" data-anchor-id="edit-distance-levenshtein-distance">3. Edit Distance (Levenshtein Distance)</h4>
<p>Problem: Minimum operations (insert, delete, replace) to convert string <code>a</code> → <code>b</code>.</p>
<p>Example: <code>kitten → sitting</code> = 3 (replace k→s, insert i, insert g)</p>
</section>
<section id="a.-state-4" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-4">A. State</h4>
<p><code>dp[i][j]</code> = min edits to convert <code>a[0..i-1]</code> → <code>b[0..j-1]</code></p>
</section>
<section id="b.-recurrence-4" class="level4">
<h4 class="anchored" data-anchor-id="b.-recurrence-4">B. Recurrence</h4>
<p>If <code>a[i-1] == b[j-1]</code>: <span class="math display">\[
dp[i][j] = dp[i-1][j-1]
\]</span></p>
<p>Else: <span class="math display">\[
dp[i][j] = 1 + \min(dp[i-1][j], dp[i][j-1], dp[i-1][j-1])
\]</span> (Delete, Insert, Replace)</p>
</section>
<section id="c.-base-2" class="level4">
<h4 class="anchored" data-anchor-id="c.-base-2">C. Base</h4>
<ul>
<li><code>dp[0][j] = j</code> (insert all)- <code>dp[i][0] = i</code> (delete all)</li>
</ul>
</section>
<section id="d.-implementation-4" class="level4">
<h4 class="anchored" data-anchor-id="d.-implementation-4">D. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb208"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> edit_distance<span class="op">(</span>string a<span class="op">,</span> string b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> a<span class="op">.</span>size<span class="op">(),</span> m <span class="op">=</span> b<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">][</span>m<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>j <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> min<span class="op">({</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">],</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]});</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>m<span class="op">];</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O(nm))</p>
</section>
<section id="e.-example-1" class="level4">
<h4 class="anchored" data-anchor-id="e.-example-1">E. Example</h4>
<p>a = “horse”, b = “ros”</p>
<ul>
<li>replace h→r, delete r, delete e → 3</li>
</ul>
</section>
<section id="summary-4" class="level4">
<h4 class="anchored" data-anchor-id="summary-4">4. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 31%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>Type</th>
<th>State</th>
<th>Transition</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LIS</td>
<td>Single seq</td>
<td>dp[i]</td>
<td>1 + max(dp[j])</td>
<td>O(n²) / O(n log n)</td>
</tr>
<tr class="even">
<td>LCS</td>
<td>Two seqs</td>
<td>dp[i][j]</td>
<td>if match +1 else max</td>
<td>O(nm)</td>
</tr>
<tr class="odd">
<td>Edit Distance</td>
<td>Two seqs</td>
<td>dp[i][j]</td>
<td>if match 0 else 1 + min</td>
<td>O(nm)</td>
</tr>
</tbody>
</table>
</section>
<section id="common-insights" class="level4">
<h4 class="anchored" data-anchor-id="common-insights">5. Common Insights</h4>
<ul>
<li>LIS builds upward , from smaller sequences.- LCS aligns two sequences , compare prefixes.- Edit Distance quantifies <em>difference</em> , minimal edits. They’re templates for bioinformatics, text diffing, version control, and more.</li>
</ul>
</section>
<section id="tiny-code-42" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-42">Tiny Code</h4>
<p>LCS:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb209"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-42" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-42">Why It Matters</h4>
<p>Sequence DPs teach you how to compare progressions , how structure and similarity evolve over time.</p>
<p>They transform vague “compare these” tasks into crisp recurrence relations.</p>
<blockquote class="blockquote">
<p>“To align is to understand.”</p>
</blockquote>
</section>
<section id="try-it-yourself-42" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-42">Try It Yourself</h4>
<ol type="1">
<li>Implement LIS (O(n²) and O(n log n))</li>
<li>Find LCS of two given strings</li>
<li>Compute edit distance between “intention” and “execution”</li>
<li>Modify LCS to print one valid subsequence</li>
<li>Try to unify LCS and Edit Distance in a single table</li>
</ol>
<p>Master these, and you can handle any DP on sequences , the DNA of algorithmic thinking.</p>
</section>
</section>
<section id="matrix-and-chain-problems" class="level3">
<h3 class="anchored" data-anchor-id="matrix-and-chain-problems">44. Matrix and Chain Problems</h3>
<p>Dynamic programming shines when a problem involves choices over intervals , which order, which split, which parenthesis. This chapter explores a class of problems built on chains and matrices, where order matters and substructure is defined by intervals.</p>
<p>We’ll study:</p>
<ul>
<li>Matrix Chain Multiplication (MCM) - optimal parenthesization- Polygon Triangulation - divide shape into minimal-cost triangles- Optimal BST / Merge Patterns - weighted merging decisions These problems teach interval DP, where each state represents a segment ([i, j]).</li>
</ul>
<section id="matrix-chain-multiplication-mcm" class="level4">
<h4 class="anchored" data-anchor-id="matrix-chain-multiplication-mcm">1. Matrix Chain Multiplication (MCM)</h4>
<p>Problem: Given matrices <span class="math inline">\(A_1, A_2, ..., A_n\)</span>, find the parenthesization that minimizes total scalar multiplications.</p>
<p>Matrix <span class="math inline">\(A_i\)</span> has dimensions <span class="math inline">\(p[i-1] \times p[i]\)</span>. We can multiply <span class="math inline">\(A_i \cdot A_{i+1}\)</span> only if inner dimensions match.</p>
<p>Goal: Minimize operations: <span class="math display">\[
\text{cost}(i, j) = \min_k \big(\text{cost}(i, k) + \text{cost}(k+1, j) + p[i-1] \cdot p[k] \cdot p[j]\big)
\]</span></p>
</section>
<section id="a.-state-5" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-5">A. State</h4>
<p><code>dp[i][j]</code> = min multiplications to compute <span class="math inline">\(A_i...A_j\)</span></p>
</section>
<section id="b.-base" class="level4">
<h4 class="anchored" data-anchor-id="b.-base">B. Base</h4>
<p><code>dp[i][i] = 0</code> (single matrix needs no multiplication)</p>
</section>
<section id="c.-recurrence" class="level4">
<h4 class="anchored" data-anchor-id="c.-recurrence">C. Recurrence</h4>
<p><span class="math display">\[
dp[i][j] = \min_{i \le k &lt; j} { dp[i][k] + dp[k+1][j] + p[i-1] \times p[k] \times p[j] }
\]</span></p>
</section>
<section id="d.-implementation-5" class="level4">
<h4 class="anchored" data-anchor-id="d.-implementation-5">D. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb210"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> matrix_chain<span class="op">(</span><span class="dt">int</span> p<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">][</span>n<span class="op">];</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> dp<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;</span> n<span class="op">;</span> len<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> j<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span></span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>                    dp<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>k<span class="op">+</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> p<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]*</span>p<span class="op">[</span>k<span class="op">]*</span>p<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span><span class="dv">1</span><span class="op">][</span>n<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(n^3\)</span>) time, (O<span class="math inline">\(n^2\)</span>) space</p>
</section>
<section id="e.-example-2" class="level4">
<h4 class="anchored" data-anchor-id="e.-example-2">E. Example</h4>
<p>p = [10, 20, 30, 40, 30] Optimal order: ((A1A2)A3)A4 → cost 30000</p>
</section>
<section id="polygon-triangulation" class="level4">
<h4 class="anchored" data-anchor-id="polygon-triangulation">2. Polygon Triangulation</h4>
<p>Given a convex polygon with <code>n</code> vertices, connect non-intersecting diagonals to minimize total cost. Cost of a triangle = perimeter or product of side weights.</p>
<p>This is the same structure as MCM , divide polygon by diagonals.</p>
</section>
<section id="a.-state-6" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-6">A. State</h4>
<p><code>dp[i][j]</code> = min triangulation cost for polygon vertices from i to j.</p>
</section>
<section id="b.-recurrence-5" class="level4">
<h4 class="anchored" data-anchor-id="b.-recurrence-5">B. Recurrence</h4>
<p><span class="math display">\[
dp[i][j] = \min_{i &lt; k &lt; j} (dp[i][k] + dp[k][j] + cost(i, j, k))
\]</span></p>
<p>Base: dp[i][i+1] = 0 (fewer than 3 points)</p>
</section>
<section id="c.-implementation-1" class="level4">
<h4 class="anchored" data-anchor-id="c.-implementation-1">C. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb211"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> polygon_triangulation<span class="op">(</span>vector<span class="op">&lt;</span>Point<span class="op">&gt;</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> p<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> dp<span class="op">[</span>n<span class="op">][</span>n<span class="op">];</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;</span> n<span class="op">;</span> len<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">+</span> len <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> len<span class="op">;</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="fl">1e18</span><span class="op">;</span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">+</span><span class="dv">1</span><span class="op">;</span> k <span class="op">&lt;</span> j<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>                    dp<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>k<span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> dist<span class="op">(</span>p<span class="op">[</span>i<span class="op">],</span>p<span class="op">[</span>k<span class="op">])+</span>dist<span class="op">(</span>p<span class="op">[</span>k<span class="op">],</span>p<span class="op">[</span>j<span class="op">])+</span>dist<span class="op">(</span>p<span class="op">[</span>j<span class="op">],</span>p<span class="op">[</span>i<span class="op">]));</span></span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span>n<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(n^3\)</span>)</p>
</section>
<section id="optimal-binary-search-tree-obst" class="level4">
<h4 class="anchored" data-anchor-id="optimal-binary-search-tree-obst">3. Optimal Binary Search Tree (OBST)</h4>
<p>Given sorted keys <span class="math inline">\(k_1 &lt; k_2 &lt; \dots &lt; k_n\)</span> with search frequencies ( f[i] ), construct a BST with minimal expected search cost.</p>
<p>The more frequently accessed nodes should be nearer the root.</p>
</section>
<section id="a.-state-7" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-7">A. State</h4>
<p><code>dp[i][j]</code> = min cost to build BST from keys <code>i..j</code> <code>sum[i][j]</code> = sum of frequencies from i to j (precomputed)</p>
</section>
<section id="b.-recurrence-6" class="level4">
<h4 class="anchored" data-anchor-id="b.-recurrence-6">B. Recurrence</h4>
<p><span class="math display">\[
dp[i][j] = \min_{k=i}^{j} (dp[i][k-1] + dp[k+1][j] + sum[i][j])
\]</span></p>
<p>Each root adds one to depth of its subtrees → extra cost = <code>sum[i][j]</code></p>
</section>
<section id="c.-implementation-2" class="level4">
<h4 class="anchored" data-anchor-id="c.-implementation-2">C. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb212"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> optimal_bst<span class="op">(</span><span class="dt">int</span> freq<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">][</span>n<span class="op">],</span> sum<span class="op">[</span>n<span class="op">][</span>n<span class="op">];</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> freq<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>        sum<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> freq<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i<span class="op">+</span><span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>            sum<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> sum<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> freq<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;=</span> n<span class="op">;</span> len<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">+</span>len<span class="op">-</span><span class="dv">1</span> <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> INT_MAX<span class="op">;</span></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> r <span class="op">=</span> i<span class="op">;</span> r <span class="op">&lt;=</span> j<span class="op">;</span> r<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> left <span class="op">=</span> <span class="op">(</span>r <span class="op">&gt;</span> i<span class="op">)</span> <span class="op">?</span> dp<span class="op">[</span>i<span class="op">][</span>r<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> right <span class="op">=</span> <span class="op">(</span>r <span class="op">&lt;</span> j<span class="op">)</span> <span class="op">?</span> dp<span class="op">[</span>r<span class="op">+</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span> left <span class="op">+</span> right <span class="op">+</span> sum<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span>n<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: (O<span class="math inline">\(n^3\)</span>)</p>
</section>
<section id="merge-pattern-problems" class="level4">
<h4 class="anchored" data-anchor-id="merge-pattern-problems">4. Merge Pattern Problems</h4>
<p>Many problems , merging files, joining ropes, Huffman coding , involve repeatedly combining elements with minimal total cost.</p>
<p>All follow this template: <span class="math display">\[
dp[i][j] = \min_{k} (dp[i][k] + dp[k+1][j] + \text{merge cost})
\]</span></p>
<p>Same structure as MCM.</p>
</section>
<section id="key-pattern-interval-dp" class="level4">
<h4 class="anchored" data-anchor-id="key-pattern-interval-dp">5. Key Pattern: Interval DP</h4>
<p>State: <code>dp[i][j] = best answer for subarray [i..j]</code> Transition: Try all splits <code>k</code> between <code>i</code> and <code>j</code></p>
<p>Template:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb213"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;=</span> n<span class="op">;</span> len<span class="op">++)</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> j<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>       dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>k<span class="op">+</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> cost<span class="op">(</span>i<span class="op">,</span>j<span class="op">,</span>k<span class="op">));</span></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a> <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-5" class="level4">
<h4 class="anchored" data-anchor-id="summary-5">6. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 10%">
<col style="width: 51%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>State</th>
<th>Recurrence</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MCM</td>
<td>dp[i][j]</td>
<td>min(dp[i][k]+dp[k+1][j]+p[i-1]<em>p[k]</em>p[j])</td>
<td>O(n³)</td>
</tr>
<tr class="even">
<td>Polygon Triangulation</td>
<td>dp[i][j]</td>
<td>min(dp[i][k]+dp[k][j]+cost)</td>
<td>O(n³)</td>
</tr>
<tr class="odd">
<td>OBST</td>
<td>dp[i][j]</td>
<td>min(dp[i][k-1]+dp[k+1][j]+sum[i][j])</td>
<td>O(n³)</td>
</tr>
<tr class="even">
<td>Merge Problems</td>
<td>dp[i][j]</td>
<td>min(dp[i][k]+dp[k+1][j]+merge cost)</td>
<td>O(n³)</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-43" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-43">Tiny Code</h4>
<p>Matrix Chain (Compact):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb214"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;</span> n<span class="op">;</span> len<span class="op">++)</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> j<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>      dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>k<span class="op">+</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> p<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]*</span>p<span class="op">[</span>k<span class="op">]*</span>p<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-43" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-43">Why It Matters</h4>
<p>These problems are DP in 2D , reasoning over intervals and splits. They train your ability to “cut the problem” at every possible point.</p>
<blockquote class="blockquote">
<p>“Between every start and end lies a choice of where to divide.”</p>
</blockquote>
</section>
<section id="try-it-yourself-43" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-43">Try It Yourself</h4>
<ol type="1">
<li>Implement MCM and print parenthesization.</li>
<li>Solve polygon triangulation with edge weights.</li>
<li>Build OBST for frequencies [34, 8, 50].</li>
<li>Visualize DP table diagonally.</li>
<li>Generalize to merging <code>k</code> segments at a time.</li>
</ol>
<p>Master these, and you’ll see interval DP patterns hiding in parsing, merging, and even AI planning.</p>
</section>
</section>
<section id="bitmask-dp-and-traveling-salesman" class="level3">
<h3 class="anchored" data-anchor-id="bitmask-dp-and-traveling-salesman">45. Bitmask DP and Traveling Salesman</h3>
<p>Some dynamic programming problems require you to track which items have been used, or which subset of elements is active at a given point. This is where Bitmask DP shines. It encodes subsets as binary masks, allowing you to represent state space efficiently.</p>
<p>This technique is a must-know for:</p>
<ul>
<li>Traveling Salesman Problem (TSP)- Subset covering / visiting problems- Permutations and combinations of sets- Game states and toggles</li>
</ul>
<section id="the-idea-of-bitmask-dp" class="level4">
<h4 class="anchored" data-anchor-id="the-idea-of-bitmask-dp">1. The Idea of Bitmask DP</h4>
<p>A bitmask is an integer whose binary representation encodes a subset.</p>
<p>For ( n ) elements:</p>
<ul>
<li>There are <span class="math inline">\(2^n\)</span> subsets.- A subset is represented by a mask from <code>0</code> to <code>(1 &lt;&lt; n) - 1</code>. Example for <code>n = 4</code>:</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Subset</th>
<th>Mask (binary)</th>
<th>Mask (decimal)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>∅</td>
<td>0000</td>
<td>0</td>
</tr>
<tr class="even">
<td>{0}</td>
<td>0001</td>
<td>1</td>
</tr>
<tr class="odd">
<td>{1}</td>
<td>0010</td>
<td>2</td>
</tr>
<tr class="even">
<td>{0,1,3}</td>
<td>1011</td>
<td>11</td>
</tr>
</tbody>
</table>
<p>We can check membership:</p>
<ul>
<li><code>mask &amp; (1 &lt;&lt; i)</code> → whether element <code>i</code> is in subset We can add elements:</li>
<li><code>mask | (1 &lt;&lt; i)</code> → add element <code>i</code> We can remove elements:</li>
<li><code>mask &amp; ~(1 &lt;&lt; i)</code> → remove element <code>i</code></li>
</ul>
</section>
<section id="example-traveling-salesman-problem-tsp" class="level4">
<h4 class="anchored" data-anchor-id="example-traveling-salesman-problem-tsp">2. Example: Traveling Salesman Problem (TSP)</h4>
<p>Problem: Given <code>n</code> cities and cost matrix <code>cost[i][j]</code>, find the minimum cost Hamiltonian cycle visiting all cities exactly once and returning to start.</p>
</section>
<section id="a.-state-8" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-8">A. State</h4>
<p><code>dp[mask][i]</code> = minimum cost to reach city <code>i</code> having visited subset <code>mask</code></p>
<ul>
<li><code>mask</code> → set of visited cities- <code>i</code> → current city</li>
</ul>
</section>
<section id="b.-base-case" class="level4">
<h4 class="anchored" data-anchor-id="b.-base-case">B. Base Case</h4>
<p><code>dp[1&lt;&lt;0][0] = 0</code> (start at city 0, only 0 visited)</p>
</section>
<section id="c.-transition" class="level4">
<h4 class="anchored" data-anchor-id="c.-transition">C. Transition</h4>
<p>For each subset <code>mask</code> and city <code>i</code> in <code>mask</code>, try moving from <code>i</code> to <code>j</code> not in <code>mask</code>:</p>
<p><span class="math display">\[
dp[mask \cup (1 &lt;&lt; j)][j] = \min \big(dp[mask \cup (1 &lt;&lt; j)][j], dp[mask][i] + cost[i][j]\big)
\]</span></p>
</section>
<section id="d.-implementation-6" class="level4">
<h4 class="anchored" data-anchor-id="d.-implementation-6">D. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb215"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tsp<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> cost<span class="op">[</span><span class="dv">20</span><span class="op">][</span><span class="dv">20</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> n<span class="op">;</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> <span class="dt">int</span> INF <span class="op">=</span> <span class="fl">1e9</span><span class="op">;</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>N<span class="op">][</span>n<span class="op">];</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> m <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> m <span class="op">&lt;</span> N<span class="op">;</span> m<span class="op">++)</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>m<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// start at city 0</span></span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> mask <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> mask <span class="op">&lt;</span> N<span class="op">;</span> mask<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">)))</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> j<span class="op">))</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> next <span class="op">=</span> mask <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> j<span class="op">);</span></span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>next<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>next<span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>mask<span class="op">][</span>i<span class="op">]</span> <span class="op">+</span> cost<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> min<span class="op">(</span>ans<span class="op">,</span> dp<span class="op">[</span>N<span class="op">-</span><span class="dv">1</span><span class="op">][</span>i<span class="op">]</span> <span class="op">+</span> cost<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>States: ( O<span class="math inline">\(n \cdot 2^n\)</span> )- Transitions: ( O(n) )- Total: ( O<span class="math inline">\(n^2 \cdot 2^n\)</span> )</li>
</ul>
</section>
<section id="e.-example-3" class="level4">
<h4 class="anchored" data-anchor-id="e.-example-3">E. Example</h4>
<pre><code>n = 4
cost = {
 {0, 10, 15, 20},
 {10, 0, 35, 25},
 {15, 35, 0, 30},
 {20, 25, 30, 0}
}</code></pre>
<p>Optimal path: 0 → 1 → 3 → 2 → 0 Cost = 80</p>
</section>
<section id="other-common-bitmask-dp-patterns" class="level4">
<h4 class="anchored" data-anchor-id="other-common-bitmask-dp-patterns">3. Other Common Bitmask DP Patterns</h4>
<ol type="1">
<li><p>Subset Sum / Partition <code>dp[mask] = true if subset represented by mask satisfies property</code></p></li>
<li><p>Counting Set Bits <code>__builtin_popcount(mask)</code> gives number of elements in subset.</p></li>
<li><p>Iterating Over Submasks</p></li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb217"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> sub <span class="op">=</span> mask<span class="op">;</span> sub<span class="op">;</span> sub <span class="op">=</span> <span class="op">(</span>sub<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">&amp;</span> mask<span class="op">)</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// handle subset sub</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="4" type="1">
<li>Assigning Tasks (Assignment Problem)</li>
</ol>
<ul>
<li>Each mask represents set of workers assigned.- State: <code>dp[mask] = min cost for assigned tasks</code>.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb218"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>mask<span class="op">)</span> <span class="cf">for</span> <span class="op">(</span>task<span class="op">)</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> <span class="op">(!(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> task<span class="op">)))</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>   dp<span class="op">[</span>mask <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> task<span class="op">)]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>mask <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> task<span class="op">)],</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>mask<span class="op">]</span> <span class="op">+</span> cost<span class="op">[</span>__builtin_popcount<span class="op">(</span>mask<span class="op">)][</span>task<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="memory-tricks" class="level4">
<h4 class="anchored" data-anchor-id="memory-tricks">4. Memory Tricks</h4>
<ul>
<li>If only previous masks needed, use rolling arrays:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb219"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span>next<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="op">...</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>swap<span class="op">(</span>dp<span class="op">,</span> next_dp<span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>Compress dimensions: (O<span class="math inline">\(2^n\)</span>) memory for small <code>n</code></li>
</ul>
</section>
<section id="summary-6" class="level4">
<h4 class="anchored" data-anchor-id="summary-6">5. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 48%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>State</th>
<th>Transition</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>TSP</td>
<td>dp[mask][i]</td>
<td>min(dp[mask][i] + cost[i][j])</td>
<td>O(n²·2ⁿ)</td>
</tr>
<tr class="even">
<td>Assignment</td>
<td>dp[mask]</td>
<td>add one new element</td>
<td>O(n²·2ⁿ)</td>
</tr>
<tr class="odd">
<td>Subset Sum</td>
<td>dp[mask]</td>
<td>union of valid subsets</td>
<td>O(2ⁿ·n)</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-44" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-44">Tiny Code</h4>
<p>Core Transition:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb220"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>mask<span class="op">)</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>i<span class="op">)</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>i<span class="op">))</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span>j<span class="op">)</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>j<span class="op">)))</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>          dp<span class="op">[</span>mask<span class="op">|(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>j<span class="op">)][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>mask<span class="op">|(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>j<span class="op">)][</span>j<span class="op">],</span> dp<span class="op">[</span>mask<span class="op">][</span>i<span class="op">]</span> <span class="op">+</span> cost<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-44" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-44">Why It Matters</h4>
<p>Bitmask DP is how you enumerate subsets efficiently. It bridges combinatorics and optimization, solving exponential problems with manageable constants.</p>
<blockquote class="blockquote">
<p>“Every subset is a story, and bits are its alphabet.”</p>
</blockquote>
</section>
<section id="try-it-yourself-44" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-44">Try It Yourself</h4>
<ol type="1">
<li>Solve TSP with 4 cities (hand-trace the table).</li>
<li>Implement Assignment Problem using bitmask DP.</li>
<li>Count subsets with even sum.</li>
<li>Use bitmask DP to find maximum compatible set of tasks.</li>
<li>Explore how to optimize memory with bit tricks.</li>
</ol>
<p>Bitmask DP unlocks the world of subset-based reasoning , the foundation of combinatorial optimization.</p>
</section>
</section>
<section id="digit-dp-and-sos-dp" class="level3">
<h3 class="anchored" data-anchor-id="digit-dp-and-sos-dp">46. Digit DP and SOS DP</h3>
<p>In some problems, you don’t iterate over indices or subsets , you iterate over digits or masks to count or optimize over structured states. Two major flavors stand out:</p>
<ul>
<li>Digit DP - counting numbers with certain properties (e.g.&nbsp;digit sum, constraints)- SOS DP (Sum Over Subsets) - efficiently computing functions over all subsets These are essential techniques when brute force would require enumerating every number or subset, which quickly becomes impossible.</li>
</ul>
<section id="digit-dp-counting-with-constraints" class="level4">
<h4 class="anchored" data-anchor-id="digit-dp-counting-with-constraints">1. Digit DP (Counting with Constraints)</h4>
<p>Digit DP is used to count or sum over all numbers ≤ N that satisfy a condition, such as:</p>
<ul>
<li>The sum of digits equals a target.- The number doesn’t contain a forbidden digit.- The number has certain parity or divisibility. Instead of iterating over all numbers (up to 10¹⁸!), we iterate digit-by-digit.</li>
</ul>
</section>
<section id="a.-state-design" class="level4">
<h4 class="anchored" data-anchor-id="a.-state-design">A. State Design</h4>
<p>Typical DP state:</p>
<p><code>dp[pos][sum][tight][leading_zero]</code></p>
<ul>
<li><code>pos</code>: current digit index (from most significant to least)- <code>sum</code>: property tracker (e.g.&nbsp;sum of digits, remainder)- <code>tight</code>: whether we’re still restricted by N’s prefix- <code>leading_zero</code>: whether we’ve started placing nonzero digits</li>
</ul>
</section>
<section id="b.-transition" class="level4">
<h4 class="anchored" data-anchor-id="b.-transition">B. Transition</h4>
<p>At each digit position, we choose a digit <code>d</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb221"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>limit <span class="op">=</span> tight <span class="op">?</span> <span class="op">(</span>digit at pos in N<span class="op">)</span> <span class="op">:</span> <span class="dv">9</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>d <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> d <span class="op">&lt;=</span> limit<span class="op">;</span> d<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>    new_tight <span class="op">=</span> tight <span class="op">&amp;&amp;</span> <span class="op">(</span>d <span class="op">==</span> limit<span class="op">)</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>    new_sum <span class="op">=</span> sum <span class="op">+</span> d</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// or new_mod = (mod * 10 + d) % M</span></span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Transition accumulates results across valid choices.</p>
</section>
<section id="c.-base-case-2" class="level4">
<h4 class="anchored" data-anchor-id="c.-base-case-2">C. Base Case</h4>
<p>When <code>pos == len(N)</code> (end of digits):</p>
<ul>
<li>Return 1 if condition holds (e.g.&nbsp;<code>sum == target</code>), else 0</li>
</ul>
</section>
<section id="d.-example-count-numbers-n-with-digit-sum-s" class="level4">
<h4 class="anchored" data-anchor-id="d.-example-count-numbers-n-with-digit-sum-s">D. Example: Count numbers ≤ N with digit sum = S</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb222"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> dp<span class="op">[</span><span class="dv">20</span><span class="op">][</span><span class="dv">200</span><span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> solve<span class="op">(</span>string s<span class="op">,</span> <span class="dt">int</span> pos<span class="op">,</span> <span class="dt">int</span> sum<span class="op">,</span> <span class="dt">bool</span> tight<span class="op">)</span> <span class="op">{</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>pos <span class="op">==</span> s<span class="op">.</span>size<span class="op">())</span> <span class="cf">return</span> sum <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>sum <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>dp<span class="op">[</span>pos<span class="op">][</span>sum<span class="op">][</span>tight<span class="op">]</span> <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> dp<span class="op">[</span>pos<span class="op">][</span>sum<span class="op">][</span>tight<span class="op">];</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> limit <span class="op">=</span> tight <span class="op">?</span> <span class="op">(</span>s<span class="op">[</span>pos<span class="op">]</span> <span class="op">-</span> <span class="ch">'0'</span><span class="op">)</span> <span class="op">:</span> <span class="dv">9</span><span class="op">;</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> d <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> d <span class="op">&lt;=</span> limit<span class="op">;</span> d<span class="op">++)</span></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>        res <span class="op">+=</span> solve<span class="op">(</span>s<span class="op">,</span> pos<span class="op">+</span><span class="dv">1</span><span class="op">,</span> sum<span class="op">-</span>d<span class="op">,</span> tight <span class="op">&amp;&amp;</span> <span class="op">(</span>d<span class="op">==</span>limit<span class="op">));</span></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>pos<span class="op">][</span>sum<span class="op">][</span>tight<span class="op">]</span> <span class="op">=</span> res<span class="op">;</span></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Usage:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb223"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>string N <span class="op">=</span> <span class="st">"12345"</span><span class="op">;</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> S <span class="op">=</span> <span class="dv">9</span><span class="op">;</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>memset<span class="op">(</span>dp<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="kw">sizeof</span> dp<span class="op">);</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> solve<span class="op">(</span>N<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> S<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: O(number of digits × sum × 2) → typically O(20 × 200 × 2)</p>
</section>
<section id="e.-example-variants" class="level4">
<h4 class="anchored" data-anchor-id="e.-example-variants">E. Example Variants</h4>
<ol type="1">
<li><p>Count numbers divisible by 3 → track remainder: <code>new_rem = (rem*10 + d) % 3</code></p></li>
<li><p>Count numbers without consecutive equal digits → add <code>last_digit</code> to state.</p></li>
<li><p>Count beautiful numbers (like palindromes, no repeated digits) → track bitmask of used digits.</p></li>
</ol>
</section>
<section id="f.-summary" class="level4">
<h4 class="anchored" data-anchor-id="f.-summary">F. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 33%">
<col style="width: 20%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>State</th>
<th>Transition</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sum of digits = S</td>
<td>dp[pos][sum][tight]</td>
<td>sum-d</td>
<td>O(len·S)</td>
</tr>
<tr class="even">
<td>Divisible by k</td>
<td>dp[pos][rem][tight]</td>
<td>(rem*10+d)%k</td>
<td>O(len·k)</td>
</tr>
<tr class="odd">
<td>No repeated digits</td>
<td>dp[pos][mask][tight]</td>
<td>mask</td>
<td>O(len·2¹⁰)</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-45" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-45">Tiny Code</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb224"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> d <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> d <span class="op">&lt;=</span> limit<span class="op">;</span> d<span class="op">++)</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>    res <span class="op">+=</span> solve<span class="op">(</span>pos<span class="op">+</span><span class="dv">1</span><span class="op">,</span> sum<span class="op">-</span>d<span class="op">,</span> tight <span class="op">&amp;&amp;</span> <span class="op">(</span>d<span class="op">==</span>limit<span class="op">));</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sos-dp-sum-over-subsets" class="level4">
<h4 class="anchored" data-anchor-id="sos-dp-sum-over-subsets">2. SOS DP (Sum Over Subsets)</h4>
<p>When dealing with functions on subsets, we sometimes need to compute:</p>
<p><span class="math display">\[
f(S) = \sum_{T \subseteq S} g(T)
\]</span></p>
<p>Naively O(3ⁿ). SOS DP reduces it to O(n·2ⁿ).</p>
</section>
<section id="a.-setup" class="level4">
<h4 class="anchored" data-anchor-id="a.-setup">A. Setup</h4>
<p>Let <code>f[mask] = g[mask]</code> initially. For each bit <code>i</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb225"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>mask <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> mask <span class="op">&lt;</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>n<span class="op">);</span> mask<span class="op">++)</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>i<span class="op">))</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>mask<span class="op">]</span> <span class="op">+=</span> f<span class="op">[</span>mask<span class="op">^(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>i<span class="op">)];</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>After this, <code>f[mask]</code> = sum of <code>g[sub]</code> for all <code>sub ⊆ mask</code>.</p>
</section>
<section id="b.-example-3" class="level4">
<h4 class="anchored" data-anchor-id="b.-example-3">B. Example</h4>
<p>Given array <code>a[mask]</code>, compute <code>sum[mask] = sum_{sub ⊆ mask} a[sub]</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb226"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> N <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> n<span class="op">;</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> f<span class="op">[</span>N<span class="op">],</span> a<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co">// initialize a[]</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> mask <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> mask <span class="op">&lt;</span> N<span class="op">;</span> mask<span class="op">++)</span> f<span class="op">[</span>mask<span class="op">]</span> <span class="op">=</span> a<span class="op">[</span>mask<span class="op">];</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> mask <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> mask <span class="op">&lt;</span> N<span class="op">;</span> mask<span class="op">++)</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">))</span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>mask<span class="op">]</span> <span class="op">+=</span> f<span class="op">[</span>mask <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">)];</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-why-it-works" class="level4">
<h4 class="anchored" data-anchor-id="c.-why-it-works">C. Why It Works</h4>
<p>Each iteration adds contributions from subsets differing by one bit. By processing all bits, every subset’s contribution propagates upward.</p>
</section>
<section id="d.-variants-1" class="level4">
<h4 class="anchored" data-anchor-id="d.-variants-1">D. Variants</h4>
<ul>
<li>Sum over supersets: reverse direction.- Max instead of sum: replace <code>+=</code> with <code>max=</code>.- XOR convolution: combine values under XOR subset relation.</li>
</ul>
</section>
<section id="e.-applications" class="level4">
<h4 class="anchored" data-anchor-id="e.-applications">E. Applications</h4>
<ul>
<li>Inclusion-exclusion acceleration- Precomputing subset statistics- DP over masks with subset transitions</li>
</ul>
</section>
<section id="f.-complexity" class="level4">
<h4 class="anchored" data-anchor-id="f.-complexity">F. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Problem</th>
<th>Naive</th>
<th>SOS DP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Subset sum</td>
<td>O(3ⁿ)</td>
<td>O(n·2ⁿ)</td>
</tr>
<tr class="even">
<td>Superset sum</td>
<td>O(3ⁿ)</td>
<td>O(n·2ⁿ)</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-45" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-45">Why It Matters</h4>
<p>Digit DP teaches counting under constraints , thinking digit by digit. SOS DP teaches subset propagation , spreading information efficiently.</p>
<p>Together, they show how to tame exponential state spaces with structure.</p>
<blockquote class="blockquote">
<p>“When the search space explodes, symmetry and structure are your compass.”</p>
</blockquote>
</section>
<section id="try-it-yourself-45" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-45">Try It Yourself</h4>
<ol type="1">
<li>Count numbers ≤ 10⁹ whose digit sum = 10.</li>
<li>Count numbers ≤ 10⁶ without repeated digits.</li>
<li>Compute f[mask] = sum_{sub⊆mask} a[sub] for n=4.</li>
<li>Use SOS DP to find how many subsets of bits have even sum.</li>
<li>Modify Digit DP to handle leading zeros explicitly.</li>
</ol>
<p>Master these, and you can handle structured exponential problems with elegance and speed.</p>
</section>
</section>
<section id="dp-optimizations-divide-conquer-convex-hull-trick-knuth" class="level3">
<h3 class="anchored" data-anchor-id="dp-optimizations-divide-conquer-convex-hull-trick-knuth">47. DP Optimizations (Divide &amp; Conquer, Convex Hull Trick, Knuth)</h3>
<p>Dynamic Programming often starts with a simple recurrence, but naïve implementations can be too slow (e.g., ( O<span class="math inline">\(n^2\)</span> ) or worse). When the recurrence has special structure , such as monotonicity or convexity , we can exploit it to reduce time complexity drastically.</p>
<p>This chapter introduces three powerful optimization families:</p>
<ol type="1">
<li>Divide and Conquer DP</li>
<li>Convex Hull Trick (CHT)</li>
<li>Knuth Optimization</li>
</ol>
<p>Each one is based on discovering order or geometry hidden inside transitions.</p>
<section id="divide-and-conquer-optimization" class="level4">
<h4 class="anchored" data-anchor-id="divide-and-conquer-optimization">1. Divide and Conquer Optimization</h4>
<p>If you have a recurrence like: <span class="math display">\[
dp[i] = \min_{k &lt; i} { dp[k] + C(k, i) }
\]</span></p>
<p>and the optimal k for dp[i] ≤ optimal k for dp[i+1], you can use divide &amp; conquer to compute dp in ( O<span class="math inline">\(n \log n\)</span> ) or ( O<span class="math inline">\(n \log^2 n\)</span> ).</p>
<p>This property is called monotonicity of argmin.</p>
</section>
<section id="a.-conditions" class="level4">
<h4 class="anchored" data-anchor-id="a.-conditions">A. Conditions</h4>
<p>Let ( C(k, i) ) be the cost to transition from ( k ) to ( i ). Divide and conquer optimization applies if:</p>
<p><span class="math display">\[
opt(i) \le opt(i+1)
\]</span></p>
<p>and ( C ) satisfies quadrangle inequality (or similar convex structure).</p>
</section>
<section id="b.-template" class="level4">
<h4 class="anchored" data-anchor-id="b.-template">B. Template</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb227"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> compute<span class="op">(</span><span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> optL<span class="op">,</span> <span class="dt">int</span> optR<span class="op">)</span> <span class="op">{</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>l <span class="op">&gt;</span> r<span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>    pair<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;</span> best <span class="op">=</span> <span class="op">{</span>INF<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">};</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> optL<span class="op">;</span> k <span class="op">&lt;=</span> min<span class="op">(</span>mid<span class="op">,</span> optR<span class="op">);</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> val <span class="op">=</span> dp_prev<span class="op">[</span>k<span class="op">]</span> <span class="op">+</span> cost<span class="op">(</span>k<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>val <span class="op">&lt;</span> best<span class="op">.</span>first<span class="op">)</span> best <span class="op">=</span> <span class="op">{</span>val<span class="op">,</span> k<span class="op">};</span></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>mid<span class="op">]</span> <span class="op">=</span> best<span class="op">.</span>first<span class="op">;</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> opt <span class="op">=</span> best<span class="op">.</span>second<span class="op">;</span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>    compute<span class="op">(</span>l<span class="op">,</span> mid<span class="op">-</span><span class="dv">1</span><span class="op">,</span> optL<span class="op">,</span> opt<span class="op">);</span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>    compute<span class="op">(</span>mid<span class="op">+</span><span class="dv">1</span><span class="op">,</span> r<span class="op">,</span> opt<span class="op">,</span> optR<span class="op">);</span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>You call it as:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb228"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>compute<span class="op">(</span><span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-example-divide-array-into-k-segments" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-divide-array-into-k-segments">C. Example: Divide Array into K Segments</h4>
<p>Given array <code>a[1..n]</code>, divide into <code>k</code> parts to minimize <span class="math display">\[
dp[i][k] = \min_{j &lt; i} dp[j][k-1] + cost(j+1, i)
\]</span> If cost satisfies quadrangle inequality, you can optimize each layer in ( O<span class="math inline">\(n \log n\)</span> ).</p>
</section>
<section id="d.-complexity-1" class="level4">
<h4 class="anchored" data-anchor-id="d.-complexity-1">D. Complexity</h4>
<p>Naive: ( O<span class="math inline">\(n^2\)</span> ) → Optimized: ( O<span class="math inline">\(n \log n\)</span> )</p>
</section>
<section id="convex-hull-trick-cht" class="level4">
<h4 class="anchored" data-anchor-id="convex-hull-trick-cht">2. Convex Hull Trick (CHT)</h4>
<p>Applies when DP recurrence is linear in i and k: <span class="math display">\[
dp[i] = \min_{k &lt; i} (m_k \cdot x_i + b_k)
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(m_k\)</span> is slope (depends on k)- ( b_k = dp[k] + c(k) )- <span class="math inline">\(x_i\)</span> is known (monotonic) You can maintain lines <span class="math inline">\(y = m_k x + b_k\)</span> in a convex hull, and query min efficiently.</li>
</ul>
</section>
<section id="a.-conditions-1" class="level4">
<h4 class="anchored" data-anchor-id="a.-conditions-1">A. Conditions</h4>
<ul>
<li>Slopes <span class="math inline">\(m_k\)</span> are monotonic (either increasing or decreasing)- Query points <span class="math inline">\(x_i\)</span> are sorted If both monotonic, we can use pointer walk in O(1) amortized per query. Otherwise, use Li Chao Tree (O(log n)).</li>
</ul>
</section>
<section id="b.-implementation-monotonic-slopes" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-monotonic-slopes">B. Implementation (Monotonic Slopes)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb229"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Line <span class="op">{</span> <span class="dt">long</span> <span class="dt">long</span> m<span class="op">,</span> b<span class="op">;</span> <span class="op">};</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>deque<span class="op">&lt;</span>Line<span class="op">&gt;</span> hull<span class="op">;</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> bad<span class="op">(</span>Line l1<span class="op">,</span> Line l2<span class="op">,</span> Line l3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>l3<span class="op">.</span>b <span class="op">-</span> l1<span class="op">.</span>b<span class="op">)*(</span>l1<span class="op">.</span>m <span class="op">-</span> l2<span class="op">.</span>m<span class="op">)</span> <span class="op">&lt;=</span> <span class="op">(</span>l2<span class="op">.</span>b <span class="op">-</span> l1<span class="op">.</span>b<span class="op">)*(</span>l1<span class="op">.</span>m <span class="op">-</span> l3<span class="op">.</span>m<span class="op">);</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> add<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> m<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>    Line l <span class="op">=</span> <span class="op">{</span>m<span class="op">,</span> b<span class="op">};</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>hull<span class="op">.</span>size<span class="op">()</span> <span class="op">&gt;=</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span> bad<span class="op">(</span>hull<span class="op">[</span>hull<span class="op">.</span>size<span class="op">()-</span><span class="dv">2</span><span class="op">],</span> hull<span class="op">.</span>back<span class="op">(),</span> l<span class="op">))</span></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>        hull<span class="op">.</span>pop_back<span class="op">();</span></span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>    hull<span class="op">.</span>push_back<span class="op">(</span>l<span class="op">);</span></span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> query<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>hull<span class="op">.</span>size<span class="op">()</span> <span class="op">&gt;=</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span> </span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>          hull<span class="op">[</span><span class="dv">0</span><span class="op">].</span>m<span class="op">*</span>x <span class="op">+</span> hull<span class="op">[</span><span class="dv">0</span><span class="op">].</span>b <span class="op">&gt;=</span> hull<span class="op">[</span><span class="dv">1</span><span class="op">].</span>m<span class="op">*</span>x <span class="op">+</span> hull<span class="op">[</span><span class="dv">1</span><span class="op">].</span>b<span class="op">)</span></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a>        hull<span class="op">.</span>pop_front<span class="op">();</span></span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hull<span class="op">.</span>front<span class="op">().</span>m<span class="op">*</span>x <span class="op">+</span> hull<span class="op">.</span>front<span class="op">().</span>b<span class="op">;</span></span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-example-dp-for-line-based-recurrence" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-dp-for-line-based-recurrence">C. Example: DP for Line-Based Recurrence</h4>
<p><span class="math display">\[
dp[i] = a_i^2 + \min_{j &lt; i} (dp[j] + b_j \cdot a_i)
\]</span> Here <span class="math inline">\(m_j = b_j\)</span>, <span class="math inline">\(x_i = a_i\)</span>, <span class="math inline">\(b_j = dp[j]\)</span></p>
</section>
<section id="d.-complexity-2" class="level4">
<h4 class="anchored" data-anchor-id="d.-complexity-2">D. Complexity</h4>
<ul>
<li>Naive: ( O<span class="math inline">\(n^2\)</span> )- CHT: ( O(n) ) or ( O<span class="math inline">\(n \log n\)</span> )</li>
</ul>
</section>
<section id="knuth-optimization" class="level4">
<h4 class="anchored" data-anchor-id="knuth-optimization">3. Knuth Optimization</h4>
<p>Used in interval DP problems (like Matrix Chain, Merging Stones).</p>
<p>If:</p>
<ol type="1">
<li><span class="math inline">\(dp[i][j] = \min_{k=i}^{j-1} (dp[i][k] + dp[k+1][j] + w(i,j))\)</span></li>
<li>The cost <span class="math inline">\(w(i,j)\)</span> satisfies the quadrangle inequality: <span class="math display">\[
w(a,c) + w(b,d) \le w(a,d) + w(b,c)
\]</span></li>
<li>And the monotonicity condition: <span class="math display">\[
opt[i][j-1] \le opt[i][j] \le opt[i+1][j]
\]</span></li>
</ol>
<p>Then you can reduce the search space from ( O(n) ) to ( O(1) ) per cell, making total complexity ( O<span class="math inline">\(n^2\)</span> ) instead of ( O<span class="math inline">\(n^3\)</span> ).</p>
</section>
<section id="a.-implementation-1" class="level4">
<h4 class="anchored" data-anchor-id="a.-implementation-1">A. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb230"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;=</span> n<span class="op">;</span> len<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> opt<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">];</span> k <span class="op">&lt;=</span> opt<span class="op">[</span>i<span class="op">+</span><span class="dv">1</span><span class="op">][</span>j<span class="op">];</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">long</span> <span class="dt">long</span> val <span class="op">=</span> dp<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>k<span class="op">+</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> cost<span class="op">(</span>i<span class="op">,</span>j<span class="op">);</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>val <span class="op">&lt;</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">])</span> <span class="op">{</span></span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> val<span class="op">;</span></span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>                opt<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> k<span class="op">;</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-example-4" class="level4">
<h4 class="anchored" data-anchor-id="b.-example-4">B. Example</h4>
<p>Optimal Binary Search Tree or Merging Stones (with additive cost). Typical improvement: ( O<span class="math inline">\(n^3\)</span> O<span class="math inline">\(n^2\)</span> )</p>
</section>
<section id="summary-7" class="level4">
<h4 class="anchored" data-anchor-id="summary-7">4. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 22%">
<col style="width: 31%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>Technique</th>
<th>Applies To</th>
<th>Key Property</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Divide &amp; Conquer DP</td>
<td>1D transitions</td>
<td>Monotonic argmin</td>
<td>O(n log n)</td>
</tr>
<tr class="even">
<td>Convex Hull Trick</td>
<td>Linear transitions</td>
<td>Monotonic slopes</td>
<td>O(n) / O(n log n)</td>
</tr>
<tr class="odd">
<td>Knuth Optimization</td>
<td>Interval DP</td>
<td>Quadrangle + Monotonicity</td>
<td>O(n²)</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-46" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-46">Tiny Code</h4>
<p>Divide &amp; Conquer Template</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb231"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> compute<span class="op">(</span><span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> optL<span class="op">,</span> <span class="dt">int</span> optR<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>CHT Query</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb232"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>size<span class="op">&gt;=</span><span class="dv">2</span> <span class="op">&amp;&amp;</span> f<span class="op">[</span><span class="dv">1</span><span class="op">](</span>x<span class="op">)</span> <span class="op">&lt;</span> f<span class="op">[</span><span class="dv">0</span><span class="op">](</span>x<span class="op">))</span> pop_front<span class="op">();</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-46" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-46">Why It Matters</h4>
<p>These optimizations show that DP isn’t just brute force with memory , it’s mathematical reasoning on structure.</p>
<p>Once you spot monotonicity or linearity, you can shrink a quadratic solution into near-linear time.</p>
<blockquote class="blockquote">
<p>“Optimization is the art of seeing simplicity hiding in structure.”</p>
</blockquote>
</section>
<section id="try-it-yourself-46" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-46">Try It Yourself</h4>
<ol type="1">
<li>Optimize Matrix Chain DP using Knuth.</li>
<li>Apply Divide &amp; Conquer on <code>dp[i] = min_{k&lt;i}(dp[k]+(i-k)^2)</code>.</li>
<li>Solve Slope DP with CHT for convex cost functions.</li>
<li>Compare runtime vs naive DP on random data.</li>
<li>Derive conditions for opt monotonicity in your custom recurrence.</li>
</ol>
<p>Master these techniques, and you’ll turn your DPs from slow prototypes into lightning-fast solutions.</p>
</section>
</section>
<section id="tree-dp-and-rerooting" class="level3">
<h3 class="anchored" data-anchor-id="tree-dp-and-rerooting">48. Tree DP and Rerooting</h3>
<p>Dynamic Programming on trees is one of the most elegant and powerful patterns in algorithm design. Unlike linear arrays or grids, trees form hierarchical structures, where each node depends on its children or parent. Tree DP teaches you how to aggregate results up and down the tree, handling problems where subtrees interact.</p>
<p>In this section, we’ll cover:</p>
<ol type="1">
<li>Basic Tree DP (rooted trees)</li>
<li>DP over children (bottom-up aggregation)</li>
<li>Rerooting technique (top-down propagation)</li>
<li>Common applications and examples</li>
</ol>
<section id="basic-tree-dp-the-idea" class="level4">
<h4 class="anchored" data-anchor-id="basic-tree-dp-the-idea">1. Basic Tree DP: The Idea</h4>
<p>We define <code>dp[u]</code> to represent some property of the subtree rooted at <code>u</code>. Then we combine children’s results to compute <code>dp[u]</code>.</p>
<p>This bottom-up approach is like postorder traversal.</p>
<p>Example structure:</p>
<pre><code>function dfs(u, parent):
    dp[u] = base_value
    for v in adj[u]:
        if v == parent: continue
        dfs(v, u)
        dp[u] = combine(dp[u], dp[v])</code></pre>
</section>
<section id="example-1-size-of-subtree" class="level4">
<h4 class="anchored" data-anchor-id="example-1-size-of-subtree">Example 1: Size of Subtree</h4>
<p>Let <code>dp[u] = number of nodes in subtree rooted at u</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb234"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> p<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>u<span class="op">]</span> <span class="op">+=</span> dp<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Key idea: Combine children’s sizes to get parent size. Complexity: ( O(n) )</p>
</section>
<section id="example-2-height-of-tree" class="level4">
<h4 class="anchored" data-anchor-id="example-2-height-of-tree">Example 2: Height of Tree</h4>
<p>Let <code>dp[u] = height of subtree rooted at u</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb235"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> p<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>u<span class="op">],</span> <span class="dv">1</span> <span class="op">+</span> dp<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This gives you the height when rooted at any node.</p>
</section>
<section id="dp-over-children-bottom-up-aggregation" class="level4">
<h4 class="anchored" data-anchor-id="dp-over-children-bottom-up-aggregation">2. DP Over Children (Bottom-Up Aggregation)</h4>
<p>Tree DP is all about merging children.</p>
<p>For example, if you want the number of ways to color or number of independent sets, you compute children’s dp and merge results at parent.</p>
</section>
<section id="example-3-counting-independent-sets" class="level4">
<h4 class="anchored" data-anchor-id="example-3-counting-independent-sets">Example 3: Counting Independent Sets</h4>
<p>In a tree, an independent set is a set of nodes with no two adjacent.</p>
<p>State:</p>
<ul>
<li><code>dp[u][0]</code> = ways if <code>u</code> is not selected- <code>dp[u][1]</code> = ways if <code>u</code> is selected Recurrence: <span class="math display">\[
dp[u][0] = \prod_{v \in children(u)} (dp[v][0] + dp[v][1])
\]</span></li>
</ul>
<p><span class="math display">\[
dp[u][1] = \prod_{v \in children(u)} dp[v][0]
\]</span></p>
<p>Implementation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb236"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> p<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">*=</span> <span class="op">(</span>dp<span class="op">[</span>v<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>v<span class="op">][</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">*=</span> dp<span class="op">[</span>v<span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Final answer = <code>dp[root][0] + dp[root][1]</code></p>
</section>
<section id="example-4-maximum-path-sum-in-tree" class="level4">
<h4 class="anchored" data-anchor-id="example-4-maximum-path-sum-in-tree">Example 4: Maximum Path Sum in Tree</h4>
<p>Let <code>dp[u]</code> = max path sum starting at <code>u</code> and going down To find best path anywhere, store a global max over child pairs.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb237"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> best1 <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> best2 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> p<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> val <span class="op">=</span> dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">)</span> <span class="op">+</span> weight<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>val <span class="op">&gt;</span> best1<span class="op">)</span> swap<span class="op">(</span>best1<span class="op">,</span> val<span class="op">);</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>val <span class="op">&gt;</span> best2<span class="op">)</span> best2 <span class="op">=</span> val<span class="op">;</span></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> best1 <span class="op">+</span> best2<span class="op">);</span></span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best1<span class="op">;</span></span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This gives tree diameter or max path sum.</p>
</section>
<section id="rerooting-technique" class="level4">
<h4 class="anchored" data-anchor-id="rerooting-technique">3. Rerooting Technique</h4>
<p>Rerooting DP allows you to compute answers for every node as root, without recomputing from scratch ( O<span class="math inline">\(n^2\)</span> ). It’s also known as DP on trees with re-rooting.</p>
</section>
<section id="idea" class="level4">
<h4 class="anchored" data-anchor-id="idea">Idea</h4>
<ol type="1">
<li>First, compute <code>dp_down[u]</code> = answer for subtree when rooted at <code>u</code>.</li>
<li>Then, propagate info from parent to child (<code>dp_up[u]</code>), so each node gets info from outside its subtree.</li>
<li>Combine <code>dp_down</code> and <code>dp_up</code> to get <code>dp_all[u]</code>.</li>
</ol>
</section>
<section id="example-5-sum-of-distances-from-each-node" class="level4">
<h4 class="anchored" data-anchor-id="example-5-sum-of-distances-from-each-node">Example 5: Sum of Distances from Each Node</h4>
<p>Let’s find <code>ans[u]</code> = sum of distances from <code>u</code> to all nodes.</p>
<ol type="1">
<li>Root the tree at 0.</li>
<li>Compute subtree sizes and total distance from root.</li>
<li>Reroot to adjust distances using parent’s info.</li>
</ol>
<p>Step 1: Bottom-up:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb238"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs1<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>    sz<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> p<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>        dfs1<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>        sz<span class="op">[</span>u<span class="op">]</span> <span class="op">+=</span> sz<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>u<span class="op">]</span> <span class="op">+=</span> dp<span class="op">[</span>v<span class="op">]</span> <span class="op">+</span> sz<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Step 2: Top-down:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb239"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs2<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> p<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>u<span class="op">]</span> <span class="op">-</span> sz<span class="op">[</span>v<span class="op">]</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">-</span> sz<span class="op">[</span>v<span class="op">]);</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>        dfs2<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>After <code>dfs2</code>, <code>dp[u]</code> = sum of distances from node <code>u</code>.</p>
<p>Complexity: ( O(n) )</p>
</section>
<section id="general-rerooting-template" class="level4">
<h4 class="anchored" data-anchor-id="general-rerooting-template">4. General Rerooting Template</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb240"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 1. Postorder: compute dp_down[u] from children</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs_down<span class="op">(</span>u<span class="op">,</span> p<span class="op">):</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>    dp_down<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> base</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> v in adj<span class="op">[</span>u<span class="op">]:</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> v <span class="op">!=</span> p<span class="op">:</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>            dfs_down<span class="op">(</span>v<span class="op">,</span> u<span class="op">)</span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>            dp_down<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> merge<span class="op">(</span>dp_down<span class="op">[</span>u<span class="op">],</span> dp_down<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="co">// 2. Preorder: use parent's dp_up to compute dp_all[u]</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs_up<span class="op">(</span>u<span class="op">,</span> p<span class="op">,</span> dp_up_parent<span class="op">):</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> merge<span class="op">(</span>dp_down<span class="op">[</span>u<span class="op">],</span> dp_up_parent<span class="op">)</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>    prefix<span class="op">,</span> suffix <span class="op">=</span> prefix products of children</span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> each child v<span class="op">:</span></span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>        dp_up_v <span class="op">=</span> merge<span class="op">(</span>prefix<span class="op">[</span>v<span class="op">-</span><span class="dv">1</span><span class="op">],</span> suffix<span class="op">[</span>v<span class="op">+</span><span class="dv">1</span><span class="op">],</span> dp_up_parent<span class="op">)</span></span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>        dfs_up<span class="op">(</span>v<span class="op">,</span> u<span class="op">,</span> dp_up_v<span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This template generalizes rerooting to many problems:</p>
<ul>
<li>Maximum distance from each node- Number of ways to select subtrees- Sum of subtree sizes seen from each root</li>
</ul>
</section>
<section id="summary-8" class="level4">
<h4 class="anchored" data-anchor-id="summary-8">5. Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pattern</th>
<th>Description</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Basic Tree DP</td>
<td>Combine child subresults</td>
<td>O(n)</td>
</tr>
<tr class="even">
<td>DP Over Children</td>
<td>Each node depends on children</td>
<td>O(n)</td>
</tr>
<tr class="odd">
<td>Rerooting DP</td>
<td>Compute result for every root</td>
<td>O(n)</td>
</tr>
<tr class="even">
<td>Multiple States</td>
<td>Track choices (e.g.&nbsp;include/exclude)</td>
<td>O(n·state)</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-47" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-47">Tiny Code</h4>
<p>Subtree Size</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb241"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v<span class="op">:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">,</span>u<span class="op">);</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>u<span class="op">]</span> <span class="op">+=</span> dp<span class="op">[</span>v<span class="op">];</span></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Reroot Sum Distances</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb242"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>u<span class="op">]</span> <span class="op">-</span> sz<span class="op">[</span>v<span class="op">]</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">-</span> sz<span class="op">[</span>v<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-47" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-47">Why It Matters</h4>
<p>Tree DP is how we think recursively over structure , each node’s truth emerges from its children. Rerooting expands this idea globally, giving every node its own perspective.</p>
<blockquote class="blockquote">
<p>“In the forest of states, each root sees a different world , yet all follow the same law.”</p>
</blockquote>
</section>
<section id="try-it-yourself-47" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-47">Try It Yourself</h4>
<ol type="1">
<li>Count number of nodes in each subtree.</li>
<li>Compute sum of depths from each node.</li>
<li>Find tree diameter using DP.</li>
<li>Count number of independent sets modulo 1e9+7.</li>
<li>Implement rerooting to find max distance from each node.</li>
</ol>
<p>Tree DP turns recursive patterns into universal strategies for hierarchical data.</p>
</section>
</section>
<section id="dp-reconstruction-and-traceback" class="level3">
<h3 class="anchored" data-anchor-id="dp-reconstruction-and-traceback">49. DP Reconstruction and Traceback</h3>
<p>So far, we’ve focused on computing optimal values (min cost, max score, count of ways). But in most real problems, we don’t just want the number , we want to know how we got it.</p>
<p>That’s where reconstruction comes in: once you’ve filled your DP table, you can trace back the decisions that led to the optimal answer.</p>
<p>This chapter shows you how to:</p>
<ol type="1">
<li>Record transitions during DP computation</li>
<li>Reconstruct paths, subsets, or sequences</li>
<li>Handle multiple reconstructions (paths, sets, parent links)</li>
<li>Understand traceback in 1D, 2D, and graph-based DPs</li>
</ol>
<section id="the-core-idea-2" class="level4">
<h4 class="anchored" data-anchor-id="the-core-idea-2">1. The Core Idea</h4>
<p>Each DP state comes from a choice. If you store <em>which choice was best</em>, you can walk backward from the final state to rebuild the solution.</p>
<p>Think of it as:</p>
<pre><code>dp[i] = best over options
choice[i] = argmin or argmax option</code></pre>
<p>Then:</p>
<pre><code>reconstruction_path = []
i = n
while i &gt; 0:
    reconstruction_path.push(choice[i])
    i = choice[i].prev</code></pre>
<p>You’re not just solving , you’re remembering the path.</p>
</section>
<section id="reconstruction-in-1d-dp" class="level4">
<h4 class="anchored" data-anchor-id="reconstruction-in-1d-dp">2. Reconstruction in 1D DP</h4>
</section>
<section id="example-coin-change-minimum-coins" class="level4">
<h4 class="anchored" data-anchor-id="example-coin-change-minimum-coins">Example: Coin Change (Minimum Coins)</h4>
<p>Problem: Find minimum number of coins to make value <code>n</code>.</p>
<p>Recurrence: <span class="math display">\[
dp[x] = 1 + \min_{c \in coins, c \le x} dp[x-c]
\]</span></p>
<p>To reconstruct which coins were used:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb245"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>MAXN<span class="op">],</span> prev_coin<span class="op">[</span>MAXN<span class="op">];</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> x <span class="op">&lt;=</span> n<span class="op">;</span> x<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c <span class="op">:</span> coins<span class="op">)</span> <span class="op">{</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>x <span class="op">&gt;=</span> c <span class="op">&amp;&amp;</span> dp<span class="op">[</span>x<span class="op">-</span>c<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">&lt;</span> dp<span class="op">[</span>x<span class="op">])</span> <span class="op">{</span></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>x<span class="op">-</span>c<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>            prev_coin<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> c<span class="op">;</span></span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Reconstruction:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb246"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> used<span class="op">;</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cur <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>cur <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>    used<span class="op">.</span>push_back<span class="op">(</span>prev_coin<span class="op">[</span>cur<span class="op">]);</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>    cur <span class="op">-=</span> prev_coin<span class="op">[</span>cur<span class="op">];</span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Output: coins used in one optimal solution.</p>
</section>
<section id="example-lis-reconstruction" class="level4">
<h4 class="anchored" data-anchor-id="example-lis-reconstruction">Example: LIS Reconstruction</h4>
<p>You know how to find LIS length. Now reconstruct the sequence.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb247"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dp<span class="op">[</span>n<span class="op">],</span> prev<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> best_end <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> prev<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;&amp;</span> dp<span class="op">[</span>j<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">&gt;</span> dp<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>j<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a>            prev<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb247-10"><a href="#cb247-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> dp<span class="op">[</span>best_end<span class="op">])</span> best_end <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb247-11"><a href="#cb247-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Rebuild LIS:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb248"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> lis<span class="op">;</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> best_end<span class="op">;</span> i <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span> i <span class="op">=</span> prev<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>    lis<span class="op">.</span>push_back<span class="op">(</span>a<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>reverse<span class="op">(</span>lis<span class="op">.</span>begin<span class="op">(),</span> lis<span class="op">.</span>end<span class="op">());</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="reconstruction-in-2d-dp" class="level4">
<h4 class="anchored" data-anchor-id="reconstruction-in-2d-dp">3. Reconstruction in 2D DP</h4>
</section>
<section id="example-lcs-longest-common-subsequence" class="level4">
<h4 class="anchored" data-anchor-id="example-lcs-longest-common-subsequence">Example: LCS (Longest Common Subsequence)</h4>
<p>We have <code>dp[i][j]</code> filled using:</p>
<p><span class="math display">\[
dp[i][j] =
\begin{cases}
dp[i-1][j-1] + 1, &amp; \text{if } a[i-1] = b[j-1], \\
\max(dp[i-1][j], dp[i][j-1]), &amp; \text{otherwise.}
\end{cases}
\]</span></p>
<p>To reconstruct LCS:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb249"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> i <span class="op">=</span> n<span class="op">,</span> j <span class="op">=</span> m<span class="op">;</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>string lcs <span class="op">=</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>i <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> j <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>        lcs<span class="op">.</span>push_back<span class="op">(</span>a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a>        i<span class="op">--;</span> j<span class="op">--;</span></span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">&gt;</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span> i<span class="op">--;</span></span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> j<span class="op">--;</span></span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a>reverse<span class="op">(</span>lcs<span class="op">.</span>begin<span class="op">(),</span> lcs<span class="op">.</span>end<span class="op">());</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Output: one valid LCS string.</p>
</section>
<section id="example-edit-distance" class="level4">
<h4 class="anchored" data-anchor-id="example-edit-distance">Example: Edit Distance</h4>
<p>Operations: insert, delete, replace.</p>
<p>You can store the operation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb250"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span> op<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="st">"match"</span><span class="op">;</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">==</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> op<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="st">"replace"</span><span class="op">;</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">==</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> op<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="st">"delete"</span><span class="op">;</span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> op<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="st">"insert"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then backtrack to list operations:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb251"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>i <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">||</span> j <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">==</span> <span class="st">"match"</span><span class="op">)</span> i<span class="op">--,</span> j<span class="op">--;</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">==</span> <span class="st">"replace"</span><span class="op">)</span> <span class="op">{</span> print<span class="op">(</span><span class="st">"Replace"</span><span class="op">);</span> i<span class="op">--;</span> j<span class="op">--;</span> <span class="op">}</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">==</span> <span class="st">"delete"</span><span class="op">)</span> <span class="op">{</span> print<span class="op">(</span><span class="st">"Delete"</span><span class="op">);</span> i<span class="op">--;</span> <span class="op">}</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span> print<span class="op">(</span><span class="st">"Insert"</span><span class="op">);</span> j<span class="op">--;</span> <span class="op">}</span></span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="reconstruction-in-path-problems" class="level4">
<h4 class="anchored" data-anchor-id="reconstruction-in-path-problems">4. Reconstruction in Path Problems</h4>
<p>When DP tracks shortest paths, you can keep parent pointers.</p>
</section>
<section id="example-bellman-ford-path-reconstruction" class="level4">
<h4 class="anchored" data-anchor-id="example-bellman-ford-path-reconstruction">Example: Bellman-Ford Path Reconstruction</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb252"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dist<span class="op">[</span>n<span class="op">],</span> parent<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>dist<span class="op">[</span>src<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">-</span><span class="dv">1</span><span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>u<span class="op">,</span>v<span class="op">,</span>w<span class="op">]</span> <span class="op">:</span> edges<span class="op">)</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w <span class="op">&lt;</span> dist<span class="op">[</span>v<span class="op">])</span> <span class="op">{</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>        dist<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">;</span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> u<span class="op">;</span></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> path<span class="op">;</span></span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> v <span class="op">=</span> dest<span class="op">;</span> v <span class="op">!=</span> src<span class="op">;</span> v <span class="op">=</span> parent<span class="op">[</span>v<span class="op">])</span></span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a>    path<span class="op">.</span>push_back<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>path<span class="op">.</span>push_back<span class="op">(</span>src<span class="op">);</span></span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a>reverse<span class="op">(</span>path<span class="op">.</span>begin<span class="op">(),</span> path<span class="op">.</span>end<span class="op">());</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>You now have the actual shortest path.</p>
</section>
<section id="handling-multiple-solutions" class="level4">
<h4 class="anchored" data-anchor-id="handling-multiple-solutions">5. Handling Multiple Solutions</h4>
<p>Sometimes multiple optimal paths exist. You can:</p>
<ul>
<li>Store all predecessors instead of one- Backtrack recursively to enumerate all solutions- Tie-break deterministically (e.g., lexicographically smallest) Example:</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb253"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>new_val <span class="op">==</span> dp<span class="op">[</span>i<span class="op">])</span> parents<span class="op">[</span>i<span class="op">].</span>push_back<span class="op">(</span>j<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then recursively generate all possible paths.</p>
</section>
<section id="visualization-1" class="level4">
<h4 class="anchored" data-anchor-id="visualization-1">6. Visualization</h4>
<p>DP reconstruction often looks like following arrows in a grid or graph:</p>
<ul>
<li>LCS: diagonal (↖), up (↑), left (←)- Shortest path: parent edges- LIS: predecessor chain You’re walking through decisions, not just numbers.</li>
</ul>
</section>
<section id="summary-9" class="level4">
<h4 class="anchored" data-anchor-id="summary-9">7. Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>State</th>
<th>Reconstruction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1D DP</td>
<td><code>prev[i]</code></td>
<td>Trace chain</td>
</tr>
<tr class="even">
<td>2D DP</td>
<td><code>op[i][j]</code></td>
<td>Follow choices</td>
</tr>
<tr class="odd">
<td>Graph DP</td>
<td><code>parent[v]</code></td>
<td>Follow edges</td>
</tr>
<tr class="even">
<td>Counting DP</td>
<td>optional</td>
<td>Recover counts / paths</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-48" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-48">Tiny Code</h4>
<p>General pattern:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb254"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>state<span class="op">)</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>choice<span class="op">)</span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>better<span class="op">)</span> <span class="op">{</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>state<span class="op">]</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>        parent<span class="op">[</span>state<span class="op">]</span> <span class="op">=</span> choice<span class="op">;</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb255"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>state <span class="op">!=</span> base<span class="op">)</span> <span class="op">{</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>    path<span class="op">.</span>push_back<span class="op">(</span>parent<span class="op">[</span>state<span class="op">]);</span></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> parent<span class="op">[</span>state<span class="op">];</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-48" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-48">Why It Matters</h4>
<p>Solving DP gets you the score , reconstructing shows you the story. It’s the difference between knowing the answer and understanding the reasoning.</p>
<blockquote class="blockquote">
<p>“Numbers tell you the outcome; pointers tell you the path.”</p>
</blockquote>
</section>
<section id="try-it-yourself-48" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-48">Try It Yourself</h4>
<ol type="1">
<li>Reconstruct one LIS path.</li>
<li>Print all LCSs for small strings.</li>
<li>Show edit operations to transform “cat” → “cut”.</li>
<li>Track subset used in Knapsack to reach exact weight.</li>
<li>Recover optimal merge order in Matrix Chain DP.</li>
</ol>
<p>Reconstruction turns DP from a static table into a narrative of decisions , a map back through the maze of optimal choices.</p>
</section>
</section>
<section id="meta-dp-and-optimization-templates" class="level3">
<h3 class="anchored" data-anchor-id="meta-dp-and-optimization-templates">50. Meta-DP and Optimization Templates</h3>
<p>We’ve now explored many flavors of dynamic programming , on sequences, grids, trees, graphs, subsets, and digits. This final chapter in the DP arc zooms out to the <em>meta-level</em>: how to see DP patterns, generalize them, and turn them into reusable templates.</p>
<p>If classical DP is about solving one problem, meta-DP is about recognizing <em>families</em> of problems that share structure. You’ll learn how to build your own DP frameworks, use common templates, and reason from first principles.</p>
<section id="what-is-meta-dp" class="level4">
<h4 class="anchored" data-anchor-id="what-is-meta-dp">1. What Is Meta-DP?</h4>
<p>A <em>Meta-DP</em> is a high-level abstraction of a dynamic programming pattern. It encodes:</p>
<ul>
<li>State definition pattern- Transition pattern- Optimization structure- Dimensional dependencies By learning these patterns, you can design DPs faster, reuse logic across problems, and spot optimizations early.</li>
</ul>
<p>Think of Meta-DP as:</p>
<blockquote class="blockquote">
<p>“Instead of memorizing 100 DPs, master 10 DP blueprints.”</p>
</blockquote>
</section>
<section id="the-four-building-blocks" class="level4">
<h4 class="anchored" data-anchor-id="the-four-building-blocks">2. The Four Building Blocks</h4>
<p>Every DP has the same core ingredients:</p>
<ol type="1">
<li><p>State: what subproblem you’re solving</p>
<ul>
<li><p>Often <code>dp[i]</code>, <code>dp[i][j]</code>, or <code>dp[mask]</code> - Represents smallest unit of progress2. Transition: how to build larger subproblems from smaller ones</p></li>
<li><p>E.g. <code>dp[i] = min(dp[j] + cost(j, i))</code>3. Base Case: known trivial answers</p></li>
<li><p>E.g. <code>dp[0] = 0</code>4. Order: how to fill the states</p></li>
<li><p>E.g. increasing <code>i</code>, decreasing <code>i</code>, or topological order Once you can describe a problem in these four, it <em>is</em> a DP.</p></li>
</ul></li>
</ol>
</section>
<section id="meta-templates-for-common-structures" class="level4">
<h4 class="anchored" data-anchor-id="meta-templates-for-common-structures">3. Meta-Templates for Common Structures</h4>
<p>Below are generalized templates to use and adapt.</p>
</section>
<section id="a.-line-dp-1d-sequential" class="level4">
<h4 class="anchored" data-anchor-id="a.-line-dp-1d-sequential">A. Line DP (1D Sequential)</h4>
<p>Shape: linear progression Examples:</p>
<ul>
<li>Fibonacci- Knapsack (1D capacity)- LIS (sequential dependency)</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb256"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> base<span class="op">;</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">:</span> transitions<span class="op">(</span>i<span class="op">))</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>        dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">],</span> dp<span class="op">[</span>j<span class="op">]</span> <span class="op">+</span> cost<span class="op">(</span>j<span class="op">,</span> i<span class="op">));</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Visualization: → → → Each state depends on previous positions.</p>
</section>
<section id="b.-grid-dp-2d-spatial" class="level4">
<h4 class="anchored" data-anchor-id="b.-grid-dp-2d-spatial">B. Grid DP (2D Spatial)</h4>
<p>Shape: grid or matrix Examples:</p>
<ul>
<li>Paths in a grid- Edit Distance- Counting paths with obstacles</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb257"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> m<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> combine<span class="op">(</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Visualization: ⬇️ ⬇️ ➡️ Moves from top-left to bottom-right.</p>
</section>
<section id="c.-interval-dp" class="level4">
<h4 class="anchored" data-anchor-id="c.-interval-dp">C. Interval DP</h4>
<p>Shape: segments or subarrays Examples:</p>
<ul>
<li>Matrix Chain Multiplication- Optimal BST- Merging Stones</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb258"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;=</span> n<span class="op">;</span> len<span class="op">++)</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>      j <span class="op">=</span> i <span class="op">+</span> len <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>      dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span>k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> j<span class="op">;</span> k<span class="op">++)</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>          dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> dp<span class="op">[</span>k<span class="op">+</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> cost<span class="op">(</span>i<span class="op">,</span>j<span class="op">));</span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Key Insight: overlapping intervals, split points.</p>
</section>
<section id="d.-subset-dp" class="level4">
<h4 class="anchored" data-anchor-id="d.-subset-dp">D. Subset DP</h4>
<p>Shape: subsets of a set Examples:</p>
<ul>
<li>Traveling Salesman (TSP)- Assignment problem- SOS DP</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb259"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>mask <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> mask <span class="op">&lt;</span> <span class="op">(</span><span class="dv">1</span><span class="op">&lt;&lt;</span>n<span class="op">);</span> mask<span class="op">++)</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>sub <span class="op">=</span> mask<span class="op">;</span> sub<span class="op">;</span> sub <span class="op">=</span> <span class="op">(</span>sub<span class="op">-</span><span class="dv">1</span><span class="op">)&amp;</span>mask<span class="op">)</span></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>      dp<span class="op">[</span>mask<span class="op">]</span> <span class="op">=</span> combine<span class="op">(</span>dp<span class="op">[</span>mask<span class="op">],</span> dp<span class="op">[</span>sub<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Key Insight: use bitmasks to represent subsets.</p>
</section>
<section id="e.-tree-dp" class="level4">
<h4 class="anchored" data-anchor-id="e.-tree-dp">E. Tree DP</h4>
<p>Shape: hierarchical dependencies Examples:</p>
<ul>
<li>Subtree sizes- Independent sets- Rerooting</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb260"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span>u<span class="op">,</span> p<span class="op">):</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>  dp<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> base</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>v in children<span class="op">)</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>v <span class="op">!=</span> p<span class="op">)</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>      dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">)</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>      dp<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> merge<span class="op">(</span>dp<span class="op">[</span>u<span class="op">],</span> dp<span class="op">[</span>v<span class="op">])</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="f.-graph-dp-topological-order" class="level4">
<h4 class="anchored" data-anchor-id="f.-graph-dp-topological-order">F. Graph DP (Topological Order)</h4>
<p>Shape: DAG structure Examples:</p>
<ul>
<li>Longest path in DAG- Counting paths- DAG shortest path</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb261"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>u in topo_order<span class="op">)</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>v in adj<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>    dp<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> combine<span class="op">(</span>dp<span class="op">[</span>v<span class="op">],</span> dp<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> weight<span class="op">(</span>u<span class="op">,</span>v<span class="op">));</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Key: process nodes in topological order.</p>
</section>
<section id="g.-digit-dp" class="level4">
<h4 class="anchored" data-anchor-id="g.-digit-dp">G. Digit DP</h4>
<p>Shape: positional digits, constrained transitions Examples:</p>
<ul>
<li>Count numbers satisfying digit conditions- Divisibility / digit sum problems</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb262"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span>pos<span class="op">][</span>sum<span class="op">][</span>tight<span class="op">]</span> <span class="op">=</span> ∑ dp<span class="op">[</span>next_pos<span class="op">][</span>new_sum<span class="op">][</span>new_tight<span class="op">];</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="h.-knuth-divide-conquer-convex-hull-trick" class="level4">
<h4 class="anchored" data-anchor-id="h.-knuth-divide-conquer-convex-hull-trick">H. Knuth / Divide &amp; Conquer / Convex Hull Trick</h4>
<p>Shape: optimization over monotone or convex transitions Examples:</p>
<ul>
<li>Cost-based splits- Line-based transitions</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb263"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> min_k <span class="op">(</span>dp<span class="op">[</span>k<span class="op">]</span> <span class="op">+</span> cost<span class="op">(</span>k<span class="op">,</span> i<span class="op">))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Key: structure in <code>opt[i]</code> or <code>slope</code>.</p>
</section>
<section id="recognizing-dp-type" class="level4">
<h4 class="anchored" data-anchor-id="recognizing-dp-type">4. Recognizing DP Type</h4>
<p>Ask these diagnostic questions:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 71%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>Question</th>
<th>Clue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“Does each step depend on smaller subproblems?”</td>
<td>DP</td>
</tr>
<tr class="even">
<td>“Do I split a segment?”</td>
<td>Interval DP</td>
</tr>
<tr class="odd">
<td>“Do I choose subsets?”</td>
<td>Subset / Bitmask DP</td>
</tr>
<tr class="even">
<td>“Do I move along positions?”</td>
<td>Line DP</td>
</tr>
<tr class="odd">
<td>“Do I merge children?”</td>
<td>Tree DP</td>
</tr>
<tr class="even">
<td>“Do I process in a DAG?”</td>
<td>Graph DP</td>
</tr>
<tr class="odd">
<td>“Do I track digits or constraints?”</td>
<td>Digit DP</td>
</tr>
</tbody>
</table>
</section>
<section id="optimization-layer" class="level4">
<h4 class="anchored" data-anchor-id="optimization-layer">5. Optimization Layer</h4>
<p>Once you have a working DP, ask:</p>
<ul>
<li>Can transitions be reduced (monotonicity)?- Can overlapping cost be cached (prefix sums)?- Can dimensions be compressed (rolling arrays)?- Can you reuse solutions for each segment (Divide &amp; Conquer / Knuth)? This transforms your DP from conceptual to efficient.</li>
</ul>
</section>
<section id="meta-dp-transformations" class="level4">
<h4 class="anchored" data-anchor-id="meta-dp-transformations">6. Meta-DP: Transformations</h4>
<ul>
<li>Compress dimensions: if only <code>dp[i-1]</code> needed, use 1D array.- Invert loops: bottom-up ↔︎ top-down.- Change base: prefix-sums for range queries.- State lifting: add dimension for new property (like remainder, parity, bitmask). &gt; “When stuck, add a dimension. When slow, remove one.”</li>
</ul>
</section>
<section id="common-template-snippets" class="level4">
<h4 class="anchored" data-anchor-id="common-template-snippets">7. Common Template Snippets</h4>
<p>Rolling 1D Knapsack:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb264"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>c <span class="op">=</span> C<span class="op">;</span> c <span class="op">&gt;=</span> w<span class="op">[</span>i<span class="op">];</span> c<span class="op">--)</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  dp<span class="op">[</span>c<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>dp<span class="op">[</span>c<span class="op">],</span> dp<span class="op">[</span>c<span class="op">-</span>w<span class="op">[</span>i<span class="op">]]</span> <span class="op">+</span> val<span class="op">[</span>i<span class="op">]);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Top-Down Memoization:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb265"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> solve<span class="op">(</span>state<span class="op">):</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>visited<span class="op">[</span>state<span class="op">])</span> <span class="cf">return</span> dp<span class="op">[</span>state<span class="op">];</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  dp<span class="op">[</span>state<span class="op">]</span> <span class="op">=</span> combine<span class="op">(</span>solve<span class="op">(</span>next_states<span class="op">));</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Iterative DP:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb266"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>state in order<span class="op">)</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  dp<span class="op">[</span>state<span class="op">]</span> <span class="op">=</span> merge<span class="op">(</span>prev_states<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="building-your-own-dp-framework" class="level4">
<h4 class="anchored" data-anchor-id="building-your-own-dp-framework">8. Building Your Own DP Framework</h4>
<p>You can design a generic <code>DP(state, transition)</code> class:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb267"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> DP <span class="op">{</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;</span> dp<span class="op">;</span></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>    function<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">(</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">)&gt;</span> cost<span class="op">;</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>    DP<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="kw">auto</span> cost<span class="op">):</span> dp<span class="op">(</span>n<span class="op">,</span> INF<span class="op">),</span> cost<span class="op">(</span>cost<span class="op">)</span> <span class="op">{}</span></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> solve<span class="op">()</span> <span class="op">{</span> <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span> i<span class="op">&lt;</span>n<span class="op">;</span> i<span class="op">++)</span> <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span> j<span class="op">&lt;</span>i<span class="op">;</span> j<span class="op">++)</span> </span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>         dp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>dp<span class="op">[</span>i<span class="op">],</span> dp<span class="op">[</span>j<span class="op">]</span> <span class="op">+</span> cost<span class="op">(</span>j<span class="op">,</span> i<span class="op">));</span> <span class="op">}</span></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Reusable, readable, flexible.</p>
</section>
<section id="summary-10" class="level4">
<h4 class="anchored" data-anchor-id="summary-10">9. Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>DP Type</th>
<th>Core State</th>
<th>Shape</th>
<th>Typical Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Line DP</td>
<td>dp[i]</td>
<td>Linear</td>
<td>O(n²) → O(n)</td>
</tr>
<tr class="even">
<td>Grid DP</td>
<td>dp[i][j]</td>
<td>Matrix</td>
<td>O(n·m)</td>
</tr>
<tr class="odd">
<td>Interval DP</td>
<td>dp[i][j]</td>
<td>Triangular</td>
<td>O(n³)</td>
</tr>
<tr class="even">
<td>Subset DP</td>
<td>dp[mask]</td>
<td>Exponential</td>
<td>O(n·2ⁿ)</td>
</tr>
<tr class="odd">
<td>Tree DP</td>
<td>dp[u]</td>
<td>Tree</td>
<td>O(n)</td>
</tr>
<tr class="even">
<td>Digit DP</td>
<td>dp[pos][sum]</td>
<td>Recursive</td>
<td>O(len·sum)</td>
</tr>
<tr class="odd">
<td>Graph DP</td>
<td>dp[v]</td>
<td>DAG</td>
<td>O(V+E)</td>
</tr>
</tbody>
</table>
</section>
<section id="tiny-code-49" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-49">Tiny Code</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb268"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>state in order<span class="op">)</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>  dp<span class="op">[</span>state<span class="op">]</span> <span class="op">=</span> combine<span class="op">(</span>all_prev<span class="op">(</span>state<span class="op">));</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-it-matters-49" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-49">Why It Matters</h4>
<p>Meta-DP turns your thinking from case-by-case to pattern-by-pattern. You stop memorizing formulas and start <em>seeing shapes</em>: lines, grids, intervals, trees, masks.</p>
<p>Once you can name the shape, you can write the DP.</p>
<blockquote class="blockquote">
<p>“DP is not about filling tables. It’s about recognizing structure.”</p>
</blockquote>
</section>
<section id="try-it-yourself-49" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-49">Try It Yourself</h4>
<ol type="1">
<li>Classify each classic DP problem into a type.</li>
<li>Write one template per pattern (Line, Grid, Tree, etc.).</li>
<li>Create a <code>dp_solve(state, transitions)</code> function to generalize logic.</li>
<li>For each pattern, practice a small example.</li>
<li>Build your own “Little Book of DP Patterns” with code snippets.</li>
</ol>
<p>This is your bridge from concrete solutions to algorithmic fluency , the foundation for mastering the next 950 algorithms ahead.</p>
</section>
</section>
</section>
<section id="chapter-6.-strings-and-text-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="chapter-6.-strings-and-text-algorithms">Chapter 6. Strings and Text Algorithms</h2>
<section id="number-theory-gcd-modular-arithmetic-crt" class="level3">
<h3 class="anchored" data-anchor-id="number-theory-gcd-modular-arithmetic-crt">51. Number Theory (GCD, Modular Arithmetic, CRT)</h3>
<p>Number theory forms the mathematical backbone of many algorithms , from hashing and cryptography to modular combinatorics and primality testing. In algorithmic problem-solving, it’s all about working with integers, divisibility, and modular systems efficiently.</p>
<p>This section covers the essential toolkit:</p>
<ul>
<li>GCD and Extended Euclidean Algorithm- Modular Arithmetic (addition, subtraction, multiplication, inverse)- Modular Exponentiation- Chinese Remainder Theorem (CRT)</li>
</ul>
<section id="the-greatest-common-divisor-gcd" class="level4">
<h4 class="anchored" data-anchor-id="the-greatest-common-divisor-gcd">1. The Greatest Common Divisor (GCD)</h4>
<p>The GCD of two integers <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, denoted <span class="math inline">\(\gcd(a, b)\)</span>, is the largest integer that divides both. It’s the cornerstone for fraction simplification, Diophantine equations, and modular inverses.</p>
</section>
<section id="a.-euclidean-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="a.-euclidean-algorithm">A. Euclidean Algorithm</h4>
<p>Based on: <span class="math display">\[
\gcd(a, b) = \gcd(b, a \bmod b)
\]</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb269"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> gcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> b <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> a <span class="op">:</span> gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">);</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time complexity: <span class="math inline">\(O(\log \min(a,b))\)</span></p>
</section>
<section id="b.-extended-euclidean-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="b.-extended-euclidean-algorithm">B. Extended Euclidean Algorithm</h4>
<p>Finds integers ( x, y ) such that: <span class="math display">\[
ax + by = \gcd(a, b)
\]</span></p>
<p>This is critical for finding modular inverses.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb270"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ext_gcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="dt">int</span> <span class="op">&amp;</span>y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x1<span class="op">,</span> y1<span class="op">;</span></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> g <span class="op">=</span> ext_gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">,</span> x1<span class="op">,</span> y1<span class="op">);</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> y1<span class="op">;</span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> x1 <span class="op">-</span> <span class="op">(</span>a <span class="op">/</span> b<span class="op">)</span> <span class="op">*</span> y1<span class="op">;</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g<span class="op">;</span></span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-bezouts-identity" class="level4">
<h4 class="anchored" data-anchor-id="c.-bezouts-identity">C. Bezout’s Identity</h4>
<p>If <span class="math inline">\(g = \gcd(a,b)\)</span>, then <span class="math inline">\(ax + by = g\)</span> has integer solutions. If <span class="math inline">\(g = 1\)</span>, <span class="math inline">\(x\)</span> is the modular inverse of <span class="math inline">\(a modulo b\)</span>.</p>
</section>
<section id="modular-arithmetic" class="level4">
<h4 class="anchored" data-anchor-id="modular-arithmetic">2. Modular Arithmetic</h4>
<p>A modular system “wraps around” after a certain value ( m ).</p>
<p>We write: <span class="math display">\[
a \equiv b \pmod{m} \quad \text{if } m \mid (a - b)
\]</span></p>
<p>It behaves like ordinary arithmetic, with the rule:</p>
<ul>
<li><span class="math inline">\((a + b) \bmod m = ((a \bmod m) + (b \bmod m)) \bmod m\)</span></li>
<li><span class="math inline">\((a \cdot b) \bmod m = ((a \bmod m) \cdot (b \bmod m)) \bmod m\)</span></li>
<li><span class="math inline">\((a - b) \bmod m = ((a \bmod m) - (b \bmod m) + m) \bmod m\)</span></li>
</ul>
</section>
<section id="a.-modular-exponentiation" class="level4">
<h4 class="anchored" data-anchor-id="a.-modular-exponentiation">A. Modular Exponentiation</h4>
<p>Compute <span class="math inline">\(a^b \bmod m\)</span> efficiently using binary exponentiation.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb271"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> modpow<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">%=</span> m<span class="op">;</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> res <span class="op">=</span> <span class="op">(</span>res <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="op">(</span>a <span class="op">*</span> a<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>        b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: ( O<span class="math inline">\(\log b\)</span> )</p>
</section>
<section id="b.-modular-inverse" class="level4">
<h4 class="anchored" data-anchor-id="b.-modular-inverse">B. Modular Inverse</h4>
<p>Given ( a ), find <span class="math inline">\(a^{-1}\)</span> such that: <span class="math display">\[
a \cdot a^{-1} \equiv 1 \pmod{m}
\]</span></p>
<p>Case 1: If ( m ) is prime, use Fermat’s Little Theorem: <span class="math display">\[
a^{-1} \equiv a^{m-2} \pmod{m}
\]</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb272"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> modinv<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modpow<span class="op">(</span>a<span class="op">,</span> m<span class="op">-</span><span class="dv">2</span><span class="op">,</span> m<span class="op">);</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Case 2: If ( a ) and ( m ) are coprime, use Extended GCD:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb273"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> inv<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> g <span class="op">=</span> ext_gcd<span class="op">(</span>a<span class="op">,</span> m<span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>g <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span> <span class="co">// no inverse</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>x <span class="op">%</span> m <span class="op">+</span> m<span class="op">)</span> <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-modular-division" class="level4">
<h4 class="anchored" data-anchor-id="c.-modular-division">C. Modular Division</h4>
<p>To divide <span class="math inline">\(a / b \bmod m\)</span>: <span class="math display">\[
a / b \equiv a \cdot b^{-1} \pmod{m}
\]</span></p>
<p>So compute the inverse and multiply.</p>
</section>
<section id="chinese-remainder-theorem-crt" class="level4">
<h4 class="anchored" data-anchor-id="chinese-remainder-theorem-crt">3. Chinese Remainder Theorem (CRT)</h4>
<p>The CRT solves systems of congruences: <span class="math display">\[
x \equiv a_1 \pmod{m_1}
\]</span></p>
<p><span class="math display">\[
x \equiv a_2 \pmod{m_2}
\]</span> If moduli <span class="math inline">\(m_1, m_2, \dots, m_k\)</span> are pairwise coprime, there exists a unique solution modulo <span class="math inline">\(M = m_1 m_2 \dots m_k\)</span>.</p>
</section>
<section id="a.-2-equation-example" class="level4">
<h4 class="anchored" data-anchor-id="a.-2-equation-example">A. 2-Equation Example</h4>
<p>Solve: <span class="math display">\[
x \equiv a_1 \pmod{m_1}, \quad x \equiv a_2 \pmod{m_2}
\]</span></p>
<p>Let:</p>
<ul>
<li><span class="math inline">\(M = m_1 m_2\)</span>- <span class="math inline">\(M_1 = M / m_1\)</span>- <span class="math inline">\(M_2 = M / m_2\)</span> Find inverses <span class="math inline">\(inv_1 = M_1^{-1} \bmod m_1\)</span>, <span class="math inline">\(inv_2 = M_2^{-1} \bmod m_2\)</span></li>
</ul>
<p>Then: <span class="math display">\[
x = (a_1 \cdot M_1 \cdot inv_1 + a_2 \cdot M_2 \cdot inv_2) \bmod M
\]</span></p>
</section>
<section id="b.-implementation-7" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-7">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb274"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> crt<span class="op">(</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> a<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> M <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> mod <span class="op">:</span> m<span class="op">)</span> M <span class="op">*=</span> mod<span class="op">;</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> a<span class="op">.</span>size<span class="op">();</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> Mi <span class="op">=</span> M <span class="op">/</span> m<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> inv <span class="op">=</span> modinv<span class="op">(</span>Mi <span class="op">%</span> m<span class="op">[</span>i<span class="op">],</span> m<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> <span class="op">(</span>res <span class="op">+</span> <span class="dv">1</span><span class="bu">LL</span> <span class="op">*</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> Mi <span class="op">%</span> M <span class="op">*</span> inv <span class="op">%</span> M<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>res <span class="op">%</span> M <span class="op">+</span> M<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-example-6" class="level4">
<h4 class="anchored" data-anchor-id="c.-example-6">C. Example</h4>
<p>Solve:</p>
<pre><code>x ≡ 2 (mod 3)
x ≡ 3 (mod 5)
x ≡ 2 (mod 7)</code></pre>
<p>Solution: ( x = 23 ) (mod 105)</p>
<p>Check:</p>
<ul>
<li>( 23 % 3 = 2 )- ( 23 % 5 = 3 )- ( 23 % 7 = 2 )</li>
</ul>
</section>
<section id="tiny-code-50" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-50">4. Tiny Code</h4>
<p>GCD</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb276"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> gcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> b <span class="op">?</span> gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">)</span> <span class="op">:</span> a<span class="op">;</span> <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Modular Power</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb277"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>modpow<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> m<span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Modular Inverse</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb278"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>modinv<span class="op">(</span>a<span class="op">,</span> m<span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>CRT</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb279"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>crt<span class="op">(</span>a<span class="op">[],</span> m<span class="op">[])</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-11" class="level4">
<h4 class="anchored" data-anchor-id="summary-11">5. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 47%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Concept</th>
<th>Formula</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GCD</td>
<td><span class="math inline">\(\gcd(a,b) = \gcd(b, a \bmod b)\)</span></td>
<td>Simplify ratios</td>
</tr>
<tr class="even">
<td>Extended GCD</td>
<td><span class="math inline">\(ax + by = \gcd(a,b)\)</span></td>
<td>Find modular inverse</td>
</tr>
<tr class="odd">
<td>Modular Inverse</td>
<td><span class="math inline">\(a^{-1} \equiv a^{m-2} \pmod{m}\)</span></td>
<td>Solve modular equations</td>
</tr>
<tr class="even">
<td>Modular Exp</td>
<td><span class="math inline">\(a^b \bmod m\)</span></td>
<td>Fast exponentiation</td>
</tr>
<tr class="odd">
<td>CRT</td>
<td>Combine congruences</td>
<td>Multi-mod system</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-50" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-50">Why It Matters</h4>
<p>Number theory lets algorithms speak the language of integers , turning huge computations into modular games. From hashing to RSA, from combinatorics to cryptography, it’s everywhere.</p>
<blockquote class="blockquote">
<p>“When numbers wrap around, math becomes modular , and algorithms become magical.”</p>
</blockquote>
</section>
<section id="try-it-yourself-50" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-50">Try It Yourself</h4>
<ol type="1">
<li>Compute gcd(48, 180).</li>
<li>Find inverse of 7 mod 13.</li>
<li>Solve <span class="math inline">\(x ≡ 1 \pmod{2}, x ≡ 2 \pmod{3}, x ≡ 3 \pmod{5}\)</span>.</li>
<li>Implement modular division <span class="math inline">\(a / b \bmod m\)</span>.</li>
<li>Use modpow to compute <span class="math inline">\(3^{200} \bmod 13\)</span>.</li>
</ol>
<p>These basics unlock higher algorithms in cryptography, combinatorics, and beyond.</p>
</section>
</section>
<section id="primality-and-factorization-miller-rabin-pollard-rho" class="level3">
<h3 class="anchored" data-anchor-id="primality-and-factorization-miller-rabin-pollard-rho">52. Primality and Factorization (Miller-Rabin, Pollard Rho)</h3>
<p>Primality and factorization are core to number theory, cryptography, and competitive programming. Many modern systems (RSA, ECC) rely on the hardness of factoring large numbers. Here, we learn how to test if a number is prime and break it into factors efficiently.</p>
<p>We’ll cover:</p>
<ul>
<li>Trial Division</li>
<li>Sieve of Eratosthenes (for precomputation)</li>
<li>Probabilistic Primality Test (Miller-Rabin)</li>
<li>Integer Factorization (Pollard Rho)</li>
</ul>
<section id="trial-division" class="level4">
<h4 class="anchored" data-anchor-id="trial-division">1. Trial Division</h4>
<p>The simplest way to test primality is by dividing by all integers up to √n.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb280"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> is_prime<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> n <span class="op">==</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> i <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> i <span class="op">*</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">+=</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> i <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: ( O<span class="math inline">\(\sqrt{n}\)</span> ) Good for <span class="math inline">\(n \le 10^6\)</span>, impractical for large ( n ).</p>
</section>
<section id="sieve-of-eratosthenes" class="level4">
<h4 class="anchored" data-anchor-id="sieve-of-eratosthenes">2. Sieve of Eratosthenes</h4>
<p>For checking many numbers at once, use a sieve.</p>
<p>Idea: Mark all multiples of each prime starting from 2.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb281"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;</span> sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;</span> is_prime<span class="op">(</span>n<span class="op">+</span><span class="dv">1</span><span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>    is_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> is_prime<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">*</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">*</span> i<span class="op">;</span> j <span class="op">&lt;=</span> n<span class="op">;</span> j <span class="op">+=</span> i<span class="op">)</span></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>                is_prime<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> is_prime<span class="op">;</span></span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: ( O<span class="math inline">\(n \log \log n\)</span> )</p>
<p>Useful for generating primes up to <span class="math inline">\(10^7\)</span>.</p>
</section>
<section id="modular-multiplication" class="level4">
<h4 class="anchored" data-anchor-id="modular-multiplication">3. Modular Multiplication</h4>
<p>Before we do probabilistic tests or factorization, we need safe modular multiplication for large numbers.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb282"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> modmul<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>    __int128 res <span class="op">=</span> <span class="op">(</span>__int128<span class="op">)</span>a <span class="op">*</span> b <span class="op">%</span> m<span class="op">;</span></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>res<span class="op">;</span></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Avoid overflow for <span class="math inline">\(n \approx 10^{18}\)</span>.</p>
</section>
<section id="miller-rabin-primality-test" class="level4">
<h4 class="anchored" data-anchor-id="miller-rabin-primality-test">4. Miller-Rabin Primality Test</h4>
<p>A probabilistic test that can check if ( n ) is prime or composite in ( O<span class="math inline">\(k \log^3 n\)</span> ).</p>
<p>Idea: For a prime ( n ): <span class="math display">\[
a^{n-1} \equiv 1 \pmod{n}
\]</span> But for composites, most ( a ) fail this.</p>
<p>We write <span class="math inline">\(n - 1 = 2^s \cdot d\)</span>, ( d ) odd.</p>
<p>For each base ( a ):</p>
<ul>
<li>Compute <span class="math inline">\(x = a^d \bmod n\)</span>- If ( x = 1 ) or ( x = n - 1 ), pass- Else, square ( s-1 ) times- If none equal ( n - 1 ), composite</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb283"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> miller_rabin<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> p <span class="op">:</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">17</span><span class="op">,</span><span class="dv">19</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">29</span><span class="op">,</span><span class="dv">31</span><span class="op">,</span><span class="dv">37</span><span class="op">})</span></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> n <span class="op">==</span> p<span class="op">;</span></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> d <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> s <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">((</span>d <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> d <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">,</span> s<span class="op">++;</span></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> modpow <span class="op">=</span> <span class="op">[&amp;](</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> r <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> r <span class="op">=</span> modmul<span class="op">(</span>r<span class="op">,</span> a<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a>            a <span class="op">=</span> modmul<span class="op">(</span>a<span class="op">,</span> a<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a>            b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb283-16"><a href="#cb283-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a <span class="op">:</span> <span class="op">{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">325</span><span class="op">,</span> <span class="dv">9375</span><span class="op">,</span> <span class="dv">28178</span><span class="op">,</span> <span class="dv">450775</span><span class="op">,</span> <span class="dv">9780504</span><span class="op">,</span> <span class="dv">1795265022</span><span class="op">})</span> <span class="op">{</span></span>
<span id="cb283-17"><a href="#cb283-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>a <span class="op">%</span> n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb283-18"><a href="#cb283-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> x <span class="op">=</span> modpow<span class="op">(</span>a<span class="op">,</span> d<span class="op">);</span></span>
<span id="cb283-19"><a href="#cb283-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>x <span class="op">==</span> <span class="dv">1</span> <span class="op">||</span> x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb283-20"><a href="#cb283-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">bool</span> composite <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb283-21"><a href="#cb283-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> r <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> r <span class="op">&lt;</span> s<span class="op">;</span> r<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb283-22"><a href="#cb283-22" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> modmul<span class="op">(</span>x<span class="op">,</span> x<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb283-23"><a href="#cb283-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>x <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb283-24"><a href="#cb283-24" aria-hidden="true" tabindex="-1"></a>                composite <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb283-25"><a href="#cb283-25" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb283-26"><a href="#cb283-26" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb283-27"><a href="#cb283-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb283-28"><a href="#cb283-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>composite<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb283-29"><a href="#cb283-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb283-30"><a href="#cb283-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb283-31"><a href="#cb283-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Deterministic for:</p>
<ul>
<li><span class="math inline">\(n &lt; 2^{64}\)</span> with bases above. Complexity: ( O<span class="math inline">\(k \log^3 n\)</span> )</li>
</ul>
</section>
<section id="pollard-rho-factorization" class="level4">
<h4 class="anchored" data-anchor-id="pollard-rho-factorization">5. Pollard Rho Factorization</h4>
<p>Efficient for finding nontrivial factors of large composites. Based on Floyd’s cycle detection (Tortoise and Hare).</p>
<p>Idea: Define a pseudo-random function: <span class="math display">\[
f(x) = (x^2 + c) \bmod n
\]</span> Then find <span class="math inline">\(\gcd(|x - y|, n)\)</span> where <span class="math inline">\(x, y\)</span> move at different speeds.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb284"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> pollard_rho<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> f <span class="op">=</span> <span class="op">[&amp;](</span><span class="dt">long</span> <span class="dt">long</span> x<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">(</span>modmul<span class="op">(</span>x<span class="op">,</span> x<span class="op">,</span> n<span class="op">)</span> <span class="op">+</span> c<span class="op">)</span> <span class="op">%</span> n<span class="op">;</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="kw">true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> x <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">2</span><span class="op">)</span> <span class="op">+</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> y <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> c <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">long</span> <span class="dt">long</span> d <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> f<span class="op">(</span>x<span class="op">,</span> c<span class="op">);</span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>            y <span class="op">=</span> f<span class="op">(</span>f<span class="op">(</span>y<span class="op">,</span> c<span class="op">),</span> c<span class="op">);</span></span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a>            d <span class="op">=</span> gcd<span class="op">(</span>abs<span class="op">(</span>x <span class="op">-</span> y<span class="op">),</span> n<span class="op">);</span></span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> n<span class="op">)</span> <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb284-17"><a href="#cb284-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb284-18"><a href="#cb284-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Use:</p>
<ol type="1">
<li>Check if ( n ) is prime (Miller-Rabin)</li>
<li>If not, find a factor using Pollard Rho</li>
<li>Recurse on factors</li>
</ol>
<p>Complexity: ~ ( O<span class="math inline">\(n^{1/4}\)</span> ) average</p>
</section>
<section id="example-2" class="level4">
<h4 class="anchored" data-anchor-id="example-2">6. Example</h4>
<p>Factorize ( n = 8051 ):</p>
<ol type="1">
<li>Miller-Rabin → composite</li>
<li>Pollard Rho → factor 83</li>
<li>( 8051 / 83 = 97 )</li>
<li>Both primes ⇒ ( 8051 = 83 × 97 )</li>
</ol>
</section>
<section id="tiny-code-51" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-51">7. Tiny Code</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb285"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> factor<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> n<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;</span> <span class="op">&amp;</span>f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>miller_rabin<span class="op">(</span>n<span class="op">))</span> <span class="op">{</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>        f<span class="op">.</span>push_back<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> d <span class="op">=</span> pollard_rho<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a>    factor<span class="op">(</span>d<span class="op">,</span> f<span class="op">);</span></span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a>    factor<span class="op">(</span>n <span class="op">/</span> d<span class="op">,</span> f<span class="op">);</span></span>
<span id="cb285-10"><a href="#cb285-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Call <code>factor(n, f)</code> to get prime factors.</p>
</section>
<section id="summary-12" class="level4">
<h4 class="anchored" data-anchor-id="summary-12">8. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 26%">
<col style="width: 31%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Purpose</th>
<th>Complexity</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Trial Division</td>
<td>Small primes</td>
<td>( O<span class="math inline">\(\sqrt{n}\)</span> )</td>
<td>Deterministic</td>
</tr>
<tr class="even">
<td>Sieve</td>
<td>Precompute primes</td>
<td>( O<span class="math inline">\(n \log \log n\)</span> )</td>
<td>Deterministic</td>
</tr>
<tr class="odd">
<td>Miller-Rabin</td>
<td>Primality test</td>
<td>( O<span class="math inline">\(k \log^3 n\)</span> )</td>
<td>Probabilistic</td>
</tr>
<tr class="even">
<td>Pollard Rho</td>
<td>Factorization</td>
<td>( O<span class="math inline">\(n^{1/4}\)</span> )</td>
<td>Probabilistic</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-51" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-51">Why It Matters</h4>
<p>Modern security, number theory problems, and many algorithmic puzzles depend on knowing when a number is prime and factoring it quickly when it isn’t. These tools are the entry point to RSA, modular combinatorics, and advanced cryptography.</p>
</section>
<section id="try-it-yourself-51" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-51">Try It Yourself</h4>
<ol type="1">
<li>Check if 97 is prime using trial division and Miller-Rabin.</li>
<li>Factorize 5959 (should yield 59 × 101).</li>
<li>Generate all primes ≤ 100 using a sieve.</li>
<li>Write a recursive factorizer using Pollard Rho + Miller-Rabin.</li>
<li>Measure performance difference between <span class="math inline">\(\sqrt{n}\)</span> trial and Pollard Rho for <span class="math inline">\(n \approx 10^{12}\)</span>.</li>
</ol>
<p>These techniques make huge numbers approachable , one factor at a time.</p>
</section>
</section>
<section id="combinatorics-permutations-combinations-subsets" class="level3">
<h3 class="anchored" data-anchor-id="combinatorics-permutations-combinations-subsets">53. Combinatorics (Permutations, Combinations, Subsets)</h3>
<p>Combinatorics is the art of counting structures , how many ways can we arrange, select, or group things? In algorithms, it’s everywhere: DP transitions, counting paths, bitmask enumeration, and probabilistic reasoning. Here we’ll build a toolkit for computing factorials, nCr, nPr, and subset counts, both exactly and under a modulus.</p>
<section id="factorials-and-precomputation" class="level4">
<h4 class="anchored" data-anchor-id="factorials-and-precomputation">1. Factorials and Precomputation</h4>
<p>Most combinatorial formulas rely on factorials: <span class="math display">\[
n! = 1 \times 2 \times 3 \times \dots \times n
\]</span></p>
<p>We can precompute them modulo ( m ) (often <span class="math inline">\(10^9+7\)</span>) for efficiency.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb286"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="fl">1e9</span> <span class="op">+</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> MAXN <span class="op">=</span> <span class="fl">1e6</span><span class="op">;</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> fact<span class="op">[</span>MAXN <span class="op">+</span> <span class="dv">1</span><span class="op">],</span> invfact<span class="op">[</span>MAXN <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> modpow<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> res <span class="op">=</span> res <span class="op">*</span> a <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">*</span> a <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a>        b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-15"><a href="#cb286-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> init_factorials<span class="op">()</span> <span class="op">{</span></span>
<span id="cb286-16"><a href="#cb286-16" aria-hidden="true" tabindex="-1"></a>    fact<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb286-17"><a href="#cb286-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> MAXN<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb286-18"><a href="#cb286-18" aria-hidden="true" tabindex="-1"></a>        fact<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> fact<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> i <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb286-19"><a href="#cb286-19" aria-hidden="true" tabindex="-1"></a>    invfact<span class="op">[</span>MAXN<span class="op">]</span> <span class="op">=</span> modpow<span class="op">(</span>fact<span class="op">[</span>MAXN<span class="op">],</span> MOD <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb286-20"><a href="#cb286-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> MAXN <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span></span>
<span id="cb286-21"><a href="#cb286-21" aria-hidden="true" tabindex="-1"></a>        invfact<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> invfact<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb286-22"><a href="#cb286-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Now you can compute ( nCr ) and ( nPr ) in ( O(1) ) time.</p>
</section>
<section id="combinations-ncr" class="level4">
<h4 class="anchored" data-anchor-id="combinations-ncr">2. Combinations ( nCr )</h4>
<p>The number of ways to choose r items from ( n ) items: <span class="math display">\[
C(n, r) = \frac{n!}{r!(n-r)!}
\]</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb287"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> nCr<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">||</span> r <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact<span class="op">[</span>n<span class="op">]</span> <span class="op">*</span> invfact<span class="op">[</span>r<span class="op">]</span> <span class="op">%</span> MOD <span class="op">*</span> invfact<span class="op">[</span>n <span class="op">-</span> r<span class="op">]</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Properties:</p>
<ul>
<li><span class="math inline">\((C(n, 0) = 1),\ (C(n, n) = 1)\)</span></li>
<li><span class="math inline">\(C(n, r) = C(n, n - r)\)</span></li>
<li>Pascal’s Rule: <span class="math inline">\(C(n, r) = C(n - 1, r - 1) + C(n - 1, r)\)</span></li>
</ul>
</section>
<section id="example-3" class="level4">
<h4 class="anchored" data-anchor-id="example-3">Example</h4>
<p>( C(5, 2) = 10 ) There are 10 ways to pick 2 elements from a 5-element set.</p>
</section>
<section id="permutations-npr" class="level4">
<h4 class="anchored" data-anchor-id="permutations-npr">3. Permutations ( nPr )</h4>
<p>Number of ways to arrange r elements chosen from ( n ): <span class="math display">\[
P(n, r) = \frac{n!}{(n-r)!}
\]</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb288"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> nPr<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>r <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">||</span> r <span class="op">&gt;</span> n<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact<span class="op">[</span>n<span class="op">]</span> <span class="op">*</span> invfact<span class="op">[</span>n <span class="op">-</span> r<span class="op">]</span> <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-4" class="level4">
<h4 class="anchored" data-anchor-id="example-4">Example</h4>
<p>( P(5, 2) = 20 ) Choosing 2 out of 5 elements and arranging them yields 20 orders.</p>
</section>
<section id="subsets-and-power-set" class="level4">
<h4 class="anchored" data-anchor-id="subsets-and-power-set">4. Subsets and Power Set</h4>
<p>Each element has 2 choices: include or exclude. Hence, number of subsets: <span class="math display">\[
2^n
\]</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb289"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> subsets_count<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modpow<span class="op">(</span><span class="dv">2</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Enumerating subsets using bitmasks:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb290"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> mask <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> mask <span class="op">&lt;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> n<span class="op">);</span> mask<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>mask <span class="op">&amp;</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> i<span class="op">))</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">;</span> <span class="co">// include element i</span></span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Total: <span class="math inline">\(2^n\)</span> subsets, ( O<span class="math inline">\(n2^n\)</span> ) time to enumerate.</p>
</section>
<section id="multisets-and-repetition" class="level4">
<h4 class="anchored" data-anchor-id="multisets-and-repetition">5. Multisets and Repetition</h4>
<p>Number of ways to choose ( r ) items from ( n ) with repetition: <span class="math display">\[
C(n + r - 1, r)
\]</span></p>
<p>For example, number of ways to give 5 candies to 3 kids (each can get 0): ( C(3+5-1, 5) = C(7,5) = 21 )</p>
</section>
<section id="modular-combinatorics" class="level4">
<h4 class="anchored" data-anchor-id="modular-combinatorics">6. Modular Combinatorics</h4>
<p>When working modulo ( p ): - Use modular inverse for division. - <span class="math inline">\(C(n, r) \bmod p = fact[n] \cdot invfact[r] \cdot invfact[n - r] \bmod p\)</span></p>
<p>When <span class="math inline">\(n \ge p\)</span>, use Lucas’ Theorem: <span class="math display">\[
C(n, r) \bmod p = C(n/p, r/p) \cdot C(n%p, r%p) \bmod p
\]</span></p>
</section>
<section id="stirling-and-bell-numbers-advanced" class="level4">
<h4 class="anchored" data-anchor-id="stirling-and-bell-numbers-advanced">7. Stirling and Bell Numbers (Advanced)</h4>
<ul>
<li>Stirling Numbers of 2nd Kind: ways to partition ( n ) items into ( k ) non-empty subsets <span class="math display">\[
S(n,k) = k \cdot S(n-1,k) + S(n-1,k-1)
\]</span></li>
<li>Bell Numbers: total number of partitions <span class="math display">\[
B(n) = \sum_{k=0}^{n} S(n,k)
\]</span></li>
</ul>
<p>Used in set partition and grouping problems.</p>
</section>
<section id="tiny-code-52" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-52">8. Tiny Code</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb291"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>init_factorials<span class="op">();</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> nCr<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">3</span><span class="op">));</span>  <span class="co">// 120</span></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> nPr<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">3</span><span class="op">));</span>  <span class="co">// 720</span></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">"</span><span class="sc">%lld\n</span><span class="st">"</span><span class="op">,</span> subsets_count<span class="op">(</span><span class="dv">5</span><span class="op">));</span> <span class="co">// 32</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-13" class="level4">
<h4 class="anchored" data-anchor-id="summary-13">9. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 44%">
<col style="width: 22%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Concept</th>
<th>Formula</th>
<th>Meaning</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Factorial</td>
<td><span class="math inline">\(n!\)</span></td>
<td>All arrangements</td>
<td><span class="math inline">\(5! = 120\)</span></td>
</tr>
<tr class="even">
<td>Combination</td>
<td><span class="math inline">\(C(n, r) = \frac{n!}{r!(n - r)!}\)</span></td>
<td>Choose</td>
<td><span class="math inline">\(C(5, 2) = 10\)</span></td>
</tr>
<tr class="odd">
<td>Permutation</td>
<td><span class="math inline">\(P(n, r) = \frac{n!}{(n - r)!}\)</span></td>
<td>Arrange</td>
<td><span class="math inline">\(P(5, 2) = 20\)</span></td>
</tr>
<tr class="even">
<td>Subsets</td>
<td><span class="math inline">\(2^n\)</span></td>
<td>All combinations</td>
<td><span class="math inline">\(2^3 = 8\)</span></td>
</tr>
<tr class="odd">
<td>Multisets</td>
<td><span class="math inline">\(C(n + r - 1, r)\)</span></td>
<td>Repetition allowed</td>
<td><span class="math inline">\(C(4, 2) = 6\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-52" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-52">Why It Matters</h4>
<p>Combinatorics underlies probability, DP counting, and modular problems. You can’t master competitive programming or algorithm design without counting possibilities correctly. It teaches how structure emerges from choice , and how to count it efficiently.</p>
</section>
<section id="try-it-yourself-52" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-52">Try It Yourself</h4>
<ol type="1">
<li>Compute <span class="math inline">\(C(1000, 500) \bmod (10^9 + 7)\)</span>.</li>
<li>Count the number of 5-bit subsets with exactly 3 bits on, i.e.&nbsp;<span class="math inline">\(C(5, 3)\)</span>.</li>
<li>Write a loop to print all subsets of <code>{a, b, c, d}</code>.</li>
<li>Use Lucas’ theorem for <span class="math inline">\(C(10^6, 1000) \bmod 13\)</span>.</li>
<li>Implement Stirling recursion and print <span class="math inline">\(S(5, 2)\)</span>.</li>
</ol>
<p>Every algorithmic counting trick , from Pascal’s triangle to binomial theorem , starts right here.</p>
</section>
</section>
<section id="probability-and-randomized-algorithms" class="level3">
<h3 class="anchored" data-anchor-id="probability-and-randomized-algorithms">54. Probability and Randomized Algorithms</h3>
<p>Probability introduces controlled randomness into computation. Instead of deterministic steps, randomized algorithms use random choices to achieve speed, simplicity, or robustness. This section bridges probability theory and algorithm design , teaching how to model, analyze, and exploit randomness.</p>
<p>We’ll cover:</p>
<ul>
<li>Probability Basics</li>
<li>Expected Value</li>
<li>Monte Carlo and Las Vegas Algorithms</li>
<li>Randomized Data Structures and Algorithms</li>
</ul>
<section id="probability-basics" class="level4">
<h4 class="anchored" data-anchor-id="probability-basics">1. Probability Basics</h4>
<p>Every event has a probability between 0 and 1.<br>
If a sample space has <span class="math inline">\(n\)</span> equally likely outcomes and <span class="math inline">\(k\)</span> of them satisfy a condition, then</p>
<p><span class="math display">\[
P(E) = \frac{k}{n}
\]</span></p>
<p>Examples</p>
<ul>
<li>Rolling a fair die: <span class="math inline">\(P(\text{even}) = \frac{3}{6} = \frac{1}{2}\)</span></li>
<li>Drawing an ace from a deck: <span class="math inline">\(P(\text{ace}) = \frac{4}{52} = \frac{1}{13}\)</span></li>
</ul>
<p>Key Rules</p>
<ul>
<li>Complement: <span class="math inline">\(P(\bar{E}) = 1 - P(E)\)</span><br>
</li>
<li>Addition: <span class="math inline">\(P(A \cup B) = P(A) + P(B) - P(A \cap B)\)</span><br>
</li>
<li>Multiplication: <span class="math inline">\(P(A \cap B) = P(A) \cdot P(B \mid A)\)</span></li>
</ul>
</section>
<section id="expected-value" class="level4">
<h4 class="anchored" data-anchor-id="expected-value">2. Expected Value</h4>
<p>The expected value is the weighted average of outcomes.</p>
<p><span class="math display">\[
E[X] = \sum_{i} P(x_i) \cdot x_i
\]</span></p>
<p>Example: Expected value of a die: <span class="math display">\[
E[X] = \frac{1+2+3+4+5+6}{6} = 3.5
\]</span></p>
<p>Properties:</p>
<ul>
<li>Linearity: <span class="math inline">\(E[aX + bY] = aE[X] + bE[Y]\)</span></li>
<li>Useful for average-case analysis</li>
</ul>
<p>In algorithms:</p>
<ul>
<li>Expected number of comparisons in QuickSort is <span class="math inline">\(O(n \log n)\)</span></li>
<li>Expected time for hash table lookup is <span class="math inline">\(O(1)\)</span></li>
</ul>
</section>
<section id="monte-carlo-vs-las-vegas" class="level4">
<h4 class="anchored" data-anchor-id="monte-carlo-vs-las-vegas">3. Monte Carlo vs Las Vegas</h4>
<p>Randomized algorithms are broadly two types:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 38%">
<col style="width: 16%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Output</th>
<th>Runtime</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Monte Carlo</td>
<td>May be wrong (probabilistically)</td>
<td>Fixed</td>
<td>Miller-Rabin Primality</td>
</tr>
<tr class="even">
<td>Las Vegas</td>
<td>Always correct</td>
<td>Random runtime</td>
<td>Randomized QuickSort</td>
</tr>
</tbody>
</table>
<p>Monte Carlo:</p>
<ul>
<li>Faster, approximate</li>
<li>You can control error probability</li>
<li>E.g. primality test returns “probably prime”</li>
</ul>
<p>Las Vegas:</p>
<ul>
<li>Output guaranteed correct</li>
<li>Runtime varies by luck</li>
<li>E.g. QuickSort with random pivot</li>
</ul>
</section>
<section id="randomization-in-algorithms" class="level4">
<h4 class="anchored" data-anchor-id="randomization-in-algorithms">4. Randomization in Algorithms</h4>
<p>Randomization helps break worst-case patterns.</p>
</section>
<section id="a.-randomized-quicksort" class="level4">
<h4 class="anchored" data-anchor-id="a.-randomized-quicksort">A. Randomized QuickSort</h4>
<p>Pick a random pivot instead of first element. Expected time becomes ( O<span class="math inline">\(n \log n\)</span> ) regardless of input order.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb292"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> partition<span class="op">(</span><span class="dt">int</span> a<span class="op">[],</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot <span class="op">=</span> a<span class="op">[</span>l <span class="op">+</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>r <span class="op">-</span> l <span class="op">+</span> <span class="dv">1</span><span class="op">)];</span></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// move pivot to end, then normal partition</span></span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This avoids adversarial inputs like sorted arrays.</p>
</section>
<section id="b.-randomized-hashing" class="level4">
<h4 class="anchored" data-anchor-id="b.-randomized-hashing">B. Randomized Hashing</h4>
<p>Hash collisions can be exploited by adversaries. Using random coefficients in hash functions makes attacks infeasible.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb293"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="dt">long</span> <span class="dt">long</span> hash<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> x<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> a<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> b<span class="op">,</span> <span class="dt">long</span> <span class="dt">long</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>a <span class="op">*</span> x <span class="op">+</span> b<span class="op">)</span> <span class="op">%</span> p<span class="op">;</span></span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Pick random ( a, b ) for robustness.</p>
</section>
<section id="c.-randomized-data-structures" class="level4">
<h4 class="anchored" data-anchor-id="c.-randomized-data-structures">C. Randomized Data Structures</h4>
<ol type="1">
<li><p>Skip List: uses random levels for nodes Expected ( O<span class="math inline">\(\log n\)</span> ) search/insert/delete</p></li>
<li><p>Treap: randomized heap priority + BST order Maintains balance in expectation</p></li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb294"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">,</span> priority<span class="op">;</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>    Node <span class="op">*</span>l<span class="op">,</span> <span class="op">*</span>r<span class="op">;</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Randomized balancing gives good average performance without rotation logic.</p>
</section>
<section id="d.-random-sampling" class="level4">
<h4 class="anchored" data-anchor-id="d.-random-sampling">D. Random Sampling</h4>
<p>Pick random elements efficiently:</p>
<ul>
<li>Reservoir Sampling: sample ( k ) items from a stream of unknown size- Shuffle: Fisher-Yates Algorithm</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb295"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j <span class="op">=</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(</span>a<span class="op">[</span>i<span class="op">],</span> a<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="probabilistic-guarantees" class="level4">
<h4 class="anchored" data-anchor-id="probabilistic-guarantees">5. Probabilistic Guarantees</h4>
<p>Randomized algorithms often use Chernoff bounds and Markov’s inequality to bound errors:</p>
<ul>
<li>Markov: <span class="math inline">\(P(X \ge kE[X]) \le \frac{1}{k}\)</span></li>
<li>Chebyshev: <span class="math inline">\(P(|X - E[X]| \ge c\sigma) \le \frac{1}{c^2}\)</span></li>
<li>Chernoff: Exponentially small tail bounds</li>
</ul>
<p>These ensure “with high probability” (<span class="math inline">\(1 - \frac{1}{n^c}\)</span>) guarantees.</p>
</section>
<section id="tiny-code-53" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-53">6. Tiny Code</h4>
<p>Randomized QuickSort:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb296"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> partition<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivotIdx <span class="op">=</span> low <span class="op">+</span> rand<span class="op">()</span> <span class="op">%</span> <span class="op">(</span>high <span class="op">-</span> low <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(</span>arr<span class="op">[</span>pivotIdx<span class="op">],</span> arr<span class="op">[</span>high<span class="op">]);</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pivot <span class="op">=</span> arr<span class="op">[</span>high<span class="op">],</span> i <span class="op">=</span> low<span class="op">;</span></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> low<span class="op">;</span> j <span class="op">&lt;</span> high<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&lt;</span> pivot<span class="op">)</span> swap<span class="op">(</span>arr<span class="op">[</span>i<span class="op">++],</span> arr<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(</span>arr<span class="op">[</span>i<span class="op">],</span> arr<span class="op">[</span>high<span class="op">]);</span></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> quicksort<span class="op">(</span><span class="dt">int</span> arr<span class="op">[],</span> <span class="dt">int</span> low<span class="op">,</span> <span class="dt">int</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>low <span class="op">&lt;</span> high<span class="op">)</span> <span class="op">{</span></span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> pi <span class="op">=</span> partition<span class="op">(</span>arr<span class="op">,</span> low<span class="op">,</span> high<span class="op">);</span></span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a>        quicksort<span class="op">(</span>arr<span class="op">,</span> low<span class="op">,</span> pi <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a>        quicksort<span class="op">(</span>arr<span class="op">,</span> pi <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> high<span class="op">);</span></span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-14" class="level4">
<h4 class="anchored" data-anchor-id="summary-14">7. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 39%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Concept</th>
<th>Key Idea</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Expected Value</td>
<td>Weighted average outcome</td>
<td>Analyze average case</td>
</tr>
<tr class="even">
<td>Monte Carlo</td>
<td>Probabilistic correctness</td>
<td>Primality test</td>
</tr>
<tr class="odd">
<td>Las Vegas</td>
<td>Probabilistic runtime</td>
<td>QuickSort</td>
</tr>
<tr class="even">
<td>Random Pivot</td>
<td>Break worst-case</td>
<td>Sorting</td>
</tr>
<tr class="odd">
<td>Skip List / Treap</td>
<td>Random balancing</td>
<td>Data Structures</td>
</tr>
<tr class="even">
<td>Reservoir Sampling</td>
<td>Stream selection</td>
<td>Large data</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-53" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-53">Why It Matters</h4>
<p>Randomization is not “luck” , it’s a design principle. It transforms rigid algorithms into adaptive, robust systems. In complexity theory, randomness helps achieve bounds impossible deterministically.</p>
<blockquote class="blockquote">
<p>“A bit of randomness turns worst cases into best friends.”</p>
</blockquote>
</section>
<section id="try-it-yourself-53" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-53">Try It Yourself</h4>
<ol type="1">
<li>Simulate rolling two dice and compute expected sum.</li>
<li>Implement randomized QuickSort and measure average runtime.</li>
<li>Write a Monte Carlo primality checker.</li>
<li>Create a random hash function for integers.</li>
<li>Implement reservoir sampling for a large input stream.</li>
</ol>
<p>These experiments show how uncertainty can become a powerful ally in algorithm design.</p>
</section>
</section>
<section id="sieve-methods-and-modular-math" class="level3">
<h3 class="anchored" data-anchor-id="sieve-methods-and-modular-math">55. Sieve Methods and Modular Math</h3>
<p>Sieve methods are essential tools in number theory for generating prime numbers, prime factors, and function values (φ, μ) efficiently. Combined with modular arithmetic, they form the backbone of algorithms in cryptography, combinatorics, and competitive programming.</p>
<p>This section introduces:</p>
<ul>
<li>Sieve of Eratosthenes- Optimized Linear Sieve- Sieve for Smallest Prime Factor (SPF)- Euler’s Totient Function (φ)- Modular Applications</li>
</ul>
<section id="the-sieve-of-eratosthenes" class="level4">
<h4 class="anchored" data-anchor-id="the-sieve-of-eratosthenes">1. The Sieve of Eratosthenes</h4>
<p>The classic algorithm to find all primes ≤ ( n ).</p>
<p>Idea: Start from 2, mark all multiples as composite. Continue to √n.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb297"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> sieve<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> primes<span class="op">;</span></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">bool</span><span class="op">&gt;</span> is_prime<span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>    is_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> is_prime<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">*</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">*</span> i<span class="op">;</span> j <span class="op">&lt;=</span> n<span class="op">;</span> j <span class="op">+=</span> i<span class="op">)</span></span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>                is_prime<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span> primes<span class="op">.</span>push_back<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> primes<span class="op">;</span></span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: ( O<span class="math inline">\(n \log \log n\)</span> )</p>
<p>Space: ( O(n) )</p>
<p>Example: Primes up to 20 → 2, 3, 5, 7, 11, 13, 17, 19</p>
</section>
<section id="linear-sieve-on" class="level4">
<h4 class="anchored" data-anchor-id="linear-sieve-on">2. Linear Sieve (O(n))</h4>
<p>Unlike the basic sieve, each number is marked exactly once by its smallest prime factor (SPF).</p>
<p>Idea:</p>
<ul>
<li>For each prime ( p ), mark <span class="math inline">\(p \times i\)</span> only once.- Use <code>spf[i]</code> to store smallest prime factor.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb298"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="fl">1e6</span><span class="op">;</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> spf<span class="op">[</span>N <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> primes<span class="op">;</span></span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> linear_sieve<span class="op">()</span> <span class="op">{</span></span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>spf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a>            spf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a>            primes<span class="op">.</span>push_back<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> p <span class="op">:</span> primes<span class="op">)</span> <span class="op">{</span></span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>p <span class="op">&gt;</span> spf<span class="op">[</span>i<span class="op">]</span> <span class="op">||</span> <span class="dv">1</span><span class="bu">LL</span> <span class="op">*</span> i <span class="op">*</span> p <span class="op">&gt;</span> N<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a>            spf<span class="op">[</span>i <span class="op">*</span> p<span class="op">]</span> <span class="op">=</span> p<span class="op">;</span></span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb298-16"><a href="#cb298-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Benefits:</p>
<ul>
<li>Get primes, SPF, and factorizations in ( O(n) ).- Ideal for problems needing many factorizations.</li>
</ul>
</section>
<section id="smallest-prime-factor-spf-table" class="level4">
<h4 class="anchored" data-anchor-id="smallest-prime-factor-spf-table">3. Smallest Prime Factor (SPF) Table</h4>
<p>With <code>spf[]</code>, factorization becomes ( O<span class="math inline">\(\log n\)</span> ).</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb299"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> factorize<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> f<span class="op">;</span></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>x <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>        f<span class="op">.</span>push_back<span class="op">(</span>spf<span class="op">[</span>x<span class="op">]);</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>        x <span class="op">/=</span> spf<span class="op">[</span>x<span class="op">];</span></span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> f<span class="op">;</span></span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example: spf[12] = 2 → factors = [2, 2, 3]</p>
</section>
<section id="eulers-totient-function-n" class="level4">
<h4 class="anchored" data-anchor-id="eulers-totient-function-n">4. Euler’s Totient Function ( (n) )</h4>
<p>The number of integers ≤ ( n ) that are coprime with ( n ).</p>
<p>Formula: <span class="math display">\[
\varphi(n) = n \prod_{p|n} \left(1 - \frac{1}{p}\right)
\]</span></p>
<p>Properties:</p>
<ul>
<li><span class="math inline">\(\varphi(p) = p - 1\)</span> if <span class="math inline">\(p\)</span> is prime</li>
<li>Multiplicative: if <span class="math inline">\(\gcd(a, b) = 1\)</span>, then <span class="math inline">\(\varphi(ab) = \varphi(a)\varphi(b)\)</span></li>
</ul>
<p>Implementation (Linear Sieve):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb300"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="fl">1e6</span><span class="op">;</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> phi<span class="op">[</span>N <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> is_comp<span class="op">[</span>N <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> primes<span class="op">;</span></span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> phi_sieve<span class="op">()</span> <span class="op">{</span></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>    phi<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>is_comp<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a>            primes<span class="op">.</span>push_back<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a>            phi<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> p <span class="op">:</span> primes<span class="op">)</span> <span class="op">{</span></span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span><span class="dv">1</span><span class="bu">LL</span> <span class="op">*</span> i <span class="op">*</span> p <span class="op">&gt;</span> N<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a>            is_comp<span class="op">[</span>i <span class="op">*</span> p<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb300-16"><a href="#cb300-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb300-17"><a href="#cb300-17" aria-hidden="true" tabindex="-1"></a>                phi<span class="op">[</span>i <span class="op">*</span> p<span class="op">]</span> <span class="op">=</span> phi<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> p<span class="op">;</span></span>
<span id="cb300-18"><a href="#cb300-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb300-19"><a href="#cb300-19" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb300-20"><a href="#cb300-20" aria-hidden="true" tabindex="-1"></a>                phi<span class="op">[</span>i <span class="op">*</span> p<span class="op">]</span> <span class="op">=</span> phi<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> <span class="op">(</span>p <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb300-21"><a href="#cb300-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb300-22"><a href="#cb300-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb300-23"><a href="#cb300-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb300-24"><a href="#cb300-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example:</p>
<ul>
<li><span class="math inline">\(\varphi(6) = 6(1 - \frac{1}{2})(1 - \frac{1}{3}) = 2\)</span></li>
<li>Numbers coprime with 6: 1, 5</li>
</ul>
</section>
<section id="modular-math-applications" class="level4">
<h4 class="anchored" data-anchor-id="modular-math-applications">5. Modular Math Applications</h4>
<p>Once we have primes and totients, we can do many modular computations.</p>
</section>
<section id="a.-fermats-little-theorem" class="level4">
<h4 class="anchored" data-anchor-id="a.-fermats-little-theorem">A. Fermat’s Little Theorem</h4>
<p>If ( p ) is prime, <span class="math display">\[
a^{p-1} \equiv 1 \pmod{p}
\]</span> Hence, <span class="math display">\[
a^{-1} \equiv a^{p-2} \pmod{p}
\]</span></p>
<p>Used in: modular inverses, combinatorics.</p>
</section>
<section id="b.-eulers-theorem" class="level4">
<h4 class="anchored" data-anchor-id="b.-eulers-theorem">B. Euler’s Theorem</h4>
<p>If <span class="math inline">\(\gcd(a, n) = 1\)</span>, then</p>
<p><span class="math display">\[
a^{\varphi(n)} \equiv 1 \pmod{n}
\]</span></p>
<p>Generalizes Fermat’s theorem to composite moduli.</p>
</section>
<section id="c.-modular-exponentiation-with-totient-reduction" class="level4">
<h4 class="anchored" data-anchor-id="c.-modular-exponentiation-with-totient-reduction">C. Modular Exponentiation with Totient Reduction</h4>
<p>For very large powers:</p>
<p><span class="math display">\[
a^b \bmod n = a^{b \bmod \varphi(n)} \bmod n
\]</span></p>
<p>(when <span class="math inline">\(a\)</span> and <span class="math inline">\(n\)</span> are coprime)</p>
</section>
<section id="tiny-code-54" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-54">6. Tiny Code</h4>
<p>Primes up to n:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb301"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> primes <span class="op">=</span> sieve<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Totients up to n:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb302"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>phi_sieve<span class="op">();</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>cout <span class="op">&lt;&lt;</span> phi<span class="op">[</span><span class="dv">10</span><span class="op">];</span> <span class="co">// 4</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Factorization:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb303"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> f <span class="op">=</span> factorize<span class="op">(</span><span class="dv">60</span><span class="op">);</span> <span class="co">// [2, 2, 3, 5]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-15" class="level4">
<h4 class="anchored" data-anchor-id="summary-15">7. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 29%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Concept</th>
<th>Description</th>
<th>Time</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Eratosthenes</td>
<td>Mark multiples</td>
<td>(O<span class="math inline">\(n \log \log n\)</span>)</td>
<td>Simple prime gen</td>
</tr>
<tr class="even">
<td>Linear Sieve</td>
<td>Mark once</td>
<td>(O(n))</td>
<td>Prime + SPF</td>
</tr>
<tr class="odd">
<td>SPF Table</td>
<td>Smallest prime factor</td>
<td>(O(1)) query</td>
<td>Fast factorization</td>
</tr>
<tr class="even">
<td>φ(n)</td>
<td>Coprime count</td>
<td>(O(n))</td>
<td>Modular exponent</td>
</tr>
<tr class="odd">
<td>Fermat / Euler</td>
<td>Inverses, reduction</td>
<td>(O<span class="math inline">\(\log n\)</span>)</td>
<td>Modular arithmetic</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-54" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-54">Why It Matters</h4>
<p>Sieve methods are the fastest way to preprocess arithmetic information. They unlock efficient solutions to problems involving primes, divisors, modular equations, and cryptography.</p>
<blockquote class="blockquote">
<p>“Before you can reason about numbers, you must first sieve them clean.”</p>
</blockquote>
</section>
<section id="try-it-yourself-54" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-54">Try It Yourself</h4>
<ol type="1">
<li>Generate all primes <span class="math inline">\(\le 10^6\)</span> using a linear sieve.</li>
<li>Factorize <span class="math inline">\(840\)</span> using the SPF array.</li>
<li>Compute <span class="math inline">\(\varphi(n)\)</span> for <span class="math inline">\(n = 1..20\)</span>.</li>
<li>Verify <span class="math inline">\(a^{\varphi(n)} \equiv 1 \pmod{n}\)</span> for <span class="math inline">\(a = 3\)</span>, <span class="math inline">\(n = 10\)</span>.</li>
<li>Solve <span class="math inline">\(a^b \bmod n\)</span> with <span class="math inline">\(b\)</span> very large using <span class="math inline">\(\varphi(n)\)</span>.</li>
</ol>
<p>Sieve once, and modular math becomes effortless forever after.</p>
</section>
</section>
<section id="linear-algebra-gaussian-elimination-lu-svd" class="level3">
<h3 class="anchored" data-anchor-id="linear-algebra-gaussian-elimination-lu-svd">56. Linear Algebra (Gaussian Elimination, LU, SVD)</h3>
<p>Linear algebra gives algorithms their mathematical backbone. From solving equations to powering ML models, it’s the hidden engine behind optimization, geometry, and numerical computation.</p>
<p>In this section, we’ll focus on the algorithmic toolkit:</p>
<ul>
<li>Gaussian Elimination (solve systems, invert matrices)</li>
<li>LU Decomposition (efficient repeated solving)</li>
<li>SVD (Singular Value Decomposition) overview</li>
</ul>
<p>You’ll see how algebra becomes code , step by step.</p>
<section id="systems-of-linear-equations" class="level4">
<h4 class="anchored" data-anchor-id="systems-of-linear-equations">1. Systems of Linear Equations</h4>
<p>We want to solve: <span class="math display">\[
A \cdot x = b
\]</span> where ( A ) is an <span class="math inline">\(n \times n\)</span> matrix, and ( x, b ) are vectors.</p>
<p>For example: <span class="math display">\[\begin{cases}
2x + 3y = 8 \
x + 2y = 5
\end{cases}\]</span></p>
<p>The solution is the intersection of two lines. In general, <span class="math inline">\(A^{-1}b\)</span> gives ( x ), but we usually solve it more directly using Gaussian elimination.</p>
</section>
<section id="gaussian-elimination-row-reduction" class="level4">
<h4 class="anchored" data-anchor-id="gaussian-elimination-row-reduction">2. Gaussian Elimination (Row Reduction)</h4>
<p>Idea: Transform ( [A|b] ) (augmented matrix) into upper-triangular form, then back-substitute.</p>
<p>Steps:</p>
<ol type="1">
<li>For each row, select a pivot (non-zero leading element).</li>
<li>Eliminate below it using row operations.</li>
<li>After all pivots, back-substitute to get the solution.</li>
</ol>
</section>
<section id="a.-implementation-c" class="level4">
<h4 class="anchored" data-anchor-id="a.-implementation-c">A. Implementation (C)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb304"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">double</span> EPS <span class="op">=</span> <span class="fl">1e-9</span><span class="op">;</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> gauss<span class="op">(</span>vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;</span> A<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> A<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 1. Find pivot</span></span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> pivot <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>A<span class="op">[</span>j<span class="op">][</span>i<span class="op">])</span> <span class="op">&gt;</span> fabs<span class="op">(</span>A<span class="op">[</span>pivot<span class="op">][</span>i<span class="op">]))</span></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a>                pivot <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a>        swap<span class="op">(</span>A<span class="op">[</span>i<span class="op">],</span> A<span class="op">[</span>pivot<span class="op">]);</span></span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a>        swap<span class="op">(</span>b<span class="op">[</span>i<span class="op">],</span> b<span class="op">[</span>pivot<span class="op">]);</span></span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 2. Normalize pivot row</span></span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> div <span class="op">=</span> A<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb304-16"><a href="#cb304-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>div<span class="op">)</span> <span class="op">&lt;</span> EPS<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb304-17"><a href="#cb304-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">;</span> k<span class="op">++)</span> A<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">/=</span> div<span class="op">;</span></span>
<span id="cb304-18"><a href="#cb304-18" aria-hidden="true" tabindex="-1"></a>        b<span class="op">[</span>i<span class="op">]</span> <span class="op">/=</span> div<span class="op">;</span></span>
<span id="cb304-19"><a href="#cb304-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-20"><a href="#cb304-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 3. Eliminate below</span></span>
<span id="cb304-21"><a href="#cb304-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb304-22"><a href="#cb304-22" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> factor <span class="op">=</span> A<span class="op">[</span>j<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb304-23"><a href="#cb304-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">;</span> k<span class="op">++)</span> A<span class="op">[</span>j<span class="op">][</span>k<span class="op">]</span> <span class="op">-=</span> factor <span class="op">*</span> A<span class="op">[</span>i<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb304-24"><a href="#cb304-24" aria-hidden="true" tabindex="-1"></a>            b<span class="op">[</span>j<span class="op">]</span> <span class="op">-=</span> factor <span class="op">*</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb304-25"><a href="#cb304-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb304-26"><a href="#cb304-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb304-27"><a href="#cb304-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-28"><a href="#cb304-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 4. Back substitution</span></span>
<span id="cb304-29"><a href="#cb304-29" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> x<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb304-30"><a href="#cb304-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb304-31"><a href="#cb304-31" aria-hidden="true" tabindex="-1"></a>        x<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb304-32"><a href="#cb304-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb304-33"><a href="#cb304-33" aria-hidden="true" tabindex="-1"></a>            x<span class="op">[</span>i<span class="op">]</span> <span class="op">-=</span> A<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">*</span> x<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb304-34"><a href="#cb304-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb304-35"><a href="#cb304-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb304-36"><a href="#cb304-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time complexity: ( O<span class="math inline">\(n^3\)</span> )</p>
</section>
<section id="b.-example-5" class="level4">
<h4 class="anchored" data-anchor-id="b.-example-5">B. Example</h4>
<p>Solve: <span class="math display">\[\begin{cases}
2x + 3y = 8 \
x + 2y = 5
\end{cases}\]</span></p>
<p>Augmented matrix: <span class="math display">\[\begin{bmatrix}
2 &amp; 3 &amp; | &amp; 8 \
1 &amp; 2 &amp; | &amp; 5
\end{bmatrix}\]</span></p>
<p>Reduce:</p>
<ul>
<li>Row2 ← Row2 − ½ Row1 → <span class="math inline">\([1, 2 | 5] \to [0, 0.5 | 1]\)</span>- Back substitute → ( y = 2, x = 1 )</li>
</ul>
</section>
<section id="lu-decomposition" class="level4">
<h4 class="anchored" data-anchor-id="lu-decomposition">3. LU Decomposition</h4>
<p>LU factorization expresses: <span class="math display">\[
A = L \cdot U
\]</span> where ( L ) is lower-triangular (1s on diagonal), ( U ) is upper-triangular.</p>
<p>This allows solving ( A x = b ) in two triangular solves:</p>
<ol type="1">
<li>Solve ( L y = b )</li>
<li>Solve ( U x = y )</li>
</ol>
<p>Efficient when solving for multiple b’s (same A).</p>
</section>
<section id="a.-decomposition-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="a.-decomposition-algorithm">A. Decomposition Algorithm</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb305"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> lu_decompose<span class="op">(</span>vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;&amp;</span> A<span class="op">,</span> vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;&amp;</span> L<span class="op">,</span> vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;&amp;</span> U<span class="op">)</span> <span class="op">{</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> A<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>    L<span class="op">.</span>assign<span class="op">(</span>n<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>n<span class="op">,</span> <span class="dv">0</span><span class="op">));</span></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>    U<span class="op">.</span>assign<span class="op">(</span>n<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;(</span>n<span class="op">,</span> <span class="dv">0</span><span class="op">));</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Upper</span></span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>                sum <span class="op">+=</span> L<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">*</span> U<span class="op">[</span>j<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>            U<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">-</span> sum<span class="op">;</span></span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Lower</span></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> i<span class="op">;</span> k <span class="op">&lt;</span> n<span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>i <span class="op">==</span> k<span class="op">)</span> L<span class="op">[</span>i<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb305-17"><a href="#cb305-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb305-18"><a href="#cb305-18" aria-hidden="true" tabindex="-1"></a>                <span class="dt">double</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb305-19"><a href="#cb305-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb305-20"><a href="#cb305-20" aria-hidden="true" tabindex="-1"></a>                    sum <span class="op">+=</span> L<span class="op">[</span>k<span class="op">][</span>j<span class="op">]</span> <span class="op">*</span> U<span class="op">[</span>j<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb305-21"><a href="#cb305-21" aria-hidden="true" tabindex="-1"></a>                L<span class="op">[</span>k<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>A<span class="op">[</span>k<span class="op">][</span>i<span class="op">]</span> <span class="op">-</span> sum<span class="op">)</span> <span class="op">/</span> U<span class="op">[</span>i<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb305-22"><a href="#cb305-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb305-23"><a href="#cb305-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb305-24"><a href="#cb305-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb305-25"><a href="#cb305-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Solve with forward + backward substitution.</p>
</section>
<section id="singular-value-decomposition-svd" class="level4">
<h4 class="anchored" data-anchor-id="singular-value-decomposition-svd">4. Singular Value Decomposition (SVD)</h4>
<p>SVD generalizes diagonalization for non-square matrices: <span class="math display">\[
A = U \Sigma V^T
\]</span></p>
<p>Where:</p>
<ul>
<li><p>( U ): left singular vectors (orthogonal)- <span class="math inline">\(\Sigma\)</span>: diagonal of singular values- <span class="math inline">\(V^T\)</span>: right singular vectors Applications:</p></li>
<li><p>Data compression (PCA)- Noise reduction- Rank estimation- Pseudoinverse <span class="math inline">\(A^+ = V \Sigma^{-1} U^T\)</span> In practice, use libraries (e.g.&nbsp;LAPACK, Eigen).</p></li>
</ul>
</section>
<section id="numerical-stability-and-pivoting" class="level4">
<h4 class="anchored" data-anchor-id="numerical-stability-and-pivoting">5. Numerical Stability and Pivoting</h4>
<p>In floating-point math:</p>
<ul>
<li>Always pick largest pivot (partial pivoting)- Avoid dividing by small numbers- Use EPS = 1e-9 threshold Small numerical errors can amplify quickly , stability is key.</li>
</ul>
</section>
<section id="tiny-code-55" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-55">6. Tiny Code</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb306"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;&gt;</span> A <span class="op">=</span> <span class="op">{{</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">},</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">}};</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> b <span class="op">=</span> <span class="op">{</span><span class="dv">8</span><span class="op">,</span> <span class="dv">5</span><span class="op">};</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> x <span class="op">=</span> gauss<span class="op">(</span>A<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Output: x = [1, 2]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-16" class="level4">
<h4 class="anchored" data-anchor-id="summary-16">7. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 28%">
<col style="width: 13%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Purpose</th>
<th>Complexity</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Gaussian Elimination</td>
<td>Solve Ax=b</td>
<td>(O<span class="math inline">\(n^3\)</span>)</td>
<td>Direct method</td>
</tr>
<tr class="even">
<td>LU Decomposition</td>
<td>Repeated solves</td>
<td>(O<span class="math inline">\(n^3\)</span>)</td>
<td>Triangular factorization</td>
</tr>
<tr class="odd">
<td>SVD</td>
<td>General decomposition</td>
<td>(O<span class="math inline">\(n^3\)</span>)</td>
<td>Robust, versatile</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-55" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-55">Why It Matters</h4>
<p>Linear algebra is the language of algorithms , it solves equations, optimizes functions, and projects data. Whether building solvers or neural networks, these methods are your foundation.</p>
<blockquote class="blockquote">
<p>“Every algorithm lives in a vector space , it just needs a basis to express itself.”</p>
</blockquote>
</section>
<section id="try-it-yourself-55" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-55">Try It Yourself</h4>
<ol type="1">
<li>Solve a 3×3 linear system with Gaussian elimination.</li>
<li>Implement LU decomposition and test <span class="math inline">\(L \cdot U = A\)</span>.</li>
<li>Use LU to solve multiple ( b ) vectors.</li>
<li>Explore SVD using a math library; compute singular values of a 2×2 matrix.</li>
<li>Compare results between naive and pivoted elimination for unstable systems.</li>
</ol>
<p>Start with row operations , and you’ll see how geometry and algebra merge into code.</p>
</section>
</section>
<section id="fft-and-ntt-fast-transforms" class="level3">
<h3 class="anchored" data-anchor-id="fft-and-ntt-fast-transforms">57. FFT and NTT (Fast Transforms)</h3>
<p>The Fast Fourier Transform (FFT) is one of the most beautiful and practical algorithms ever invented. It converts data between time (or coefficient) domain and frequency (or point) domain efficiently. The Number Theoretic Transform (NTT) is its modular counterpart for integer arithmetic , ideal for polynomial multiplication under a modulus.</p>
<p>This section covers:</p>
<ul>
<li>Why we need transforms- Discrete Fourier Transform (DFT)- Cooley-Tukey FFT (complex numbers)- NTT (modular version)- Applications (polynomial multiplication, convolution)</li>
</ul>
<section id="motivation" class="level4">
<h4 class="anchored" data-anchor-id="motivation">1. Motivation</h4>
<p>Suppose you want to multiply two polynomials: <span class="math display">\[
A(x) = a_0 + a_1x + a_2x^2
\]</span></p>
<p><span class="math display">\[
B(x) = b_0 + b_1x + b_2x^2
\]</span></p>
<p>Their product has coefficients: <span class="math display">\[
c_k = \sum_{i+j=k} a_i \cdot b_j
\]</span></p>
<p>This is convolution: <span class="math display">\[
C = A * B
\]</span> Naively, this takes ( O<span class="math inline">\(n^2\)</span> ). FFT reduces it to ( O<span class="math inline">\(n \log n\)</span> ).</p>
</section>
<section id="discrete-fourier-transform-dft" class="level4">
<h4 class="anchored" data-anchor-id="discrete-fourier-transform-dft">2. Discrete Fourier Transform (DFT)</h4>
<p>The DFT maps coefficients <span class="math inline">\(a_0, a_1, \ldots, a_{n-1}\)</span> to evaluations at ( n )-th roots of unity:</p>
<p><span class="math display">\[
A_k = \sum_{j=0}^{n-1} a_j \cdot e^{-2\pi i \cdot jk / n}
\]</span></p>
<p>and the inverse transform recovers <span class="math inline">\(a_j\)</span> from <span class="math inline">\(A_k\)</span>.</p>
</section>
<section id="cooley-tukey-fft" class="level4">
<h4 class="anchored" data-anchor-id="cooley-tukey-fft">3. Cooley-Tukey FFT</h4>
<p>Key idea: recursively split the sum into even and odd parts:</p>
<p><span class="math display">\[
A_k = A_{even}(w_n^2) + w_n^k \cdot A_{odd}(w_n^2)
\]</span></p>
<p>Where <span class="math inline">\(w_n = e^{-2\pi i / n}\)</span> is an ( n )-th root of unity.</p>
</section>
<section id="implementation-c" class="level4">
<h4 class="anchored" data-anchor-id="implementation-c">Implementation (C++)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb307"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;complex&gt;</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> cd <span class="op">=</span> complex<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;;</span></span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">double</span> PI <span class="op">=</span> acos<span class="op">(-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fft<span class="op">(</span>vector<span class="op">&lt;</span>cd<span class="op">&gt;</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="dt">bool</span> invert<span class="op">)</span> <span class="op">{</span></span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> a<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> bit <span class="op">=</span> n <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(;</span> j <span class="op">&amp;</span> bit<span class="op">;</span> bit <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">)</span> j <span class="op">^=</span> bit<span class="op">;</span></span>
<span id="cb307-14"><a href="#cb307-14" aria-hidden="true" tabindex="-1"></a>        j <span class="op">^=</span> bit<span class="op">;</span></span>
<span id="cb307-15"><a href="#cb307-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">&lt;</span> j<span class="op">)</span> swap<span class="op">(</span>a<span class="op">[</span>i<span class="op">],</span> a<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb307-16"><a href="#cb307-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb307-17"><a href="#cb307-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-18"><a href="#cb307-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;=</span> n<span class="op">;</span> len <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb307-19"><a href="#cb307-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> ang <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> PI <span class="op">/</span> len <span class="op">*</span> <span class="op">(</span>invert <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb307-20"><a href="#cb307-20" aria-hidden="true" tabindex="-1"></a>        cd wlen<span class="op">(</span>cos<span class="op">(</span>ang<span class="op">),</span> sin<span class="op">(</span>ang<span class="op">));</span></span>
<span id="cb307-21"><a href="#cb307-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">+=</span> len<span class="op">)</span> <span class="op">{</span></span>
<span id="cb307-22"><a href="#cb307-22" aria-hidden="true" tabindex="-1"></a>            cd w<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb307-23"><a href="#cb307-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb307-24"><a href="#cb307-24" aria-hidden="true" tabindex="-1"></a>                cd u <span class="op">=</span> a<span class="op">[</span>i <span class="op">+</span> j<span class="op">],</span> v <span class="op">=</span> a<span class="op">[</span>i <span class="op">+</span> j <span class="op">+</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">]</span> <span class="op">*</span> w<span class="op">;</span></span>
<span id="cb307-25"><a href="#cb307-25" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>i <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> u <span class="op">+</span> v<span class="op">;</span></span>
<span id="cb307-26"><a href="#cb307-26" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>i <span class="op">+</span> j <span class="op">+</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">]</span> <span class="op">=</span> u <span class="op">-</span> v<span class="op">;</span></span>
<span id="cb307-27"><a href="#cb307-27" aria-hidden="true" tabindex="-1"></a>                w <span class="op">*=</span> wlen<span class="op">;</span></span>
<span id="cb307-28"><a href="#cb307-28" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb307-29"><a href="#cb307-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb307-30"><a href="#cb307-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb307-31"><a href="#cb307-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-32"><a href="#cb307-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>invert<span class="op">)</span> <span class="op">{</span></span>
<span id="cb307-33"><a href="#cb307-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>cd <span class="op">&amp;</span>x <span class="op">:</span> a<span class="op">)</span> x <span class="op">/=</span> n<span class="op">;</span></span>
<span id="cb307-34"><a href="#cb307-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb307-35"><a href="#cb307-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="polynomial-multiplication-with-fft" class="level4">
<h4 class="anchored" data-anchor-id="polynomial-multiplication-with-fft">Polynomial Multiplication with FFT</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb308"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;</span> multiply<span class="op">(</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> a<span class="op">,</span> vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> <span class="at">const</span><span class="op">&amp;</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>cd<span class="op">&gt;</span> fa<span class="op">(</span>a<span class="op">.</span>begin<span class="op">(),</span> a<span class="op">.</span>end<span class="op">()),</span> fb<span class="op">(</span>b<span class="op">.</span>begin<span class="op">(),</span> b<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>a<span class="op">.</span>size<span class="op">()</span> <span class="op">+</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>b<span class="op">.</span>size<span class="op">())</span> n <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>    fa<span class="op">.</span>resize<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>    fb<span class="op">.</span>resize<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>fa<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>fb<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> fa<span class="op">[</span>i<span class="op">]</span> <span class="op">*=</span> fb<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb308-11"><a href="#cb308-11" aria-hidden="true" tabindex="-1"></a>    fft<span class="op">(</span>fa<span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb308-12"><a href="#cb308-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-13"><a href="#cb308-13" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span><span class="dt">long</span> <span class="dt">long</span><span class="op">&gt;</span> result<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb308-14"><a href="#cb308-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb308-15"><a href="#cb308-15" aria-hidden="true" tabindex="-1"></a>        result<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> llround<span class="op">(</span>fa<span class="op">[</span>i<span class="op">].</span>real<span class="op">());</span></span>
<span id="cb308-16"><a href="#cb308-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb308-17"><a href="#cb308-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: ( O<span class="math inline">\(n \log n\)</span> )</p>
</section>
<section id="number-theoretic-transform-ntt" class="level4">
<h4 class="anchored" data-anchor-id="number-theoretic-transform-ntt">4. Number Theoretic Transform (NTT)</h4>
<p>FFT uses complex numbers , NTT uses modular arithmetic with roots of unity mod p. We need a prime ( p ) such that: <span class="math display">\[
p = c \cdot 2^k + 1
\]</span> so a primitive root ( g ) exists.</p>
<p>Popular choices:</p>
<ul>
<li>( p = 998244353, g = 3 )- ( p = 7340033, g = 3 )</li>
</ul>
</section>
<section id="implementation-ntt" class="level4">
<h4 class="anchored" data-anchor-id="implementation-ntt">Implementation (NTT)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb309"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> MOD <span class="op">=</span> <span class="dv">998244353</span><span class="op">;</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> G <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> modpow<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> res <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>b <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> res <span class="op">=</span> res <span class="op">*</span> a <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> <span class="dv">1</span><span class="bu">LL</span> <span class="op">*</span> a <span class="op">*</span> a <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a>        b <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb309-11"><a href="#cb309-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">;</span></span>
<span id="cb309-12"><a href="#cb309-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb309-13"><a href="#cb309-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-14"><a href="#cb309-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> ntt<span class="op">(</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="dt">bool</span> invert<span class="op">)</span> <span class="op">{</span></span>
<span id="cb309-15"><a href="#cb309-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> a<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb309-16"><a href="#cb309-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb309-17"><a href="#cb309-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> bit <span class="op">=</span> n <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb309-18"><a href="#cb309-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(;</span> j <span class="op">&amp;</span> bit<span class="op">;</span> bit <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">)</span> j <span class="op">^=</span> bit<span class="op">;</span></span>
<span id="cb309-19"><a href="#cb309-19" aria-hidden="true" tabindex="-1"></a>        j <span class="op">^=</span> bit<span class="op">;</span></span>
<span id="cb309-20"><a href="#cb309-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">&lt;</span> j<span class="op">)</span> swap<span class="op">(</span>a<span class="op">[</span>i<span class="op">],</span> a<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb309-21"><a href="#cb309-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb309-22"><a href="#cb309-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> len <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> len <span class="op">&lt;=</span> n<span class="op">;</span> len <span class="op">&lt;&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb309-23"><a href="#cb309-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> wlen <span class="op">=</span> modpow<span class="op">(</span>G<span class="op">,</span> <span class="op">(</span>MOD <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> len<span class="op">);</span></span>
<span id="cb309-24"><a href="#cb309-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>invert<span class="op">)</span> wlen <span class="op">=</span> modpow<span class="op">(</span>wlen<span class="op">,</span> MOD <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb309-25"><a href="#cb309-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">+=</span> len<span class="op">)</span> <span class="op">{</span></span>
<span id="cb309-26"><a href="#cb309-26" aria-hidden="true" tabindex="-1"></a>            <span class="dt">long</span> <span class="dt">long</span> w <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb309-27"><a href="#cb309-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb309-28"><a href="#cb309-28" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> u <span class="op">=</span> a<span class="op">[</span>i <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb309-29"><a href="#cb309-29" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> v <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)(</span>a<span class="op">[</span>i <span class="op">+</span> j <span class="op">+</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">]</span> <span class="op">*</span> w <span class="op">%</span> MOD<span class="op">);</span></span>
<span id="cb309-30"><a href="#cb309-30" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>i <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> u <span class="op">+</span> v <span class="op">&lt;</span> MOD <span class="op">?</span> u <span class="op">+</span> v <span class="op">:</span> u <span class="op">+</span> v <span class="op">-</span> MOD<span class="op">;</span></span>
<span id="cb309-31"><a href="#cb309-31" aria-hidden="true" tabindex="-1"></a>                a<span class="op">[</span>i <span class="op">+</span> j <span class="op">+</span> len <span class="op">/</span> <span class="dv">2</span><span class="op">]</span> <span class="op">=</span> u <span class="op">-</span> v <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> u <span class="op">-</span> v <span class="op">:</span> u <span class="op">-</span> v <span class="op">+</span> MOD<span class="op">;</span></span>
<span id="cb309-32"><a href="#cb309-32" aria-hidden="true" tabindex="-1"></a>                w <span class="op">=</span> w <span class="op">*</span> wlen <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb309-33"><a href="#cb309-33" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb309-34"><a href="#cb309-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb309-35"><a href="#cb309-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb309-36"><a href="#cb309-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>invert<span class="op">)</span> <span class="op">{</span></span>
<span id="cb309-37"><a href="#cb309-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> inv_n <span class="op">=</span> modpow<span class="op">(</span>n<span class="op">,</span> MOD <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb309-38"><a href="#cb309-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> <span class="op">&amp;</span>x <span class="op">:</span> a<span class="op">)</span> x <span class="op">=</span> <span class="dv">1</span><span class="bu">LL</span> <span class="op">*</span> x <span class="op">*</span> inv_n <span class="op">%</span> MOD<span class="op">;</span></span>
<span id="cb309-39"><a href="#cb309-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb309-40"><a href="#cb309-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="applications-7" class="level4">
<h4 class="anchored" data-anchor-id="applications-7">5. Applications</h4>
<ol type="1">
<li>Polynomial Multiplication: ( O<span class="math inline">\(n \log n\)</span> )</li>
<li>Convolution: digital signal processing</li>
<li>Big Integer Multiplication (Karatsuba, FFT)</li>
<li>Subset Convolution and combinatorial transforms</li>
<li>Number-theoretic sums (NTT-friendly modulus)</li>
</ol>
</section>
<section id="tiny-code-56" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-56">6. Tiny Code</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb310"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> A <span class="op">=</span> <span class="op">{</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">};</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> B <span class="op">=</span> <span class="op">{</span><span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">};</span></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Result = {4, 13, 28, 27, 18}</span></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> C <span class="op">=</span> multiply<span class="op">(</span>A<span class="op">,</span> B<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-17" class="level4">
<h4 class="anchored" data-anchor-id="summary-17">7. Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Domain</th>
<th>Complexity</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DFT</td>
<td>Complex</td>
<td>( O<span class="math inline">\(n^2\)</span> )</td>
<td>Naive</td>
</tr>
<tr class="even">
<td>FFT</td>
<td>Complex</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
<td>Recursive</td>
</tr>
<tr class="odd">
<td>NTT</td>
<td>Modular</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
<td>Integer arithmetic</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-56" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-56">Why It Matters</h4>
<p>FFT and NTT bring polynomial algebra to life. They turn slow convolutions into lightning-fast transforms. From multiplying huge integers to compressing signals, they’re the ultimate divide-and-conquer on structure.</p>
<blockquote class="blockquote">
<p>“To multiply polynomials fast, you first turn them into music , then back again.”</p>
</blockquote>
</section>
<section id="try-it-yourself-56" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-56">Try It Yourself</h4>
<ol type="1">
<li>Multiply (<span class="math inline">\(1 + 2x + 3x^2\)</span>) and (<span class="math inline">\(4 + 5x + 6x^2\)</span>) using FFT.</li>
<li>Implement NTT over 998244353 and verify results mod p.</li>
<li>Compare ( O<span class="math inline">\(n^2\)</span> ) vs FFT performance for n = 1024.</li>
<li>Experiment with inverse FFT (invert = true).</li>
<li>Explore circular convolution for signal data.</li>
</ol>
<p>Once you master FFT/NTT, you hold the power of speed in algebraic computation.</p>
</section>
</section>
<section id="numerical-methods-newton-simpson-runge-kutta" class="level3">
<h3 class="anchored" data-anchor-id="numerical-methods-newton-simpson-runge-kutta">58. Numerical Methods (Newton, Simpson, Runge-Kutta)</h3>
<p>Numerical methods let us approximate solutions when exact algebraic answers are hard or impossible. They are the foundation of scientific computing, simulation, and optimization , bridging the gap between continuous math and discrete computation.</p>
<p>In this section, we’ll explore three classics:</p>
<ul>
<li>Newton-Raphson: root finding- Simpson’s Rule: numerical integration- Runge-Kutta (RK4): solving differential equations These algorithms showcase how iteration, approximation, and convergence build powerful tools.</li>
</ul>
<section id="newton-raphson-method" class="level4">
<h4 class="anchored" data-anchor-id="newton-raphson-method">1. Newton-Raphson Method</h4>
<p>Used to find a root of ( f(x) = 0 ). Starting from a guess <span class="math inline">\(x_0\)</span>, iteratively refine:</p>
<p><span class="math display">\[
x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}
\]</span></p>
<p>Convergence is quadratic if ( f ) is smooth and <span class="math inline">\(x_0\)</span> is close enough.</p>
</section>
<section id="a.-example" class="level4">
<h4 class="anchored" data-anchor-id="a.-example">A. Example</h4>
<p>Solve ( f(x) = x^2 - 2 = 0 ) We know root = <span class="math inline">\(\sqrt{2}\)</span></p>
<p>Start <span class="math inline">\(x_0 = 1\)</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Iter</th>
<th><span class="math inline">\(x_n\)</span></th>
<th>(f<span class="math inline">\(x_n\)</span>)</th>
<th>(f’<span class="math inline">\(x_n\)</span>)</th>
<th><span class="math inline">\(x_{n+1}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.000</td>
<td>-1.000</td>
<td>2.000</td>
<td>1.500</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.500</td>
<td>0.250</td>
<td>3.000</td>
<td>1.417</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.417</td>
<td>0.006</td>
<td>2.834</td>
<td>1.414</td>
</tr>
</tbody>
</table>
<p>Converged: <span class="math inline">\(1.414 \approx \sqrt{2}\)</span></p>
</section>
<section id="b.-implementation-8" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-8">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb311"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x <span class="op">*</span> x <span class="op">-</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> df<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">2</span> <span class="op">*</span> x<span class="op">;</span> <span class="op">}</span></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> newton<span class="op">(</span><span class="dt">double</span> x0<span class="op">)</span> <span class="op">{</span></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">20</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> fx <span class="op">=</span> f<span class="op">(</span>x0<span class="op">);</span></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> dfx <span class="op">=</span> df<span class="op">(</span>x0<span class="op">);</span></span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>fx<span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-9</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x0 <span class="op">-</span> fx <span class="op">/</span> dfx<span class="op">;</span></span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x0<span class="op">;</span></span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Root: </span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> newton<span class="op">(</span><span class="fl">1.0</span><span class="op">));</span> <span class="co">// 1.414214</span></span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: ( O(k) ) iterations, each ( O(1) )</p>
</section>
<section id="simpsons-rule-numerical-integration" class="level4">
<h4 class="anchored" data-anchor-id="simpsons-rule-numerical-integration">2. Simpson’s Rule (Numerical Integration)</h4>
<p>When you can’t integrate ( f(x) ) analytically, approximate the area under the curve.</p>
<p>Divide interval ([a, b]) into even ( n ) subintervals (width ( h )).</p>
<p><span class="math display">\[
I \approx \frac{h}{3} \Big( f(a) + 4 \sum f(x_{odd}) + 2 \sum f(x_{even}) + f(b) \Big)
\]</span></p>
</section>
<section id="a.-implementation-2" class="level4">
<h4 class="anchored" data-anchor-id="a.-implementation-2">A. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb312"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x <span class="op">*</span> x<span class="op">;</span> <span class="op">}</span> <span class="co">// integrate x^2</span></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> simpson<span class="op">(</span><span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> h <span class="op">=</span> <span class="op">(</span>b <span class="op">-</span> a<span class="op">)</span> <span class="op">/</span> n<span class="op">;</span></span>
<span id="cb312-8"><a href="#cb312-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> s <span class="op">=</span> f<span class="op">(</span>a<span class="op">)</span> <span class="op">+</span> f<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb312-9"><a href="#cb312-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb312-10"><a href="#cb312-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> x <span class="op">=</span> a <span class="op">+</span> i <span class="op">*</span> h<span class="op">;</span></span>
<span id="cb312-11"><a href="#cb312-11" aria-hidden="true" tabindex="-1"></a>        s <span class="op">+=</span> f<span class="op">(</span>x<span class="op">)</span> <span class="op">*</span> <span class="op">(</span>i <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">2</span> <span class="op">:</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb312-12"><a href="#cb312-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb312-13"><a href="#cb312-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s <span class="op">*</span> h <span class="op">/</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb312-14"><a href="#cb312-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb312-15"><a href="#cb312-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-16"><a href="#cb312-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb312-17"><a href="#cb312-17" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"∫₀¹ x² dx ≈ </span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> simpson<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">));</span> <span class="co">// ~0.333333</span></span>
<span id="cb312-18"><a href="#cb312-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Accuracy: ( O<span class="math inline">\(h^4\)</span> ) Note: ( n ) must be even.</p>
</section>
<section id="b.-example-6" class="level4">
<h4 class="anchored" data-anchor-id="b.-example-6">B. Example</h4>
<p><span class="math display">\[
\int_0^1 x^2 dx = \frac{1}{3}
\]</span> With ( n = 100 ), Simpson gives ( 0.333333 ).</p>
</section>
<section id="runge-kutta-rk4" class="level4">
<h4 class="anchored" data-anchor-id="runge-kutta-rk4">3. Runge-Kutta (RK4)</h4>
<p>Used to solve first-order ODEs: <span class="math display">\[
y' = f(x, y), \quad y(x_0) = y_0
\]</span></p>
<p>RK4 Formula:</p>
<p><span class="math display">\[\begin{aligned}
k_1 &amp;= f(x_n, y_n) \
k_2 &amp;= f(x_n + \frac{h}{2}, y_n + \frac{h}{2}k_1) \
k_3 &amp;= f(x_n + \frac{h}{2}, y_n + \frac{h}{2}k_2) \
k_4 &amp;= f(x_n + h, y_n + hk_3) \
y_{n+1} &amp;= y_n + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)
\end{aligned}\]</span></p>
<p>Accuracy: ( O<span class="math inline">\(h^4\)</span> )</p>
</section>
<section id="a.-example-1" class="level4">
<h4 class="anchored" data-anchor-id="a.-example-1">A. Example</h4>
<p>Solve ( y’ = x + y ), ( y(0) = 1 ), step ( h = 0.1 ).</p>
<p>Each iteration refines ( y ) with weighted slope average.</p>
</section>
<section id="b.-implementation-9" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-9">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb313"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">+</span> y<span class="op">;</span></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> runge_kutta<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> y0<span class="op">,</span> <span class="dt">double</span> h<span class="op">,</span> <span class="dt">double</span> xn<span class="op">)</span> <span class="op">{</span></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x <span class="op">=</span> x0<span class="op">,</span> y <span class="op">=</span> y0<span class="op">;</span></span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>x <span class="op">&lt;</span> xn<span class="op">)</span> <span class="op">{</span></span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> k1 <span class="op">=</span> f<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> k2 <span class="op">=</span> f<span class="op">(</span>x <span class="op">+</span> h <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> y <span class="op">+</span> h <span class="op">*</span> k1 <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> k3 <span class="op">=</span> f<span class="op">(</span>x <span class="op">+</span> h <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> y <span class="op">+</span> h <span class="op">*</span> k2 <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> k4 <span class="op">=</span> f<span class="op">(</span>x <span class="op">+</span> h<span class="op">,</span> y <span class="op">+</span> h <span class="op">*</span> k3<span class="op">);</span></span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a>        y <span class="op">+=</span> h <span class="op">*</span> <span class="op">(</span>k1 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k2 <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>k3 <span class="op">+</span> k4<span class="op">)</span> <span class="op">/</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a>        x <span class="op">+=</span> h<span class="op">;</span></span>
<span id="cb313-16"><a href="#cb313-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb313-17"><a href="#cb313-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb313-18"><a href="#cb313-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb313-19"><a href="#cb313-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-20"><a href="#cb313-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb313-21"><a href="#cb313-21" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"y(0.1) ≈ </span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> runge_kutta<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">));</span></span>
<span id="cb313-22"><a href="#cb313-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="tiny-code-summary" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-summary">4. Tiny Code Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 15%">
<col style="width: 33%">
<col style="width: 11%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Purpose</th>
<th>Formula</th>
<th>Accuracy</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Newton-Raphson</td>
<td>Root finding</td>
<td><span class="math inline">\(x_{n+1}=x_n-\frac{f}{f'}\)</span></td>
<td>Quadratic</td>
<td>Iterative</td>
</tr>
<tr class="even">
<td>Simpson’s Rule</td>
<td>Integration</td>
<td>(h/3(…))</td>
<td>(O<span class="math inline">\(h^4\)</span>)</td>
<td>Deterministic</td>
</tr>
<tr class="odd">
<td>Runge-Kutta (RK4)</td>
<td>ODEs</td>
<td>Weighted slope avg</td>
<td>(O<span class="math inline">\(h^4\)</span>)</td>
<td>Iterative</td>
</tr>
</tbody>
</table>
</section>
<section id="numerical-stability" class="level4">
<h4 class="anchored" data-anchor-id="numerical-stability">5. Numerical Stability</h4>
<ul>
<li>Small step ( h ): better accuracy, more cost- Large ( h ): faster, less stable- Always check convergence (<span class="math inline">\(|x_{n+1} - x_n| &lt; \varepsilon\)</span>)- Avoid division by small derivatives in Newton’s method</li>
</ul>
</section>
<section id="why-it-matters-57" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-57">Why It Matters</h4>
<p>Numerical methods let computers simulate the continuous world. From physics to AI training, they solve what calculus cannot symbolically.</p>
<blockquote class="blockquote">
<p>“When equations won’t talk, iterate , and they’ll whisper their answers.”</p>
</blockquote>
</section>
<section id="try-it-yourself-57" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-57">Try It Yourself</h4>
<ol type="1">
<li>Use Newton’s method for <span class="math inline">\(\cos x - x = 0\)</span>.</li>
<li>Approximate <span class="math inline">\(\displaystyle \int_0^{\pi/2} \sin x\,dx\)</span> with Simpson’s rule.</li>
<li>Solve <span class="math inline">\(y' = y - x^2 + 1,\ y(0) = 0.5\)</span> using RK4.</li>
<li>Compare RK4 with Euler’s method for the same ODE.</li>
<li>Experiment with step sizes <span class="math inline">\(h \in \{0.1, 0.01, 0.001\}\)</span> and observe convergence.</li>
</ol>
<p>Numerical thinking turns continuous problems into iterative algorithms , precise enough to power every simulation and solver you’ll ever write.</p>
</section>
</section>
<section id="mathematical-optimization-simplex-gradient-convex" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-optimization-simplex-gradient-convex">59. Mathematical Optimization (Simplex, Gradient, Convex)</h3>
<p>Mathematical optimization is about finding the best solution , smallest cost, largest profit, shortest path , under given constraints. It’s the heart of machine learning, operations research, and engineering design.</p>
<p>In this section, we’ll explore three pillars:</p>
<ul>
<li>Simplex Method , for linear programs</li>
<li>Gradient Descent , for continuous optimization</li>
<li>Convex Optimization , the theory ensuring global optima</li>
</ul>
<section id="what-is-optimization" class="level4">
<h4 class="anchored" data-anchor-id="what-is-optimization">1. What Is Optimization?</h4>
<p>A general optimization problem looks like:</p>
<p><span class="math display">\[
\min_x \ f(x)
\]</span> subject to constraints: <span class="math display">\[
g_i(x) \le 0, \quad h_j(x) = 0
\]</span></p>
<p>When ( f ) and <span class="math inline">\(g_i, h_j\)</span> are linear, it’s a Linear Program (LP). When ( f ) is differentiable, we can use gradients. When ( f ) is convex, every local minimum is global , the ideal world.</p>
</section>
<section id="the-simplex-method-linear-programming" class="level4">
<h4 class="anchored" data-anchor-id="the-simplex-method-linear-programming">2. The Simplex Method (Linear Programming)</h4>
<p>A linear program has the form:</p>
<p><span class="math display">\[
\max \ c^T x
\]</span> subject to <span class="math display">\[
A x \le b, \quad x \ge 0
\]</span></p>
<p>Geometrically, each constraint forms a half-space. The feasible region is a convex polytope, and the optimum lies at a vertex.</p>
</section>
<section id="a.-example-2" class="level4">
<h4 class="anchored" data-anchor-id="a.-example-2">A. Example</h4>
<p>Maximize ( z = 3x + 2y ) subject to <span class="math display">\[\begin{cases}
2x + y \le 18 \
2x + 3y \le 42 \
x, y \ge 0
\end{cases}\]</span></p>
<p>Solution: ( x=9, y=8 ), ( z=43 )</p>
</section>
<section id="b.-algorithm-sketch" class="level4">
<h4 class="anchored" data-anchor-id="b.-algorithm-sketch">B. Algorithm (Sketch)</h4>
<ol type="1">
<li><p>Convert inequalities to equalities by adding slack variables.</p></li>
<li><p>Initialize at a vertex (basic feasible solution).</p></li>
<li><p>At each step:</p>
<ul>
<li>Choose entering variable (most negative coefficient in objective). - Choose leaving variable (min ratio test). - Pivot to new vertex.4. Repeat until optimal.</li>
</ul></li>
</ol>
</section>
<section id="c.-implementation-simplified-pseudocode" class="level4">
<h4 class="anchored" data-anchor-id="c.-implementation-simplified-pseudocode">C. Implementation (Simplified Pseudocode)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb314"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Basic simplex-like outline</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>exists negative coefficient in objective row<span class="op">)</span> <span class="op">{</span></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>    choose entering column j<span class="op">;</span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>    choose leaving row i <span class="op">(</span>min b<span class="op">[</span>i<span class="op">]/</span>a<span class="op">[</span>i<span class="op">][</span>j<span class="op">]);</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>    pivot<span class="op">(</span>i<span class="op">,</span> j<span class="op">);</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Libraries (like <code>GLPK</code> or <code>Eigen</code>) handle full implementations.</p>
<p>Time Complexity: worst ( O<span class="math inline">\(2^n\)</span> ), but fast in practice.</p>
</section>
<section id="gradient-descent" class="level4">
<h4 class="anchored" data-anchor-id="gradient-descent">3. Gradient Descent</h4>
<p>For differentiable ( f(x) ), we move opposite the gradient:</p>
<p><span class="math display">\[
x_{k+1} = x_k - \eta \nabla f(x_k)
\]</span></p>
<p>where <span class="math inline">\(\eta\)</span> is the learning rate.</p>
<p>Intuition: ( f(x) ) points uphill, so step opposite it.</p>
</section>
<section id="a.-example-3" class="level4">
<h4 class="anchored" data-anchor-id="a.-example-3">A. Example</h4>
<p>Minimize ( f(x) = (x-3)^2 )</p>
<p><span class="math display">\[
f'(x) = 2(x-3)
\]</span></p>
<p>Start <span class="math inline">\(x_0 = 0\)</span>, <span class="math inline">\(\eta = 0.1\)</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Iter</th>
<th><span class="math inline">\(x_k\)</span></th>
<th>(f<span class="math inline">\(x_k\)</span>)</th>
<th>Gradient</th>
<th>New (x)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>9</td>
<td>-6</td>
<td>0.6</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.6</td>
<td>5.76</td>
<td>-4.8</td>
<td>1.08</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.08</td>
<td>3.69</td>
<td>-3.84</td>
<td>1.46</td>
</tr>
<tr class="even">
<td>…</td>
<td>→3</td>
<td>→0</td>
<td>→0</td>
<td>→3</td>
</tr>
</tbody>
</table>
<p>Converges to ( x = 3 )</p>
</section>
<section id="b.-implementation-10" class="level4">
<h4 class="anchored" data-anchor-id="b.-implementation-10">B. Implementation</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb315"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>x <span class="op">-</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span>x <span class="op">-</span> <span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> df<span class="op">(</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="dv">2</span> <span class="op">*</span> <span class="op">(</span>x <span class="op">-</span> <span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> gradient_descent<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span> <span class="dt">double</span> lr<span class="op">)</span> <span class="op">{</span></span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">100</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> g <span class="op">=</span> df<span class="op">(</span>x0<span class="op">);</span></span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>fabs<span class="op">(</span>g<span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-6</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb315-11"><a href="#cb315-11" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">-=</span> lr <span class="op">*</span> g<span class="op">;</span></span>
<span id="cb315-12"><a href="#cb315-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb315-13"><a href="#cb315-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x0<span class="op">;</span></span>
<span id="cb315-14"><a href="#cb315-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb315-15"><a href="#cb315-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-16"><a href="#cb315-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb315-17"><a href="#cb315-17" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Min at x = </span><span class="sc">%.6f\n</span><span class="st">"</span><span class="op">,</span> gradient_descent<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">));</span></span>
<span id="cb315-18"><a href="#cb315-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="c.-variants" class="level4">
<h4 class="anchored" data-anchor-id="c.-variants">C. Variants</h4>
<ul>
<li>Momentum: ( v = v + <span class="math inline">\(1-\beta\)</span>f(x) )- Adam: adaptive learning rates- Stochastic Gradient Descent (SGD): random subset of data All used heavily in machine learning.</li>
</ul>
</section>
<section id="convex-optimization" class="level4">
<h4 class="anchored" data-anchor-id="convex-optimization">4. Convex Optimization</h4>
<p>A function ( f ) is convex if: <span class="math display">\[
f(\lambda x + (1-\lambda)y) \le \lambda f(x) + (1-\lambda)f(y)
\]</span></p>
<p>This means any local minimum is global.</p>
<p>Examples:</p>
<ul>
<li>( f(x) = x^2 ) (convex)- ( f(x) = x^3 ) (not convex) For convex functions with linear constraints, gradient-based methods always converge to the global optimum.</li>
</ul>
</section>
<section id="a.-checking-convexity" class="level4">
<h4 class="anchored" data-anchor-id="a.-checking-convexity">A. Checking Convexity</h4>
<ul>
<li>1D: ( f’’(x) )- Multivariate: Hessian ( ^2 f(x) ) is positive semidefinite</li>
</ul>
</section>
<section id="applications-8" class="level4">
<h4 class="anchored" data-anchor-id="applications-8">5. Applications</h4>
<ul>
<li>Linear Programming (Simplex): logistics, scheduling- Quadratic Programming: portfolio optimization- Gradient Methods: ML, curve fitting- Convex Programs: control systems, regularization</li>
</ul>
</section>
<section id="tiny-code-57" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-57">6. Tiny Code</h4>
<p>Simple gradient descent to minimize ( f(x,y)=x<sup>2+y</sup>2 ):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb316"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> f<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x<span class="op">*</span>x <span class="op">+</span> y<span class="op">*</span>y<span class="op">;</span> <span class="op">}</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> grad<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> y<span class="op">,</span> <span class="dt">double</span> <span class="op">*</span>gx<span class="op">,</span> <span class="dt">double</span> <span class="op">*</span>gy<span class="op">)</span> <span class="op">{</span></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>gx <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x<span class="op">;</span> <span class="op">*</span>gy <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>y<span class="op">;</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> optimize<span class="op">()</span> <span class="op">{</span></span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x<span class="op">=</span><span class="dv">5</span><span class="op">,</span> y<span class="op">=</span><span class="dv">3</span><span class="op">,</span> lr<span class="op">=</span><span class="fl">0.1</span><span class="op">;</span></span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span><span class="dv">100</span><span class="op">;</span> i<span class="op">++){</span></span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> gx<span class="op">,</span> gy<span class="op">;</span></span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true" tabindex="-1"></a>        grad<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="op">&amp;</span>gx<span class="op">,</span> <span class="op">&amp;</span>gy<span class="op">);</span></span>
<span id="cb316-11"><a href="#cb316-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">-=</span> lr <span class="op">*</span> gx<span class="op">;</span></span>
<span id="cb316-12"><a href="#cb316-12" aria-hidden="true" tabindex="-1"></a>        y <span class="op">-=</span> lr <span class="op">*</span> gy<span class="op">;</span></span>
<span id="cb316-13"><a href="#cb316-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb316-14"><a href="#cb316-14" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"Min at (</span><span class="sc">%.3f</span><span class="st">, </span><span class="sc">%.3f</span><span class="st">)</span><span class="sc">\n</span><span class="st">"</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb316-15"><a href="#cb316-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-18" class="level4">
<h4 class="anchored" data-anchor-id="summary-18">7. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 12%">
<col style="width: 36%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Domain</th>
<th>Complexity</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Simplex</td>
<td>Linear</td>
<td>Polynomial (average case)</td>
<td>LP solver</td>
</tr>
<tr class="even">
<td>Gradient Descent</td>
<td>Continuous</td>
<td><span class="math inline">\(O(k)\)</span></td>
<td>Needs step size</td>
</tr>
<tr class="odd">
<td>Convex Methods</td>
<td>Convex</td>
<td><span class="math inline">\(O(k \log \frac{1}{\varepsilon})\)</span></td>
<td>Global optima guaranteed</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-58" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-58">Why It Matters</h4>
<p>Optimization turns math into decisions. From fitting curves to planning resources, it formalizes trade-offs and efficiency. It’s where computation meets purpose , finding the best in all possible worlds.</p>
<blockquote class="blockquote">
<p>“Every algorithm is, at heart, an optimizer , searching for something better.”</p>
</blockquote>
</section>
<section id="try-it-yourself-58" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-58">Try It Yourself</h4>
<ol type="1">
<li>Solve a linear program with 2 constraints manually via Simplex.</li>
<li>Implement gradient descent for <span class="math inline">\(f(x) = (x - 5)^2 + 2\)</span>.</li>
<li>Add momentum to your gradient descent loop.</li>
<li>Check convexity by plotting <span class="math inline">\(f(x) = x^4 - 3x^2\)</span>.</li>
<li>Experiment with learning rates: too small leads to slow convergence; too large can diverge.</li>
</ol>
<p>Mastering optimization means mastering how algorithms improve themselves , step by step, iteration by iteration.</p>
</section>
</section>
<section id="algebraic-tricks-and-transform-techniques" class="level3">
<h3 class="anchored" data-anchor-id="algebraic-tricks-and-transform-techniques">60. Algebraic Tricks and Transform Techniques</h3>
<p>In algorithm design, algebra isn’t just theory , it’s a toolbox for transforming problems. By expressing computations algebraically, we can simplify, accelerate, or generalize solutions. This section surveys common algebraic techniques that turn hard problems into manageable ones.</p>
<p>We’ll explore:</p>
<ul>
<li>Algebraic identities and factorizations</li>
<li>Generating functions and transforms</li>
<li>Convolution tricks</li>
<li>Polynomial methods and FFT applications</li>
<li>Matrix and linear transforms for acceleration</li>
</ul>
<section id="algebraic-identities" class="level4">
<h4 class="anchored" data-anchor-id="algebraic-identities">1. Algebraic Identities</h4>
<p>These let you rewrite or decompose expressions to reveal structure or reduce complexity.</p>
<p>Classic Forms:</p>
<ul>
<li>Difference of squares: <span class="math display">\[
a^2 - b^2 = (a-b)(a+b)
\]</span></li>
<li>Sum of cubes: <span class="math display">\[
a^3 + b^3 = (a+b)(a^2 - ab + b^2)
\]</span></li>
<li>Square of sum: <span class="math display">\[
(a+b)^2 = a^2 + 2ab + b^2
\]</span></li>
</ul>
<p>Used in dynamic programming, geometry, and optimization when simplifying recurrence terms or constraints.</p>
<p>Example: Transforming <span class="math inline">\((x+y)^2\)</span> lets you compute both <span class="math inline">\(x^2 + y^2\)</span> and cross terms efficiently.</p>
</section>
<section id="generating-functions" class="level4">
<h4 class="anchored" data-anchor-id="generating-functions">2. Generating Functions</h4>
<p>A generating function encodes a sequence <span class="math inline">\(a_0, a_1, a_2, \ldots\)</span> into a formal power series:</p>
<p><span class="math display">\[
G(x) = a_0 + a_1x + a_2x^2 + \ldots
\]</span></p>
<p>They turn recurrence relations and counting problems into algebraic equations.</p>
<p>Example: Fibonacci sequence <span class="math display">\[
F(x) = F_0 + F_1x + F_2x^2 + \ldots
\]</span> with recurrence <span class="math inline">\(F_n = F_{n-1} + F_{n-2}\)</span></p>
<p>Solve algebraically: <span class="math display">\[
F(x) = \frac{x}{1 - x - x^2}
\]</span></p>
<p>Applications: combinatorics, probability, counting partitions.</p>
</section>
<section id="convolution-tricks" class="level4">
<h4 class="anchored" data-anchor-id="convolution-tricks">3. Convolution Tricks</h4>
<p>Convolution arises in combining sequences: <span class="math display">\[
(c_n) = (a * b)*n = \sum*{i=0}^{n} a_i b_{n-i}
\]</span></p>
<p>Naive computation: ( O<span class="math inline">\(n^2\)</span> ) Using Fast Fourier Transform (FFT): ( O<span class="math inline">\(n \log n\)</span> )</p>
<p>Example: Polynomial multiplication Let <span class="math display">\[
A(x) = a_0 + a_1x + a_2x^2, \quad B(x) = b_0 + b_1x + b_2x^2
\]</span> Then ( C(x) = A(x)B(x) ) gives coefficients by convolution.</p>
<p>This trick is used in:</p>
<ul>
<li>Large integer multiplication- Pattern matching (cross-correlation)- Subset sum acceleration</li>
</ul>
</section>
<section id="polynomial-methods" class="level4">
<h4 class="anchored" data-anchor-id="polynomial-methods">4. Polynomial Methods</h4>
<p>Many algorithmic problems can be represented as polynomials, where coefficients encode combinatorial structure.</p>
</section>
<section id="a.-polynomial-interpolation" class="level4">
<h4 class="anchored" data-anchor-id="a.-polynomial-interpolation">A. Polynomial Interpolation</h4>
<p>Given ( n+1 ) points, there’s a unique degree-( n ) polynomial passing through them.</p>
<p>Used in error correction, FFT-based reconstruction, and number-theoretic transforms.</p>
<p>Lagrange Interpolation: <span class="math display">\[
P(x) = \sum_i y_i \prod_{j \ne i} \frac{x - x_j}{x_i - x_j}
\]</span></p>
</section>
<section id="b.-root-representation" class="level4">
<h4 class="anchored" data-anchor-id="b.-root-representation">B. Root Representation</h4>
<p>Solve equations or check identities by working modulo a polynomial. Used in finite fields and coding theory (e.g., Reed-Solomon).</p>
</section>
<section id="transform-techniques" class="level4">
<h4 class="anchored" data-anchor-id="transform-techniques">5. Transform Techniques</h4>
<p>Transforms convert problems to simpler domains where operations become efficient.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 20%">
<col style="width: 28%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Transform</th>
<th>Converts</th>
<th>Key Property</th>
<th>Used In</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FFT / NTT</td>
<td>Time ↔︎ Frequency</td>
<td>Convolution → Multiplication</td>
<td>Signal, polynomial mult</td>
</tr>
<tr class="even">
<td>Z-Transform</td>
<td>Sequence ↔︎ Function</td>
<td>Recurrence solving</td>
<td>DSP, control</td>
</tr>
<tr class="odd">
<td>Laplace Transform</td>
<td>Function ↔︎ Algebraic</td>
<td>Diff. eq. → Algebraic eq.</td>
<td>Continuous systems</td>
</tr>
<tr class="even">
<td>Walsh-Hadamard Transform</td>
<td>Boolean vectors</td>
<td>XOR convolution</td>
<td>Subset sum, SOS DP</td>
</tr>
</tbody>
</table>
<p>Example: Subset Convolution via FWT</p>
<p>For all subsets ( S ): <span class="math display">\[
f'(S) = \sum_{T \subseteq S} f(T)
\]</span></p>
<p>Use Fast Walsh-Hadamard Transform (FWHT) to compute in ( O<span class="math inline">\(n2^n\)</span> ) instead of ( O<span class="math inline">\(3^n\)</span> ).</p>
</section>
<section id="matrix-tricks" class="level4">
<h4 class="anchored" data-anchor-id="matrix-tricks">6. Matrix Tricks</h4>
<p>Matrix algebra enables transformations and compact formulations.</p>
<ul>
<li>Matrix exponentiation: solve recurrences in <span class="math inline">\(O(\log n)\)</span></li>
<li>Diagonalization: <span class="math inline">\(A = P D P^{-1}\)</span>, then <span class="math inline">\(A^k = P D^k P^{-1}\)</span></li>
<li>Fast power: speeds up Fibonacci, linear recurrences, Markov chains</li>
</ul>
<p>Example: Fibonacci</p>
<p><span class="math display">\[
\begin{bmatrix}
F_{n+1} \\
F_n
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 1 \\
1 &amp; 0
\end{bmatrix}^n
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\]</span></p>
</section>
<section id="tiny-code-58" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-58">7. Tiny Code</h4>
<p>Polynomial Multiplication via FFT (Pseudo-C):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb317"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Outline using complex FFT library</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>fft<span class="op">(</span>A<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>fft<span class="op">(</span>B<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>    C<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> B<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>fft<span class="op">(</span>C<span class="op">,</span> <span class="kw">true</span><span class="op">);</span> <span class="co">// inverse</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Matrix Power (Fibonacci):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb318"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> matmul<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> A<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">],</span> <span class="dt">long</span> <span class="dt">long</span> B<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> C<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">0</span><span class="op">}};</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span><span class="dv">2</span><span class="op">;</span>i<span class="op">++)</span></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span><span class="dv">2</span><span class="op">;</span>j<span class="op">++)</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k<span class="op">=</span><span class="dv">0</span><span class="op">;</span>k<span class="op">&lt;</span><span class="dv">2</span><span class="op">;</span>k<span class="op">++)</span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>                C<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">+=</span> A<span class="op">[</span>i<span class="op">][</span>k<span class="op">]*</span>B<span class="op">[</span>k<span class="op">][</span>j<span class="op">];</span></span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a>    memcpy<span class="op">(</span>A<span class="op">,</span> C<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>C<span class="op">));</span></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> matpow<span class="op">(</span><span class="dt">long</span> <span class="dt">long</span> A<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">long</span> <span class="dt">long</span> R<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">{{</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">},{</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">}};</span></span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>n<span class="op">){</span></span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>n<span class="op">&amp;</span><span class="dv">1</span><span class="op">)</span> matmul<span class="op">(</span>R<span class="op">,</span>A<span class="op">);</span></span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a>        matmul<span class="op">(</span>A<span class="op">,</span>A<span class="op">);</span></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a>        n<span class="op">&gt;&gt;=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a>    memcpy<span class="op">(</span>A<span class="op">,</span> R<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>R<span class="op">));</span></span>
<span id="cb318-18"><a href="#cb318-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-19" class="level4">
<h4 class="anchored" data-anchor-id="summary-19">8. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 30%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Technique</th>
<th>Purpose</th>
<th>Speedup</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Algebraic Identities</td>
<td>Simplify expressions</td>
<td>Constant factor</td>
</tr>
<tr class="even">
<td>Generating Functions</td>
<td>Solve recurrences</td>
<td>Conceptual</td>
</tr>
<tr class="odd">
<td>FFT / Convolution</td>
<td>Combine sequences fast</td>
<td>(O<span class="math inline">\(n^2\)</span> O<span class="math inline">\(n \log n\)</span>)</td>
</tr>
<tr class="even">
<td>Polynomial Interpolation</td>
<td>Reconstruction</td>
<td>(O<span class="math inline">\(n^2\)</span> O<span class="math inline">\(n \log^2 n\)</span>)</td>
</tr>
<tr class="odd">
<td>Matrix Tricks</td>
<td>Accelerate recurrences</td>
<td>(O(n) O<span class="math inline">\(\log n\)</span>)</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-59" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-59">Why It Matters</h4>
<p>Algebra turns computation into structure. By rewriting problems in algebraic form, you reveal hidden symmetries, exploit fast transforms, and find elegant solutions. It’s not magic , it’s the math beneath performance.</p>
<blockquote class="blockquote">
<p>“The smartest code is often the one that solves itself on paper first.”</p>
</blockquote>
</section>
<section id="try-it-yourself-59" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-59">Try It Yourself</h4>
<ol type="1">
<li>Multiply two polynomials using FFT.</li>
<li>Represent Fibonacci as a matrix and compute <span class="math inline">\(F_{100}\)</span>.</li>
<li>Use generating functions to count coin change ways.</li>
<li>Implement subset sum via Walsh-Hadamard transform.</li>
<li>Derive a recurrence and solve it algebraically.</li>
</ol>
<p>Understanding algebraic tricks makes you not just a coder, but a mathematical engineer , bending structure to will.</p>
</section>
</section>
</section>
<section id="chapter-7.-strings-and-text-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="chapter-7.-strings-and-text-algorithms">Chapter 7. Strings and Text Algorithms</h2>
<section id="string-matching-kmp-z-rabin-karp-boyer-moore" class="level3">
<h3 class="anchored" data-anchor-id="string-matching-kmp-z-rabin-karp-boyer-moore">61. String Matching (KMP, Z, Rabin-Karp, Boyer-Moore)</h3>
<p>String matching is one of the oldest and most fundamental problems in computer science: given a text ( T ) of length ( n ) and a pattern ( P ) of length ( m ), find all positions where ( P ) appears in ( T ).</p>
<p>This section walks you through both naive and efficient algorithms , from the straightforward brute-force method to elegant linear-time solutions like KMP and Z-algorithm, and clever heuristics like Boyer-Moore and Rabin-Karp.</p>
<section id="problem-setup" class="level4">
<h4 class="anchored" data-anchor-id="problem-setup">1. Problem Setup</h4>
<p>We’re given:</p>
<ul>
<li>Text: <span class="math inline">\(T = t_1 t_2 \ldots t_n\)</span>- Pattern: <span class="math inline">\(P = p_1 p_2 \ldots p_m\)</span> Goal: find all ( i ) such that <span class="math display">\[
T[i \ldots i+m-1] = P[1 \ldots m]
\]</span></li>
</ul>
<p>Naive solution: compare ( P ) with every substring of ( T ) Time complexity: ( O(nm) )</p>
<p>We’ll now see how to reduce it to ( O(n + m) ) or close.</p>
</section>
<section id="knuth-morris-pratt-kmp" class="level4">
<h4 class="anchored" data-anchor-id="knuth-morris-pratt-kmp">2. Knuth-Morris-Pratt (KMP)</h4>
<p>KMP avoids rechecking characters by precomputing overlaps within the pattern.</p>
<p>It builds a prefix-function (also called failure function), which tells how much to shift when a mismatch happens.</p>
</section>
<section id="a.-prefix-function" class="level4">
<h4 class="anchored" data-anchor-id="a.-prefix-function">A. Prefix Function</h4>
<p>For each position ( i ), compute <span class="math inline">\(\pi[i]\)</span> = length of longest prefix that’s also a suffix of ( P[1..i] ).</p>
<p>Example: Pattern <code>ababc</code></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th>P[i]</th>
<th>π[i]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>a</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>b</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>a</td>
<td>1</td>
</tr>
<tr class="even">
<td>4</td>
<td>b</td>
<td>2</td>
</tr>
<tr class="odd">
<td>5</td>
<td>c</td>
<td>0</td>
</tr>
</tbody>
</table>
</section>
<section id="b.-search-phase" class="level4">
<h4 class="anchored" data-anchor-id="b.-search-phase">B. Search Phase</h4>
<p>Use <span class="math inline">\(\pi[]\)</span> to skip mismatched prefixes in the text.</p>
<p>Time Complexity: ( O(n + m) ) Space: ( O(m) )</p>
<p>Tiny Code (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb319"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> compute_pi<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>p<span class="op">,</span> <span class="dt">int</span> m<span class="op">,</span> <span class="dt">int</span> pi<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>    pi<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>k <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> p<span class="op">[</span>k<span class="op">]</span> <span class="op">!=</span> p<span class="op">[</span>i<span class="op">])</span> k <span class="op">=</span> pi<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>p<span class="op">[</span>k<span class="op">]</span> <span class="op">==</span> p<span class="op">[</span>i<span class="op">])</span> k<span class="op">++;</span></span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a>        pi<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> k<span class="op">;</span></span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> kmp_search<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>t<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> strlen<span class="op">(</span>t<span class="op">),</span> m <span class="op">=</span> strlen<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pi<span class="op">[</span>m<span class="op">];</span> compute_pi<span class="op">(</span>p<span class="op">,</span> m<span class="op">,</span> pi<span class="op">);</span></span>
<span id="cb319-13"><a href="#cb319-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb319-14"><a href="#cb319-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>k <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> p<span class="op">[</span>k<span class="op">]</span> <span class="op">!=</span> t<span class="op">[</span>i<span class="op">])</span> k <span class="op">=</span> pi<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb319-15"><a href="#cb319-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>p<span class="op">[</span>k<span class="op">]</span> <span class="op">==</span> t<span class="op">[</span>i<span class="op">])</span> k<span class="op">++;</span></span>
<span id="cb319-16"><a href="#cb319-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>k <span class="op">==</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb319-17"><a href="#cb319-17" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">"Found at </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> i <span class="op">-</span> m <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb319-18"><a href="#cb319-18" aria-hidden="true" tabindex="-1"></a>            k <span class="op">=</span> pi<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb319-19"><a href="#cb319-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb319-20"><a href="#cb319-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb319-21"><a href="#cb319-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="z-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="z-algorithm">3. Z-Algorithm</h4>
<p>Z-algorithm computes the Z-array,<br>
where <span class="math inline">\(Z[i]\)</span> = length of the longest substring starting at <span class="math inline">\(i\)</span> that matches the prefix of <span class="math inline">\(P\)</span>.</p>
<p>To match <span class="math inline">\(P\)</span> in <span class="math inline">\(T\)</span>, build the string:</p>
<p><span class="math display">\[
S = P + \# + T
\]</span></p>
<p>Then every <span class="math inline">\(i\)</span> where <span class="math inline">\(Z[i] = |P|\)</span> corresponds to a match.</p>
<p>Time: <span class="math inline">\(O(n + m)\)</span><br>
Simple and elegant.</p>
<p>Example:</p>
<pre><code>P = "aba", T = "ababa"
S = "aba#ababa"
Z = [0,0,1,0,3,0,1,0]
Match at index 0, 2</code></pre>
</section>
<section id="rabin-karp-rolling-hash" class="level4">
<h4 class="anchored" data-anchor-id="rabin-karp-rolling-hash">4. Rabin-Karp (Rolling Hash)</h4>
<p>Instead of comparing strings character-by-character, compute a hash for each window in ( T ), and compare hashes.</p>
<p><span class="math display">\[
h(s_1s_2\ldots s_m) = (s_1b^{m-1} + s_2b^{m-2} + \ldots + s_m) \bmod M
\]</span></p>
<p>Use a rolling hash to update in ( O(1) ) per shift.</p>
<p>Time: average ( O(n + m) ), worst ( O(nm) ) Good for multiple pattern search.</p>
<p>Tiny Code (Rolling Hash)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb321"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define B </span><span class="dv">256</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define M </span><span class="dv">101</span></span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> rabin_karp<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>t<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> strlen<span class="op">(</span>t<span class="op">),</span> m <span class="op">=</span> strlen<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> h <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> pHash <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> tHash <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">-</span><span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span> h <span class="op">=</span> <span class="op">(</span>h<span class="op">*</span>B<span class="op">)</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true" tabindex="-1"></a>        pHash <span class="op">=</span> <span class="op">(</span>B<span class="op">*</span>pHash <span class="op">+</span> p<span class="op">[</span>i<span class="op">])</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb321-10"><a href="#cb321-10" aria-hidden="true" tabindex="-1"></a>        tHash <span class="op">=</span> <span class="op">(</span>B<span class="op">*</span>tHash <span class="op">+</span> t<span class="op">[</span>i<span class="op">])</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb321-11"><a href="#cb321-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb321-12"><a href="#cb321-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">-</span>m<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb321-13"><a href="#cb321-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>pHash <span class="op">==</span> tHash <span class="op">&amp;&amp;</span> strncmp<span class="op">(&amp;</span>t<span class="op">[</span>i<span class="op">],</span> p<span class="op">,</span> m<span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb321-14"><a href="#cb321-14" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">"Found at </span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> i<span class="op">);</span></span>
<span id="cb321-15"><a href="#cb321-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">&lt;</span> n<span class="op">-</span>m<span class="op">)</span></span>
<span id="cb321-16"><a href="#cb321-16" aria-hidden="true" tabindex="-1"></a>            tHash <span class="op">=</span> <span class="op">(</span>B<span class="op">*(</span>tHash <span class="op">-</span> t<span class="op">[</span>i<span class="op">]*</span>h<span class="op">)</span> <span class="op">+</span> t<span class="op">[</span>i<span class="op">+</span>m<span class="op">])</span> <span class="op">%</span> M<span class="op">;</span></span>
<span id="cb321-17"><a href="#cb321-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>tHash <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> tHash <span class="op">+=</span> M<span class="op">;</span></span>
<span id="cb321-18"><a href="#cb321-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb321-19"><a href="#cb321-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="boyer-moore-heuristic-skipping" class="level4">
<h4 class="anchored" data-anchor-id="boyer-moore-heuristic-skipping">5. Boyer-Moore (Heuristic Skipping)</h4>
<p>Boyer-Moore compares from right to left and uses two heuristics:</p>
<ol type="1">
<li><p>Bad Character Rule When mismatch at ( j ), shift pattern so next occurrence of ( T[i] ) in ( P ) aligns.</p></li>
<li><p>Good Suffix Rule Shift pattern so a suffix of matched portion aligns with another occurrence.</p></li>
</ol>
<p>Time: ( O(n/m) ) on average Practical and fast, especially for English text.</p>
</section>
<section id="summary-20" class="level4">
<h4 class="anchored" data-anchor-id="summary-20">6. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 19%">
<col style="width: 26%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Time</th>
<th>Space</th>
<th>Idea</th>
<th>Best For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Naive</td>
<td>(O(nm))</td>
<td>(O(1))</td>
<td>Direct compare</td>
<td>Simple cases</td>
</tr>
<tr class="even">
<td>KMP</td>
<td>(O(n+m))</td>
<td>(O(m))</td>
<td>Prefix overlap</td>
<td>General use</td>
</tr>
<tr class="odd">
<td>Z</td>
<td>(O(n+m))</td>
<td>(O(n+m))</td>
<td>Prefix matching</td>
<td>Pattern prep</td>
</tr>
<tr class="even">
<td>Rabin-Karp</td>
<td>(O(n+m)) avg</td>
<td>(O(1))</td>
<td>Hashing</td>
<td>Multi-pattern</td>
</tr>
<tr class="odd">
<td>Boyer-Moore</td>
<td>(O(n/m)) avg</td>
<td>(O<span class="math inline">\(m+\sigma\)</span>)</td>
<td>Right-to-left skip</td>
<td>Long texts</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-60" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-60">Why It Matters</h4>
<p>String matching powers text editors, DNA search, spam filters, and search engines. These algorithms show how structure and clever preprocessing turn brute force into elegance.</p>
<blockquote class="blockquote">
<p>“To find is human, to match efficiently is divine.”</p>
</blockquote>
</section>
<section id="try-it-yourself-60" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-60">Try It Yourself</h4>
<ol type="1">
<li>Implement KMP and print all matches in a sentence.</li>
<li>Use Rabin-Karp to find multiple keywords.</li>
<li>Compare running times on large text files.</li>
<li>Modify KMP for case-insensitive matching.</li>
<li>Visualize prefix function computation step-by-step.</li>
</ol>
<p>By mastering these, you’ll wield the foundation of pattern discovery , the art of finding order in streams of symbols.</p>
</section>
</section>
<section id="multi-pattern-search-aho-corasick" class="level3">
<h3 class="anchored" data-anchor-id="multi-pattern-search-aho-corasick">62. Multi-Pattern Search (Aho-Corasick)</h3>
<p>So far, we’ve matched one pattern against a text. But what if we have many patterns , say, a dictionary of keywords , and we want to find all occurrences of all patterns in a single pass?</p>
<p>That’s where the Aho-Corasick algorithm shines. It builds a trie with failure links, turning multiple patterns into one efficient automaton. Think of it as “KMP for many words at once.”</p>
<section id="problem-setup-1" class="level4">
<h4 class="anchored" data-anchor-id="problem-setup-1">1. Problem Setup</h4>
<p>Given:</p>
<ul>
<li>A text ( T ) of length ( n )- A set of patterns <span class="math inline">\({ P_1, P_2, \ldots, P_k }\)</span> with total length <span class="math inline">\(m = \sum |P_i|\)</span></li>
</ul>
<p>Goal: find all occurrences of every <span class="math inline">\(P_i\)</span> in ( T ).</p>
<p>Naive solution: Run KMP for each pattern , ( O(kn) )</p>
<p>Better idea: Merge all patterns into a trie, and use failure links to transition on mismatches.</p>
<p>Aho-Corasick achieves O(n + m + z), where ( z ) = number of matches reported.</p>
</section>
<section id="trie-construction" class="level4">
<h4 class="anchored" data-anchor-id="trie-construction">2. Trie Construction</h4>
<p>Each pattern is inserted into a trie node-by-node.</p>
<p>Example Patterns:</p>
<pre><code>he, she, his, hers</code></pre>
<p>Trie:</p>
<pre><code>(root)
 ├─ h ─ e*
 │   └─ r ─ s*
 ├─ s ─ h ─ e*
 └─ h ─ i ─ s*</code></pre>
<p>Each node may mark an output (end of pattern).</p>
</section>
<section id="failure-links" class="level4">
<h4 class="anchored" data-anchor-id="failure-links">3. Failure Links</h4>
<p>Failure link of a node points to the longest proper suffix that’s also a prefix in the trie.</p>
<p>These links let us “fall back” like KMP.</p>
<p>When mismatch happens, follow failure link to find next possible match.</p>
</section>
<section id="building-failure-links-bfs" class="level4">
<h4 class="anchored" data-anchor-id="building-failure-links-bfs">Building Failure Links (BFS)</h4>
<ol type="1">
<li><p>Root’s failure = null</p></li>
<li><p>Children of root → failure = root</p></li>
<li><p>BFS over nodes:</p>
<ul>
<li>For each edge ( (u, c) → v ): follow failure links from ( u ) until you find ( f ) with edge ( c ) then <span class="math inline">\(v.\text{fail} = f.c\)</span></li>
</ul></li>
</ol>
</section>
<section id="example-5" class="level4">
<h4 class="anchored" data-anchor-id="example-5">Example</h4>
<p>For “he”, “she”, “his”, “hers”:</p>
<ul>
<li><code>fail("he") = root</code>- <code>fail("hers") = "rs"</code> path invalid → fallback to <code>"s"</code> if exists So failure links connect partial suffixes.</li>
</ul>
</section>
<section id="matching-phase" class="level4">
<h4 class="anchored" data-anchor-id="matching-phase">4. Matching Phase</h4>
<p>Now we can process the text in one pass:</p>
<pre><code>state = root
for each character c in text:
    while state has no child c and state != root:
        state = state.fail
    if state has child c:
        state = state.child[c]
    else:
        state = root
    if state.output:
        report matches at this position</code></pre>
<p>Each transition costs O(1) amortized. No backtracking , fully linear time.</p>
</section>
<section id="example-walkthrough" class="level4">
<h4 class="anchored" data-anchor-id="example-walkthrough">5. Example Walkthrough</h4>
<p>Patterns: <code>he</code>, <code>she</code>, <code>his</code>, <code>hers</code> Text: <code>ahishers</code></p>
<p>At each character:</p>
<pre><code>a → root (no match)
h → go to h
i → go to hi
s → go to his → output "his"
h → fallback → h
e → he → output "he"
r → her → continue
s → hers → output "hers"</code></pre>
<p>Outputs: <code>"his"</code>, <code>"he"</code>, <code>"hers"</code></p>
</section>
<section id="tiny-code-c-implementation-sketch" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-c-implementation-sketch">6. Tiny Code (C Implementation Sketch)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb326"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define ALPHA </span><span class="dv">26</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>next<span class="op">[</span>ALPHA<span class="op">];</span></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>fail<span class="op">;</span></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> out<span class="op">;</span></span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>Node<span class="op">*</span> newNode<span class="op">()</span> <span class="op">{</span></span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>    Node <span class="op">*</span>n <span class="op">=</span> calloc<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>Node<span class="op">));</span></span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> insert<span class="op">(</span>Node <span class="op">*</span>root<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> p<span class="op">[</span>i<span class="op">];</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> c <span class="op">=</span> p<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> <span class="ch">'a'</span><span class="op">;</span></span>
<span id="cb326-17"><a href="#cb326-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>root<span class="op">-&gt;</span>next<span class="op">[</span>c<span class="op">])</span> root<span class="op">-&gt;</span>next<span class="op">[</span>c<span class="op">]</span> <span class="op">=</span> newNode<span class="op">();</span></span>
<span id="cb326-18"><a href="#cb326-18" aria-hidden="true" tabindex="-1"></a>        root <span class="op">=</span> root<span class="op">-&gt;</span>next<span class="op">[</span>c<span class="op">];</span></span>
<span id="cb326-19"><a href="#cb326-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb326-20"><a href="#cb326-20" aria-hidden="true" tabindex="-1"></a>    root<span class="op">-&gt;</span>out <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb326-21"><a href="#cb326-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb326-22"><a href="#cb326-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-23"><a href="#cb326-23" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> build_failures<span class="op">(</span>Node <span class="op">*</span>root<span class="op">)</span> <span class="op">{</span></span>
<span id="cb326-24"><a href="#cb326-24" aria-hidden="true" tabindex="-1"></a>    Node <span class="op">*</span>q<span class="op">[</span><span class="dv">10000</span><span class="op">];</span></span>
<span id="cb326-25"><a href="#cb326-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> front<span class="op">=</span><span class="dv">0</span><span class="op">,</span> back<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb326-26"><a href="#cb326-26" aria-hidden="true" tabindex="-1"></a>    root<span class="op">-&gt;</span>fail <span class="op">=</span> root<span class="op">;</span></span>
<span id="cb326-27"><a href="#cb326-27" aria-hidden="true" tabindex="-1"></a>    q<span class="op">[</span>back<span class="op">++]</span> <span class="op">=</span> root<span class="op">;</span></span>
<span id="cb326-28"><a href="#cb326-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>front <span class="op">&lt;</span> back<span class="op">)</span> <span class="op">{</span></span>
<span id="cb326-29"><a href="#cb326-29" aria-hidden="true" tabindex="-1"></a>        Node <span class="op">*</span>u <span class="op">=</span> q<span class="op">[</span>front<span class="op">++];</span></span>
<span id="cb326-30"><a href="#cb326-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> c<span class="op">=</span><span class="dv">0</span><span class="op">;</span> c<span class="op">&lt;</span>ALPHA<span class="op">;</span> c<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb326-31"><a href="#cb326-31" aria-hidden="true" tabindex="-1"></a>            Node <span class="op">*</span>v <span class="op">=</span> u<span class="op">-&gt;</span>next<span class="op">[</span>c<span class="op">];</span></span>
<span id="cb326-32"><a href="#cb326-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>v<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb326-33"><a href="#cb326-33" aria-hidden="true" tabindex="-1"></a>            Node <span class="op">*</span>f <span class="op">=</span> u<span class="op">-&gt;</span>fail<span class="op">;</span></span>
<span id="cb326-34"><a href="#cb326-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="op">(</span>f <span class="op">!=</span> root <span class="op">&amp;&amp;</span> <span class="op">!</span>f<span class="op">-&gt;</span>next<span class="op">[</span>c<span class="op">])</span> f <span class="op">=</span> f<span class="op">-&gt;</span>fail<span class="op">;</span></span>
<span id="cb326-35"><a href="#cb326-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>f<span class="op">-&gt;</span>next<span class="op">[</span>c<span class="op">]</span> <span class="op">&amp;&amp;</span> f<span class="op">-&gt;</span>next<span class="op">[</span>c<span class="op">]</span> <span class="op">!=</span> v<span class="op">)</span> v<span class="op">-&gt;</span>fail <span class="op">=</span> f<span class="op">-&gt;</span>next<span class="op">[</span>c<span class="op">];</span></span>
<span id="cb326-36"><a href="#cb326-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> v<span class="op">-&gt;</span>fail <span class="op">=</span> root<span class="op">;</span></span>
<span id="cb326-37"><a href="#cb326-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>v<span class="op">-&gt;</span>fail<span class="op">-&gt;</span>out<span class="op">)</span> v<span class="op">-&gt;</span>out <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb326-38"><a href="#cb326-38" aria-hidden="true" tabindex="-1"></a>            q<span class="op">[</span>back<span class="op">++]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb326-39"><a href="#cb326-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb326-40"><a href="#cb326-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb326-41"><a href="#cb326-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="complexity-3" class="level4">
<h4 class="anchored" data-anchor-id="complexity-3">7. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Phase</th>
<th>Time</th>
<th>Space</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Trie Build</td>
<td>( O(m) )</td>
<td>( O(m) )</td>
</tr>
<tr class="even">
<td>Failure Links</td>
<td>( O(m) )</td>
<td>( O(m) )</td>
</tr>
<tr class="odd">
<td>Search</td>
<td>( O(n + z) )</td>
<td>( O(1) )</td>
</tr>
</tbody>
</table>
<p>Total: O(n + m + z)</p>
</section>
<section id="summary-21" class="level4">
<h4 class="anchored" data-anchor-id="summary-21">8. Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Trie</td>
<td>Merge patterns</td>
</tr>
<tr class="even">
<td>Fail Links</td>
<td>Handle mismatches</td>
</tr>
<tr class="odd">
<td>Outputs</td>
<td>Collect matches</td>
</tr>
<tr class="even">
<td>BFS</td>
<td>Build efficiently</td>
</tr>
<tr class="odd">
<td>One Pass</td>
<td>Match all patterns</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-61" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-61">Why It Matters</h4>
<p>Aho-Corasick is the core of:</p>
<ul>
<li>Spam filters- Intrusion detection (e.g., Snort IDS)- Keyword search in compilers- DNA sequence scanners It’s a masterclass in blending automata theory with practical efficiency.</li>
</ul>
<blockquote class="blockquote">
<p>“Why search one word at a time when your algorithm can read the whole dictionary?”</p>
</blockquote>
</section>
<section id="try-it-yourself-61" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-61">Try It Yourself</h4>
<ol type="1">
<li>Build an automaton for words {“he”, “she”, “hers”} and trace it manually.</li>
<li>Modify code for uppercase letters.</li>
<li>Extend to report overlapping matches.</li>
<li>Measure runtime vs.&nbsp;naive multi-search.</li>
<li>Visualize the failure links in a graph.</li>
</ol>
<p>Once you grasp Aho-Corasick, you’ll see pattern search not as a loop , but as a machine that reads and recognizes.</p>
</section>
</section>
<section id="suffix-structures-suffix-array-suffix-tree-lcp" class="level3">
<h3 class="anchored" data-anchor-id="suffix-structures-suffix-array-suffix-tree-lcp">63. Suffix Structures (Suffix Array, Suffix Tree, LCP)</h3>
<p>Suffix-based data structures are among the most powerful tools in string algorithms. They enable fast searching, substring queries, pattern matching, and lexicographic operations , all from one fundamental idea:</p>
<blockquote class="blockquote">
<p>Represent all suffixes of a string in a structured form.</p>
</blockquote>
<p>In this section, we explore three key constructs:</p>
<ul>
<li>Suffix Array (SA) - lexicographically sorted suffix indices- Longest Common Prefix (LCP) array - shared prefix lengths between neighbors- Suffix Tree - compressed trie of all suffixes Together, they power many advanced algorithms in text processing, bioinformatics, and compression.</li>
</ul>
<section id="suffix-array-sa" class="level4">
<h4 class="anchored" data-anchor-id="suffix-array-sa">1. Suffix Array (SA)</h4>
<p>A suffix array stores all suffixes of a string in lexicographic order, represented by their starting indices.</p>
<p>Example: String <code>banana$</code> All suffixes:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Index</th>
<th>Suffix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>banana$</td>
</tr>
<tr class="even">
<td>1</td>
<td>anana$</td>
</tr>
<tr class="odd">
<td>2</td>
<td>nana$</td>
</tr>
<tr class="even">
<td>3</td>
<td>ana$</td>
</tr>
<tr class="odd">
<td>4</td>
<td>na$</td>
</tr>
<tr class="even">
<td>5</td>
<td>a$</td>
</tr>
<tr class="odd">
<td>6</td>
<td>$</td>
</tr>
</tbody>
</table>
<p>Sort them:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Sorted Order</th>
<th>Suffix</th>
<th>Index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td><code>$</code></td>
<td>6</td>
</tr>
<tr class="even">
<td>1</td>
<td><code>a$</code></td>
<td>5</td>
</tr>
<tr class="odd">
<td>2</td>
<td><code>ana$</code></td>
<td>3</td>
</tr>
<tr class="even">
<td>3</td>
<td><code>anana$</code></td>
<td>1</td>
</tr>
<tr class="odd">
<td>4</td>
<td><code>banana$</code></td>
<td>0</td>
</tr>
<tr class="even">
<td>5</td>
<td><code>na$</code></td>
<td>4</td>
</tr>
<tr class="odd">
<td>6</td>
<td><code>nana$</code></td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Suffix Array: <code>[6, 5, 3, 1, 0, 4, 2]</code></p>
</section>
<section id="construction-prefix-doubling" class="level4">
<h4 class="anchored" data-anchor-id="construction-prefix-doubling">Construction (Prefix Doubling)</h4>
<p>We iteratively sort suffixes by first 2ⁱ characters, using radix sort on pairs of ranks.</p>
<p>Steps:</p>
<ol type="1">
<li>Assign initial rank by character.</li>
<li>Sort by (rank[i], rank[i+k]).</li>
<li>Repeat doubling <span class="math inline">\(k \leftarrow 2k\)</span> until all ranks distinct.</li>
</ol>
<p>Time Complexity: ( O<span class="math inline">\(n \log n\)</span> ) Space: ( O(n) )</p>
<p>Tiny Code (C, Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb327"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> <span class="dt">int</span> idx<span class="op">,</span> rank<span class="op">[</span><span class="dv">2</span><span class="op">];</span> <span class="op">}</span> Suffix<span class="op">;</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cmp<span class="op">(</span>Suffix a<span class="op">,</span> Suffix b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>a<span class="op">.</span>rank<span class="op">[</span><span class="dv">0</span><span class="op">]==</span>b<span class="op">.</span>rank<span class="op">[</span><span class="dv">0</span><span class="op">])</span> <span class="op">?</span> <span class="op">(</span>a<span class="op">.</span>rank<span class="op">[</span><span class="dv">1</span><span class="op">]-</span>b<span class="op">.</span>rank<span class="op">[</span><span class="dv">1</span><span class="op">])</span> <span class="op">:</span> <span class="op">(</span>a<span class="op">.</span>rank<span class="op">[</span><span class="dv">0</span><span class="op">]-</span>b<span class="op">.</span>rank<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> buildSA<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> sa<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a>    Suffix suf<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true" tabindex="-1"></a>        suf<span class="op">[</span>i<span class="op">].</span>idx <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb327-10"><a href="#cb327-10" aria-hidden="true" tabindex="-1"></a>        suf<span class="op">[</span>i<span class="op">].</span>rank<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb327-11"><a href="#cb327-11" aria-hidden="true" tabindex="-1"></a>        suf<span class="op">[</span>i<span class="op">].</span>rank<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>i<span class="op">+</span><span class="dv">1</span><span class="op">&lt;</span>n<span class="op">)</span> <span class="op">?</span> s<span class="op">[</span>i<span class="op">+</span><span class="dv">1</span><span class="op">]</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb327-12"><a href="#cb327-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb327-13"><a href="#cb327-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> k <span class="op">&lt;</span> <span class="dv">2</span><span class="op">*</span>n<span class="op">;</span> k <span class="op">*=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb327-14"><a href="#cb327-14" aria-hidden="true" tabindex="-1"></a>        qsort<span class="op">(</span>suf<span class="op">,</span> n<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>Suffix<span class="op">),</span> cmp<span class="op">);</span></span>
<span id="cb327-15"><a href="#cb327-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> r <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> rank<span class="op">[</span>n<span class="op">];</span> rank<span class="op">[</span>suf<span class="op">[</span><span class="dv">0</span><span class="op">].</span>idx<span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb327-16"><a href="#cb327-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb327-17"><a href="#cb327-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>suf<span class="op">[</span>i<span class="op">].</span>rank<span class="op">[</span><span class="dv">0</span><span class="op">]!=</span>suf<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">].</span>rank<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">||</span> suf<span class="op">[</span>i<span class="op">].</span>rank<span class="op">[</span><span class="dv">1</span><span class="op">]!=</span>suf<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">].</span>rank<span class="op">[</span><span class="dv">1</span><span class="op">])</span> r<span class="op">++;</span></span>
<span id="cb327-18"><a href="#cb327-18" aria-hidden="true" tabindex="-1"></a>            rank<span class="op">[</span>suf<span class="op">[</span>i<span class="op">].</span>idx<span class="op">]=</span>r<span class="op">;</span></span>
<span id="cb327-19"><a href="#cb327-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb327-20"><a href="#cb327-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb327-21"><a href="#cb327-21" aria-hidden="true" tabindex="-1"></a>            suf<span class="op">[</span>i<span class="op">].</span>rank<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> rank<span class="op">[</span>suf<span class="op">[</span>i<span class="op">].</span>idx<span class="op">];</span></span>
<span id="cb327-22"><a href="#cb327-22" aria-hidden="true" tabindex="-1"></a>            suf<span class="op">[</span>i<span class="op">].</span>rank<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span>suf<span class="op">[</span>i<span class="op">].</span>idx<span class="op">+</span>k<span class="op">/</span><span class="dv">2</span><span class="op">&lt;</span>n<span class="op">)?</span>rank<span class="op">[</span>suf<span class="op">[</span>i<span class="op">].</span>idx<span class="op">+</span>k<span class="op">/</span><span class="dv">2</span><span class="op">]:-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb327-23"><a href="#cb327-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb327-24"><a href="#cb327-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb327-25"><a href="#cb327-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++)</span> sa<span class="op">[</span>i<span class="op">]=</span>suf<span class="op">[</span>i<span class="op">].</span>idx<span class="op">;</span></span>
<span id="cb327-26"><a href="#cb327-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="longest-common-prefix-lcp" class="level4">
<h4 class="anchored" data-anchor-id="longest-common-prefix-lcp">2. Longest Common Prefix (LCP)</h4>
<p>The LCP array stores the length of the longest common prefix between consecutive suffixes in SA order.</p>
<p>Example: <code>banana$</code></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>SA</th>
<th>Suffix</th>
<th>LCP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>$</td>
<td>0</td>
</tr>
<tr class="even">
<td>5</td>
<td>a$</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>ana$</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>anana$</td>
<td>3</td>
</tr>
<tr class="odd">
<td>0</td>
<td>banana$</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>na$</td>
<td>0</td>
</tr>
<tr class="odd">
<td>2</td>
<td>nana$</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>So LCP = <code>[0,0,1,3,0,0,2]</code></p>
</section>
<section id="kasais-algorithm-build-in-on" class="level4">
<h4 class="anchored" data-anchor-id="kasais-algorithm-build-in-on">Kasai’s Algorithm (Build in O(n))</h4>
<p>We compute LCP in one pass using inverse SA:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb328"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> buildLCP<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> sa<span class="op">[],</span> <span class="dt">int</span> lcp<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> rank<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++)</span> rank<span class="op">[</span>sa<span class="op">[</span>i<span class="op">]]=</span>i<span class="op">;</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> k<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>rank<span class="op">[</span>i<span class="op">]==</span>n<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span> k<span class="op">=</span><span class="dv">0</span><span class="op">;</span> <span class="cf">continue</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> sa<span class="op">[</span>rank<span class="op">[</span>i<span class="op">]+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>i<span class="op">+</span>k<span class="op">&lt;</span>n <span class="op">&amp;&amp;</span> j<span class="op">+</span>k<span class="op">&lt;</span>n <span class="op">&amp;&amp;</span> s<span class="op">[</span>i<span class="op">+</span>k<span class="op">]==</span>s<span class="op">[</span>j<span class="op">+</span>k<span class="op">])</span> k<span class="op">++;</span></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>        lcp<span class="op">[</span>rank<span class="op">[</span>i<span class="op">]]=</span>k<span class="op">;</span></span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>k<span class="op">&gt;</span><span class="dv">0</span><span class="op">)</span> k<span class="op">--;</span></span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: ( O(n) )</p>
</section>
<section id="suffix-tree" class="level4">
<h4 class="anchored" data-anchor-id="suffix-tree">3. Suffix Tree</h4>
<p>A suffix tree is a compressed trie of all suffixes.</p>
<p>Each edge holds a substring interval, not individual characters. This gives:</p>
<ul>
<li>Construction in ( O(n) ) (Ukkonen’s algorithm)- Pattern search in ( O(m) )- Many advanced uses (e.g., longest repeated substring) Example: String: <code>banana$</code> Suffix tree edges:</li>
</ul>
<pre><code>(root)
 ├─ b[0:0] → ...
 ├─ a[1:1] → ...
 ├─ n[2:2] → ...</code></pre>
<p>Edges compress consecutive letters into intervals like <code>[start:end]</code>.</p>
</section>
<section id="comparison-23" class="level4">
<h4 class="anchored" data-anchor-id="comparison-23">Comparison</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Structure</th>
<th>Space</th>
<th>Build Time</th>
<th>Search</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Suffix Array</td>
<td>( O(n) )</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
<td>( O<span class="math inline">\(m \log n\)</span> )</td>
</tr>
<tr class="even">
<td>LCP Array</td>
<td>( O(n) )</td>
<td>( O(n) )</td>
<td>Range queries</td>
</tr>
<tr class="odd">
<td>Suffix Tree</td>
<td>( O(n) )</td>
<td>( O(n) )</td>
<td>( O(m) )</td>
</tr>
</tbody>
</table>
<p>Suffix Array + LCP ≈ compact Suffix Tree.</p>
</section>
<section id="applications-9" class="level4">
<h4 class="anchored" data-anchor-id="applications-9">4. Applications</h4>
<ol type="1">
<li>Substring search - binary search in SA</li>
<li>Longest repeated substring - max(LCP)</li>
<li>Lexicographic order - direct from SA</li>
<li>Distinct substrings count = ( n(n+1)/2 - LCP[i] )</li>
<li>Pattern frequency - range query in SA using LCP</li>
</ol>
</section>
<section id="tiny-code-search-via-sa" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-search-via-sa">5. Tiny Code (Search via SA)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb330"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> searchSA<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>t<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>p<span class="op">,</span> <span class="dt">int</span> sa<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> l<span class="op">=</span><span class="dv">0</span><span class="op">,</span> r<span class="op">=</span>n<span class="op">-</span><span class="dv">1</span><span class="op">,</span> m<span class="op">=</span>strlen<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>l <span class="op">&lt;=</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l<span class="op">+</span>r<span class="op">)/</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> cmp <span class="op">=</span> strncmp<span class="op">(</span>t<span class="op">+</span>sa<span class="op">[</span>mid<span class="op">],</span> p<span class="op">,</span> m<span class="op">);</span></span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>cmp<span class="op">==</span><span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> sa<span class="op">[</span>mid<span class="op">];</span></span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>cmp<span class="op">&lt;</span><span class="dv">0</span><span class="op">)</span> l<span class="op">=</span>mid<span class="op">+</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> r<span class="op">=</span>mid<span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="summary-22" class="level4">
<h4 class="anchored" data-anchor-id="summary-22">6. Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Concept</th>
<th>Purpose</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Suffix Array</td>
<td>Sorted suffix indices</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
</tr>
<tr class="even">
<td>LCP Array</td>
<td>Adjacent suffix overlap</td>
<td>( O(n) )</td>
</tr>
<tr class="odd">
<td>Suffix Tree</td>
<td>Compressed trie of suffixes</td>
<td>( O(n) )</td>
</tr>
</tbody>
</table>
<p>Together they form the core of advanced string algorithms.</p>
</section>
<section id="why-it-matters-62" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-62">Why It Matters</h4>
<p>Suffix structures reveal hidden order in strings. They turn raw text into searchable, analyzable data , ideal for compression, search engines, and DNA analysis.</p>
<blockquote class="blockquote">
<p>“All suffixes, perfectly sorted , the DNA of text.”</p>
</blockquote>
</section>
<section id="try-it-yourself-62" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-62">Try It Yourself</h4>
<ol type="1">
<li>Build suffix array for <code>banana$</code> by hand.</li>
<li>Write code to compute LCP and longest repeated substring.</li>
<li>Search multiple patterns using binary search on SA.</li>
<li>Count distinct substrings from SA + LCP.</li>
<li>Compare SA-based vs.&nbsp;tree-based search performance.</li>
</ol>
<p>Mastering suffix structures equips you to tackle problems that were once “too big” for brute force , now solvable with elegance and order.</p>
</section>
</section>
<section id="palindromes-and-periodicity-manacher" class="level3">
<h3 class="anchored" data-anchor-id="palindromes-and-periodicity-manacher">64. Palindromes and Periodicity (Manacher)</h3>
<p>Palindromes are symmetric strings that read the same forwards and backwards , like “level”, “racecar”, or “madam”. They arise naturally in text analysis, bioinformatics, and even in data compression.</p>
<p>This section introduces efficient algorithms to detect and analyze palindromic structure and periodicity in strings, including the legendary Manacher’s Algorithm, which finds all palindromic substrings in linear time.</p>
<section id="what-is-a-palindrome" class="level4">
<h4 class="anchored" data-anchor-id="what-is-a-palindrome">1. What Is a Palindrome?</h4>
<p>A string ( S ) is a palindrome if: <span class="math display">\[
S[i] = S[n - i + 1] \quad \text{for all } i
\]</span></p>
<p>Examples:</p>
<ul>
<li><code>"abba"</code> is even-length palindrome- <code>"aba"</code> is odd-length palindrome A string may contain many palindromic substrings , our goal is to find all centers efficiently.</li>
</ul>
</section>
<section id="naive-approach" class="level4">
<h4 class="anchored" data-anchor-id="naive-approach">2. Naive Approach</h4>
<p>For each center (between characters or at characters), expand outward while characters match.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb331"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each center c<span class="op">:</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>    expand left<span class="op">,</span> right <span class="cf">while</span> S<span class="op">[</span>l<span class="op">]</span> <span class="op">==</span> S<span class="op">[</span>r<span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity: ( O<span class="math inline">\(n^2\)</span> ) , too slow for large strings.</p>
<p>We need something faster , that’s where Manacher’s Algorithm steps in.</p>
</section>
<section id="manachers-algorithm-on" class="level4">
<h4 class="anchored" data-anchor-id="manachers-algorithm-on">3. Manacher’s Algorithm (O(n))</h4>
<p>Manacher’s Algorithm finds the radius of the longest palindrome centered at each position in linear time.</p>
<p>It cleverly reuses previous computations using mirror symmetry and a current right boundary.</p>
</section>
<section id="step-by-step" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step">Step-by-Step</h4>
<ol type="1">
<li><p>Preprocess string to handle even-length palindromes: Insert <code>#</code> between characters.</p>
<p>Example:</p>
<pre><code>S = "abba"
T = "^#a#b#b#a#$"</code></pre>
<p>(<code>^</code> and <code>$</code> are sentinels)</p></li>
<li><p>Maintain:</p>
<ul>
<li><code>C</code>: center of rightmost palindrome - <code>R</code>: right boundary - <code>P[i]</code>: palindrome radius at <code>i</code></li>
</ul></li>
<li><p>For each position <code>i</code>:</p>
<ul>
<li>mirror position <code>mirror = 2*C - i</code> - initialize <code>P[i] = min(R - i, P[mirror])</code> - expand around <code>i</code> while characters match - if new palindrome extends past <code>R</code>, update <code>C</code> and <code>R</code></li>
</ul></li>
<li><p>The <strong>maximum value of <code>P[i]</code></strong> gives the longest palindrome.</p></li>
</ol>
</section>
<section id="example-6" class="level4">
<h4 class="anchored" data-anchor-id="example-6">Example</h4>
<pre><code>S = "abba"
T = "^#a#b#b#a#$"
P = [0,0,1,0,3,0,3,0,1,0,0]
Longest radius = 3 → "abba"</code></pre>
<p>Tiny Code (C Implementation)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb334"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> manacher<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> strlen<span class="op">(</span>s<span class="op">);</span></span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> t<span class="op">[</span><span class="dv">2</span><span class="op">*</span>n <span class="op">+</span> <span class="dv">3</span><span class="op">];</span></span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> p<span class="op">[</span><span class="dv">2</span><span class="op">*</span>n <span class="op">+</span> <span class="dv">3</span><span class="op">];</span></span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> m <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>    t<span class="op">[</span>m<span class="op">++]</span> <span class="op">=</span> <span class="ch">'^'</span><span class="op">;</span></span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true" tabindex="-1"></a>        t<span class="op">[</span>m<span class="op">++]</span> <span class="op">=</span> <span class="ch">'#'</span><span class="op">;</span></span>
<span id="cb334-9"><a href="#cb334-9" aria-hidden="true" tabindex="-1"></a>        t<span class="op">[</span>m<span class="op">++]</span> <span class="op">=</span> s<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb334-10"><a href="#cb334-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb334-11"><a href="#cb334-11" aria-hidden="true" tabindex="-1"></a>    t<span class="op">[</span>m<span class="op">++]</span> <span class="op">=</span> <span class="ch">'#'</span><span class="op">;</span> t<span class="op">[</span>m<span class="op">++]</span> <span class="op">=</span> <span class="ch">'$'</span><span class="op">;</span></span>
<span id="cb334-12"><a href="#cb334-12" aria-hidden="true" tabindex="-1"></a>    t<span class="op">[</span>m<span class="op">]</span> <span class="op">=</span> <span class="ch">'</span><span class="sc">\0</span><span class="ch">'</span><span class="op">;</span></span>
<span id="cb334-13"><a href="#cb334-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb334-14"><a href="#cb334-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> r <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> maxLen <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb334-15"><a href="#cb334-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span> i<span class="op">&lt;</span>m<span class="op">-</span><span class="dv">1</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb334-16"><a href="#cb334-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mirror <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>c <span class="op">-</span> i<span class="op">;</span></span>
<span id="cb334-17"><a href="#cb334-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">&lt;</span> r<span class="op">)</span></span>
<span id="cb334-18"><a href="#cb334-18" aria-hidden="true" tabindex="-1"></a>            p<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>r <span class="op">-</span> i <span class="op">&lt;</span> p<span class="op">[</span>mirror<span class="op">])</span> <span class="op">?</span> <span class="op">(</span>r <span class="op">-</span> i<span class="op">)</span> <span class="op">:</span> p<span class="op">[</span>mirror<span class="op">];</span></span>
<span id="cb334-19"><a href="#cb334-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> p<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb334-20"><a href="#cb334-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>t<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> p<span class="op">[</span>i<span class="op">]]</span> <span class="op">==</span> t<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span> <span class="op">-</span> p<span class="op">[</span>i<span class="op">]])</span></span>
<span id="cb334-21"><a href="#cb334-21" aria-hidden="true" tabindex="-1"></a>            p<span class="op">[</span>i<span class="op">]++;</span></span>
<span id="cb334-22"><a href="#cb334-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">+</span> p<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb334-23"><a href="#cb334-23" aria-hidden="true" tabindex="-1"></a>            c <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb334-24"><a href="#cb334-24" aria-hidden="true" tabindex="-1"></a>            r <span class="op">=</span> i <span class="op">+</span> p<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb334-25"><a href="#cb334-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb334-26"><a href="#cb334-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>p<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> maxLen<span class="op">)</span> maxLen <span class="op">=</span> p<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb334-27"><a href="#cb334-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb334-28"><a href="#cb334-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> maxLen<span class="op">;</span></span>
<span id="cb334-29"><a href="#cb334-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: ( O(n) ) Space: ( O(n) )</p>
</section>
<section id="periodicity-and-repetition" class="level4">
<h4 class="anchored" data-anchor-id="periodicity-and-repetition">4. Periodicity and Repetition</h4>
<p>A string ( S ) has a period ( p ) if: <span class="math display">\[
S[i] = S[i + p] \text{ for all valid } i
\]</span></p>
<p>Example: <code>abcabcabc</code> has period 3 (<code>abc</code>).</p>
<p>Checking Periodicity:</p>
<ol type="1">
<li>Build prefix function (as in KMP).</li>
<li>Let ( n = |S| ), <span class="math inline">\(p = n - \pi[n-1]\)</span>.</li>
<li>If <span class="math inline">\(n \mod p = 0\)</span>, period = ( p ).</li>
</ol>
<p>Example:</p>
<pre><code>S = "ababab"
π = [0,0,1,2,3,4]
p = 6 - 4 = 2
6 mod 2 = 0 → periodic</code></pre>
<p>Tiny Code (Check Periodicity)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb336"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> period<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> strlen<span class="op">(</span>s<span class="op">),</span> pi<span class="op">[</span>n<span class="op">];</span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>    pi<span class="op">[</span><span class="dv">0</span><span class="op">]=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">,</span>k<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span><span class="op">(</span>k<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;&amp;</span> s<span class="op">[</span>k<span class="op">]!=</span>s<span class="op">[</span>i<span class="op">])</span> k<span class="op">=</span>pi<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>s<span class="op">[</span>k<span class="op">]==</span>s<span class="op">[</span>i<span class="op">])</span> k<span class="op">++;</span></span>
<span id="cb336-7"><a href="#cb336-7" aria-hidden="true" tabindex="-1"></a>        pi<span class="op">[</span>i<span class="op">]=</span>k<span class="op">;</span></span>
<span id="cb336-8"><a href="#cb336-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb336-9"><a href="#cb336-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> p <span class="op">=</span> n <span class="op">-</span> pi<span class="op">[</span>n<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb336-10"><a href="#cb336-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>n <span class="op">%</span> p <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">?</span> p <span class="op">:</span> n<span class="op">;</span></span>
<span id="cb336-11"><a href="#cb336-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="applications-10" class="level4">
<h4 class="anchored" data-anchor-id="applications-10">5. Applications</h4>
<ul>
<li>Palindrome Queries: is substring ( S[l:r] ) palindrome? → precompute radii- Longest Palindromic Substring- DNA Symmetry Analysis- Pattern Compression / Period Detection- String Regularity Tests</li>
</ul>
</section>
<section id="summary-23" class="level4">
<h4 class="anchored" data-anchor-id="summary-23">6. Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Concept</th>
<th>Purpose</th>
<th>Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Naive Expand</td>
<td>Simple palindrome check</td>
<td>( O<span class="math inline">\(n^2\)</span> )</td>
</tr>
<tr class="even">
<td>Manacher</td>
<td>Longest palindromic substring</td>
<td>( O(n) )</td>
</tr>
<tr class="odd">
<td>KMP Prefix</td>
<td>Period detection</td>
<td>( O(n) )</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-63" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-63">Why It Matters</h4>
<p>Palindromes reveal hidden symmetries. Manacher’s algorithm is a gem , a linear-time mirror-based solution to a quadratic problem.</p>
<blockquote class="blockquote">
<p>“In every word, there may hide a reflection.”</p>
</blockquote>
</section>
<section id="try-it-yourself-63" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-63">Try It Yourself</h4>
<ol type="1">
<li>Run Manacher’s algorithm on <code>"abacdfgdcaba"</code>.</li>
<li>Modify code to print all palindromic substrings.</li>
<li>Use prefix function to find smallest period.</li>
<li>Combine both to find palindromic periodic substrings.</li>
<li>Compare runtime vs.&nbsp;naive expand method.</li>
</ol>
<p>Understanding palindromes and periodicity teaches how structure emerges from repetition , a central theme in all of algorithmic design.</p>
</section>
</section>
<section id="edit-distance-and-alignment" class="level3">
<h3 class="anchored" data-anchor-id="edit-distance-and-alignment">65. Edit Distance and Alignment</h3>
<p>Edit distance measures how different two strings are , the minimal number of operations needed to turn one into the other. It’s a cornerstone of spell checking, DNA sequence alignment, plagiarism detection, and fuzzy search.</p>
<p>The most common form is the Levenshtein distance, using:</p>
<ul>
<li>Insertion (add a character)- Deletion (remove a character)- Substitution (replace a character) We’ll also touch on alignment, which generalizes this idea with custom scoring and penalties.</li>
</ul>
<section id="problem-definition-1" class="level4">
<h4 class="anchored" data-anchor-id="problem-definition-1">1. Problem Definition</h4>
<p>Given two strings ( A ) and ( B ), find the minimum number of edits to convert <span class="math inline">\(A \to B\)</span>.</p>
<p>If ( A = “kitten” ) ( B = “sitting” )</p>
<p>One optimal sequence:</p>
<pre><code>kitten → sitten (substitute 'k'→'s')
sitten → sittin (substitute 'e'→'i')
sittin → sitting (insert 'g')</code></pre>
<p>So edit distance = 3.</p>
</section>
<section id="dynamic-programming-solution" class="level4">
<h4 class="anchored" data-anchor-id="dynamic-programming-solution">2. Dynamic Programming Solution</h4>
<p>Let <span class="math inline">\(dp[i][j]\)</span> be the minimum edits to convert <span class="math inline">\(A[0..i-1] \to B[0..j-1]\)</span>.</p>
<p>Recurrence: <span class="math display">\[
dp[i][j] =
\begin{cases}
dp[i-1][j-1], &amp; \text{if } A[i-1] = B[j-1], \\
1 + \min\big(dp[i-1][j],\, dp[i][j-1],\, dp[i-1][j-1]\big), &amp; \text{otherwise}
\end{cases}
\]</span></p>
<p>Where: - <span class="math inline">\(dp[i-1][j]\)</span>: delete from <span class="math inline">\(A\)</span> - <span class="math inline">\(dp[i][j-1]\)</span>: insert into <span class="math inline">\(A\)</span> - <span class="math inline">\(dp[i-1][j-1]\)</span>: substitute</p>
<p>Base cases: <span class="math display">\[
dp[0][j] = j,\quad dp[i][0] = i
\]</span></p>
<p>Time complexity: <span class="math inline">\(O(|A||B|)\)</span></p>
</section>
<section id="example-7" class="level4">
<h4 class="anchored" data-anchor-id="example-7">Example</h4>
<p>A = <code>kitten</code>, B = <code>sitting</code></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>“”</th>
<th>s</th>
<th>i</th>
<th>t</th>
<th>t</th>
<th>i</th>
<th>n</th>
<th>g</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“”</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="even">
<td>k</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="odd">
<td>i</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
<tr class="even">
<td>t</td>
<td>3</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="odd">
<td>t</td>
<td>4</td>
<td>4</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td>e</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>n</td>
<td>6</td>
<td>6</td>
<td>5</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>2</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>Edit distance = 3</p>
<p>Tiny Code (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb338"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MIN3</span><span class="op">(</span><span class="pp">a</span><span class="op">,</span><span class="pp">b</span><span class="op">,</span><span class="pp">c</span><span class="op">)</span><span class="pp"> </span><span class="op">((</span><span class="pp">a</span><span class="op">&lt;</span><span class="pp">b</span><span class="op">)?((</span><span class="pp">a</span><span class="op">&lt;</span><span class="pp">c</span><span class="op">)?</span><span class="pp">a</span><span class="op">:</span><span class="pp">c</span><span class="op">):((</span><span class="pp">b</span><span class="op">&lt;</span><span class="pp">c</span><span class="op">)?</span><span class="pp">b</span><span class="op">:</span><span class="pp">c</span><span class="op">))</span></span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> edit_distance<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>A<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>B<span class="op">)</span> <span class="op">{</span></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> strlen<span class="op">(</span>A<span class="op">),</span> m <span class="op">=</span> strlen<span class="op">(</span>B<span class="op">);</span></span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">][</span>m<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++)</span> dp<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]=</span>i<span class="op">;</span></span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;=</span>m<span class="op">;</span>j<span class="op">++)</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span>j<span class="op">]=</span>j<span class="op">;</span></span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++)</span></span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">1</span><span class="op">;</span>j<span class="op">&lt;=</span>m<span class="op">;</span>j<span class="op">++)</span></span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]==</span>B<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]=</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a>                dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]=</span><span class="dv">1</span><span class="op">+</span>MIN3<span class="op">(</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">],</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb338-16"><a href="#cb338-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>m<span class="op">];</span></span>
<span id="cb338-17"><a href="#cb338-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb338-18"><a href="#cb338-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-19"><a href="#cb338-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb338-20"><a href="#cb338-20" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">"</span><span class="sc">%d\n</span><span class="st">"</span><span class="op">,</span> edit_distance<span class="op">(</span><span class="st">"kitten"</span><span class="op">,</span><span class="st">"sitting"</span><span class="op">));</span> <span class="co">// 3</span></span>
<span id="cb338-21"><a href="#cb338-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="space-optimization" class="level4">
<h4 class="anchored" data-anchor-id="space-optimization">3. Space Optimization</h4>
<p>We only need the previous row to compute the current row.</p>
<p>So,<br>
Space complexity: <span class="math inline">\(O(\min(|A|, |B|))\)</span></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb339"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> edit_distance_opt<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>A<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>B<span class="op">)</span> <span class="op">{</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">=</span>strlen<span class="op">(</span>A<span class="op">),</span> m<span class="op">=</span>strlen<span class="op">(</span>B<span class="op">);</span></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> prev<span class="op">[</span>m<span class="op">+</span><span class="dv">1</span><span class="op">],</span> curr<span class="op">[</span>m<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;=</span>m<span class="op">;</span>j<span class="op">++)</span> prev<span class="op">[</span>j<span class="op">]=</span>j<span class="op">;</span></span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i<span class="op">&lt;=</span>n<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a>        curr<span class="op">[</span><span class="dv">0</span><span class="op">]=</span>i<span class="op">;</span></span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">1</span><span class="op">;</span>j<span class="op">&lt;=</span>m<span class="op">;</span>j<span class="op">++){</span></span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>A<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]==</span>B<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span> curr<span class="op">[</span>j<span class="op">]=</span>prev<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> curr<span class="op">[</span>j<span class="op">]=</span><span class="dv">1</span><span class="op">+</span>MIN3<span class="op">(</span>prev<span class="op">[</span>j<span class="op">],</span> curr<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">],</span> prev<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a>        memcpy<span class="op">(</span>prev<span class="op">,</span>curr<span class="op">,</span><span class="kw">sizeof</span><span class="op">(</span>curr<span class="op">));</span></span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prev<span class="op">[</span>m<span class="op">];</span></span>
<span id="cb339-14"><a href="#cb339-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="alignment" class="level4">
<h4 class="anchored" data-anchor-id="alignment">4. Alignment</h4>
<p>Alignment shows which characters correspond between two strings. Used in bioinformatics (e.g., DNA sequence alignment).</p>
<p>Each operation has a cost:</p>
<ul>
<li>Match: 0</li>
<li>Mismatch: 1</li>
<li>Gap (insert/delete): 1 We fill the DP table similarly, but track choices to trace back alignment.</li>
</ul>
</section>
<section id="example-alignment" class="level4">
<h4 class="anchored" data-anchor-id="example-alignment">Example Alignment</h4>
<pre><code>A: kitten-
B: sitt-ing</code></pre>
<p>We can visualize the transformation path by backtracking dp table.</p>
</section>
<section id="scoring-alignment-general-form" class="level4">
<h4 class="anchored" data-anchor-id="scoring-alignment-general-form">Scoring Alignment (General Form)</h4>
<p>We can generalize: <span class="math display">\[
dp[i][j] = \min \begin{cases}
dp[i-1][j-1] + cost(A_i,B_j) \
dp[i-1][j] + gap \
dp[i][j-1] + gap
\end{cases}
\]</span></p>
<p>Used in Needleman-Wunsch (global alignment) and Smith-Waterman (local alignment).</p>
</section>
<section id="variants" class="level4">
<h4 class="anchored" data-anchor-id="variants">5. Variants</h4>
<ul>
<li>Damerau-Levenshtein: adds transposition (swap adjacent chars)- Hamming Distance: only substitutions, equal-length strings- Weighted Distance: different operation costs- Local Alignment: only best matching substrings</li>
</ul>
</section>
<section id="summary-24" class="level4">
<h4 class="anchored" data-anchor-id="summary-24">6. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 36%">
<col style="width: 26%">
<col style="width: 8%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Operations</th>
<th>Time</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Levenshtein</td>
<td>insert, delete, replace</td>
<td>(O(nm))</td>
<td>Spell check, fuzzy search</td>
</tr>
<tr class="even">
<td>Hamming</td>
<td>substitution only</td>
<td>(O(n))</td>
<td>DNA, binary strings</td>
</tr>
<tr class="odd">
<td>Alignment (Needleman-Wunsch)</td>
<td>with scoring</td>
<td>(O(nm))</td>
<td>Bioinformatics</td>
</tr>
<tr class="even">
<td>Local Alignment (Smith-Waterman)</td>
<td>best substring</td>
<td>(O(nm))</td>
<td>DNA regions</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-64" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-64">Why It Matters</h4>
<p>Edit distance transforms “difference” into data. It quantifies how far apart two strings are, enabling flexible, robust comparisons.</p>
<blockquote class="blockquote">
<p>“Similarity isn’t perfection , it’s the cost of becoming alike.”</p>
</blockquote>
</section>
<section id="try-it-yourself-64" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-64">Try It Yourself</h4>
<ol type="1">
<li>Compute edit distance between “intention” and “execution”.</li>
<li>Trace back operations to show alignment.</li>
<li>Modify costs (insertion=2, deletion=1, substitution=2) and compare results.</li>
<li>Implement Hamming distance for equal-length strings.</li>
<li>Explore Smith-Waterman for longest common substring.</li>
</ol>
<p>Once you master edit distance, you can build tools that understand typos, align genomes, and search imperfectly , perfectly.</p>
</section>
</section>
<section id="compression-huffman-arithmetic-lz77-bwt" class="level3">
<h3 class="anchored" data-anchor-id="compression-huffman-arithmetic-lz77-bwt">66. Compression (Huffman, Arithmetic, LZ77, BWT)</h3>
<p>Compression algorithms let us encode information efficiently, reducing storage or transmission cost without losing meaning. They turn patterns and redundancy into shorter representations , the essence of data compression.</p>
<p>This section introduces the key families of lossless compression algorithms that form the backbone of formats like ZIP, PNG, and GZIP.</p>
<p>We’ll explore:</p>
<ul>
<li>Huffman Coding (prefix-free variable-length codes)</li>
<li>Arithmetic Coding (fractional interval encoding)</li>
<li>LZ77 / LZ78 (dictionary-based methods)</li>
<li>Burrows-Wheeler Transform (BWT) (reversible sorting transform)</li>
</ul>
<section id="huffman-coding" class="level4">
<h4 class="anchored" data-anchor-id="huffman-coding">1. Huffman Coding</h4>
<p>Huffman coding assigns shorter codes to frequent symbols, and longer codes to rare ones , achieving optimal compression among prefix-free codes.</p>
</section>
<section id="a.-algorithm-2" class="level4">
<h4 class="anchored" data-anchor-id="a.-algorithm-2">A. Algorithm</h4>
<ol type="1">
<li><p>Count frequencies of all symbols.</p></li>
<li><p>Build a min-heap of nodes <code>(symbol, freq)</code>.</p></li>
<li><p>While heap size &gt; 1:</p>
<ul>
<li>Extract two smallest nodes <code>a</code>, <code>b</code>. - Create new node with <code>freq = a.freq + b.freq</code>. - Push back into heap.4. Assign <code>0</code> to left, <code>1</code> to right.</li>
</ul></li>
<li><p>Traverse tree , collect codes.</p></li>
</ol>
<p>Each symbol gets a unique prefix code (no code is prefix of another).</p>
</section>
<section id="b.-example-7" class="level4">
<h4 class="anchored" data-anchor-id="b.-example-7">B. Example</h4>
<p>Text: <code>ABRACADABRA</code></p>
<p>Frequencies:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Symbol</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>5</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
</tr>
<tr class="odd">
<td>R</td>
<td>2</td>
</tr>
<tr class="even">
<td>C</td>
<td>1</td>
</tr>
<tr class="odd">
<td>D</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Building tree gives codes like:</p>
<pre><code>A: 0  
B: 101  
R: 100  
C: 1110  
D: 1111</code></pre>
<p>Encoded text: <code>0 101 100 0 1110 0 1111 0 101 100 0</code> Compression achieved!</p>
<p>Tiny Code (C, Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb342"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> ch<span class="op">;</span></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> freq<span class="op">;</span></span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>left<span class="op">,</span> <span class="op">*</span>right<span class="op">;</span></span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Use a min-heap (priority queue) to build the tree. Traverse recursively to print codewords.</p>
<p>Complexity: (O<span class="math inline">\(n \log n\)</span>)</p>
</section>
<section id="arithmetic-coding" class="level4">
<h4 class="anchored" data-anchor-id="arithmetic-coding">2. Arithmetic Coding</h4>
<p>Instead of mapping symbols to bit strings, arithmetic coding maps the entire message to a single number in [0,1).</p>
<p>We start with interval ([0,1)), and iteratively narrow it based on symbol probabilities.</p>
</section>
<section id="example-8" class="level4">
<h4 class="anchored" data-anchor-id="example-8">Example</h4>
<p>Symbols: {A: 0.5, B: 0.3, C: 0.2} Message: <code>ABC</code></p>
<p>Intervals:</p>
<pre><code>Start: [0, 1)
A → [0, 0.5)
B → [0.25, 0.4)
C → [0.34, 0.37)</code></pre>
<p>Final code = any number in [0.34, 0.37) (e.g.&nbsp;0.35)</p>
<p>Decoding reverses this process.</p>
<p>Advantage: achieves near-optimal entropy compression. Used in: JPEG2000, H.264</p>
<p>Time Complexity: ( O(n) )</p>
</section>
<section id="lz77-sliding-window-compression" class="level4">
<h4 class="anchored" data-anchor-id="lz77-sliding-window-compression">3. LZ77 (Sliding Window Compression)</h4>
<p>LZ77 replaces repeated substrings with back-references <code>(offset, length, next_char)</code> pointing into a sliding window.</p>
</section>
<section id="example-9" class="level4">
<h4 class="anchored" data-anchor-id="example-9">Example</h4>
<p>Text: <code>abcabcabcx</code></p>
<p>Window slides; when <code>abc</code> repeats:</p>
<pre><code>(0,0,'a'), (0,0,'b'), (0,0,'c'),
(3,3,'x')  // "abc" repeats from 3 chars back</code></pre>
<p>So sequence is compressed as references to earlier substrings.</p>
<p>Used in: DEFLATE (ZIP, GZIP), PNG</p>
<p>Time: ( O(n) ), Space: proportional to window size.</p>
</section>
<section id="tiny-code-conceptual" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-conceptual">Tiny Code (Conceptual)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb345"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Token <span class="op">{</span> <span class="dt">int</span> offset<span class="op">,</span> length<span class="op">;</span> <span class="dt">char</span> next<span class="op">;</span> <span class="op">};</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Search previous window for longest match before emitting token.</p>
</section>
<section id="lz78-dictionary-based" class="level4">
<h4 class="anchored" data-anchor-id="lz78-dictionary-based">4. LZ78 (Dictionary-Based)</h4>
<p>Instead of sliding window, LZ78 builds an explicit dictionary of substrings.</p>
<p>Algorithm:</p>
<ul>
<li>Start with empty dictionary.- Read input, find longest prefix in dictionary.- Output <code>(index, next_char)</code> and insert new entry. Example:</li>
</ul>
<pre><code>Input: ABAABABAABAB
Output: (0,A), (0,B), (1,B), (2,A), (4,A), (3,B)</code></pre>
<p>Used in: LZW (GIF, TIFF)</p>
</section>
<section id="burrows-wheeler-transform-bwt" class="level4">
<h4 class="anchored" data-anchor-id="burrows-wheeler-transform-bwt">5. Burrows-Wheeler Transform (BWT)</h4>
<p>BWT is not compression itself , it permutes text to cluster similar characters, making it more compressible by run-length or Huffman coding.</p>
</section>
<section id="steps" class="level4">
<h4 class="anchored" data-anchor-id="steps">Steps</h4>
<ol type="1">
<li>Generate all rotations of string.</li>
<li>Sort them lexicographically.</li>
<li>Take last column as output.</li>
</ol>
<p>Example: <code>banana$</code></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Rotations</th>
<th>Sorted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>banana$</td>
<td><span class="math inline">\(banana |
| anana\)</span>b</td>
</tr>
<tr class="even">
<td>a<span class="math inline">\(banan   | na\)</span>bana</td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(banana   | nana\)</span>ba</td>
<td></td>
</tr>
</tbody>
</table>
<p>Last column: <code>annb$aa</code> BWT(“banana<span class="math inline">\(") = "annb\)</span>aa”</p>
<p>Reversible with index of original row.</p>
<p>Used in: bzip2, FM-index (bioinformatics)</p>
</section>
<section id="summary-25" class="level4">
<h4 class="anchored" data-anchor-id="summary-25">6. Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 39%">
<col style="width: 18%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Idea</th>
<th>Complexity</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Huffman</td>
<td>Variable-length prefix codes</td>
<td>(O<span class="math inline">\(n \log n\)</span>)</td>
<td>General compression</td>
</tr>
<tr class="even">
<td>Arithmetic</td>
<td>Interval encoding</td>
<td>(O(n))</td>
<td>Near-optimal entropy</td>
</tr>
<tr class="odd">
<td>LZ77</td>
<td>Sliding window matches</td>
<td>(O(n))</td>
<td>ZIP, PNG</td>
</tr>
<tr class="even">
<td>LZ78</td>
<td>Dictionary building</td>
<td>(O(n))</td>
<td>GIF, TIFF</td>
</tr>
<tr class="odd">
<td>BWT</td>
<td>Permute for clustering</td>
<td>(O<span class="math inline">\(n \log n\)</span>)</td>
<td>bzip2</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-65" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-65">Why It Matters</h4>
<p>Compression algorithms reveal structure in data , they exploit patterns that humans can’t see. They’re also a window into information theory, showing how close we can get to the entropy limit.</p>
<blockquote class="blockquote">
<p>“To compress is to understand , every bit saved is a pattern found.”</p>
</blockquote>
</section>
<section id="try-it-yourself-65" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-65">Try It Yourself</h4>
<ol type="1">
<li>Build a Huffman tree for <code>MISSISSIPPI</code>.</li>
<li>Implement a simple LZ77 encoder for repeating patterns.</li>
<li>Apply BWT and observe clustering of symbols.</li>
<li>Compare Huffman and Arithmetic outputs on same input.</li>
<li>Explore DEFLATE format combining LZ77 + Huffman.</li>
</ol>
<p>Understanding compression means learning to see redundancy , the key to efficient storage, transmission, and understanding itself.</p>
</section>
</section>
<section id="cryptographic-hashes-and-checksums" class="level3">
<h3 class="anchored" data-anchor-id="cryptographic-hashes-and-checksums">67. Cryptographic Hashes and Checksums</h3>
<p>In algorithms, hashing helps us map data to fixed-size values. But when used for security and verification, hashing becomes a cryptographic tool. This section explores cryptographic hashes and checksums , algorithms that verify integrity, detect corruption, and secure data.</p>
<p>We’ll look at:</p>
<ul>
<li>Simple checksums (parity, CRC)- Cryptographic hash functions (MD5, SHA family, BLAKE3)- Properties like collision resistance and preimage resistance- Practical uses in verification, signing, and storage</li>
</ul>
<section id="checksums" class="level4">
<h4 class="anchored" data-anchor-id="checksums">1. Checksums</h4>
<p>Checksums are lightweight methods to detect accidental errors in data (not secure against attackers). They’re used in filesystems, networking, and storage to verify integrity.</p>
</section>
<section id="a.-parity-bit" class="level4">
<h4 class="anchored" data-anchor-id="a.-parity-bit">A. Parity Bit</h4>
<p>Adds one bit to make total 1s even or odd. Used in memory or communication to detect single-bit errors.</p>
<p>Example: Data = <code>1011</code> → has three 1s. Add parity bit <code>1</code> to make total 4 (even parity).</p>
<p>Limitation: Only detects odd number of bit errors.</p>
</section>
<section id="b.-modular-sum-simple-checksum" class="level4">
<h4 class="anchored" data-anchor-id="b.-modular-sum-simple-checksum">B. Modular Sum (Simple Checksum)</h4>
<p>Sum all bytes (mod 256 or 65536).</p>
<p>Tiny Code (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb347"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="dt">uint8_t</span> checksum<span class="op">(</span><span class="dt">uint8_t</span> <span class="op">*</span>data<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> sum <span class="op">+=</span> data<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">uint8_t</span><span class="op">)(</span>sum <span class="op">%</span> <span class="dv">256</span><span class="op">);</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Use: Simple file or packet validation.</p>
</section>
<section id="c.-crc-cyclic-redundancy-check" class="level4">
<h4 class="anchored" data-anchor-id="c.-crc-cyclic-redundancy-check">C. CRC (Cyclic Redundancy Check)</h4>
<p>CRCs treat bits as coefficients of a polynomial. Divide by a generator polynomial, remainder = CRC code.</p>
<p>Used in Ethernet, ZIP, and PNG.</p>
<p>Example: CRC-32, CRC-16.</p>
<p>Fast hardware and table-driven implementations available.</p>
<p>Key Property:</p>
<ul>
<li>Detects most burst errors- Not cryptographically secure</li>
</ul>
</section>
<section id="cryptographic-hash-functions" class="level4">
<h4 class="anchored" data-anchor-id="cryptographic-hash-functions">2. Cryptographic Hash Functions</h4>
<p>A cryptographic hash function ( h(x) ) maps any input to a fixed-size output such that:</p>
<ol type="1">
<li>Deterministic: same input → same output</li>
<li>Fast computation</li>
<li>Preimage resistance: hard to find ( x ) given ( h(x) )</li>
<li>Second-preimage resistance: hard to find <span class="math inline">\(x' \neq x\)</span> with ( h(x’) = h(x) )</li>
<li>Collision resistance: hard to find any two distinct inputs with same hash</li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Output (bits)</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MD5</td>
<td>128</td>
<td>Broken (collisions found)</td>
</tr>
<tr class="even">
<td>SHA-1</td>
<td>160</td>
<td>Deprecated</td>
</tr>
<tr class="odd">
<td>SHA-256</td>
<td>256</td>
<td>Standard (SHA-2 family)</td>
</tr>
<tr class="even">
<td>SHA-3</td>
<td>256</td>
<td>Keccak-based sponge</td>
</tr>
<tr class="odd">
<td>BLAKE3</td>
<td>256</td>
<td>Fast, parallel, modern</td>
</tr>
</tbody>
</table>
</section>
<section id="example-10" class="level4">
<h4 class="anchored" data-anchor-id="example-10">Example</h4>
<pre class="text"><code>h("hello") = 2cf24dba5fb0a... (SHA-256)</code></pre>
<p>Change one letter, hash changes completely (avalanche effect):</p>
<pre class="text"><code>h("Hello") = 185f8db32271f... </code></pre>
<p>Even small changes → big differences.</p>
</section>
<section id="tiny-code-c-using-pseudo-interface" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-c-using-pseudo-interface">Tiny Code (C, using pseudo-interface)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb350"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;openssl/sha.h&gt;</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="dt">unsigned</span> <span class="dt">char</span> hash<span class="op">[</span>SHA256_DIGEST_LENGTH<span class="op">];</span></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>SHA256<span class="op">((</span><span class="dt">unsigned</span> <span class="dt">char</span><span class="op">*)</span><span class="st">"hello"</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> hash<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Print hash as hex string to verify.</p>
</section>
<section id="applications-11" class="level4">
<h4 class="anchored" data-anchor-id="applications-11">3. Applications</h4>
<ul>
<li>Data integrity: verify files (e.g., SHA256SUM)- Digital signatures: sign hashes, not raw data- Password storage: store hashes, not plaintext- Deduplication: detect identical files via hashes- Blockchain: link blocks with hash pointers- Git: stores objects via SHA-1 identifiers</li>
</ul>
</section>
<section id="hash-collisions" class="level4">
<h4 class="anchored" data-anchor-id="hash-collisions">4. Hash Collisions</h4>
<p>A collision occurs when ( h(x) = h(y) ) for <span class="math inline">\(x \neq y\)</span>. Good cryptographic hashes make this computationally infeasible.</p>
<p>By the birthday paradox, collisions appear after <span class="math inline">\(2^{n/2}\)</span> operations for an ( n )-bit hash.</p>
<p>Hence, SHA-256 → ~<span class="math inline">\(2^{128}\)</span> effort to collide.</p>
</section>
<section id="checksums-vs-hashes" class="level4">
<h4 class="anchored" data-anchor-id="checksums-vs-hashes">5. Checksums vs Hashes</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>Checksum</th>
<th>Cryptographic Hash</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Goal</td>
<td>Detect errors</td>
<td>Ensure integrity and authenticity</td>
</tr>
<tr class="even">
<td>Resistance</td>
<td>Low</td>
<td>High</td>
</tr>
<tr class="odd">
<td>Output Size</td>
<td>Small</td>
<td>128-512 bits</td>
</tr>
<tr class="even">
<td>Performance</td>
<td>Very fast</td>
<td>Fast but secure</td>
</tr>
<tr class="odd">
<td>Example</td>
<td>CRC32</td>
<td>SHA-256, BLAKE3</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-66" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-66">Why It Matters</h4>
<p>Checksums catch accidental corruption, hashes protect against malicious tampering. Together, they guard the trustworthiness of data , the foundation of secure systems.</p>
<blockquote class="blockquote">
<p>“Integrity is invisible , until it’s lost.”</p>
</blockquote>
</section>
<section id="try-it-yourself-66" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-66">Try It Yourself</h4>
<ol type="1">
<li>Compute CRC32 of a text file, flip one bit, and recompute.</li>
<li>Use <code>sha256sum</code> to verify file integrity.</li>
<li>Experiment: change one character in input, observe avalanche.</li>
<li>Compare performance of SHA-256 and BLAKE3.</li>
<li>Research how Git uses SHA-1 to track versions.</li>
</ol>
<p>By learning hashes, you master one of the pillars of security , proof that something hasn’t changed, even when everything else does.</p>
</section>
</section>
<section id="approximate-and-streaming-matching" class="level3">
<h3 class="anchored" data-anchor-id="approximate-and-streaming-matching">68. Approximate and Streaming Matching</h3>
<p>Exact string matching (like KMP or Boyer-Moore) demands perfect alignment between pattern and text. But what if errors, noise, or incomplete data exist?</p>
<p>That’s where approximate matching and streaming matching come in. These algorithms let you search efficiently even when:</p>
<ul>
<li>The pattern might contain typos or mutations- The text arrives in a stream (too large to store entirely)- You want to match “close enough,” not “exactly” They’re crucial in search engines, spell checkers, bioinformatics, and real-time monitoring systems.</li>
</ul>
<section id="approximate-string-matching" class="level4">
<h4 class="anchored" data-anchor-id="approximate-string-matching">1. Approximate String Matching</h4>
<p>Approximate string matching finds occurrences of a pattern in a text allowing mismatches, insertions, or deletions , often measured by edit distance.</p>
</section>
<section id="a.-dynamic-programming-levenshtein-distance" class="level4">
<h4 class="anchored" data-anchor-id="a.-dynamic-programming-levenshtein-distance">A. Dynamic Programming (Levenshtein Distance)</h4>
<p>Given two strings <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, the edit distance is the minimum number of insertions, deletions, or substitutions to turn <span class="math inline">\(A\)</span> into <span class="math inline">\(B\)</span>.</p>
<p>We can build a DP table <span class="math inline">\(dp[i][j]\)</span>:</p>
<ul>
<li><span class="math inline">\(dp[i][0] = i\)</span> (delete all characters)<br>
</li>
<li><span class="math inline">\(dp[0][j] = j\)</span> (insert all characters)<br>
</li>
<li>If <span class="math inline">\(A[i] = B[j]\)</span>, then <span class="math inline">\(dp[i][j] = dp[i-1][j-1]\)</span><br>
</li>
<li>Else <span class="math inline">\(dp[i][j] = 1 + \min(dp[i-1][j],\, dp[i][j-1],\, dp[i-1][j-1])\)</span></li>
</ul>
<p>Tiny Code (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb351"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> edit_distance<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> strlen<span class="op">(</span>a<span class="op">),</span> m <span class="op">=</span> strlen<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">][</span>m<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> dp<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> j<span class="op">;</span></span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> fmin<span class="op">(</span>fmin<span class="op">(</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">],</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]),</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb351-11"><a href="#cb351-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>m<span class="op">];</span></span>
<span id="cb351-12"><a href="#cb351-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This computes Levenshtein distance in ( O(nm) ) time.</p>
</section>
<section id="b.-bitap-algorithm-shift-or" class="level4">
<h4 class="anchored" data-anchor-id="b.-bitap-algorithm-shift-or">B. Bitap Algorithm (Shift-Or)</h4>
<p>When pattern length is small, Bitap uses bitmasks to track mismatches. It efficiently supports up to k errors and runs in near linear time for small patterns.</p>
<p>Used in grep -E, ag, and fuzzy searching systems.</p>
<p>Idea: Maintain a bitmask where 1 = mismatch, 0 = match. Shift and OR masks as we scan text.</p>
</section>
<section id="c.-k-approximate-matching" class="level4">
<h4 class="anchored" data-anchor-id="c.-k-approximate-matching">C. k-Approximate Matching</h4>
<p>Find all positions where edit distance ≤ k. Efficient for small ( k ) (e.g., spell correction: edit distance ≤ 2).</p>
<p>Applications:</p>
<ul>
<li>Typo-tolerant search- DNA sequence matching- Autocomplete systems</li>
</ul>
</section>
<section id="streaming-matching" class="level4">
<h4 class="anchored" data-anchor-id="streaming-matching">2. Streaming Matching</h4>
<p>In streaming, the text is too large or unbounded, so we must process input online. We can’t store everything , only summaries or sketches.</p>
</section>
<section id="a.-rolling-hash-rabin-karp-style" class="level4">
<h4 class="anchored" data-anchor-id="a.-rolling-hash-rabin-karp-style">A. Rolling Hash (Rabin-Karp style)</h4>
<p>Maintains a moving hash of recent characters. When new character arrives, update hash in ( O(1) ). Compare with pattern’s hash for possible match.</p>
<p>Good for sliding window matching.</p>
<p>Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb352"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>hash <span class="op">=</span> <span class="op">(</span>base <span class="op">*</span> <span class="op">(</span>hash <span class="op">-</span> old_char <span class="op">*</span> base<span class="op">^(</span>m<span class="op">-</span><span class="dv">1</span><span class="op">))</span> <span class="op">+</span> new_char<span class="op">)</span> <span class="op">%</span> mod<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-fingerprinting-karp-rabin-fingerprint" class="level4">
<h4 class="anchored" data-anchor-id="b.-fingerprinting-karp-rabin-fingerprint">B. Fingerprinting (Karp-Rabin Fingerprint)</h4>
<p>A compact representation of a substring. If fingerprints match, do full verification (avoid false positives). Used in streaming algorithms and chunking.</p>
</section>
<section id="c.-sketch-based-matching" class="level4">
<h4 class="anchored" data-anchor-id="c.-sketch-based-matching">C. Sketch-Based Matching</h4>
<p>Algorithms like Count-Min Sketch or SimHash build summaries of large data. They help approximate similarity between streams.</p>
<p>Applications:</p>
<ul>
<li>Near-duplicate detection (SimHash in Google)- Network anomaly detection- Real-time log matching</li>
</ul>
</section>
<section id="approximate-matching-in-practice" class="level4">
<h4 class="anchored" data-anchor-id="approximate-matching-in-practice">3. Approximate Matching in Practice</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 34%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th>Domain</th>
<th>Use Case</th>
<th>Algorithm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Spell Checking</td>
<td>“recieve” → “receive”</td>
<td>Edit Distance</td>
</tr>
<tr class="even">
<td>DNA Alignment</td>
<td>Find similar sequences</td>
<td>Smith-Waterman</td>
</tr>
<tr class="odd">
<td>Autocomplete</td>
<td>Suggest close matches</td>
<td>Fuzzy Search</td>
</tr>
<tr class="even">
<td>Logs &amp; Streams</td>
<td>Online pattern alerts</td>
<td>Streaming Bitap, Karp-Rabin</td>
</tr>
<tr class="odd">
<td>Near-Duplicate</td>
<td>Detect similar text</td>
<td>SimHash, MinHash</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-4" class="level4">
<h4 class="anchored" data-anchor-id="complexity-4">4. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Time</th>
<th>Space</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Levenshtein DP</td>
<td>(O(nm))</td>
<td>(O(nm))</td>
<td>Exact distance</td>
</tr>
<tr class="even">
<td>Bitap</td>
<td>(O(n))</td>
<td>(O(1))</td>
<td>For small patterns</td>
</tr>
<tr class="odd">
<td>Rolling Hash</td>
<td>(O(n))</td>
<td>(O(1))</td>
<td>Probabilistic match</td>
</tr>
<tr class="even">
<td>SimHash</td>
<td>(O(n))</td>
<td>(O(1))</td>
<td>Approximate similarity</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-67" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-67">Why It Matters</h4>
<p>Real-world data is messy , typos, noise, loss, corruption. Approximate matching lets you build algorithms that forgive errors and adapt to streams. It powers everything from search engines to genomics, ensuring your algorithms stay practical in an imperfect world.</p>
</section>
<section id="try-it-yourself-67" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-67">Try It Yourself</h4>
<ol type="1">
<li>Compute edit distance between “kitten” and “sitting.”</li>
<li>Implement fuzzy search that returns words with ≤1 typo.</li>
<li>Use rolling hash to detect repeated substrings in a stream.</li>
<li>Experiment with SimHash to compare document similarity.</li>
<li>Observe how small typos affect fuzzy vs exact search.</li>
</ol>
</section>
</section>
<section id="bioinformatics-alignment-needleman-wunsch-smith-waterman" class="level3">
<h3 class="anchored" data-anchor-id="bioinformatics-alignment-needleman-wunsch-smith-waterman">69. Bioinformatics Alignment (Needleman-Wunsch, Smith-Waterman)</h3>
<p>In bioinformatics, comparing DNA, RNA, or protein sequences is like comparing strings , but with biological meaning. Each sequence is made of letters (A, C, G, T for DNA; amino acids for proteins). To analyze similarity, scientists use sequence alignment algorithms that handle insertions, deletions, and substitutions.</p>
<p>Two fundamental methods dominate:</p>
<ul>
<li>Needleman-Wunsch for global alignment- Smith-Waterman for local alignment</li>
</ul>
<section id="sequence-alignment" class="level4">
<h4 class="anchored" data-anchor-id="sequence-alignment">1. Sequence Alignment</h4>
<p>Alignment means placing two sequences side by side to maximize matches and minimize gaps or mismatches.</p>
<p>For example:</p>
<pre><code>A C G T G A
| | |   | |
A C G A G A</code></pre>
<p>Here, mismatches and gaps may occur, but the alignment finds the best possible match under a scoring system.</p>
</section>
<section id="scoring-system" class="level4">
<h4 class="anchored" data-anchor-id="scoring-system">Scoring System</h4>
<p>Alignment uses scores instead of just counts. Typical scheme:</p>
<ul>
<li>Match: +1- Mismatch: -1- Gap (insertion or deletion): -2 You can adjust weights depending on the biological context.</li>
</ul>
</section>
<section id="needleman-wunsch-global-alignment" class="level4">
<h4 class="anchored" data-anchor-id="needleman-wunsch-global-alignment">2. Needleman-Wunsch (Global Alignment)</h4>
<p>Used when you want to align entire sequences , from start to end.</p>
<p>It uses dynamic programming to build a score table ( dp[i][j] ), where each cell represents the best score for aligning prefixes ( A[1..i] ) and ( B[1..j] ).</p>
<p>Recurrence:</p>
<p><span class="math display">\[dp[i][j] = \max
\begin{cases}
dp[i-1][j-1] + \text{score}(A_i, B_j) \
dp[i-1][j] + \text{gap penalty} \
dp[i][j-1] + \text{gap penalty}
\end{cases}\]</span></p>
<p>Base cases: <span class="math display">\[
dp[0][j] = j \times \text{gap penalty}, \quad dp[i][0] = i \times \text{gap penalty}
\]</span></p>
<p>Tiny Code (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb354"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> max3<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">&gt;</span> b <span class="op">?</span> <span class="op">(</span>a <span class="op">&gt;</span> c <span class="op">?</span> a <span class="op">:</span> c<span class="op">)</span> <span class="op">:</span> <span class="op">(</span>b <span class="op">&gt;</span> c <span class="op">?</span> b <span class="op">:</span> c<span class="op">);</span></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> needleman_wunsch<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>A<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>B<span class="op">,</span> <span class="dt">int</span> match<span class="op">,</span> <span class="dt">int</span> mismatch<span class="op">,</span> <span class="dt">int</span> gap<span class="op">)</span> <span class="op">{</span></span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> strlen<span class="op">(</span>A<span class="op">),</span> m <span class="op">=</span> strlen<span class="op">(</span>B<span class="op">);</span></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dp<span class="op">[</span>n<span class="op">+</span><span class="dv">1</span><span class="op">][</span>m<span class="op">+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> dp<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> i <span class="op">*</span> gap<span class="op">;</span></span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span> dp<span class="op">[</span><span class="dv">0</span><span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> j <span class="op">*</span> gap<span class="op">;</span></span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> m<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> s <span class="op">=</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">==</span> B<span class="op">[</span>j<span class="op">-</span><span class="dv">1</span><span class="op">])</span> <span class="op">?</span> match <span class="op">:</span> mismatch<span class="op">;</span></span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a>            dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> max3<span class="op">(</span>dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> s<span class="op">,</span> dp<span class="op">[</span>i<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">+</span> gap<span class="op">,</span> dp<span class="op">[</span>i<span class="op">][</span>j<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> gap<span class="op">);</span></span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb354-16"><a href="#cb354-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb354-17"><a href="#cb354-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dp<span class="op">[</span>n<span class="op">][</span>m<span class="op">];</span></span>
<span id="cb354-18"><a href="#cb354-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Example:</p>
<pre><code>A = "ACGT"
B = "AGT"
match = +1, mismatch = -1, gap = -2</code></pre>
<p>Produces optimal alignment:</p>
<pre><code>A C G T
A - G T</code></pre>
</section>
<section id="smith-waterman-local-alignment" class="level4">
<h4 class="anchored" data-anchor-id="smith-waterman-local-alignment">3. Smith-Waterman (Local Alignment)</h4>
<p>Used when sequences may have similar segments, not full-length similarity. Perfect for finding motifs or conserved regions.</p>
<p>Recurrence is similar, but with local reset to zero:</p>
<p><span class="math display">\[dp[i][j] = \max
\begin{cases}
0, \
dp[i-1][j-1] + \text{score}(A_i, B_j), \
dp[i-1][j] + \text{gap penalty}, \
dp[i][j-1] + \text{gap penalty}
\end{cases}\]</span></p>
<p>Final answer = maximum value in the table (not necessarily at the end).</p>
<p>It finds the best substring alignment.</p>
</section>
<section id="example-11" class="level4">
<h4 class="anchored" data-anchor-id="example-11">Example</h4>
<pre><code>A = "ACGTTG"
B = "CGT"</code></pre>
<p>Smith-Waterman finds best local match:</p>
<pre><code>A C G T
  | | |
  C G T</code></pre>
<p>Unlike global alignment, extra prefixes or suffixes are ignored.</p>
</section>
<section id="variants-and-extensions" class="level4">
<h4 class="anchored" data-anchor-id="variants-and-extensions">4. Variants and Extensions</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 12%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Type</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Needleman-Wunsch</td>
<td>Global</td>
<td>Aligns full sequences</td>
</tr>
<tr class="even">
<td>Smith-Waterman</td>
<td>Local</td>
<td>Finds similar subsequences</td>
</tr>
<tr class="odd">
<td>Gotoh Algorithm</td>
<td>Global</td>
<td>Uses affine gap penalty (opening + extension)</td>
</tr>
<tr class="even">
<td>BLAST</td>
<td>Heuristic</td>
<td>Speeds up search for large databases</td>
</tr>
</tbody>
</table>
<p>BLAST (Basic Local Alignment Search Tool) uses word seeds and extension, trading exactness for speed , essential for large genome databases.</p>
</section>
<section id="complexity-5" class="level4">
<h4 class="anchored" data-anchor-id="complexity-5">5. Complexity</h4>
<p>Both Needleman-Wunsch and Smith-Waterman run in:</p>
<ul>
<li>Time: ( O(nm) )- Space: ( O(nm) ) But optimized versions use banded DP or Hirschberg’s algorithm to cut memory to ( O(n + m) ).</li>
</ul>
</section>
<section id="why-it-matters-68" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-68">Why It Matters</h4>
<p>Sequence alignment bridges computer science and biology. It’s how we:</p>
<ul>
<li>Compare species- Identify genes- Detect mutations- Trace ancestry- Build phylogenetic trees The idea of “minimum edit cost” echoes everywhere , from spell checkers to DNA analysis.</li>
</ul>
<blockquote class="blockquote">
<p>“In biology, similarity is a story. Alignment is how we read it.”</p>
</blockquote>
</section>
<section id="try-it-yourself-68" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-68">Try It Yourself</h4>
<ol type="1">
<li>Implement Needleman-Wunsch for short DNA sequences.</li>
<li>Change gap penalties , see how alignment shifts.</li>
<li>Compare outputs from global and local alignment.</li>
<li>Use real sequences from GenBank to test.</li>
<li>Explore BLAST online and compare to exact alignment results.</li>
</ol>
</section>
</section>
<section id="text-indexing-and-search-structures" class="level3">
<h3 class="anchored" data-anchor-id="text-indexing-and-search-structures">70. Text Indexing and Search Structures</h3>
<p>When text becomes large , think books, databases, or the entire web , searching naively for patterns (O(nm)) is far too slow. We need indexing structures that let us search fast, often in O(m) or O(log n) time.</p>
<p>This section covers the backbone of search engines and string processing:</p>
<ul>
<li>Suffix Arrays- Suffix Trees- Inverted Indexes- Tries and Prefix Trees- Compressed Indexes like FM-Index (Burrows-Wheeler)</li>
</ul>
<section id="why-index" class="level4">
<h4 class="anchored" data-anchor-id="why-index">1. Why Index?</h4>
<p>A text index is like a table of contents , it doesn’t store the book, but lets you jump straight to what you want.</p>
<p>If you have a text of length ( n ), and you’ll run many queries, it’s worth building an index (even if it costs ( O<span class="math inline">\(n \log n\)</span> ) to build).</p>
<p>Without indexing: each query takes ( O(nm) ). With indexing: each query can take ( O(m) ) or less.</p>
</section>
<section id="suffix-array" class="level4">
<h4 class="anchored" data-anchor-id="suffix-array">2. Suffix Array</h4>
<p>A suffix array is a sorted array of all suffixes of a string.</p>
<p>For text <code>"banana"</code>, suffixes are:</p>
<pre><code>0: banana  
1: anana  
2: nana  
3: ana  
4: na  
5: a</code></pre>
<p>Sorted lexicographically:</p>
<pre><code>5: a  
3: ana  
1: anana  
0: banana  
4: na  
2: nana</code></pre>
<p>Suffix Array = <code>[5, 3, 1, 0, 4, 2]</code></p>
<p>To search, binary search over the suffix array using your pattern , ( O<span class="math inline">\(m \log n\)</span> ).</p>
<p>Tiny Code (C) (naive construction)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb361"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cmp<span class="op">(</span><span class="dt">const</span> <span class="dt">void</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">const</span> <span class="dt">void</span> <span class="op">*</span>b<span class="op">,</span> <span class="dt">void</span> <span class="op">*</span>txt<span class="op">)</span> <span class="op">{</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="op">*(</span><span class="dt">int</span><span class="op">*)</span>a<span class="op">,</span> j <span class="op">=</span> <span class="op">*(</span><span class="dt">int</span><span class="op">*)</span>b<span class="op">;</span></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> strcmp<span class="op">((</span><span class="dt">char</span><span class="op">*)</span>txt <span class="op">+</span> i<span class="op">,</span> <span class="op">(</span><span class="dt">char</span><span class="op">*)</span>txt <span class="op">+</span> j<span class="op">);</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> build_suffix_array<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>txt<span class="op">,</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> sa<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> sa<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a>    qsort_r<span class="op">(</span>sa<span class="op">,</span> n<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">int</span><span class="op">),</span> cmp<span class="op">,</span> txt<span class="op">);</span></span>
<span id="cb361-9"><a href="#cb361-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Modern methods like prefix doubling or radix sort build it in ( O<span class="math inline">\(n \log n\)</span> ).</p>
<p>Applications:</p>
<ul>
<li>Fast substring search- Longest common prefix (LCP) array- Pattern matching in DNA sequences- Plagiarism detection</li>
</ul>
</section>
<section id="suffix-tree-1" class="level4">
<h4 class="anchored" data-anchor-id="suffix-tree-1">3. Suffix Tree</h4>
<p>A suffix tree is a compressed trie of all suffixes , each edge stores multiple characters.</p>
<p>For <code>"banana"</code>, you’d build a tree where each leaf corresponds to a suffix index.</p>
<p>Advantages:</p>
<ul>
<li>Pattern search in ( O(m) )- Space ( O(n) ) (with compression) Built using Ukkonen’s algorithm in ( O(n) ).</li>
</ul>
<p>Use Suffix Array + LCP as a space-efficient alternative.</p>
</section>
<section id="fm-index-burrows-wheeler-transform" class="level4">
<h4 class="anchored" data-anchor-id="fm-index-burrows-wheeler-transform">4. FM-Index (Burrows-Wheeler Transform)</h4>
<p>Used in compressed full-text search (e.g., Bowtie, BWA). Combines:</p>
<ul>
<li>Burrows-Wheeler Transform (BWT)- Rank/select bitvectors Supports pattern search in O(m) time with very low memory.</li>
</ul>
<p>Idea: transform text so similar substrings cluster together, enabling compression and backward search.</p>
<p>Applications:</p>
<ul>
<li>DNA alignment- Large text archives- Memory-constrained search</li>
</ul>
</section>
<section id="inverted-index" class="level4">
<h4 class="anchored" data-anchor-id="inverted-index">5. Inverted Index</h4>
<p>Used in search engines. Instead of suffixes, it indexes words.</p>
<p>For example, text corpus:</p>
<pre><code>doc1: quick brown fox  
doc2: quick red fox</code></pre>
<p>Inverted index:</p>
<pre><code>"quick" → [doc1, doc2]
"brown" → [doc1]
"red"   → [doc2]
"fox"   → [doc1, doc2]</code></pre>
<p>Now searching “quick fox” becomes set intersection of lists.</p>
<p>Used with ranking functions (TF-IDF, BM25).</p>
</section>
<section id="tries-and-prefix-trees" class="level4">
<h4 class="anchored" data-anchor-id="tries-and-prefix-trees">6. Tries and Prefix Trees</h4>
<p>A trie stores strings character by character. Each node = prefix.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb364"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>child<span class="op">[</span><span class="dv">26</span><span class="op">];</span></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> end<span class="op">;</span></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Perfect for:</p>
<ul>
<li>Autocomplete- Prefix search- Spell checkers Search: O(m), where m = pattern length.</li>
</ul>
<p>Compressed tries (Patricia trees) reduce space.</p>
</section>
<section id="comparing-structures" class="level4">
<h4 class="anchored" data-anchor-id="comparing-structures">7. Comparing Structures</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Structure</th>
<th>Search Time</th>
<th>Build Time</th>
<th>Space</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Trie</td>
<td>O(m)</td>
<td>O(n)</td>
<td>High</td>
<td>Prefix queries</td>
</tr>
<tr class="even">
<td>Suffix Array</td>
<td>O(m log n)</td>
<td>O(n log n)</td>
<td>Medium</td>
<td>Sorted suffixes</td>
</tr>
<tr class="odd">
<td>Suffix Tree</td>
<td>O(m)</td>
<td>O(n)</td>
<td>High</td>
<td>Rich structure</td>
</tr>
<tr class="even">
<td>FM-Index</td>
<td>O(m)</td>
<td>O(n)</td>
<td>Low</td>
<td>Compressed</td>
</tr>
<tr class="odd">
<td>Inverted Index</td>
<td>O(k)</td>
<td>O(N)</td>
<td>Medium</td>
<td>Word-based</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-69" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-69">Why It Matters</h4>
<p>Text indexing is the backbone of search engines, DNA alignment, and autocomplete systems. Without it, Google searches, code lookups, or genome scans would take minutes, not milliseconds.</p>
<blockquote class="blockquote">
<p>“Indexing turns oceans of text into navigable maps.”</p>
</blockquote>
</section>
<section id="try-it-yourself-69" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-69">Try It Yourself</h4>
<ol type="1">
<li>Build a suffix array for “banana” and perform binary search for “ana.”</li>
<li>Construct a trie for a dictionary and query prefixes.</li>
<li>Write a simple inverted index for a few documents.</li>
<li>Compare memory usage of suffix tree vs suffix array.</li>
<li>Experiment with FM-index using an online demo (like BWT explorer).</li>
</ol>
</section>
</section>
</section>
<section id="chapter-8.-geometry-graphics-and-spatial-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="chapter-8.-geometry-graphics-and-spatial-algorithms">Chapter 8. Geometry, Graphics, and Spatial Algorithms</h2>
<section id="convex-hull-graham-andrew-chan" class="level3">
<h3 class="anchored" data-anchor-id="convex-hull-graham-andrew-chan">71. Convex Hull (Graham, Andrew, Chan)</h3>
<p>In computational geometry, the convex hull of a set of points is the smallest convex polygon that contains all the points. Intuitively, imagine stretching a rubber band around a set of nails on a board , the shape the band takes is the convex hull.</p>
<p>Convex hulls are foundational for many geometric algorithms, like closest pair, Voronoi diagrams, and collision detection.</p>
<p>In this section, we’ll explore three classical algorithms:</p>
<ul>
<li>Graham Scan - elegant and simple (O(n log n))- Andrew’s Monotone Chain - robust and practical (O(n log n))- Chan’s Algorithm - advanced and optimal (O(n log h), where h = number of hull points)</li>
</ul>
<section id="definition-1" class="level4">
<h4 class="anchored" data-anchor-id="definition-1">1. Definition</h4>
<p>Given a set of points <span class="math inline">\(P = {p_1, p_2, ..., p_n}\)</span>, the convex hull, ( (P) ), is the smallest convex polygon enclosing all points.</p>
<p>Formally: <span class="math display">\[
\text{CH}(P) = \bigcap {C \subseteq \mathbb{R}^2 \mid C \text{ is convex and } P \subseteq C }
\]</span></p>
<p>A polygon is convex if every line segment between two points of the polygon lies entirely inside it.</p>
</section>
<section id="orientation-test" class="level4">
<h4 class="anchored" data-anchor-id="orientation-test">2. Orientation Test</h4>
<p>All convex hull algorithms rely on an orientation test using cross product: Given three points ( a, b, c ):</p>
<p><span class="math display">\[
\text{cross}(a,b,c) = (b_x - a_x)(c_y - a_y) - (b_y - a_y)(c_x - a_x)
\]</span></p>
<ul>
<li><code>&gt; 0</code> → counter-clockwise turn- <code>&lt; 0</code> → clockwise turn- <code>= 0</code> → collinear</li>
</ul>
</section>
<section id="graham-scan" class="level4">
<h4 class="anchored" data-anchor-id="graham-scan">3. Graham Scan</h4>
<p>One of the earliest convex hull algorithms.</p>
<p>Idea:</p>
<ol type="1">
<li><p>Pick the lowest point (and leftmost if tie).</p></li>
<li><p>Sort all other points by polar angle with respect to it.</p></li>
<li><p>Traverse points and maintain a stack:</p>
<ul>
<li>Add point - While last three points make a right turn, pop middle one4. Remaining points form convex hull in CCW order.</li>
</ul></li>
</ol>
<p>Tiny Code (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb365"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> <span class="dt">double</span> x<span class="op">,</span> y<span class="op">;</span> <span class="op">}</span> Point<span class="op">;</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> cross<span class="op">(</span>Point a<span class="op">,</span> Point b<span class="op">,</span> Point c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>b<span class="op">.</span>x <span class="op">-</span> a<span class="op">.</span>x<span class="op">)*(</span>c<span class="op">.</span>y <span class="op">-</span> a<span class="op">.</span>y<span class="op">)</span> <span class="op">-</span> <span class="op">(</span>b<span class="op">.</span>y <span class="op">-</span> a<span class="op">.</span>y<span class="op">)*(</span>c<span class="op">.</span>x <span class="op">-</span> a<span class="op">.</span>x<span class="op">);</span></span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cmp<span class="op">(</span><span class="dt">const</span> <span class="dt">void</span> <span class="op">*</span>p1<span class="op">,</span> <span class="dt">const</span> <span class="dt">void</span> <span class="op">*</span>p2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>    Point <span class="op">*</span>a <span class="op">=</span> <span class="op">(</span>Point<span class="op">*)</span>p1<span class="op">,</span> <span class="op">*</span>b <span class="op">=</span> <span class="op">(</span>Point<span class="op">*)</span>p2<span class="op">;</span></span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Compare by polar angle or distance</span></span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>a<span class="op">-&gt;</span>y <span class="op">!=</span> b<span class="op">-&gt;</span>y<span class="op">)</span> <span class="op">?</span> <span class="op">(</span>a<span class="op">-&gt;</span>y <span class="op">-</span> b<span class="op">-&gt;</span>y<span class="op">)</span> <span class="op">:</span> <span class="op">(</span>a<span class="op">-&gt;</span>x <span class="op">-</span> b<span class="op">-&gt;</span>x<span class="op">);</span></span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> graham_scan<span class="op">(</span>Point pts<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> Point hull<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb365-14"><a href="#cb365-14" aria-hidden="true" tabindex="-1"></a>    qsort<span class="op">(</span>pts<span class="op">,</span> n<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>Point<span class="op">),</span> cmp<span class="op">);</span></span>
<span id="cb365-15"><a href="#cb365-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> top <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb365-16"><a href="#cb365-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb365-17"><a href="#cb365-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>top <span class="op">&gt;=</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span> cross<span class="op">(</span>hull<span class="op">[</span>top<span class="op">-</span><span class="dv">2</span><span class="op">],</span> hull<span class="op">[</span>top<span class="op">-</span><span class="dv">1</span><span class="op">],</span> pts<span class="op">[</span>i<span class="op">])</span> <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb365-18"><a href="#cb365-18" aria-hidden="true" tabindex="-1"></a>            top<span class="op">--;</span></span>
<span id="cb365-19"><a href="#cb365-19" aria-hidden="true" tabindex="-1"></a>        hull<span class="op">[</span>top<span class="op">++]</span> <span class="op">=</span> pts<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb365-20"><a href="#cb365-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb365-21"><a href="#cb365-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> top<span class="op">;</span> <span class="co">// number of hull points</span></span>
<span id="cb365-22"><a href="#cb365-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Complexity:</p>
<ul>
<li>Sorting: ( O<span class="math inline">\(n \log n\)</span> )- Scanning: ( O(n) ) → Total: O(n log n)</li>
</ul>
</section>
<section id="example-12" class="level4">
<h4 class="anchored" data-anchor-id="example-12">Example</h4>
<p>Input:</p>
<pre><code>(0, 0), (1, 1), (2, 2), (2, 0), (0, 2)</code></pre>
<p>Hull (CCW):</p>
<pre><code>(0,0) → (2,0) → (2,2) → (0,2)</code></pre>
</section>
<section id="andrews-monotone-chain" class="level4">
<h4 class="anchored" data-anchor-id="andrews-monotone-chain">4. Andrew’s Monotone Chain</h4>
<p>Simpler and more robust for floating-point coordinates. Builds lower and upper hulls separately.</p>
<p>Steps:</p>
<ol type="1">
<li>Sort points lexicographically (x, then y).</li>
<li>Build lower hull (left-to-right)</li>
<li>Build upper hull (right-to-left)</li>
<li>Concatenate (excluding duplicates)</li>
</ol>
<p>Tiny Code (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb368"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> monotone_chain<span class="op">(</span>Point pts<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> Point hull<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>    qsort<span class="op">(</span>pts<span class="op">,</span> n<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>Point<span class="op">),</span> cmp<span class="op">);</span></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Lower hull</span></span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>k <span class="op">&gt;=</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span> cross<span class="op">(</span>hull<span class="op">[</span>k<span class="op">-</span><span class="dv">2</span><span class="op">],</span> hull<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">],</span> pts<span class="op">[</span>i<span class="op">])</span> <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> k<span class="op">--;</span></span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>        hull<span class="op">[</span>k<span class="op">++]</span> <span class="op">=</span> pts<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Upper hull</span></span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> n<span class="op">-</span><span class="dv">2</span><span class="op">,</span> t <span class="op">=</span> k<span class="op">+</span><span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>k <span class="op">&gt;=</span> t <span class="op">&amp;&amp;</span> cross<span class="op">(</span>hull<span class="op">[</span>k<span class="op">-</span><span class="dv">2</span><span class="op">],</span> hull<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">],</span> pts<span class="op">[</span>i<span class="op">])</span> <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> k<span class="op">--;</span></span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>        hull<span class="op">[</span>k<span class="op">++]</span> <span class="op">=</span> pts<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> k<span class="op">-</span><span class="dv">1</span><span class="op">;</span> <span class="co">// last point == first point</span></span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: ( O<span class="math inline">\(n \log n\)</span> )</p>
</section>
<section id="chans-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="chans-algorithm">5. Chan’s Algorithm</h4>
<p>When <span class="math inline">\(h \ll n\)</span>, Chan’s method achieves ( O<span class="math inline">\(n \log h\)</span> ):</p>
<ol type="1">
<li>Partition points into groups of size ( m ).</li>
<li>Compute hulls for each group (Graham).</li>
<li>Merge hulls with Jarvis March (gift wrapping).</li>
<li>Choose ( m ) cleverly (<span class="math inline">\(m = 2^k\)</span>) to ensure ( O<span class="math inline">\(n \log h\)</span> ).</li>
</ol>
<p>Used in: large-scale geometric processing.</p>
</section>
<section id="applications-12" class="level4">
<h4 class="anchored" data-anchor-id="applications-12">6. Applications</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Domain</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Computer Graphics</td>
<td>Shape boundary, hitboxes</td>
</tr>
<tr class="even">
<td>GIS / Mapping</td>
<td>Region boundaries</td>
</tr>
<tr class="odd">
<td>Robotics</td>
<td>Obstacle envelopes</td>
</tr>
<tr class="even">
<td>Clustering</td>
<td>Outlier detection</td>
</tr>
<tr class="odd">
<td>Data Analysis</td>
<td>Minimal bounding shape</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-summary" class="level4">
<h4 class="anchored" data-anchor-id="complexity-summary">7. Complexity Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Time</th>
<th>Space</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Graham Scan</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
<td>( O(n) )</td>
<td>Simple, classic</td>
</tr>
<tr class="even">
<td>Monotone Chain</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
<td>( O(n) )</td>
<td>Stable, robust</td>
</tr>
<tr class="odd">
<td>Chan’s Algorithm</td>
<td>( O<span class="math inline">\(n \log h\)</span> )</td>
<td>( O(n) )</td>
<td>Best asymptotic</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-70" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-70">Why It Matters</h4>
<p>Convex hulls are one of the cornerstones of computational geometry. They teach sorting, cross products, and geometric reasoning , and form the basis for many spatial algorithms.</p>
<blockquote class="blockquote">
<p>“Every scattered set hides a simple shape. The convex hull is that hidden simplicity.”</p>
</blockquote>
</section>
<section id="try-it-yourself-70" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-70">Try It Yourself</h4>
<ol type="1">
<li>Implement Graham Scan for 10 random points.</li>
<li>Plot the points and verify the hull.</li>
<li>Compare results with Andrew’s Monotone Chain.</li>
<li>Test with collinear and duplicate points.</li>
<li>Explore 3D convex hulls (QuickHull, Gift Wrapping) next.</li>
</ol>
</section>
</section>
<section id="closest-pair-and-segment-intersection" class="level3">
<h3 class="anchored" data-anchor-id="closest-pair-and-segment-intersection">72. Closest Pair and Segment Intersection</h3>
<p>Geometric problems often ask: <em>what’s the shortest distance between two points?</em> or <em>do these segments cross?</em> These are classic building blocks in computational geometry , essential for collision detection, graphics, clustering, and path planning.</p>
<p>This section covers two foundational problems:</p>
<ul>
<li>Closest Pair of Points - find two points with minimum Euclidean distance- Segment Intersection - determine if (and where) two line segments intersect</li>
</ul>
<section id="closest-pair-of-points" class="level4">
<h4 class="anchored" data-anchor-id="closest-pair-of-points">1. Closest Pair of Points</h4>
<p>Given ( n ) points in 2D, find a pair with the smallest distance. The brute force solution is ( O<span class="math inline">\(n^2\)</span> ), but using Divide and Conquer, we can solve it in O(n log n).</p>
</section>
<section id="a.-divide-and-conquer-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="a.-divide-and-conquer-algorithm">A. Divide and Conquer Algorithm</h4>
<p>Idea:</p>
<ol type="1">
<li>Sort points by x-coordinate.</li>
<li>Split into left and right halves.</li>
<li>Recursively find closest pairs in each half (distance = ( d )).</li>
<li>Merge step: check pairs across the split line within ( d ).</li>
</ol>
<p>In merge step, we only need to check at most 6 neighbors per point (by geometric packing).</p>
<p>Tiny Code (C, Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb369"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> <span class="dt">double</span> x<span class="op">,</span> y<span class="op">;</span> <span class="op">}</span> Point<span class="op">;</span></span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> dist<span class="op">(</span>Point a<span class="op">,</span> Point b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> dx <span class="op">=</span> a<span class="op">.</span>x <span class="op">-</span> b<span class="op">.</span>x<span class="op">,</span> dy <span class="op">=</span> a<span class="op">.</span>y <span class="op">-</span> b<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt<span class="op">(</span>dx<span class="op">*</span>dx <span class="op">+</span> dy<span class="op">*</span>dy<span class="op">);</span></span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> brute_force<span class="op">(</span>Point pts<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> d <span class="op">=</span> <span class="fl">1e9</span><span class="op">;</span></span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> j<span class="op">++)</span></span>
<span id="cb369-13"><a href="#cb369-13" aria-hidden="true" tabindex="-1"></a>            d <span class="op">=</span> fmin<span class="op">(</span>d<span class="op">,</span> dist<span class="op">(</span>pts<span class="op">[</span>i<span class="op">],</span> pts<span class="op">[</span>j<span class="op">]));</span></span>
<span id="cb369-14"><a href="#cb369-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb369-15"><a href="#cb369-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Recursive divide and merge:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb370"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> closest_pair<span class="op">(</span>Point pts<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">3</span><span class="op">)</span> <span class="cf">return</span> brute_force<span class="op">(</span>pts<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> d <span class="op">=</span> fmin<span class="op">(</span>closest_pair<span class="op">(</span>pts<span class="op">,</span> mid<span class="op">),</span></span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>                    closest_pair<span class="op">(</span>pts <span class="op">+</span> mid<span class="op">,</span> n <span class="op">-</span> mid<span class="op">));</span></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// merge step: check strip points within distance d</span></span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// sort by y, check neighbors</span></span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Time Complexity: ( O<span class="math inline">\(n \log n\)</span> )</p>
<p>Example:</p>
<p>Points:</p>
<pre><code>(2,3), (12,30), (40,50), (5,1), (12,10), (3,4)</code></pre>
<p>Closest pair: (2,3) and (3,4), distance = √2</p>
</section>
<section id="b.-sweep-line-variant" class="level4">
<h4 class="anchored" data-anchor-id="b.-sweep-line-variant">B. Sweep Line Variant</h4>
<p>Another method uses a line sweep and a balanced tree to keep active points. As you move from left to right, maintain a window of recent points within ( d ).</p>
<p>Used in large-scale spatial systems.</p>
</section>
<section id="applications-13" class="level4">
<h4 class="anchored" data-anchor-id="applications-13">Applications</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Domain</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Clustering</td>
<td>Find nearest neighbors</td>
</tr>
<tr class="even">
<td>Robotics</td>
<td>Avoid collisions</td>
</tr>
<tr class="odd">
<td>GIS</td>
<td>Nearest city search</td>
</tr>
<tr class="even">
<td>Networking</td>
<td>Sensor proximity</td>
</tr>
</tbody>
</table>
</section>
<section id="segment-intersection" class="level4">
<h4 class="anchored" data-anchor-id="segment-intersection">2. Segment Intersection</h4>
<p>Given two segments ( AB ) and ( CD ), determine whether they intersect. It’s the core of geometry engines and vector graphics systems.</p>
</section>
<section id="a.-orientation-test" class="level4">
<h4 class="anchored" data-anchor-id="a.-orientation-test">A. Orientation Test</h4>
<p>We use the cross product (orientation) test again. Two segments ( AB ) and ( CD ) intersect if and only if:</p>
<ol type="1">
<li>The segments straddle each other: <span class="math display">\[
\text{orient}(A, B, C) \neq \text{orient}(A, B, D)
\]</span></li>
</ol>
<p><span class="math display">\[
\text{orient}(C, D, A) \neq \text{orient}(C, D, B)
\]</span> 2. Special cases for collinear points (check bounding boxes).</p>
<p>Tiny Code (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb372"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> cross<span class="op">(</span>Point a<span class="op">,</span> Point b<span class="op">,</span> Point c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>b<span class="op">.</span>x <span class="op">-</span> a<span class="op">.</span>x<span class="op">)*(</span>c<span class="op">.</span>y <span class="op">-</span> a<span class="op">.</span>y<span class="op">)</span> <span class="op">-</span> <span class="op">(</span>b<span class="op">.</span>y <span class="op">-</span> a<span class="op">.</span>y<span class="op">)*(</span>c<span class="op">.</span>x <span class="op">-</span> a<span class="op">.</span>x<span class="op">);</span></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> on_segment<span class="op">(</span>Point a<span class="op">,</span> Point b<span class="op">,</span> Point c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fmin<span class="op">(</span>a<span class="op">.</span>x<span class="op">,</span> b<span class="op">.</span>x<span class="op">)</span> <span class="op">&lt;=</span> c<span class="op">.</span>x <span class="op">&amp;&amp;</span> c<span class="op">.</span>x <span class="op">&lt;=</span> fmax<span class="op">(</span>a<span class="op">.</span>x<span class="op">,</span> b<span class="op">.</span>x<span class="op">)</span> <span class="op">&amp;&amp;</span></span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a>           fmin<span class="op">(</span>a<span class="op">.</span>y<span class="op">,</span> b<span class="op">.</span>y<span class="op">)</span> <span class="op">&lt;=</span> c<span class="op">.</span>y <span class="op">&amp;&amp;</span> c<span class="op">.</span>y <span class="op">&lt;=</span> fmax<span class="op">(</span>a<span class="op">.</span>y<span class="op">,</span> b<span class="op">.</span>y<span class="op">);</span></span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> intersect<span class="op">(</span>Point a<span class="op">,</span> Point b<span class="op">,</span> Point c<span class="op">,</span> Point d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> o1 <span class="op">=</span> cross<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> c<span class="op">);</span></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> o2 <span class="op">=</span> cross<span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> d<span class="op">);</span></span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> o3 <span class="op">=</span> cross<span class="op">(</span>c<span class="op">,</span> d<span class="op">,</span> a<span class="op">);</span></span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> o4 <span class="op">=</span> cross<span class="op">(</span>c<span class="op">,</span> d<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>o1<span class="op">*</span>o2 <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> o3<span class="op">*</span>o4 <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// general case</span></span>
<span id="cb372-16"><a href="#cb372-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>o1 <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> on_segment<span class="op">(</span>a<span class="op">,</span>b<span class="op">,</span>c<span class="op">))</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb372-17"><a href="#cb372-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>o2 <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> on_segment<span class="op">(</span>a<span class="op">,</span>b<span class="op">,</span>d<span class="op">))</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb372-18"><a href="#cb372-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>o3 <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> on_segment<span class="op">(</span>c<span class="op">,</span>d<span class="op">,</span>a<span class="op">))</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb372-19"><a href="#cb372-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>o4 <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> on_segment<span class="op">(</span>c<span class="op">,</span>d<span class="op">,</span>b<span class="op">))</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb372-20"><a href="#cb372-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb372-21"><a href="#cb372-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="b.-line-sweep-algorithm-bentley-ottmann" class="level4">
<h4 class="anchored" data-anchor-id="b.-line-sweep-algorithm-bentley-ottmann">B. Line Sweep Algorithm (Bentley-Ottmann)</h4>
<p>For multiple segments, check all intersections efficiently. Algorithm:</p>
<ol type="1">
<li>Sort all endpoints by x-coordinate.</li>
<li>Sweep from left to right.</li>
<li>Maintain active set (balanced BST).</li>
<li>Check neighboring segments for intersections.</li>
</ol>
<p>Time complexity: <span class="math inline">\(O((n + k) \log n)\)</span>, where <span class="math inline">\(k\)</span> is the number of intersections.</p>
<p>Used in CAD, map rendering, and collision systems.</p>
</section>
<section id="complexity-summary-1" class="level4">
<h4 class="anchored" data-anchor-id="complexity-summary-1">3. Complexity Summary</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 18%">
<col style="width: 28%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>Naive</th>
<th>Optimal</th>
<th>Technique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Closest Pair</td>
<td><span class="math inline">\(O(n^2)\)</span></td>
<td><span class="math inline">\(O(n \log n)\)</span></td>
<td>Divide &amp; Conquer</td>
</tr>
<tr class="even">
<td>Segment Intersection</td>
<td><span class="math inline">\(O(n^2)\)</span></td>
<td><span class="math inline">\(O((n + k) \log n)\)</span></td>
<td>Sweep Line</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-71" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-71">Why It Matters</h4>
<p>Geometric algorithms like these teach how to reason spatially , blending math, sorting, and logic. They power real-world systems where precision matters: from self-driving cars to game engines.</p>
<blockquote class="blockquote">
<p>“Every point has a neighbor; every path may cross another , geometry finds the truth in space.”</p>
</blockquote>
</section>
<section id="try-it-yourself-71" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-71">Try It Yourself</h4>
<ol type="1">
<li>Implement the closest pair algorithm using divide and conquer.</li>
<li>Visualize all pairwise distances , see which pairs are minimal.</li>
<li>Test segment intersection on random pairs.</li>
<li>Modify for 3D line segments using vector cross products.</li>
<li>Try building a line sweep visualizer to catch intersections step-by-step.</li>
</ol>
</section>
</section>
<section id="line-sweep-and-plane-sweep-algorithms" class="level3">
<h3 class="anchored" data-anchor-id="line-sweep-and-plane-sweep-algorithms">73. Line Sweep and Plane Sweep Algorithms</h3>
<p>The sweep line (or plane sweep) technique is one of the most powerful paradigms in computational geometry. It transforms complex spatial problems into manageable one-dimensional events , by sweeping a line (or plane) across the input and maintaining a dynamic set of active elements.</p>
<p>This method underlies many geometric algorithms:</p>
<ul>
<li>Event sorting → handle things in order- Active set maintenance → track current structure- Updates and queries → respond as the sweep progresses Used for intersection detection, closest pair, rectangle union, computational geometry in graphics and GIS.</li>
</ul>
<section id="the-core-idea-3" class="level4">
<h4 class="anchored" data-anchor-id="the-core-idea-3">1. The Core Idea</h4>
<p>Imagine a vertical line sweeping from left to right across the plane. At each “event” (like a point or segment endpoint), we update the set of objects the line currently touches , the active set.</p>
<p>Each event may trigger queries, insertions, or removals.</p>
<p>This approach works because geometry problems often depend only on local relationships between nearby elements as the sweep advances.</p>
</section>
<section id="a.-sweep-line-template" class="level4">
<h4 class="anchored" data-anchor-id="a.-sweep-line-template">A. Sweep Line Template</h4>
<p>A general structure looks like this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb373"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Event <span class="op">{</span> <span class="dt">double</span> x<span class="op">;</span> <span class="dt">int</span> type<span class="op">;</span> Object <span class="op">*</span>obj<span class="op">;</span> <span class="op">};</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>sort<span class="op">(</span>events<span class="op">.</span>begin<span class="op">(),</span> events<span class="op">.</span>end<span class="op">());</span></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>ActiveSet S<span class="op">;</span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>Event e <span class="op">:</span> events<span class="op">)</span> <span class="op">{</span></span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>e<span class="op">.</span>type <span class="op">==</span> START<span class="op">)</span> S<span class="op">.</span>insert<span class="op">(</span>e<span class="op">.</span>obj<span class="op">);</span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>e<span class="op">.</span>type <span class="op">==</span> END<span class="op">)</span> S<span class="op">.</span>erase<span class="op">(</span>e<span class="op">.</span>obj<span class="op">);</span></span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>e<span class="op">.</span>type <span class="op">==</span> QUERY<span class="op">)</span> handle_query<span class="op">(</span>S<span class="op">,</span> e<span class="op">.</span>obj<span class="op">);</span></span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Sorting ensures events are processed in order of increasing x (or another dimension).</p>
</section>
<section id="classic-applications" class="level4">
<h4 class="anchored" data-anchor-id="classic-applications">2. Classic Applications</h4>
<p>Let’s explore three foundational problems solvable by sweep techniques.</p>
</section>
<section id="a.-segment-intersection-bentley-ottmann" class="level4">
<h4 class="anchored" data-anchor-id="a.-segment-intersection-bentley-ottmann">A. Segment Intersection (Bentley-Ottmann)</h4>
<p>Goal: detect all intersections among ( n ) line segments.</p>
<p>Steps:</p>
<ol type="1">
<li>Sort endpoints by x-coordinate.</li>
<li>Sweep from left to right.</li>
<li>Maintain an ordered set of active segments (sorted by y).</li>
<li>When a new segment starts, check intersection with neighbors above and below.</li>
<li>When segments intersect, record intersection and insert a new event at the x-coordinate of intersection.</li>
</ol>
<p>Complexity: <span class="math inline">\(O((n + k)\log n)\)</span>, where <span class="math inline">\(k\)</span> is the number of intersections.</p>
</section>
<section id="b.-closest-pair-of-points" class="level4">
<h4 class="anchored" data-anchor-id="b.-closest-pair-of-points">B. Closest Pair of Points</h4>
<p>Sweep line version sorts by x, then slides a vertical line while maintaining active points within a strip of width ( d ) (current minimum). Only need to check at most 6-8 nearby points in strip.</p>
<p>Complexity: ( O<span class="math inline">\(n \log n\)</span> )</p>
</section>
<section id="c.-rectangle-union-area" class="level4">
<h4 class="anchored" data-anchor-id="c.-rectangle-union-area">C. Rectangle Union Area</h4>
<p>Given axis-aligned rectangles, compute total area covered.</p>
<p>Idea:</p>
<ul>
<li>Treat vertical edges as events (entering/exiting rectangles).- Sweep line moves along x-axis.- Maintain y-intervals in active set (using a segment tree or interval tree).- At each step, multiply current width × height of union of active intervals. Complexity: ( O<span class="math inline">\(n \log n\)</span> )</li>
</ul>
<p>Tiny Code Sketch (C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb374"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> <span class="dt">double</span> x<span class="op">,</span> y1<span class="op">,</span> y2<span class="op">;</span> <span class="dt">int</span> type<span class="op">;</span> <span class="op">}</span> Event<span class="op">;</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>Event events<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n_events<span class="op">;</span></span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>qsort<span class="op">(</span>events<span class="op">,</span> n_events<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>Event<span class="op">),</span> cmp_by_x<span class="op">);</span></span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> prev_x <span class="op">=</span> events<span class="op">[</span><span class="dv">0</span><span class="op">].</span>x<span class="op">,</span> area <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a>SegmentTree T<span class="op">;</span></span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n_events<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb374-11"><a href="#cb374-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> dx <span class="op">=</span> events<span class="op">[</span>i<span class="op">].</span>x <span class="op">-</span> prev_x<span class="op">;</span></span>
<span id="cb374-12"><a href="#cb374-12" aria-hidden="true" tabindex="-1"></a>    area <span class="op">+=</span> dx <span class="op">*</span> T<span class="op">.</span>total_length<span class="op">();</span> <span class="co">// current union height</span></span>
<span id="cb374-13"><a href="#cb374-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>events<span class="op">[</span>i<span class="op">].</span>type <span class="op">==</span> START<span class="op">)</span></span>
<span id="cb374-14"><a href="#cb374-14" aria-hidden="true" tabindex="-1"></a>        T<span class="op">.</span>insert<span class="op">(</span>events<span class="op">[</span>i<span class="op">].</span>y1<span class="op">,</span> events<span class="op">[</span>i<span class="op">].</span>y2<span class="op">);</span></span>
<span id="cb374-15"><a href="#cb374-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb374-16"><a href="#cb374-16" aria-hidden="true" tabindex="-1"></a>        T<span class="op">.</span>remove<span class="op">(</span>events<span class="op">[</span>i<span class="op">].</span>y1<span class="op">,</span> events<span class="op">[</span>i<span class="op">].</span>y2<span class="op">);</span></span>
<span id="cb374-17"><a href="#cb374-17" aria-hidden="true" tabindex="-1"></a>    prev_x <span class="op">=</span> events<span class="op">[</span>i<span class="op">].</span>x<span class="op">;</span></span>
<span id="cb374-18"><a href="#cb374-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="other-applications" class="level4">
<h4 class="anchored" data-anchor-id="other-applications">3. Other Applications</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 50%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>Description</th>
<th>Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K-closest points</td>
<td>Maintain top <span class="math inline">\(k\)</span> in active set</td>
<td><span class="math inline">\(O(n \log n)\)</span></td>
</tr>
<tr class="even">
<td>Union of rectangles</td>
<td>Compute covered area</td>
<td><span class="math inline">\(O(n \log n)\)</span></td>
</tr>
<tr class="odd">
<td>Point location</td>
<td>Locate point in planar subdivision</td>
<td><span class="math inline">\(O(\log n)\)</span></td>
</tr>
<tr class="even">
<td>Visibility graph</td>
<td>Track visible edges</td>
<td><span class="math inline">\(O(n \log n)\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="plane-sweep-extensions" class="level4">
<h4 class="anchored" data-anchor-id="plane-sweep-extensions">4. Plane Sweep Extensions</h4>
<p>While line sweep moves in one dimension (x), plane sweep handles 2D or higher-dimensional spaces, where:</p>
<ul>
<li>Events are 2D cells or regions.- Sweep front is a plane instead of a line. Used in 3D collision detection, computational topology, and CAD systems.</li>
</ul>
</section>
<section id="conceptual-visualization" class="level4">
<h4 class="anchored" data-anchor-id="conceptual-visualization">Conceptual Visualization</h4>
<ol type="1">
<li>Sort events by one axis (say, x).</li>
<li>Maintain structure (set, tree, or heap) of intersecting or active elements.</li>
<li>Update at each event and record desired output (intersection, union, coverage).</li>
</ol>
<p>The key is the locality principle: only neighbors in the sweep structure can change outcomes.</p>
</section>
<section id="complexity-6" class="level4">
<h4 class="anchored" data-anchor-id="complexity-6">5. Complexity</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Phase</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sorting events</td>
<td><span class="math inline">\(O(n \log n)\)</span></td>
</tr>
<tr class="even">
<td>Processing events</td>
<td><span class="math inline">\(O(n \log n)\)</span></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(O(n \log n)\)</span> (typical)</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-72" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-72">Why It Matters</h4>
<p>The sweep line method transforms geometric chaos into order , turning spatial relationships into sorted sequences. It’s the bridge between geometry and algorithms, blending structure with motion.</p>
<blockquote class="blockquote">
<p>“A sweep line sees everything , not all at once, but just in time.”</p>
</blockquote>
</section>
<section id="try-it-yourself-72" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-72">Try It Yourself</h4>
<ol type="1">
<li>Implement a sweep-line segment intersection finder.</li>
<li>Compute the union area of 3 rectangles with overlaps.</li>
<li>Animate the sweep line to visualize event processing.</li>
<li>Modify for circular or polygonal objects.</li>
<li>Explore how sweep-line logic applies to time-based events in scheduling.</li>
</ol>
</section>
</section>
<section id="delaunay-and-voronoi-diagrams" class="level3">
<h3 class="anchored" data-anchor-id="delaunay-and-voronoi-diagrams">74. Delaunay and Voronoi Diagrams</h3>
<p>In geometry and spatial computing, Delaunay triangulations and Voronoi diagrams are duals , elegant structures that capture proximity, territory, and connectivity among points.</p>
<p>They’re used everywhere: from mesh generation, pathfinding, geospatial analysis, to computational biology. This section introduces both, their relationship, and algorithms to construct them efficiently.</p>
<section id="voronoi-diagram" class="level4">
<h4 class="anchored" data-anchor-id="voronoi-diagram">1. Voronoi Diagram</h4>
<p>Given a set of sites (points) <span class="math inline">\(P = {p_1, p_2, \ldots, p_n}\)</span>, the Voronoi diagram partitions the plane into regions , one per point , so that every location in a region is closer to its site than to any other.</p>
<p>Formally, the Voronoi cell for <span class="math inline">\(p_i\)</span> is: <span class="math display">\[
V(p_i) = {x \in \mathbb{R}^2 \mid d(x, p_i) \le d(x, p_j), \forall j \neq i }
\]</span></p>
<p>Each region is convex, and boundaries are formed by perpendicular bisectors.</p>
</section>
<section id="example-13" class="level4">
<h4 class="anchored" data-anchor-id="example-13">Example</h4>
<p>For points ( A, B, C ):</p>
<ul>
<li>Draw bisectors between each pair.- Intersection points define Voronoi vertices.- Resulting polygons cover the plane, one per site. Used to model nearest neighbor regions , “which tower serves which area?”</li>
</ul>
</section>
<section id="properties" class="level4">
<h4 class="anchored" data-anchor-id="properties">Properties</h4>
<ul>
<li>Every cell is convex.- Neighboring cells share edges.- The diagram’s vertices are centers of circumcircles through three sites.- Dual graph = Delaunay triangulation.</li>
</ul>
</section>
<section id="delaunay-triangulation" class="level4">
<h4 class="anchored" data-anchor-id="delaunay-triangulation">2. Delaunay Triangulation</h4>
<p>The Delaunay triangulation (DT) connects points so that no point lies inside the circumcircle of any triangle.</p>
<p>Equivalently, it’s the dual graph of the Voronoi diagram.</p>
<p>It tends to avoid skinny triangles , maximizing minimum angles, creating well-shaped meshes.</p>
</section>
<section id="formal-definition" class="level4">
<h4 class="anchored" data-anchor-id="formal-definition">Formal Definition</h4>
<p>A triangulation ( T ) of ( P ) is Delaunay if for every triangle <span class="math inline">\(\triangle abc \in T\)</span>, no point <span class="math inline">\(p \in P \setminus {a,b,c}\)</span> lies inside the circumcircle of <span class="math inline">\(\triangle abc\)</span>.</p>
<p>Why It Matters:</p>
<ul>
<li>Avoids sliver triangles.- Used in finite element meshes, terrain modeling, and path planning.- Leads to natural neighbor interpolation and smooth surfaces.</li>
</ul>
</section>
<section id="relationship" class="level4">
<h4 class="anchored" data-anchor-id="relationship">3. Relationship</h4>
<p>Voronoi and Delaunay are geometric duals:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Voronoi</th>
<th>Delaunay</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regions = proximity zones</td>
<td>Triangles = neighbor connections</td>
</tr>
<tr class="even">
<td>Edges = bisectors</td>
<td>Edges = neighbor pairs</td>
</tr>
<tr class="odd">
<td>Vertices = circumcenters</td>
<td>Faces = circumcircles</td>
</tr>
</tbody>
</table>
<p>Connecting neighboring Voronoi cells gives Delaunay edges.</p>
</section>
<section id="algorithms" class="level4">
<h4 class="anchored" data-anchor-id="algorithms">4. Algorithms</h4>
<p>Several algorithms can build these diagrams efficiently.</p>
</section>
<section id="a.-incremental-insertion" class="level4">
<h4 class="anchored" data-anchor-id="a.-incremental-insertion">A. Incremental Insertion</h4>
<ol type="1">
<li>Start with a super-triangle enclosing all points.</li>
<li>Insert points one by one.</li>
<li>Remove triangles whose circumcircle contains the point.</li>
<li>Re-triangulate the resulting polygonal hole.</li>
</ol>
<p>Time Complexity: ( O<span class="math inline">\(n^2\)</span> ), improved to ( O<span class="math inline">\(n \log n\)</span> ) with randomization.</p>
</section>
<section id="b.-divide-and-conquer" class="level4">
<h4 class="anchored" data-anchor-id="b.-divide-and-conquer">B. Divide and Conquer</h4>
<ol type="1">
<li>Sort points by x.</li>
<li>Recursively build DT for left and right halves.</li>
<li>Merge by finding common tangents.</li>
</ol>
<p>Time Complexity: ( O<span class="math inline">\(n \log n\)</span> ) Elegant, structured, and deterministic.</p>
</section>
<section id="c.-fortunes-sweep-line-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="c.-fortunes-sweep-line-algorithm">C. Fortune’s Sweep Line Algorithm</h4>
<p>For Voronoi diagrams, Fortune’s algorithm sweeps a line from top to bottom. Maintains a beach line of parabolic arcs and event queue.</p>
<p>Each event (site or circle) updates the structure , building Voronoi edges incrementally.</p>
<p>Time Complexity: ( O<span class="math inline">\(n \log n\)</span> )</p>
</section>
<section id="d.-bowyer-watson-delaunay-via-circumcircle-test" class="level4">
<h4 class="anchored" data-anchor-id="d.-bowyer-watson-delaunay-via-circumcircle-test">D. Bowyer-Watson (Delaunay via Circumcircle Test)**</h4>
<p>A practical incremental version widely used in graphics and simulation.</p>
<p>Steps:</p>
<ul>
<li>Start with supertriangle- Insert point- Remove all triangles whose circumcircle contains point- Reconnect the resulting cavity</li>
</ul>
<p>Tiny Code (Conceptual)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb375"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> <span class="dt">double</span> x<span class="op">,</span> y<span class="op">;</span> <span class="op">}</span> Point<span class="op">;</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> Point a<span class="op">,</span> b<span class="op">,</span> c<span class="op">;</span> <span class="op">}</span> Triangle<span class="op">;</span></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> in_circle<span class="op">(</span>Point a<span class="op">,</span> Point b<span class="op">,</span> Point c<span class="op">,</span> Point p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span>a<span class="op">.</span>x <span class="op">-</span> p<span class="op">.</span>x<span class="op">,</span> a<span class="op">.</span>y <span class="op">-</span> p<span class="op">.</span>y<span class="op">,</span> <span class="op">(</span>a<span class="op">.</span>x<span class="op">*</span>a<span class="op">.</span>x <span class="op">+</span> a<span class="op">.</span>y<span class="op">*</span>a<span class="op">.</span>y<span class="op">)</span> <span class="op">-</span> <span class="op">(</span>p<span class="op">.</span>x<span class="op">*</span>p<span class="op">.</span>x <span class="op">+</span> p<span class="op">.</span>y<span class="op">*</span>p<span class="op">.</span>y<span class="op">)},</span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span>b<span class="op">.</span>x <span class="op">-</span> p<span class="op">.</span>x<span class="op">,</span> b<span class="op">.</span>y <span class="op">-</span> p<span class="op">.</span>y<span class="op">,</span> <span class="op">(</span>b<span class="op">.</span>x<span class="op">*</span>b<span class="op">.</span>x <span class="op">+</span> b<span class="op">.</span>y<span class="op">*</span>b<span class="op">.</span>y<span class="op">)</span> <span class="op">-</span> <span class="op">(</span>p<span class="op">.</span>x<span class="op">*</span>p<span class="op">.</span>x <span class="op">+</span> p<span class="op">.</span>y<span class="op">*</span>p<span class="op">.</span>y<span class="op">)},</span></span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span>c<span class="op">.</span>x <span class="op">-</span> p<span class="op">.</span>x<span class="op">,</span> c<span class="op">.</span>y <span class="op">-</span> p<span class="op">.</span>y<span class="op">,</span> <span class="op">(</span>c<span class="op">.</span>x<span class="op">*</span>c<span class="op">.</span>x <span class="op">+</span> c<span class="op">.</span>y<span class="op">*</span>c<span class="op">.</span>y<span class="op">)</span> <span class="op">-</span> <span class="op">(</span>p<span class="op">.</span>x<span class="op">*</span>p<span class="op">.</span>x <span class="op">+</span> p<span class="op">.</span>y<span class="op">*</span>p<span class="op">.</span>y<span class="op">)}</span></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> determinant<span class="op">(</span>A<span class="op">)</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This test ensures Delaunay property.</p>
</section>
<section id="applications-14" class="level4">
<h4 class="anchored" data-anchor-id="applications-14">5. Applications</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Domain</th>
<th>Application</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GIS</td>
<td>Nearest facility, region partition</td>
</tr>
<tr class="even">
<td>Mesh Generation</td>
<td>Finite element methods</td>
</tr>
<tr class="odd">
<td>Robotics</td>
<td>Visibility graphs, navigation</td>
</tr>
<tr class="even">
<td>Computer Graphics</td>
<td>Terrain triangulation</td>
</tr>
<tr class="odd">
<td>Clustering</td>
<td>Spatial neighbor structure</td>
</tr>
</tbody>
</table>
</section>
<section id="complexity-summary-2" class="level4">
<h4 class="anchored" data-anchor-id="complexity-summary-2">6. Complexity Summary</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Type</th>
<th>Time</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fortune</td>
<td>Voronoi</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
<td>Sweep line</td>
</tr>
<tr class="even">
<td>Bowyer-Watson</td>
<td>Delaunay</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
<td>Incremental</td>
</tr>
<tr class="odd">
<td>Divide &amp; Conquer</td>
<td>Delaunay</td>
<td>( O<span class="math inline">\(n \log n\)</span> )</td>
<td>Recursive</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-73" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-73">Why It Matters</h4>
<p>Voronoi and Delaunay diagrams reveal natural structure in point sets. They convert distance into geometry, showing how space is divided and connected. If geometry is the shape of space, these diagrams are its skeleton.</p>
<blockquote class="blockquote">
<p>“Every point claims its territory; every territory shapes its network.”</p>
</blockquote>
</section>
<section id="try-it-yourself-73" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-73">Try It Yourself</h4>
<ol type="1">
<li>Draw Voronoi regions for 5 random points by hand.</li>
<li>Build Delaunay triangles (connect neighboring sites).</li>
<li>Verify the empty circumcircle property.</li>
<li>Use a library (CGAL / SciPy) to visualize both structures.</li>
<li>Explore how adding new points reshapes the diagrams.</li>
</ol>
</section>
</section>
<section id="point-in-polygon-and-polygon-triangulation" class="level3">
<h3 class="anchored" data-anchor-id="point-in-polygon-and-polygon-triangulation">75. Point in Polygon and Polygon Triangulation</h3>
<p>Geometry often asks two fundamental questions:</p>
<ol type="1">
<li>Is a point inside or outside a polygon?</li>
<li>How can a complex polygon be broken into triangles for computation?</li>
</ol>
<p>These are the building blocks of spatial analysis, computer graphics, and computational geometry.</p>
<section id="point-in-polygon-pip" class="level4">
<h4 class="anchored" data-anchor-id="point-in-polygon-pip">1. Point in Polygon (PIP)</h4>
<p>Given a polygon defined by vertices ( <span class="math inline">\(x_1, y_1\)</span>, <span class="math inline">\(x_2, y_2\)</span>, , <span class="math inline">\(x_n, y_n\)</span> ) and a test point ( (x, y) ), we want to determine if the point lies inside, on the boundary, or outside the polygon.</p>
</section>
<section id="methods" class="level4">
<h4 class="anchored" data-anchor-id="methods">Methods</h4>
</section>
<section id="a.-ray-casting-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="a.-ray-casting-algorithm">A. Ray Casting Algorithm</h4>
<p>Shoot a ray horizontally to the right of the point. Count how many times it intersects polygon edges.</p>
<ul>
<li>Odd count → Inside- Even count → Outside This is based on the even-odd rule.</li>
</ul>
<p>Tiny Code (Ray Casting in C)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb376"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> point_in_polygon<span class="op">(</span>Point p<span class="op">,</span> Point poly<span class="op">[],</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> inside <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> j <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> j <span class="op">=</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(((</span>poly<span class="op">[</span>i<span class="op">].</span>y <span class="op">&gt;</span> p<span class="op">.</span>y<span class="op">)</span> <span class="op">!=</span> <span class="op">(</span>poly<span class="op">[</span>j<span class="op">].</span>y <span class="op">&gt;</span> p<span class="op">.</span>y<span class="op">))</span> <span class="op">&amp;&amp;</span></span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a>            <span class="op">(</span>p<span class="op">.</span>x <span class="op">&lt;</span> <span class="op">(</span>poly<span class="op">[</span>j<span class="op">].</span>x <span class="op">-</span> poly<span class="op">[</span>i<span class="op">].</span>x<span class="op">)</span> <span class="op">*</span> </span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a>                   <span class="op">(</span>p<span class="op">.</span>y <span class="op">-</span> poly<span class="op">[</span>i<span class="op">].</span>y<span class="op">)</span> <span class="op">/</span> </span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a>                   <span class="op">(</span>poly<span class="op">[</span>j<span class="op">].</span>y <span class="op">-</span> poly<span class="op">[</span>i<span class="op">].</span>y<span class="op">)</span> <span class="op">+</span> poly<span class="op">[</span>i<span class="op">].</span>x<span class="op">))</span></span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a>            inside <span class="op">=</span> <span class="op">!</span>inside<span class="op">;</span></span>
<span id="cb376-9"><a href="#cb376-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb376-10"><a href="#cb376-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> inside<span class="op">;</span></span>
<span id="cb376-11"><a href="#cb376-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This toggles <code>inside</code> every time a crossing is found.</p>
</section>
<section id="b.-winding-number-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="b.-winding-number-algorithm">B. Winding Number Algorithm</h4>
<p>Counts how many times the polygon winds around the point.</p>
<ul>
<li>Nonzero winding number → Inside- Zero → Outside More robust for complex polygons with holes or self-intersections.</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Time Complexity</th>
<th>Robustness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ray Casting</td>
<td>(O(n))</td>
<td>Simple, may fail on edge cases</td>
</tr>
<tr class="even">
<td>Winding Number</td>
<td>(O(n))</td>
<td>More accurate for complex shapes</td>
</tr>
</tbody>
</table>
</section>
<section id="edge-cases" class="level4">
<h4 class="anchored" data-anchor-id="edge-cases">Edge Cases</h4>
<p>Handle:</p>
<ul>
<li>Points on edges or vertices- Horizontal edges (special treatment to avoid double counting) Numerical precision is key.</li>
</ul>
</section>
<section id="applications-15" class="level4">
<h4 class="anchored" data-anchor-id="applications-15">Applications</h4>
<ul>
<li>Hit testing in computer graphics- GIS spatial queries- Collision detection</li>
</ul>
</section>
<section id="polygon-triangulation-1" class="level4">
<h4 class="anchored" data-anchor-id="polygon-triangulation-1">2. Polygon Triangulation</h4>
<p>A polygon triangulation divides a polygon into non-overlapping triangles whose union equals the polygon.</p>
<p>Why triangulate?</p>
<ul>
<li>Triangles are simple, stable, and efficient for rendering and computation.- Used in graphics pipelines, area computation, physics, and mesh generation.</li>
</ul>
</section>
<section id="a.-triangulation-basics" class="level4">
<h4 class="anchored" data-anchor-id="a.-triangulation-basics">A. Triangulation Basics</h4>
<p>For a simple polygon with ( n ) vertices,</p>
<ul>
<li>Always possible- Always yields ( n - 2 ) triangles Goal: Find a triangulation efficiently and stably.</li>
</ul>
</section>
<section id="b.-ear-clipping-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="b.-ear-clipping-algorithm">B. Ear Clipping Algorithm</h4>
<p>An intuitive and widely used method for triangulation.</p>
</section>
<section id="idea-1" class="level4">
<h4 class="anchored" data-anchor-id="idea-1">Idea</h4>
<ol type="1">
<li><p>Find an ear: a triangle formed by three consecutive vertices ( <span class="math inline">\(v_{i-1}, v_i, v_{i+1}\)</span> ) such that:</p>
<ul>
<li>It is convex - Contains no other vertex inside</li>
</ul></li>
<li><p>Clip the ear (remove vertex <span class="math inline">\(v_i\)</span>)</p></li>
<li><p>Repeat until only one triangle remains</p></li>
</ol>
<p>Time Complexity: ( O<span class="math inline">\(n^2\)</span> )</p>
<p>Tiny Code (Ear Clipping Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb377"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_ear<span class="op">(</span>i<span class="op">))</span> <span class="op">{</span></span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>            add_triangle<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">,</span> i<span class="op">,</span> i<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>            remove_vertex<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Helper <code>is_ear()</code> checks convexity and emptiness.</p>
</section>
<section id="c.-dynamic-programming-for-convex-polygons" class="level4">
<h4 class="anchored" data-anchor-id="c.-dynamic-programming-for-convex-polygons">C. Dynamic Programming for Convex Polygons</h4>
<p>If the polygon is convex, use DP triangulation:</p>
<p><span class="math display">\[
dp[i][j] = \min_{k \in (i,j)} dp[i][k] + dp[k][j] + cost(i, j, k)
\]</span></p>
<p>Cost: perimeter or area (for minimum-weight triangulation)</p>
<p>Time Complexity: ( O<span class="math inline">\(n^3\)</span> ) Space: ( O<span class="math inline">\(n^2\)</span> )</p>
</section>
<section id="d.-divide-and-conquer" class="level4">
<h4 class="anchored" data-anchor-id="d.-divide-and-conquer">D. Divide and Conquer</h4>
<p>Recursively split polygon and triangulate sub-polygons. Useful for convex or near-convex shapes.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Time</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ear Clipping</td>
<td>(O<span class="math inline">\(n^2\)</span>)</td>
<td>Simple polygons</td>
</tr>
<tr class="even">
<td>DP Triangulation</td>
<td>(O<span class="math inline">\(n^3\)</span>)</td>
<td>Weighted cost</td>
</tr>
<tr class="odd">
<td>Convex Polygon</td>
<td>(O(n))</td>
<td>Straightforward</td>
</tr>
</tbody>
</table>
</section>
<section id="applications-16" class="level4">
<h4 class="anchored" data-anchor-id="applications-16">3. Applications</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Domain</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Computer Graphics</td>
<td>Rendering, rasterization</td>
</tr>
<tr class="even">
<td>Computational Geometry</td>
<td>Area computation, integration</td>
</tr>
<tr class="odd">
<td>Finite Element Analysis</td>
<td>Mesh subdivision</td>
</tr>
<tr class="even">
<td>Robotics</td>
<td>Path planning, map decomposition</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-74" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-74">Why It Matters</h4>
<p>Point-in-polygon answers where you are. Triangulation tells you how space is built. Together, they form the foundation of geometric reasoning.</p>
<blockquote class="blockquote">
<p>“From a single point to a thousand triangles, geometry turns space into structure.”</p>
</blockquote>
</section>
<section id="try-it-yourself-74" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-74">Try It Yourself</h4>
<ol type="1">
<li>Draw a non-convex polygon and test random points using the ray casting rule.</li>
<li>Implement the ear clipping algorithm for a simple polygon.</li>
<li>Visualize how each step removes an ear and simplifies the shape.</li>
<li>Compare triangulation results for convex vs concave shapes.</li>
</ol>
</section>
</section>
<section id="spatial-data-structures-kd-r-tree" class="level3">
<h3 class="anchored" data-anchor-id="spatial-data-structures-kd-r-tree">76. Spatial Data Structures (KD, R-tree)</h3>
<p>When working with geometric data, points, rectangles, or polygons, efficient lookup and organization are crucial. Spatial data structures are designed to answer queries like:</p>
<ul>
<li>Which objects are near a given point?- Which shapes intersect a region?- What’s the nearest neighbor? They form the backbone of computational geometry, computer graphics, GIS, and search systems.</li>
</ul>
<section id="motivation-1" class="level4">
<h4 class="anchored" data-anchor-id="motivation-1">1. Motivation</h4>
<p>Brute force approaches that check every object have ( O(n) ) or worse performance. Spatial indexing structures, like KD-Trees and R-Trees, enable efficient range queries, nearest neighbor searches, and spatial joins.</p>
</section>
<section id="kd-tree-k-dimensional-tree" class="level4">
<h4 class="anchored" data-anchor-id="kd-tree-k-dimensional-tree">2. KD-Tree (k-dimensional tree)</h4>
<p>A KD-tree is a binary tree that recursively partitions space using axis-aligned hyperplanes.</p>
<p>Each node splits the data by one coordinate axis (x, y, z, …).</p>
</section>
<section id="structure" class="level4">
<h4 class="anchored" data-anchor-id="structure">Structure</h4>
<ul>
<li>Each node represents a point.- Each level splits by a different axis (x, y, x, y, …).- Left child contains points with smaller coordinate.- Right child contains larger coordinate.</li>
</ul>
<p>Tiny Code (KD-tree Construction in 2D)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb378"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Point<span class="op">;</span></span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> axis<span class="op">;</span> <span class="co">// 0 for x, 1 for y</span></span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>KDNode<span class="op">*</span> build<span class="op">(</span>Point points<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> depth<span class="op">)</span> <span class="op">{</span></span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> NULL<span class="op">;</span></span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>    axis <span class="op">=</span> depth <span class="op">%</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>    nth_element<span class="op">(</span>points<span class="op">,</span> points <span class="op">+</span> mid<span class="op">,</span> points <span class="op">+</span> n<span class="op">,</span> compare_by_axis<span class="op">);</span></span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>    KDNode<span class="op">*</span> node <span class="op">=</span> new_node<span class="op">(</span>points<span class="op">[</span>mid<span class="op">]);</span></span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>    node<span class="op">-&gt;</span>left  <span class="op">=</span> build<span class="op">(</span>points<span class="op">,</span> mid<span class="op">,</span> depth <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a>    node<span class="op">-&gt;</span>right <span class="op">=</span> build<span class="op">(</span>points <span class="op">+</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> n <span class="op">-</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> depth <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb378-15"><a href="#cb378-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node<span class="op">;</span></span>
<span id="cb378-16"><a href="#cb378-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Search Complexity:</p>
<ul>
<li>Average: ( O<span class="math inline">\(\log n\)</span> )- Worst-case: ( O(n) )</li>
</ul>
</section>
<section id="queries" class="level4">
<h4 class="anchored" data-anchor-id="queries">Queries</h4>
<ul>
<li>Range query: Find points in a region.- Nearest neighbor: Search branches that might contain closer points.- K-nearest neighbors: Use priority queues.</li>
</ul>
</section>
<section id="pros-cons" class="level4">
<h4 class="anchored" data-anchor-id="pros-cons">Pros &amp; Cons</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Efficient for static data</td>
<td>Costly updates</td>
</tr>
<tr class="even">
<td>Good for low dimensions</td>
<td>Degrades with high dimensions</td>
</tr>
</tbody>
</table>
</section>
<section id="applications-17" class="level4">
<h4 class="anchored" data-anchor-id="applications-17">Applications</h4>
<ul>
<li>Nearest neighbor in ML- Collision detection- Clustering (e.g., k-means acceleration)</li>
</ul>
</section>
<section id="r-tree-rectangle-tree" class="level4">
<h4 class="anchored" data-anchor-id="r-tree-rectangle-tree">3. R-Tree (Rectangle Tree)</h4>
<p>An R-tree is a height-balanced tree for rectangular bounding boxes. It’s the spatial analog of a B-tree.</p>
</section>
<section id="idea-2" class="level4">
<h4 class="anchored" data-anchor-id="idea-2">Idea</h4>
<ul>
<li>Store objects or bounding boxes in leaf nodes.- Internal nodes store MBRs (Minimum Bounding Rectangles) that cover child boxes.- Query by traversing overlapping MBRs.</li>
</ul>
<p>Tiny Code (R-Tree Node Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb379"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>    Rectangle mbr<span class="op">;</span></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>    Node<span class="op">*</span> children<span class="op">[</span>MAX_CHILDREN<span class="op">];</span></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count<span class="op">;</span></span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Insertion chooses the child whose MBR expands least to accommodate the new entry.</p>
</section>
<section id="operations" class="level4">
<h4 class="anchored" data-anchor-id="operations">Operations</h4>
<ul>
<li><p>Insert: Choose subtree → Insert → Adjust MBRs- Search: Descend into nodes whose MBR intersects query- Split: When full, use heuristics (linear, quadratic, R*-Tree) Complexity:</p></li>
<li><p>Query: ( O<span class="math inline">\(\log n\)</span> )- Insert/Delete: ( O<span class="math inline">\(\log n\)</span> ) average</p></li>
</ul>
</section>
<section id="pros-cons-1" class="level4">
<h4 class="anchored" data-anchor-id="pros-cons-1">Pros &amp; Cons</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Supports dynamic data</td>
<td>Overlaps can degrade performance</td>
</tr>
<tr class="even">
<td>Ideal for rectangles</td>
<td>Complex split rules</td>
</tr>
</tbody>
</table>
</section>
<section id="variants-1" class="level4">
<h4 class="anchored" data-anchor-id="variants-1">Variants</h4>
<ul>
<li>R*-Tree: Optimized reinsertion, better packing- R+ Tree: Non-overlapping partitions- Hilbert R-Tree: Uses space-filling curves</li>
</ul>
</section>
<section id="comparison-24" class="level4">
<h4 class="anchored" data-anchor-id="comparison-24">4. Comparison</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>KD-Tree</th>
<th>R-Tree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Data Type</td>
<td>Points</td>
<td>Rectangles / Regions</td>
</tr>
<tr class="even">
<td>Dimensionality</td>
<td>Low (2-10)</td>
<td>Medium</td>
</tr>
<tr class="odd">
<td>Use Case</td>
<td>NN, range queries</td>
<td>Spatial joins, overlap queries</td>
</tr>
<tr class="even">
<td>Updates</td>
<td>Expensive</td>
<td>Dynamic-friendly</td>
</tr>
<tr class="odd">
<td>Balance</td>
<td>Recursive median</td>
<td>B-tree-like</td>
</tr>
</tbody>
</table>
</section>
<section id="other-spatial-structures" class="level4">
<h4 class="anchored" data-anchor-id="other-spatial-structures">5. Other Spatial Structures</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Structure</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Quadtree</td>
<td>Recursive 2D subdivision into 4 quadrants</td>
</tr>
<tr class="even">
<td>Octree</td>
<td>3D analog of quadtree</td>
</tr>
<tr class="odd">
<td>BSP Tree</td>
<td>Binary partition using arbitrary planes</td>
</tr>
<tr class="even">
<td>Grid Index</td>
<td>Divide space into uniform grid cells</td>
</tr>
</tbody>
</table>
</section>
<section id="applications-18" class="level4">
<h4 class="anchored" data-anchor-id="applications-18">6. Applications</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Domain</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GIS</td>
<td>Region queries, map intersections</td>
</tr>
<tr class="even">
<td>Graphics</td>
<td>Ray tracing acceleration</td>
</tr>
<tr class="odd">
<td>Robotics</td>
<td>Collision and path planning</td>
</tr>
<tr class="even">
<td>ML</td>
<td>Nearest neighbor search</td>
</tr>
<tr class="odd">
<td>Databases</td>
<td>Spatial indexing</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-75" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-75">Why It Matters</h4>
<p>Spatial structures turn geometry into searchable data. They enable efficient algorithms for where and what’s near, vital for real-time systems.</p>
<blockquote class="blockquote">
<p>“Divide space wisely, and queries become whispers instead of shouts.”</p>
</blockquote>
</section>
<section id="try-it-yourself-75" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-75">Try It Yourself</h4>
<ol type="1">
<li>Build a KD-tree for 10 random 2D points.</li>
<li>Implement nearest neighbor search.</li>
<li>Insert rectangles into a simple R-tree and query intersection with a bounding box.</li>
<li>Compare query time vs brute force.</li>
</ol>
</section>
</section>
<section id="rasterization-and-scanline-techniques" class="level3">
<h3 class="anchored" data-anchor-id="rasterization-and-scanline-techniques">77. Rasterization and Scanline Techniques</h3>
<p>When you draw shapes on a screen, triangles, polygons, circles, they must be converted into pixels. This conversion is called rasterization. It’s the bridge between geometric math and visible images.</p>
<p>Rasterization and scanline algorithms are foundational to computer graphics, game engines, and rendering pipelines.</p>
<section id="what-is-rasterization" class="level4">
<h4 class="anchored" data-anchor-id="what-is-rasterization">1. What Is Rasterization?</h4>
<p>Rasterization transforms vector shapes (continuous lines and surfaces) into discrete pixels on a grid.</p>
<p>For example, a triangle defined by vertices <code>(x1, y1), (x2, y2), (x3, y3)</code> must be filled pixel by pixel.</p>
</section>
<section id="core-idea" class="level4">
<h4 class="anchored" data-anchor-id="core-idea">2. Core Idea</h4>
<p>Each shape (line, polygon, circle) is sampled over a grid. The algorithm decides which pixels are inside, on, or outside the shape.</p>
<p>A rasterizer answers:</p>
<ul>
<li>Which pixels should be lit?- What color or depth should each pixel have?</li>
</ul>
</section>
<section id="line-rasterization-bresenhams-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="line-rasterization-bresenhams-algorithm">3. Line Rasterization (Bresenham’s Algorithm)</h4>
<p>A classic method for drawing straight lines with integer arithmetic.</p>
<p>Key Idea: Move from one pixel to the next, choosing the pixel closest to the true line path.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb380"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_line<span class="op">(</span><span class="dt">int</span> x0<span class="op">,</span> <span class="dt">int</span> y0<span class="op">,</span> <span class="dt">int</span> x1<span class="op">,</span> <span class="dt">int</span> y1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dx <span class="op">=</span> abs<span class="op">(</span>x1 <span class="op">-</span> x0<span class="op">),</span> dy <span class="op">=</span> abs<span class="op">(</span>y1 <span class="op">-</span> y0<span class="op">);</span></span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sx <span class="op">=</span> <span class="op">(</span>x0 <span class="op">&lt;</span> x1<span class="op">)</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sy <span class="op">=</span> <span class="op">(</span>y0 <span class="op">&lt;</span> y1<span class="op">)</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> err <span class="op">=</span> dx <span class="op">-</span> dy<span class="op">;</span></span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="kw">true</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>        plot<span class="op">(</span>x0<span class="op">,</span> y0<span class="op">);</span> <span class="co">// draw pixel</span></span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>x0 <span class="op">==</span> x1 <span class="op">&amp;&amp;</span> y0 <span class="op">==</span> y1<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> e2 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> err<span class="op">;</span></span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e2 <span class="op">&gt;</span> <span class="op">-</span>dy<span class="op">)</span> <span class="op">{</span> err <span class="op">-=</span> dy<span class="op">;</span> x0 <span class="op">+=</span> sx<span class="op">;</span> <span class="op">}</span></span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e2 <span class="op">&lt;</span> dx<span class="op">)</span> <span class="op">{</span> err <span class="op">+=</span> dx<span class="op">;</span> y0 <span class="op">+=</span> sy<span class="op">;</span> <span class="op">}</span></span>
<span id="cb380-12"><a href="#cb380-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb380-13"><a href="#cb380-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Why it works: Bresenham avoids floating-point math and keeps the line visually continuous.</p>
</section>
<section id="polygon-rasterization" class="level4">
<h4 class="anchored" data-anchor-id="polygon-rasterization">4. Polygon Rasterization</h4>
<p>To fill shapes, we need scanline algorithms, they sweep a horizontal line (y-axis) across the shape and fill pixels in between edges.</p>
</section>
<section id="scanline-fill-steps" class="level4">
<h4 class="anchored" data-anchor-id="scanline-fill-steps">Scanline Fill Steps</h4>
<ol type="1">
<li>Sort edges by their y-coordinates.</li>
<li>Scan each line (y).</li>
<li>Find intersections with polygon edges.</li>
<li>Fill between intersection pairs.</li>
</ol>
<p>This guarantees correct filling for convex and concave polygons.</p>
</section>
<section id="example-simple-triangle-rasterization" class="level4">
<h4 class="anchored" data-anchor-id="example-simple-triangle-rasterization">Example (Simple Triangle Rasterization)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb381"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> y <span class="op">=</span> y_min<span class="op">;</span> y <span class="op">&lt;=</span> y_max<span class="op">;</span> y<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>    find all x<span class="op">-</span>intersections with polygon edges<span class="op">;</span></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>    sort x<span class="op">-</span>intersections<span class="op">;</span></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> count<span class="op">;</span> i <span class="op">+=</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">[</span>i<span class="op">],</span> y<span class="op">,</span> x<span class="op">[</span>i<span class="op">+</span><span class="dv">1</span><span class="op">],</span> y<span class="op">);</span></span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="circle-rasterization-midpoint-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="circle-rasterization-midpoint-algorithm">5. Circle Rasterization (Midpoint Algorithm)</h4>
<p>Use symmetry, a circle is symmetric in 8 octants.</p>
<p>Each step calculates the error term to decide whether to move horizontally or diagonally.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb382"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_circle<span class="op">(</span><span class="dt">int</span> xc<span class="op">,</span> <span class="dt">int</span> yc<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> y <span class="op">=</span> r<span class="op">,</span> d <span class="op">=</span> <span class="dv">3</span> <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> r<span class="op">;</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>y <span class="op">&gt;=</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>        plot_circle_points<span class="op">(</span>xc<span class="op">,</span> yc<span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a>        x<span class="op">++;</span></span>
<span id="cb382-6"><a href="#cb382-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> y<span class="op">--;</span> d <span class="op">+=</span> <span class="dv">4</span> <span class="op">*</span> <span class="op">(</span>x <span class="op">-</span> y<span class="op">)</span> <span class="op">+</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb382-7"><a href="#cb382-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> d <span class="op">+=</span> <span class="dv">4</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb382-8"><a href="#cb382-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb382-9"><a href="#cb382-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="depth-and-shading" class="level4">
<h4 class="anchored" data-anchor-id="depth-and-shading">6. Depth and Shading</h4>
<p>In 3D graphics, rasterization includes depth testing (Z-buffer) and color interpolation. Each pixel stores its depth; new pixels overwrite only if closer.</p>
<p>Interpolated shading (Gouraud, Phong) computes smooth color transitions across polygons.</p>
</section>
<section id="hardware-rasterization" class="level4">
<h4 class="anchored" data-anchor-id="hardware-rasterization">7. Hardware Rasterization</h4>
<p>Modern GPUs perform rasterization in parallel:</p>
<ul>
<li>Vertex Shader → Projection- Rasterizer → Pixel Grid- Fragment Shader → Color &amp; Depth Each pixel is processed in fragment shaders for lighting, texture, and effects.</li>
</ul>
</section>
<section id="optimizations" class="level4">
<h4 class="anchored" data-anchor-id="optimizations">8. Optimizations</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Technique</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bounding Box Clipping</td>
<td>Skip off-screen regions</td>
</tr>
<tr class="even">
<td>Early Z-Culling</td>
<td>Discard hidden pixels early</td>
</tr>
<tr class="odd">
<td>Edge Functions</td>
<td>Fast inside-test for triangles</td>
</tr>
<tr class="even">
<td>Barycentric Coordinates</td>
<td>Interpolate depth/color smoothly</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-76" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-76">9. Why It Matters</h4>
<p>Rasterization turns math into imagery. It’s the foundation of all visual computing, renderers, CAD, games, and GUIs. Even with ray tracing rising, rasterization remains dominant for real-time rendering.</p>
<blockquote class="blockquote">
<p>“Every pixel you see began as math, it’s just geometry painted by light.”</p>
</blockquote>
</section>
<section id="try-it-yourself-76" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-76">10. Try It Yourself</h4>
<ol type="1">
<li>Implement Bresenham’s algorithm for lines.</li>
<li>Write a scanline polygon fill for triangles.</li>
<li>Extend it with color interpolation using barycentric coordinates.</li>
<li>Compare performance vs brute force (looping over all pixels).</li>
</ol>
</section>
</section>
<section id="computer-vision-canny-hough-sift" class="level3">
<h3 class="anchored" data-anchor-id="computer-vision-canny-hough-sift">78. Computer Vision (Canny, Hough, SIFT)</h3>
<p>Computer vision is where algorithms learn to see, to extract structure, shape, and meaning from images. Behind every object detector, edge map, and keypoint matcher lies a handful of powerful geometric algorithms.</p>
<p>In this section, we explore four pillars of classical vision: Canny edge detection, Hough transform, and SIFT (Scale-Invariant Feature Transform).</p>
<section id="the-vision-pipeline" class="level4">
<h4 class="anchored" data-anchor-id="the-vision-pipeline">1. The Vision Pipeline</h4>
<p>Most vision algorithms follow a simple pattern:</p>
<ol type="1">
<li>Input: Raw pixels (grayscale or color)</li>
<li>Preprocess: Smoothing or filtering</li>
<li>Feature extraction: Edges, corners, blobs</li>
<li>Detection or matching: Shapes, keypoints</li>
<li>Interpretation: Object recognition, tracking</li>
</ol>
<p>Canny, Hough, and SIFT live in the feature extraction and detection stages.</p>
</section>
<section id="canny-edge-detector" class="level4">
<h4 class="anchored" data-anchor-id="canny-edge-detector">2. Canny Edge Detector</h4>
<p>Edges mark places where intensity changes sharply, the outlines of objects. The Canny algorithm (1986) is one of the most robust and widely used edge detectors.</p>
</section>
<section id="steps-1" class="level4">
<h4 class="anchored" data-anchor-id="steps-1">Steps</h4>
<ol type="1">
<li><p>Smoothing: Apply Gaussian blur to reduce noise.</p></li>
<li><p>Gradient computation:</p>
<ul>
<li>Compute <span class="math inline">\(G_x\)</span> and <span class="math inline">\(G_y\)</span> via Sobel filters<br>
</li>
<li>Gradient magnitude: <span class="math inline">\(G = \sqrt{G_x^2 + G_y^2}\)</span><br>
</li>
<li>Gradient direction: <span class="math inline">\(\theta = \tan^{-1}\frac{G_y}{G_x}\)</span></li>
</ul></li>
<li><p>Non-maximum suppression:</p>
<ul>
<li>Keep only local maxima along the gradient direction</li>
</ul></li>
<li><p>Double thresholding:</p>
<ul>
<li>Strong edges (high gradient)<br>
</li>
<li>Weak edges (connected to strong ones)</li>
</ul></li>
<li><p>Edge tracking by hysteresis:</p>
<ul>
<li>Connect weak edges linked to strong edges</li>
</ul></li>
</ol>
</section>
<section id="tiny-code-pseudocode" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-pseudocode">Tiny Code (Pseudocode)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb383"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>Image canny<span class="op">(</span>Image input<span class="op">)</span> <span class="op">{</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>    Image smoothed <span class="op">=</span> gaussian_blur<span class="op">(</span>input<span class="op">);</span></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>    Gradient grad <span class="op">=</span> sobel<span class="op">(</span>smoothed<span class="op">);</span></span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>    Image suppressed <span class="op">=</span> non_max_suppression<span class="op">(</span>grad<span class="op">);</span></span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a>    Image edges <span class="op">=</span> hysteresis_threshold<span class="op">(</span>suppressed<span class="op">,</span> low<span class="op">,</span> high<span class="op">);</span></span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> edges<span class="op">;</span></span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="why-canny-works" class="level4">
<h4 class="anchored" data-anchor-id="why-canny-works">Why Canny Works</h4>
<p>Canny maximizes three criteria:</p>
<ol type="1">
<li>Good detection (low false negatives)</li>
<li>Good localization (edges close to true edges)</li>
<li>Single response (no duplicates)</li>
</ol>
<p>It’s a careful balance between sensitivity and stability.</p>
</section>
<section id="hough-transform" class="level4">
<h4 class="anchored" data-anchor-id="hough-transform">3. Hough Transform</h4>
<p>Canny finds edge points, Hough connects them into shapes.</p>
<p>The Hough transform detects lines, circles, and other parametric shapes using voting in parameter space.</p>
</section>
<section id="line-detection" class="level4">
<h4 class="anchored" data-anchor-id="line-detection">Line Detection</h4>
<p>Equation of a line: <span class="math display">\[
\rho = x\cos\theta + y\sin\theta
\]</span></p>
<p>Each edge point votes for all (<span class="math inline">\(\rho, \theta\)</span>) combinations it could belong to. Peaks in the accumulator array correspond to strong lines.</p>
<p>Tiny Code (Hough Transform)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb384"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each edge point <span class="op">(</span>x<span class="op">,</span> y<span class="op">):</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> theta in <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">180</span><span class="op">):</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>    rho <span class="op">=</span> x<span class="op">*</span>cos<span class="op">(</span>theta<span class="op">)</span> <span class="op">+</span> y<span class="op">*</span>sin<span class="op">(</span>theta<span class="op">);</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>    accumulator<span class="op">[</span>rho<span class="op">,</span> theta<span class="op">]++;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then pick (<span class="math inline">\(\rho, \theta\)</span>) with highest votes.</p>
</section>
<section id="circle-detection" class="level4">
<h4 class="anchored" data-anchor-id="circle-detection">Circle Detection</h4>
<p>Use 3D accumulator <span class="math inline">\(center_x, center_y, radius\)</span>. Each edge pixel votes for possible circle centers.</p>
</section>
<section id="applications-19" class="level4">
<h4 class="anchored" data-anchor-id="applications-19">Applications</h4>
<ul>
<li>Lane detection in self-driving- Shape recognition (circles, ellipses)- Document analysis (lines, grids)</li>
</ul>
</section>
<section id="sift-scale-invariant-feature-transform" class="level4">
<h4 class="anchored" data-anchor-id="sift-scale-invariant-feature-transform">4. SIFT (Scale-Invariant Feature Transform)</h4>
<p>SIFT finds keypoints that remain stable under scale, rotation, and illumination changes.</p>
<p>It’s widely used for image matching, panoramas, 3D reconstruction, and object recognition.</p>
</section>
<section id="steps-2" class="level4">
<h4 class="anchored" data-anchor-id="steps-2">Steps</h4>
<ol type="1">
<li><p>Scale-space extrema detection</p>
<ul>
<li><p>Use Difference of Gaussians (DoG) across scales. - Detect maxima/minima in space-scale neighborhood.2. Keypoint localization</p></li>
<li><p>Refine keypoint position and discard unstable ones.3. Orientation assignment</p></li>
<li><p>Assign dominant gradient direction.4. Descriptor generation</p></li>
<li><p>Build a 128D histogram of gradient orientations in a local patch.</p></li>
</ul></li>
</ol>
<p>Tiny Code (Outline)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb385"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each octave<span class="op">:</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>  build scale<span class="op">-</span>space pyramid</span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>  find DoG extrema</span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>  localize keypoints</span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>  assign orientations</span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a>  compute <span class="dv">128</span><span class="er">D</span> descriptor</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="properties-1" class="level4">
<h4 class="anchored" data-anchor-id="properties-1">Properties</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Scale Invariant</td>
<td>Detects features at multiple scales</td>
</tr>
<tr class="even">
<td>Rotation Invariant</td>
<td>Uses local orientation</td>
</tr>
<tr class="odd">
<td>Robust</td>
<td>Handles lighting, noise, affine transforms</td>
</tr>
</tbody>
</table>
</section>
<section id="comparison-25" class="level4">
<h4 class="anchored" data-anchor-id="comparison-25">5. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 23%">
<col style="width: 30%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Purpose</th>
<th>Output</th>
<th>Robustness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Canny</td>
<td>Edge detection</td>
<td>Binary edge map</td>
<td>Sensitive to thresholds</td>
</tr>
<tr class="even">
<td>Hough</td>
<td>Shape detection</td>
<td>Lines, circles</td>
<td>Needs clean edges</td>
</tr>
<tr class="odd">
<td>SIFT</td>
<td>Feature detection</td>
<td>Keypoints, descriptors</td>
<td>Very robust</td>
</tr>
</tbody>
</table>
</section>
<section id="applications-20" class="level4">
<h4 class="anchored" data-anchor-id="applications-20">6. Applications</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Domain</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Robotics</td>
<td>Visual SLAM, localization</td>
</tr>
<tr class="even">
<td>AR / VR</td>
<td>Marker tracking</td>
</tr>
<tr class="odd">
<td>Search</td>
<td>Image matching</td>
</tr>
<tr class="even">
<td>Medical</td>
<td>Edge segmentation</td>
</tr>
<tr class="odd">
<td>Industry</td>
<td>Quality inspection</td>
</tr>
</tbody>
</table>
</section>
<section id="modern-successors" class="level4">
<h4 class="anchored" data-anchor-id="modern-successors">7. Modern Successors</h4>
<ul>
<li>ORB (FAST + BRIEF): Efficient for real-time- SURF: Faster SIFT alternative- Harris / FAST: Corner detectors- Deep features: CNN-based descriptors</li>
</ul>
</section>
<section id="why-it-matters-77" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-77">Why It Matters</h4>
<p>These algorithms gave machines their first eyes, before deep learning, they were how computers recognized structure. Even today, they’re used in preprocessing, embedded systems, and hybrid pipelines.</p>
<blockquote class="blockquote">
<p>“Before neural nets could dream, vision began with gradients, geometry, and votes.”</p>
</blockquote>
</section>
<section id="try-it-yourself-77" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-77">Try It Yourself</h4>
<ol type="1">
<li>Implement Canny using Sobel and hysteresis.</li>
<li>Use Hough transform to detect lines in a synthetic image.</li>
<li>Try OpenCV SIFT to match keypoints between two rotated images.</li>
<li>Compare edge maps before and after Gaussian blur.</li>
</ol>
</section>
</section>
<section id="pathfinding-in-space-a-rrt-prm" class="level3">
<h3 class="anchored" data-anchor-id="pathfinding-in-space-a-rrt-prm">79. Pathfinding in Space (A*, RRT, PRM)</h3>
<p>When navigating a maze, driving an autonomous car, or moving a robot arm, the question is the same: How do we find a path from start to goal efficiently and safely?</p>
<p>Pathfinding algorithms answer this question, balancing optimality, speed, and adaptability. In this section, we explore three foundational families:</p>
<ul>
<li>A*: Heuristic search in grids and graphs- RRT (Rapidly-Exploring Random Tree): Sampling-based exploration- PRM (Probabilistic Roadmap): Precomputed navigation networks</li>
</ul>
<section id="the-pathfinding-problem" class="level4">
<h4 class="anchored" data-anchor-id="the-pathfinding-problem">1. The Pathfinding Problem</h4>
<p>Given:</p>
<ul>
<li>A space (grid, graph, or continuous)- A start node and goal node- A cost function (distance, time, energy)- Optional obstacles Find a collision-free, low-cost path.</li>
</ul>
</section>
<section id="a-a-star-search" class="level4">
<h4 class="anchored" data-anchor-id="a-a-star-search">2. A* (A-star) Search</h4>
<p>A* combines Dijkstra’s algorithm with a heuristic that estimates remaining cost. It’s the most popular graph-based pathfinding algorithm.</p>
</section>
<section id="key-idea" class="level4">
<h4 class="anchored" data-anchor-id="key-idea">Key Idea</h4>
<p>Each node ( n ) has: <span class="math display">\[
f(n) = g(n) + h(n)
\]</span></p>
<ul>
<li>( g(n) ): cost so far- ( h(n) ): estimated cost to goal- ( f(n) ): total estimated cost</li>
</ul>
<p>Algorithm</p>
<ol type="1">
<li><p>Initialize priority queue with start node</p></li>
<li><p>While queue not empty:</p>
<ul>
<li>Pop node with smallest ( f(n) ) - If goal reached → return path - For each neighbor:
<ul>
<li>Compute new ( g ), ( f ) - Update queue if better</li>
</ul></li>
</ul></li>
</ol>
<p>Tiny Code (Grid A*)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb386"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> <span class="op">{</span> <span class="dt">int</span> x<span class="op">,</span> y<span class="op">;</span> <span class="dt">double</span> g<span class="op">,</span> f<span class="op">;</span> <span class="op">}</span> Node<span class="op">;</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> heuristic<span class="op">(</span>Node a<span class="op">,</span> Node b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fabs<span class="op">(</span>a<span class="op">.</span>x <span class="op">-</span> b<span class="op">.</span>x<span class="op">)</span> <span class="op">+</span> fabs<span class="op">(</span>a<span class="op">.</span>y <span class="op">-</span> b<span class="op">.</span>y<span class="op">);</span> <span class="co">// Manhattan</span></span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> a_star<span class="op">(</span>Node start<span class="op">,</span> Node goal<span class="op">)</span> <span class="op">{</span></span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a>    PriorityQueue open<span class="op">;</span></span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a>    push<span class="op">(</span>open<span class="op">,</span> start<span class="op">);</span></span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>empty<span class="op">(</span>open<span class="op">))</span> <span class="op">{</span></span>
<span id="cb386-11"><a href="#cb386-11" aria-hidden="true" tabindex="-1"></a>        Node cur <span class="op">=</span> pop_min<span class="op">(</span>open<span class="op">);</span></span>
<span id="cb386-12"><a href="#cb386-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>cur <span class="op">==</span> goal<span class="op">)</span> <span class="cf">return</span> reconstruct_path<span class="op">();</span></span>
<span id="cb386-13"><a href="#cb386-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>Node n <span class="op">:</span> neighbors<span class="op">(</span>cur<span class="op">))</span> <span class="op">{</span></span>
<span id="cb386-14"><a href="#cb386-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> tentative_g <span class="op">=</span> cur<span class="op">.</span>g <span class="op">+</span> dist<span class="op">(</span>cur<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb386-15"><a href="#cb386-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>tentative_g <span class="op">&lt;</span> n<span class="op">.</span>g<span class="op">)</span> <span class="op">{</span></span>
<span id="cb386-16"><a href="#cb386-16" aria-hidden="true" tabindex="-1"></a>                n<span class="op">.</span>g <span class="op">=</span> tentative_g<span class="op">;</span></span>
<span id="cb386-17"><a href="#cb386-17" aria-hidden="true" tabindex="-1"></a>                n<span class="op">.</span>f <span class="op">=</span> n<span class="op">.</span>g <span class="op">+</span> heuristic<span class="op">(</span>n<span class="op">,</span> goal<span class="op">);</span></span>
<span id="cb386-18"><a href="#cb386-18" aria-hidden="true" tabindex="-1"></a>                push<span class="op">(</span>open<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb386-19"><a href="#cb386-19" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb386-20"><a href="#cb386-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb386-21"><a href="#cb386-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb386-22"><a href="#cb386-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="complexity-7" class="level4">
<h4 class="anchored" data-anchor-id="complexity-7">Complexity</h4>
<ul>
<li>Time: ( O<span class="math inline">\(E \log V\)</span> )- Space: ( O(V) )- Optimal if ( h(n) ) is admissible (never overestimates)</li>
</ul>
</section>
<section id="variants-2" class="level4">
<h4 class="anchored" data-anchor-id="variants-2">Variants</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variant</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dijkstra</td>
<td>A* with ( h(n) = 0 )</td>
</tr>
<tr class="even">
<td>Greedy Best-First</td>
<td>Uses ( h(n) ) only</td>
</tr>
<tr class="odd">
<td>Weighted A*</td>
<td>Speeds up with tradeoff on optimality</td>
</tr>
<tr class="even">
<td>Jump Point Search</td>
<td>Optimized for uniform grids</td>
</tr>
</tbody>
</table>
</section>
<section id="rrt-rapidly-exploring-random-tree" class="level4">
<h4 class="anchored" data-anchor-id="rrt-rapidly-exploring-random-tree">3. RRT (Rapidly-Exploring Random Tree)</h4>
<p>A* struggles in continuous or high-dimensional spaces (e.g.&nbsp;robot arms). RRT tackles this with randomized exploration.</p>
</section>
<section id="core-idea-1" class="level4">
<h4 class="anchored" data-anchor-id="core-idea-1">Core Idea</h4>
<ul>
<li>Grow a tree from the start by randomly sampling points.- Extend tree toward each sample (step size <span class="math inline">\(\epsilon\)</span>).- Stop when near the goal.</li>
</ul>
<p>Tiny Code (RRT Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb387"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>Tree T <span class="op">=</span> <span class="op">{</span>start<span class="op">};</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> MAX_ITERS<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>    Point q_rand <span class="op">=</span> random_point<span class="op">();</span></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>    Point q_near <span class="op">=</span> nearest<span class="op">(</span>T<span class="op">,</span> q_rand<span class="op">);</span></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>    Point q_new <span class="op">=</span> steer<span class="op">(</span>q_near<span class="op">,</span> q_rand<span class="op">,</span> step_size<span class="op">);</span></span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>collision_free<span class="op">(</span>q_near<span class="op">,</span> q_new<span class="op">))</span></span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a>        add_edge<span class="op">(</span>T<span class="op">,</span> q_near<span class="op">,</span> q_new<span class="op">);</span></span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>distance<span class="op">(</span>q_new<span class="op">,</span> goal<span class="op">)</span> <span class="op">&lt;</span> eps<span class="op">)</span></span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> path<span class="op">;</span></span>
<span id="cb387-10"><a href="#cb387-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pros-cons-2" class="level4">
<h4 class="anchored" data-anchor-id="pros-cons-2">Pros &amp; Cons</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Works in continuous space</td>
<td>Paths are suboptimal</td>
</tr>
<tr class="even">
<td>Handles high dimensions</td>
<td>Randomness may miss narrow passages</td>
</tr>
<tr class="odd">
<td>Simple and fast</td>
<td>Needs post-processing (smoothing)</td>
</tr>
</tbody>
</table>
</section>
<section id="variants-3" class="level4">
<h4 class="anchored" data-anchor-id="variants-3">Variants</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variant</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>RRT*</td>
<td>Asymptotically optimal</td>
</tr>
<tr class="even">
<td>Bi-RRT</td>
<td>Grow from both start and goal</td>
</tr>
<tr class="odd">
<td>Informed RRT*</td>
<td>Focus on promising regions</td>
</tr>
</tbody>
</table>
</section>
<section id="prm-probabilistic-roadmap" class="level4">
<h4 class="anchored" data-anchor-id="prm-probabilistic-roadmap">4. PRM (Probabilistic Roadmap)</h4>
<p>PRM builds a graph of feasible configurations, a roadmap, then searches it.</p>
</section>
<section id="steps-3" class="level4">
<h4 class="anchored" data-anchor-id="steps-3">Steps</h4>
<ol type="1">
<li>Sample random points in free space</li>
<li>Connect nearby points with collision-free edges</li>
<li>Search roadmap (e.g., with A*)</li>
</ol>
<p>Tiny Code (PRM Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb388"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>Graph G <span class="op">=</span> <span class="op">{};</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>    Point p <span class="op">=</span> random_free_point<span class="op">();</span></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>    G<span class="op">.</span>add_vertex<span class="op">(</span>p<span class="op">);</span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each p in G<span class="op">:</span></span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> each q near p<span class="op">:</span></span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>collision_free<span class="op">(</span>p<span class="op">,</span> q<span class="op">))</span></span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a>            G<span class="op">.</span>add_edge<span class="op">(</span>p<span class="op">,</span> q<span class="op">);</span></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> a_star<span class="op">(</span>G<span class="op">,</span> start<span class="op">,</span> goal<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pros-cons-3" class="level4">
<h4 class="anchored" data-anchor-id="pros-cons-3">Pros &amp; Cons</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Precomputes reusable roadmap</td>
<td>Needs many samples for coverage</td>
</tr>
<tr class="even">
<td>Good for multiple queries</td>
<td>Poor for single-query planning</td>
</tr>
<tr class="odd">
<td>Works in high-dim spaces</td>
<td>May need post-smoothing</td>
</tr>
</tbody>
</table>
</section>
<section id="comparison-26" class="level4">
<h4 class="anchored" data-anchor-id="comparison-26">5. Comparison</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Space</th>
<th>Nature</th>
<th>Optimal</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A*</td>
<td>Discrete</td>
<td>Deterministic</td>
<td>Yes</td>
<td>Grids, graphs</td>
</tr>
<tr class="even">
<td>RRT</td>
<td>Continuous</td>
<td>Randomized</td>
<td>No (RRT* = Yes)</td>
<td>Robotics, motion planning</td>
</tr>
<tr class="odd">
<td>PRM</td>
<td>Continuous</td>
<td>Randomized</td>
<td>Approx.</td>
<td>Multi-query planning</td>
</tr>
</tbody>
</table>
</section>
<section id="applications-21" class="level4">
<h4 class="anchored" data-anchor-id="applications-21">6. Applications</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Domain</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Robotics</td>
<td>Arm motion, mobile navigation</td>
</tr>
<tr class="even">
<td>Games</td>
<td>NPC pathfinding, AI navigation mesh</td>
</tr>
<tr class="odd">
<td>Autonomous vehicles</td>
<td>Route planning</td>
</tr>
<tr class="even">
<td>Aerospace</td>
<td>Drone and spacecraft trajectory</td>
</tr>
<tr class="odd">
<td>Logistics</td>
<td>Warehouse robot movement</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-78" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-78">Why It Matters</h4>
<p>Pathfinding is decision-making in space, it gives agents the ability to move, explore, and act purposefully. From Pac-Man to Mars rovers, every journey starts with an algorithm.</p>
<blockquote class="blockquote">
<p>“To move with purpose, one must first see the paths that are possible.”</p>
</blockquote>
</section>
<section id="try-it-yourself-78" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-78">Try It Yourself</h4>
<ol type="1">
<li>Implement A* on a 2D grid with walls.</li>
<li>Generate an RRT in a 2D obstacle field.</li>
<li>Build a PRM for a continuous space and run A* on the roadmap.</li>
<li>Compare speed and path smoothness across methods.</li>
</ol>
</section>
</section>
<section id="computational-geometry-variants-and-applications" class="level3">
<h3 class="anchored" data-anchor-id="computational-geometry-variants-and-applications">80. Computational Geometry Variants and Applications</h3>
<p>Computational geometry is the study of algorithms on geometric data, points, lines, polygons, circles, and higher-dimensional shapes. By now, you’ve seen core building blocks: convex hulls, intersections, nearest neighbors, triangulations, and spatial indexing.</p>
<p>This final section brings them together through variants, generalizations, and real-world applications, showing how geometry quietly powers modern computing.</p>
<section id="beyond-the-plane" class="level4">
<h4 class="anchored" data-anchor-id="beyond-the-plane">1. Beyond the Plane</h4>
<p>Most examples so far assumed 2D geometry. But real systems often live in 3D or N-D spaces.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 57%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Dimension</th>
<th>Example Problems</th>
<th>Typical Uses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2D</td>
<td>Convex hull, polygon area, line sweep</td>
<td>GIS, CAD, mapping</td>
</tr>
<tr class="even">
<td>3D</td>
<td>Convex polyhedra, mesh intersection, visibility</td>
<td>Graphics, simulation</td>
</tr>
<tr class="odd">
<td>N-D</td>
<td>Voronoi in high-D, KD-trees, optimization</td>
<td>ML, robotics, data science</td>
</tr>
</tbody>
</table>
<p>Higher dimensions add complexity (and sometimes impossibility):</p>
<ul>
<li>Exact geometry often replaced by approximations.- Volume, distance, and intersection tests become more expensive.</li>
</ul>
</section>
<section id="approximate-and-robust-geometry" class="level4">
<h4 class="anchored" data-anchor-id="approximate-and-robust-geometry">2. Approximate and Robust Geometry</h4>
<p>Real-world geometry faces numerical errors (floating point) and degenerate cases (collinear, overlapping). To handle this, algorithms adopt robustness and approximation strategies.</p>
<ul>
<li>Epsilon comparisons: treat values within tolerance as equal- Orientation tests: robustly compute turn direction via cross product- Exact arithmetic: rational or symbolic computation- Grid snapping: quantize space for stability Approximate geometry accepts small error for large speed-up, essential in graphics and machine learning.</li>
</ul>
</section>
<section id="geometric-duality" class="level4">
<h4 class="anchored" data-anchor-id="geometric-duality">3. Geometric Duality</h4>
<p>A powerful tool for reasoning about problems: map points to lines, lines to points. For example:</p>
<ul>
<li><p>A point ( (a, b) ) maps to line ( y = ax - b ).- A line ( y = mx + c ) maps to point ( (m, -c) ). Applications:</p></li>
<li><p>Transforming line intersection problems into point location problems- Simplifying half-plane intersections- Enabling arrangement algorithms in computational geometry Duality is a common trick: turn geometry upside-down to make it simpler.</p></li>
</ul>
</section>
<section id="geometric-data-structures" class="level4">
<h4 class="anchored" data-anchor-id="geometric-data-structures">4. Geometric Data Structures</h4>
<p>Recap of core spatial structures and what they’re best at:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 32%">
<col style="width: 23%">
<col style="width: 17%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Structure</th>
<th>Stores</th>
<th>Queries</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KD-Tree</td>
<td>Points</td>
<td>NN, range</td>
<td>Low-D search</td>
</tr>
<tr class="even">
<td>R-Tree</td>
<td>Rectangles</td>
<td>Overlaps</td>
<td>Spatial DB</td>
</tr>
<tr class="odd">
<td>Quad/Octree</td>
<td>Space partitions</td>
<td>Point lookup</td>
<td>Graphics, GIS</td>
</tr>
<tr class="even">
<td>BSP Tree</td>
<td>Polygons</td>
<td>Visibility</td>
<td>Rendering</td>
</tr>
<tr class="odd">
<td>Delaunay Triangulation</td>
<td>Points</td>
<td>Neighbors</td>
<td>Mesh generation</td>
</tr>
<tr class="even">
<td>Segment Tree</td>
<td>Intervals</td>
<td>Range</td>
<td>Sweep-line events</td>
</tr>
</tbody>
</table>
</section>
<section id="randomized-geometry" class="level4">
<h4 class="anchored" data-anchor-id="randomized-geometry">5. Randomized Geometry</h4>
<p>Randomness simplifies deterministic geometry:</p>
<ul>
<li>Randomized incremental construction (Convex Hulls, Delaunay)- Random sampling for approximation (ε-nets, VC dimension)- Monte Carlo geometry for probabilistic intersection and coverage Example: randomized incremental convex hull builds expected ( O<span class="math inline">\(n \log n\)</span> ) structures with elegant proofs.</li>
</ul>
</section>
<section id="computational-topology" class="level4">
<h4 class="anchored" data-anchor-id="computational-topology">6. Computational Topology</h4>
<p>Beyond geometry lies shape connectivity, studied by topology. Algorithms compute connected components, holes, homology, and Betti numbers.</p>
<p>Applications include:</p>
<ul>
<li>3D printing (watertightness)- Data analysis (persistent homology)- Robotics (free space topology) Geometry meets topology in alpha-shapes, simplicial complexes, and manifold reconstruction.</li>
</ul>
</section>
<section id="geometry-meets-machine-learning" class="level4">
<h4 class="anchored" data-anchor-id="geometry-meets-machine-learning">7. Geometry Meets Machine Learning</h4>
<p>Many ML methods are geometric at heart:</p>
<ul>
<li>Nearest neighbor → Voronoi diagram- SVM → hyperplane separation- K-means → Voronoi partitioning- Manifold learning → low-dim geometry- Convex optimization → geometric feasibility Visualization tools (t-SNE, UMAP) rely on spatial embedding and distance geometry.</li>
</ul>
</section>
<section id="applications-across-fields" class="level4">
<h4 class="anchored" data-anchor-id="applications-across-fields">8. Applications Across Fields</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 34%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th>Field</th>
<th>Application</th>
<th>Geometric Core</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Graphics</td>
<td>Rendering, collision</td>
<td>Triangulation, ray tracing</td>
</tr>
<tr class="even">
<td>GIS</td>
<td>Maps, roads</td>
<td>Polygons, point-in-region</td>
</tr>
<tr class="odd">
<td>Robotics</td>
<td>Path planning</td>
<td>Obstacles, configuration space</td>
</tr>
<tr class="even">
<td>Architecture</td>
<td>Modeling</td>
<td>Mesh operations</td>
</tr>
<tr class="odd">
<td>Vision</td>
<td>Object boundaries</td>
<td>Contours, convexity</td>
</tr>
<tr class="even">
<td>AI</td>
<td>Clustering, similarity</td>
<td>Distance metrics</td>
</tr>
<tr class="odd">
<td>Physics</td>
<td>Simulation</td>
<td>Particle collision</td>
</tr>
<tr class="even">
<td>Databases</td>
<td>Spatial joins</td>
<td>R-Trees, indexing</td>
</tr>
</tbody>
</table>
<p>Geometry underpins structure, position, and relationship, the backbone of spatial reasoning.</p>
</section>
<section id="complexity-and-open-problems" class="level4">
<h4 class="anchored" data-anchor-id="complexity-and-open-problems">9. Complexity and Open Problems</h4>
<p>Some problems still challenge efficient solutions:</p>
<ul>
<li>Point location in dynamic settings- Visibility graphs in complex polygons- Motion planning in high dimensions- Geometric median / center problems- Approximation guarantees in robust settings These remain active areas in computational geometry research.</li>
</ul>
</section>
<section id="tiny-code-point-in-polygon-via-ray-casting" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-point-in-polygon-via-ray-casting">Tiny Code (Point-in-Polygon via Ray Casting)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb389"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> inside<span class="op">(</span>Point p<span class="op">,</span> Polygon poly<span class="op">)</span> <span class="op">{</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> poly<span class="op">.</span>n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>        Point a <span class="op">=</span> poly<span class="op">[</span>i<span class="op">],</span> b <span class="op">=</span> poly<span class="op">[(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> poly<span class="op">.</span>n<span class="op">];</span></span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>intersect_ray<span class="op">(</span>p<span class="op">,</span> a<span class="op">,</span> b<span class="op">))</span> cnt<span class="op">++;</span></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cnt <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// odd crossings = inside</span></span>
<span id="cb389-8"><a href="#cb389-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This small routine appears everywhere, maps, games, GUIs, and physics engines.</p>
</section>
<section id="why-it-matters-79" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-79">10. Why It Matters</h4>
<p>Computational geometry is more than shape, it’s the mathematics of space, powering visual computing, spatial data, and intelligent systems. Everywhere something moves, collides, maps, or recognizes form, geometry is the invisible hand guiding it.</p>
<blockquote class="blockquote">
<p>“All computation lives somewhere, and geometry is how we understand the where.”</p>
</blockquote>
</section>
<section id="try-it-yourself-79" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-79">Try It Yourself</h4>
<ol type="1">
<li>Implement point-in-polygon and test on convex vs concave shapes.</li>
<li>Visualize a Delaunay triangulation and its Voronoi dual.</li>
<li>Experiment with KD-trees for nearest neighbor queries.</li>
<li>Write a small convex hull in 3D using incremental insertion.</li>
<li>Sketch an RRT path over a geometric map.</li>
</ol>
</section>
</section>
</section>
<section id="chapter-9.-systems-databases-and-distributed-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="chapter-9.-systems-databases-and-distributed-algorithms">Chapter 9. Systems, Databases, and Distributed Algorithms</h2>
<section id="concurrency-control-2pl-mvcc-occ" class="level3">
<h3 class="anchored" data-anchor-id="concurrency-control-2pl-mvcc-occ">81. Concurrency Control (2PL, MVCC, OCC)</h3>
<p>In multi-user or multi-threaded systems, many operations want to read or write shared data at the same time. Without discipline, this leads to chaos, lost updates, dirty reads, or even inconsistent states.</p>
<p>Concurrency control ensures correctness under parallelism, so that the result is as if each transaction ran alone (a property called serializability).</p>
<p>This section introduces three foundational techniques:</p>
<ul>
<li>2PL - Two-Phase Locking- MVCC - Multi-Version Concurrency Control- OCC - Optimistic Concurrency Control</li>
</ul>
<section id="the-goal-serializability" class="level4">
<h4 class="anchored" data-anchor-id="the-goal-serializability">1. The Goal: Serializability</h4>
<p>We want transactions to behave as if executed in some serial order, even though they’re interleaved.</p>
<p>A schedule is <em>serializable</em> if it yields the same result as some serial order of transactions.</p>
<p>Concurrency control prevents problems like:</p>
<ul>
<li>Lost Update: Two writes overwrite each other.- Dirty Read: Read uncommitted data.- Non-repeatable Read: Data changes mid-transaction.- Phantom Read: New rows appear after a query.</li>
</ul>
</section>
<section id="two-phase-locking-2pl" class="level4">
<h4 class="anchored" data-anchor-id="two-phase-locking-2pl">2. Two-Phase Locking (2PL)</h4>
<p>Idea: Use locks to coordinate access. Each transaction has two phases:</p>
<ol type="1">
<li>Growing phase: acquire locks (shared or exclusive)</li>
<li>Shrinking phase: release locks (no new locks allowed after release)</li>
</ol>
<p>This ensures conflict-serializability.</p>
</section>
<section id="lock-types" class="level4">
<h4 class="anchored" data-anchor-id="lock-types">Lock Types</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Operation</th>
<th>Shared?</th>
<th>Exclusive?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Shared (S)</td>
<td>Read</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="even">
<td>Exclusive (X)</td>
<td>Write</td>
<td>No</td>
<td>No</td>
</tr>
</tbody>
</table>
<p>If a transaction needs to read: request S-lock. If it needs to write: request X-lock.</p>
<p>Tiny Code (Lock Manager Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb390"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> acquire_lock<span class="op">(</span>Transaction <span class="op">*</span>T<span class="op">,</span> Item <span class="op">*</span>X<span class="op">,</span> LockType type<span class="op">)</span> <span class="op">{</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>conflict_exists<span class="op">(</span>X<span class="op">,</span> type<span class="op">))</span></span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true" tabindex="-1"></a>        wait<span class="op">();</span></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true" tabindex="-1"></a>    add_lock<span class="op">(</span>X<span class="op">,</span> T<span class="op">,</span> type<span class="op">);</span></span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb390-6"><a href="#cb390-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-7"><a href="#cb390-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> release_all<span class="op">(</span>Transaction <span class="op">*</span>T<span class="op">)</span> <span class="op">{</span></span>
<span id="cb390-8"><a href="#cb390-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>Lock <span class="op">*</span>l in T<span class="op">-&gt;</span>locks<span class="op">)</span></span>
<span id="cb390-9"><a href="#cb390-9" aria-hidden="true" tabindex="-1"></a>        unlock<span class="op">(</span>l<span class="op">);</span></span>
<span id="cb390-10"><a href="#cb390-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-14" class="level4">
<h4 class="anchored" data-anchor-id="example-14">Example</h4>
<pre><code>T1: read(A); write(A)
T2: read(A); write(A)</code></pre>
<p>Without locks → race condition. With 2PL → one must wait → consistent.</p>
</section>
<section id="variants-4" class="level4">
<h4 class="anchored" data-anchor-id="variants-4">Variants</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Variant</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Strict 2PL</td>
<td>Holds all locks until commit → avoids cascading aborts</td>
</tr>
<tr class="even">
<td>Rigorous 2PL</td>
<td>Same as Strict, all locks released at end</td>
</tr>
<tr class="odd">
<td>Conservative 2PL</td>
<td>Acquires all locks before execution</td>
</tr>
</tbody>
</table>
</section>
<section id="pros-cons-4" class="level4">
<h4 class="anchored" data-anchor-id="pros-cons-4">Pros &amp; Cons</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Guarantees serializability</td>
<td>Can cause deadlocks</td>
</tr>
<tr class="even">
<td>Simple concept</td>
<td>Blocking, contention under load</td>
</tr>
</tbody>
</table>
</section>
<section id="multi-version-concurrency-control-mvcc" class="level4">
<h4 class="anchored" data-anchor-id="multi-version-concurrency-control-mvcc">3. Multi-Version Concurrency Control (MVCC)</h4>
<p>Idea: Readers don’t block writers, and writers don’t block readers. Each write creates a new version of data with a timestamp.</p>
<p>Transactions read from a consistent snapshot based on their start time.</p>
</section>
<section id="snapshot-isolation" class="level4">
<h4 class="anchored" data-anchor-id="snapshot-isolation">Snapshot Isolation</h4>
<ul>
<li><p>Readers see the latest committed version at transaction start.- Writers produce new versions; conflicts detected at commit time. Each record stores:</p></li>
<li><p><code>value</code>- <code>created_at</code>- <code>deleted_at</code> (if applicable)</p></li>
</ul>
<p>Tiny Code (Version Chain)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb392"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Version <span class="op">{</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> value<span class="op">;</span></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>    Timestamp created<span class="op">;</span></span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a>    Timestamp deleted<span class="op">;</span></span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a>    Version <span class="op">*</span>next<span class="op">;</span></span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Read finds version with <code>created &lt;= tx.start &amp;&amp; deleted &gt; tx.start</code>.</p>
</section>
<section id="pros-cons-5" class="level4">
<h4 class="anchored" data-anchor-id="pros-cons-5">Pros &amp; Cons</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No read locks</td>
<td>Higher memory (multiple versions)</td>
</tr>
<tr class="even">
<td>Readers never block</td>
<td>Write conflicts at commit</td>
</tr>
<tr class="odd">
<td>Great for OLTP systems</td>
<td>GC of old versions needed</td>
</tr>
</tbody>
</table>
</section>
<section id="used-in" class="level4">
<h4 class="anchored" data-anchor-id="used-in">Used In</h4>
<ul>
<li>PostgreSQL- Oracle- MySQL (InnoDB)- Spanner</li>
</ul>
</section>
<section id="optimistic-concurrency-control-occ" class="level4">
<h4 class="anchored" data-anchor-id="optimistic-concurrency-control-occ">4. Optimistic Concurrency Control (OCC)</h4>
<p>Idea: Assume conflicts are rare. Let transactions run without locks. At commit time, validate, if conflicts exist, rollback.</p>
</section>
<section id="phases" class="level4">
<h4 class="anchored" data-anchor-id="phases">Phases</h4>
<ol type="1">
<li>Read phase - execute, read data, buffer writes.</li>
<li>Validation phase - check if conflicts occurred.</li>
<li>Write phase - apply changes if valid, else abort.</li>
</ol>
<p>Tiny Code (OCC Validation)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb393"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> validate<span class="op">(</span>Transaction <span class="op">*</span>T<span class="op">)</span> <span class="op">{</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>Transaction <span class="op">*</span>U in committed_since<span class="op">(</span>T<span class="op">.</span>start<span class="op">))</span></span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>conflict<span class="op">(</span>T<span class="op">,</span> U<span class="op">))</span></span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pros-cons-6" class="level4">
<h4 class="anchored" data-anchor-id="pros-cons-6">Pros &amp; Cons</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No locks → no deadlocks</td>
<td>High abort rate under contention</td>
</tr>
<tr class="even">
<td>Great for low-conflict workloads</td>
<td>Wasted work on abort</td>
</tr>
</tbody>
</table>
</section>
<section id="used-in-1" class="level4">
<h4 class="anchored" data-anchor-id="used-in-1">Used In</h4>
<ul>
<li>In-memory DBs- Distributed systems- STM (Software Transactional Memory)</li>
</ul>
</section>
<section id="choosing-a-strategy" class="level4">
<h4 class="anchored" data-anchor-id="choosing-a-strategy">5. Choosing a Strategy</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>System Type</th>
<th>Preferred Control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>OLTP (many reads/writes)</td>
<td>MVCC</td>
</tr>
<tr class="even">
<td>OLAP (read-heavy)</td>
<td>MVCC or OCC</td>
</tr>
<tr class="odd">
<td>Real-time systems</td>
<td>2PL (predictable)</td>
</tr>
<tr class="even">
<td>Low contention</td>
<td>OCC</td>
</tr>
<tr class="odd">
<td>High contention</td>
<td>2PL / MVCC</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-80" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-80">6. Why It Matters</h4>
<p>Concurrency control is the backbone of consistency in databases, distributed systems, and even multi-threaded programs. It enforces correctness amid chaos, ensuring your data isn’t silently corrupted.</p>
<blockquote class="blockquote">
<p>“Without order, parallelism is noise. Concurrency control is its conductor.”</p>
</blockquote>
</section>
<section id="try-it-yourself-80" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-80">Try It Yourself</h4>
<ol type="1">
<li>Simulate 2PL with two transactions updating shared data.</li>
<li>Implement a toy MVCC table with version chains.</li>
<li>Write an OCC validator for three concurrent transactions.</li>
<li>Experiment: under high conflict, which model performs best?</li>
</ol>
</section>
</section>
<section id="logging-recovery-and-commit-protocols" class="level3">
<h3 class="anchored" data-anchor-id="logging-recovery-and-commit-protocols">82. Logging, Recovery, and Commit Protocols</h3>
<p>No matter how elegant your algorithms or how fast your storage, failures happen. Power cuts, crashes, and network splits are inevitable. What matters is recovery, restoring the system to a consistent state without losing committed work.</p>
<p>Logging, recovery, and commit protocols form the backbone of reliable transactional systems, ensuring durability and correctness in the face of crashes.</p>
<section id="the-problem-2" class="level4">
<h4 class="anchored" data-anchor-id="the-problem-2">1. The Problem</h4>
<p>We need to guarantee the ACID properties:</p>
<ul>
<li>Atomicity - all or nothing- Consistency - valid before and after- Isolation - no interference- Durability - once committed, always safe If a crash occurs mid-transaction, how do we roll back or redo correctly?</li>
</ul>
<p>The answer: Log everything, then replay or undo after failure.</p>
</section>
<section id="write-ahead-logging-wal" class="level4">
<h4 class="anchored" data-anchor-id="write-ahead-logging-wal">2. Write-Ahead Logging (WAL)</h4>
<p>The golden rule:</p>
<blockquote class="blockquote">
<p>“Write log entries before modifying the database.”</p>
</blockquote>
<p>Every action is recorded in a sequential log on disk, ensuring the system can reconstruct the state.</p>
</section>
<section id="log-record-format" class="level4">
<h4 class="anchored" data-anchor-id="log-record-format">Log Record Format</h4>
<p>Each log entry typically includes:</p>
<ul>
<li><code>LSN</code> (Log Sequence Number)- <code>Transaction ID</code>- <code>Operation</code> (update, insert, delete)- <code>Before image</code> (old value)- <code>After image</code> (new value)</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb394"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> LogEntry <span class="op">{</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> lsn<span class="op">;</span></span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> tx_id<span class="op">;</span></span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> op<span class="op">[</span><span class="dv">10</span><span class="op">];</span></span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a>    Value before<span class="op">,</span> after<span class="op">;</span></span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>When a transaction commits, the system first flushes logs to disk (<code>fsync</code>). Only then is the commit acknowledged.</p>
</section>
<section id="recovery-actions" class="level4">
<h4 class="anchored" data-anchor-id="recovery-actions">3. Recovery Actions</h4>
<p>When the system restarts, it reads logs and applies a recovery algorithm.</p>
</section>
<section id="three-phases-aries-model" class="level4">
<h4 class="anchored" data-anchor-id="three-phases-aries-model">Three Phases (ARIES Model)</h4>
<ol type="1">
<li>Analysis - determine state at crash (active vs committed)</li>
<li>Redo - repeat all actions from last checkpoint</li>
<li>Undo - rollback incomplete transactions</li>
</ol>
<p>ARIES (Algorithm for Recovery and Isolation Exploiting Semantics) is the most widely used approach (IBM DB2, PostgreSQL, SQL Server).</p>
</section>
<section id="redo-rule" class="level4">
<h4 class="anchored" data-anchor-id="redo-rule">Redo Rule</h4>
<p>If the system committed before crash → redo all updates so data is preserved.</p>
</section>
<section id="undo-rule" class="level4">
<h4 class="anchored" data-anchor-id="undo-rule">Undo Rule</h4>
<p>If the system didn’t commit → undo to maintain atomicity.</p>
<p>Tiny Code (Simplified Recovery Sketch)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb395"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> recover<span class="op">(</span>Log log<span class="op">)</span> <span class="op">{</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>Entry e <span class="op">:</span> log<span class="op">)</span> <span class="op">{</span></span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e<span class="op">.</span>committed<span class="op">)</span></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>            apply<span class="op">(</span>e<span class="op">.</span>after<span class="op">);</span></span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a>            apply<span class="op">(</span>e<span class="op">.</span>before<span class="op">);</span></span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="checkpointing" class="level4">
<h4 class="anchored" data-anchor-id="checkpointing">4. Checkpointing</h4>
<p>Instead of replaying the entire log, systems take checkpoints, periodic snapshots marking a safe state.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 29%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sharp checkpoint</td>
<td>Stop all transactions briefly, flush data + log</td>
</tr>
<tr class="even">
<td>Fuzzy checkpoint</td>
<td>Mark consistent LSN; continue running</td>
</tr>
</tbody>
</table>
<p>Checkpoints reduce recovery time: only replay after the last checkpoint.</p>
</section>
<section id="commit-protocols" class="level4">
<h4 class="anchored" data-anchor-id="commit-protocols">5. Commit Protocols</h4>
<p>In distributed systems, multiple nodes must agree to commit or abort together. This is handled by atomic commit protocols.</p>
</section>
<section id="two-phase-commit-2pc" class="level4">
<h4 class="anchored" data-anchor-id="two-phase-commit-2pc">Two-Phase Commit (2PC)</h4>
<p>Goal: All participants either commit or abort in unison.</p>
<p>Steps:</p>
<ol type="1">
<li><p>Prepare phase (voting):</p>
<ul>
<li><p>Coordinator asks all participants to “prepare” - Each replies yes/no2. Commit phase (decision):</p></li>
<li><p>If all say yes → commit - Else → abort</p></li>
</ul>
<pre class="text"><code>Coordinator: PREPARE  
Participants: VOTE YES / NO  
Coordinator: COMMIT / ABORT</code></pre></li>
</ol>
<p>If the coordinator crashes after prepare, participants must wait → blocking protocol.</p>
<p>Tiny Code (2PC Pseudocode)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb397"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> two_phase_commit<span class="op">(</span>Participants P<span class="op">)</span> <span class="op">{</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> each p in P<span class="op">:</span></span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>p<span class="op">.</span>prepare<span class="op">())</span> <span class="cf">return</span> abort_all<span class="op">();</span></span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> each p in P<span class="op">:</span></span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a>        p<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="three-phase-commit-3pc" class="level4">
<h4 class="anchored" data-anchor-id="three-phase-commit-3pc">Three-Phase Commit (3PC)</h4>
<p>Improves on 2PC by adding an intermediate phase to avoid indefinite blocking. More complex, used in systems with reliable failure detection.</p>
</section>
<section id="logging-in-distributed-systems" class="level4">
<h4 class="anchored" data-anchor-id="logging-in-distributed-systems">6. Logging in Distributed Systems</h4>
<p>Each participant maintains its own WAL. To recover globally:</p>
<ul>
<li>Use coordinated checkpoints- Maintain global commit logs- Consensus-based protocols (Paxos Commit, Raft) can replace 2PC for high availability</li>
</ul>
</section>
<section id="example-timeline" class="level4">
<h4 class="anchored" data-anchor-id="example-timeline">7. Example Timeline</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Step</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T1 updates record A</td>
<td>WAL entry written</td>
</tr>
<tr class="even">
<td>T1 updates record B</td>
<td>WAL entry written</td>
</tr>
<tr class="odd">
<td>T1 commits</td>
<td>WAL flush, commit record</td>
</tr>
<tr class="even">
<td>Crash!</td>
<td>Disk may be inconsistent</td>
</tr>
<tr class="odd">
<td>Restart</td>
<td>Recovery scans log, redoes T1</td>
</tr>
</tbody>
</table>
</section>
<section id="pros-and-cons" class="level4">
<h4 class="anchored" data-anchor-id="pros-and-cons">8. Pros and Cons</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Approach</th>
<th>Strength</th>
<th>Weakness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>WAL</td>
<td>Simple, durable</td>
<td>Write overhead</td>
</tr>
<tr class="even">
<td>Checkpointing</td>
<td>Faster recovery</td>
<td>I/O spikes</td>
</tr>
<tr class="odd">
<td>2PC</td>
<td>Global atomicity</td>
<td>Blocking</td>
</tr>
<tr class="even">
<td>3PC / Consensus</td>
<td>Non-blocking</td>
<td>Complex, slower</td>
</tr>
</tbody>
</table>
</section>
<section id="real-systems" class="level4">
<h4 class="anchored" data-anchor-id="real-systems">9. Real Systems</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>System</th>
<th>Strategy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PostgreSQL</td>
<td>WAL + ARIES + Checkpoint</td>
</tr>
<tr class="even">
<td>MySQL (InnoDB)</td>
<td>WAL + Fuzzy checkpoint</td>
</tr>
<tr class="odd">
<td>Spanner</td>
<td>WAL + 2PC + TrueTime</td>
</tr>
<tr class="even">
<td>Kafka</td>
<td>WAL for durability</td>
</tr>
<tr class="odd">
<td>RocksDB</td>
<td>WAL + LSM checkpoints</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-81" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-81">10. Why It Matters</h4>
<p>Logging and commit protocols make data survive crashes and stay consistent across machines. Without them, every failure risks corruption.</p>
<blockquote class="blockquote">
<p>“Persistence is not about never failing, it’s about remembering how to stand back up.”</p>
</blockquote>
</section>
<section id="try-it-yourself-81" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-81">Try It Yourself</h4>
<ol type="1">
<li>Write a toy WAL system that logs before writes.</li>
<li>Simulate a crash mid-transaction and replay the log.</li>
<li>Implement a simple 2PC coordinator with two participants.</li>
<li>Compare recovery time with vs without checkpoints.</li>
</ol>
</section>
</section>
<section id="scheduling-round-robin-edf-rate-monotonic" class="level3">
<h3 class="anchored" data-anchor-id="scheduling-round-robin-edf-rate-monotonic">83. Scheduling (Round Robin, EDF, Rate-Monotonic)</h3>
<p>In operating systems and real-time systems, scheduling determines the order in which tasks or processes run. Since resources like CPU time are limited, a good scheduler aims to balance fairness, efficiency, and responsiveness.</p>
<section id="the-goal-of-scheduling" class="level4">
<h4 class="anchored" data-anchor-id="the-goal-of-scheduling">1. The Goal of Scheduling</h4>
<p>Every system has tasks competing for the CPU. Scheduling decides:</p>
<ul>
<li>Which task runs next- How long it runs- When it yields or preempts Different goals apply in different domains:</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Domain</th>
<th>Objective</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>General-purpose OS</td>
<td>Fairness, responsiveness</td>
</tr>
<tr class="even">
<td>Real-time systems</td>
<td>Meeting deadlines</td>
</tr>
<tr class="odd">
<td>Embedded systems</td>
<td>Predictability</td>
</tr>
<tr class="even">
<td>High-performance servers</td>
<td>Throughput, latency balance</td>
</tr>
</tbody>
</table>
<p>A scheduler’s policy can be preemptive (interrupts tasks) or non-preemptive (waits for voluntary yield).</p>
</section>
<section id="round-robin-scheduling" class="level4">
<h4 class="anchored" data-anchor-id="round-robin-scheduling">2. Round Robin Scheduling</h4>
<p>Round Robin (RR) is one of the simplest preemptive schedulers. Each process gets a fixed time slice (quantum) and runs in a circular queue.</p>
<p>If a process doesn’t finish, it’s put back at the end of the queue.</p>
</section>
<section id="tiny-code-round-robin-pseudocode" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-round-robin-pseudocode">Tiny Code: Round Robin (Pseudocode)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb398"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>queue processes<span class="op">;</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(!</span>empty<span class="op">(</span>processes<span class="op">))</span> <span class="op">{</span></span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>    process <span class="op">=</span> dequeue<span class="op">(</span>processes<span class="op">);</span></span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a>    run_for_quantum<span class="op">(</span>process<span class="op">);</span></span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>process<span class="op">.</span>finished<span class="op">)</span></span>
<span id="cb398-6"><a href="#cb398-6" aria-hidden="true" tabindex="-1"></a>        enqueue<span class="op">(</span>processes<span class="op">,</span> process<span class="op">);</span></span>
<span id="cb398-7"><a href="#cb398-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="characteristics" class="level4">
<h4 class="anchored" data-anchor-id="characteristics">Characteristics</h4>
<ul>
<li>Fair: Every process gets CPU time.- Responsive: Short tasks don’t starve.- Downside: Context switching overhead if quantum is too small. #### Example</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Process</th>
<th>Burst Time</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>P1</td>
<td>4</td>
<td></td>
</tr>
<tr class="even">
<td>P2</td>
<td>3</td>
<td></td>
</tr>
<tr class="odd">
<td>P3</td>
<td>2</td>
<td></td>
</tr>
</tbody>
</table>
<p>Quantum = 1 Order: P1, P2, P3, P1, P2, P3, P1, P2 → all finish fairly.</p>
</section>
<section id="priority-scheduling" class="level4">
<h4 class="anchored" data-anchor-id="priority-scheduling">3. Priority Scheduling</h4>
<p>Each task has a priority. The scheduler always picks the highest-priority ready task.</p>
<ul>
<li><p>Preemptive: A higher-priority task can interrupt a lower one.- Non-preemptive: The CPU is released voluntarily. #### Problems</p></li>
<li><p>Starvation: Low-priority tasks may never run.- Solution: Aging - gradually increase waiting task priority.</p></li>
</ul>
</section>
<section id="earliest-deadline-first-edf" class="level4">
<h4 class="anchored" data-anchor-id="earliest-deadline-first-edf">4. Earliest Deadline First (EDF)</h4>
<p>EDF is a dynamic priority scheduler for real-time systems. Each task has a deadline, and the task with the earliest deadline runs first.</p>
</section>
<section id="rule" class="level4">
<h4 class="anchored" data-anchor-id="rule">Rule</h4>
<p>At any time, run the ready task with the closest deadline.</p>
</section>
<section id="example-15" class="level4">
<h4 class="anchored" data-anchor-id="example-15">Example</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Task</th>
<th>Execution Time</th>
<th>Deadline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T1</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td>T2</td>
<td>2</td>
<td>5</td>
</tr>
<tr class="odd">
<td>T3</td>
<td>1</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Order: T3 → T1 → T2</p>
<p>EDF is optimal for preemptive scheduling of independent tasks on a single processor.</p>
</section>
<section id="rate-monotonic-scheduling-rms" class="level4">
<h4 class="anchored" data-anchor-id="rate-monotonic-scheduling-rms">5. Rate-Monotonic Scheduling (RMS)</h4>
<p>In periodic real-time systems, tasks repeat at fixed intervals. RMS assigns higher priority to tasks with shorter periods.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Task</th>
<th>Period</th>
<th>Priority</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T1</td>
<td>2 ms</td>
<td>High</td>
</tr>
<tr class="even">
<td>T2</td>
<td>5 ms</td>
<td>Medium</td>
</tr>
<tr class="odd">
<td>T3</td>
<td>10 ms</td>
<td>Low</td>
</tr>
</tbody>
</table>
<p>It’s static (priorities don’t change) and optimal among fixed-priority schedulers.</p>
</section>
<section id="utilization-bound" class="level4">
<h4 class="anchored" data-anchor-id="utilization-bound">Utilization Bound</h4>
<p>For n tasks, RMS is guaranteed schedulable if:</p>
<p><span class="math display">\[
U = \sum_{i=1}^{n} \frac{C_i}{T_i} \le n(2^{1/n} - 1)
\]</span></p>
<p>For example, for 3 tasks, <span class="math inline">\(U \le 0.78\)</span>.</p>
</section>
<section id="shortest-job-first-sjf" class="level4">
<h4 class="anchored" data-anchor-id="shortest-job-first-sjf">6. Shortest Job First (SJF)</h4>
<p>Run the task with the shortest burst time first.</p>
<ul>
<li>Non-preemptive SJF: Once started, runs to completion.- Preemptive SJF (Shortest Remaining Time First): Preempts if a shorter job arrives. Advantage: Minimizes average waiting time. Disadvantage: Needs knowledge of future job lengths.</li>
</ul>
</section>
<section id="multilevel-queue-scheduling" class="level4">
<h4 class="anchored" data-anchor-id="multilevel-queue-scheduling">7. Multilevel Queue Scheduling</h4>
<p>Divide processes into classes (interactive, batch, system). Each class has its own queue with own policy, e.g.:</p>
<ul>
<li>Queue 1: System → RR (quantum = 10ms)- Queue 2: Interactive → RR (quantum = 50ms)- Queue 3: Batch → FCFS (First-Come-First-Serve) CPU is assigned based on queue priority.</li>
</ul>
</section>
<section id="multilevel-feedback-queue-mlfq" class="level4">
<h4 class="anchored" data-anchor-id="multilevel-feedback-queue-mlfq">8. Multilevel Feedback Queue (MLFQ)</h4>
<p>Processes move between queues based on behavior.</p>
<ul>
<li>CPU-bound → move down (lower priority)- I/O-bound → move up (higher priority) Goal: Adaptive scheduling that rewards interactive tasks.</li>
</ul>
<p>Used in modern OS kernels (Linux, Windows).</p>
</section>
<section id="scheduling-metrics" class="level4">
<h4 class="anchored" data-anchor-id="scheduling-metrics">9. Scheduling Metrics</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Metric</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Turnaround Time</td>
<td>Completion − Arrival</td>
</tr>
<tr class="even">
<td>Waiting Time</td>
<td>Time spent in ready queue</td>
</tr>
<tr class="odd">
<td>Response Time</td>
<td>Time from arrival to first execution</td>
</tr>
<tr class="even">
<td>Throughput</td>
<td>Completed tasks per unit time</td>
</tr>
<tr class="odd">
<td>CPU Utilization</td>
<td>% of time CPU is busy</td>
</tr>
</tbody>
</table>
<p>Schedulers balance these based on design goals.</p>
</section>
<section id="why-it-matters-82" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-82">10. Why It Matters</h4>
<p>Schedulers shape how responsive, efficient, and fair a system feels. In operating systems, they govern multitasking. In real-time systems, they ensure deadlines are met. In servers, they keep latency low and throughput high.</p>
<blockquote class="blockquote">
<p>“Scheduling is not just about time. It’s about fairness, foresight, and flow.”</p>
</blockquote>
</section>
<section id="try-it-yourself-82" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-82">Try It Yourself</h4>
<ol type="1">
<li>Simulate Round Robin with quantum = 2, compare average waiting time.</li>
<li>Implement EDF for a set of periodic tasks with deadlines.</li>
<li>Check schedulability under RMS for 3 periodic tasks.</li>
<li>Explore Linux CFS (Completely Fair Scheduler) source code.</li>
<li>Compare SJF and RR for CPU-bound vs I/O-bound workloads.</li>
</ol>
</section>
</section>
<section id="caching-and-replacement-lru-lfu-clock" class="level3">
<h3 class="anchored" data-anchor-id="caching-and-replacement-lru-lfu-clock">84. Caching and Replacement (LRU, LFU, CLOCK)</h3>
<p>Caching is the art of remembering the past to speed up the future. In computing, caches store recently used or frequently accessed data to reduce latency and load on slower storage (like disks or networks). The challenge: caches have limited capacity, so when full, we must decide what to evict. That’s where replacement policies come in.</p>
<section id="the-need-for-caching" class="level4">
<h4 class="anchored" data-anchor-id="the-need-for-caching">1. The Need for Caching</h4>
<p>Caches appear everywhere:</p>
<ul>
<li><p>CPU: L1, L2, L3 caches speed up memory access- Databases: query results or index pages- Web browsers / CDNs: recently fetched pages- Operating systems: page cache for disk blocks The principle guiding all caches is locality:</p></li>
<li><p>Temporal locality: recently used items are likely used again soon- Spatial locality: nearby items are likely needed next</p></li>
</ul>
</section>
<section id="cache-replacement-problem" class="level4">
<h4 class="anchored" data-anchor-id="cache-replacement-problem">2. Cache Replacement Problem</h4>
<p>When the cache is full, which item should we remove?</p>
<p>We want to minimize cache misses (requests not found in cache).</p>
<p>Formally:</p>
<blockquote class="blockquote">
<p>Given a sequence of accesses, find a replacement policy that minimizes misses.</p>
</blockquote>
<p>Theoretical optimal policy (OPT): always evict the item used farthest in the future. But OPT requires future knowledge, so we rely on heuristics like LRU, LFU, CLOCK.</p>
</section>
<section id="least-recently-used-lru" class="level4">
<h4 class="anchored" data-anchor-id="least-recently-used-lru">3. Least Recently Used (LRU)</h4>
<p>LRU evicts the least recently accessed item. It assumes recently used = likely to be used again.</p>
</section>
<section id="implementation-approaches" class="level4">
<h4 class="anchored" data-anchor-id="implementation-approaches">Implementation Approaches</h4>
<ul>
<li>Stack (list): move item to top on access- Hash map + doubly linked list: <code>O(1)</code> insert, delete, lookup #### Tiny Code: LRU (Simplified)</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb399"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="kw">struct</span> Node <span class="op">{</span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span></span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Node <span class="op">*</span>prev<span class="op">,</span> <span class="op">*</span>next<span class="op">;</span></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> Node<span class="op">;</span></span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a>HashMap cache<span class="op">;</span></span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a>List lru_list<span class="op">;</span></span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> access<span class="op">(</span><span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>in_cache<span class="op">(</span>key<span class="op">))</span> move_to_front<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb399-11"><a href="#cb399-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb399-12"><a href="#cb399-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>cache_full<span class="op">())</span> remove_lru<span class="op">();</span></span>
<span id="cb399-13"><a href="#cb399-13" aria-hidden="true" tabindex="-1"></a>        insert_front<span class="op">(</span>key<span class="op">);</span></span>
<span id="cb399-14"><a href="#cb399-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb399-15"><a href="#cb399-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pros" class="level4">
<h4 class="anchored" data-anchor-id="pros">Pros</h4>
<ul>
<li><p>Good for workloads with strong temporal locality #### Cons</p></li>
<li><p>Costly in hardware or massive caches (metadata overhead)</p></li>
</ul>
</section>
<section id="least-frequently-used-lfu" class="level4">
<h4 class="anchored" data-anchor-id="least-frequently-used-lfu">4. Least Frequently Used (LFU)</h4>
<p>LFU evicts the least frequently accessed item.</p>
<p>Tracks usage count for each item:</p>
<ul>
<li>Increment on each access- Evict lowest-count item #### Example</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Item</th>
<th>Accesses</th>
<th>Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="even">
<td>B</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>C</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Evict B.</p>
</section>
<section id="variants-5" class="level4">
<h4 class="anchored" data-anchor-id="variants-5">Variants</h4>
<ul>
<li><p>LFU with aging: gradually reduce counts to adapt to new trends- Approximate LFU: counters in ranges (for memory efficiency) #### Pros</p></li>
<li><p>Great for stable, repetitive workloads #### Cons</p></li>
<li><p>Poor for workloads with shifting popularity (slow adaptation)</p></li>
</ul>
</section>
<section id="fifo-first-in-first-out" class="level4">
<h4 class="anchored" data-anchor-id="fifo-first-in-first-out">5. FIFO (First In First Out)</h4>
<p>Simple but naive:</p>
<ul>
<li>Evict the oldest item, ignoring usage Used in simple hardware caches. Good when access pattern is cyclic, bad otherwise.</li>
</ul>
</section>
<section id="random-replacement-rr" class="level4">
<h4 class="anchored" data-anchor-id="random-replacement-rr">6. Random Replacement (RR)</h4>
<p>Evict a random entry.</p>
<p>Surprisingly competitive in some high-concurrency systems, and trivial to implement. Used in memcached (as an option).</p>
</section>
<section id="clock-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="clock-algorithm">7. CLOCK Algorithm</h4>
<p>A practical approximation of LRU, widely used in OS page replacement.</p>
<p>Each page has a reference bit (R). Pages form a circular list.</p>
<p>Algorithm:</p>
<ol type="1">
<li>Clock hand sweeps over pages.</li>
<li>If <code>R = 0</code>, evict page.</li>
<li>If <code>R = 1</code>, set <code>R = 0</code> and skip.</li>
</ol>
<p>This mimics LRU with O(1) cost and low overhead.</p>
</section>
<section id="second-chance-and-enhanced-clock" class="level4">
<h4 class="anchored" data-anchor-id="second-chance-and-enhanced-clock">8. Second-Chance and Enhanced CLOCK</h4>
<p>Second-Chance: give recently used pages a “second chance” before eviction. Enhanced CLOCK: also uses modify bit (M) to prefer clean pages.</p>
<p>Used in Linux’s page replacement (with Active/Inactive lists).</p>
</section>
<section id="adaptive-algorithms" class="level4">
<h4 class="anchored" data-anchor-id="adaptive-algorithms">9. Adaptive Algorithms</h4>
<p>Modern systems use hybrid or adaptive policies:</p>
<ul>
<li>ARC (Adaptive Replacement Cache) - balances recency and frequency- CAR (Clock with Adaptive Replacement) - CLOCK-style adaptation- TinyLFU - frequency sketch + admission policy- Hyperbolic caching - popularity decay for large-scale systems These adapt dynamically to changing workloads.</li>
</ul>
</section>
<section id="why-it-matters-83" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-83">10. Why It Matters</h4>
<p>Caching is the backbone of system speed:</p>
<ul>
<li>OS uses it for paging- Databases for buffer pools- CPUs for memory hierarchies- CDNs for global acceleration Choosing the right eviction policy can mean orders of magnitude improvement in latency and throughput.</li>
</ul>
<blockquote class="blockquote">
<p>“A good cache remembers what matters, and forgets what no longer does.”</p>
</blockquote>
</section>
<section id="try-it-yourself-83" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-83">Try It Yourself</h4>
<ol type="1">
<li>Simulate a cache of size 3 with sequence: A B C A B D A B C D Compare LRU, LFU, and FIFO miss counts.</li>
<li>Implement LRU with a doubly-linked list and hash map in C.</li>
<li>Try CLOCK with reference bits, simulate a sweep.</li>
<li>Experiment with ARC and TinyLFU for dynamic workloads.</li>
<li>Measure hit ratios for different access patterns (sequential, random, looping).</li>
</ol>
</section>
</section>
<section id="networking-routing-congestion-control" class="level3">
<h3 class="anchored" data-anchor-id="networking-routing-congestion-control">85. Networking (Routing, Congestion Control)</h3>
<p>Networking algorithms make sure data finds its way through vast, connected systems, efficiently, reliably, and fairly. Two core pillars of network algorithms are routing (deciding <em>where</em> packets go) and congestion control (deciding <em>how fast</em> to send them).</p>
<p>Together, they ensure the internet functions under heavy load, dynamic topology, and unpredictable demand.</p>
<section id="the-goals-of-networking-algorithms" class="level4">
<h4 class="anchored" data-anchor-id="the-goals-of-networking-algorithms">1. The Goals of Networking Algorithms</h4>
<ul>
<li>Correctness: all destinations are reachable if paths exist- Efficiency: use minimal resources (bandwidth, latency, hops)- Scalability: support large, dynamic networks- Robustness: recover from failures- Fairness: avoid starving flows</li>
</ul>
</section>
<section id="types-of-routing" class="level4">
<h4 class="anchored" data-anchor-id="types-of-routing">2. Types of Routing</h4>
<p>Routing decides paths packets should follow through a graph-like network.</p>
</section>
<section id="static-vs-dynamic-routing" class="level4">
<h4 class="anchored" data-anchor-id="static-vs-dynamic-routing">Static vs Dynamic Routing</h4>
<ul>
<li><p>Static: fixed routes, manual configuration (good for small networks)- Dynamic: routes adjust automatically as topology changes (internet-scale) #### Unicast, Multicast, Broadcast</p></li>
<li><p>Unicast: one-to-one (most traffic)- Multicast: one-to-many (video streaming, gaming)- Broadcast: one-to-all (local networks)</p></li>
</ul>
</section>
<section id="shortest-path-routing" class="level4">
<h4 class="anchored" data-anchor-id="shortest-path-routing">3. Shortest Path Routing</h4>
<p>Most routing relies on shortest path algorithms:</p>
</section>
<section id="dijkstras-algorithm-1" class="level4">
<h4 class="anchored" data-anchor-id="dijkstras-algorithm-1">Dijkstra’s Algorithm</h4>
<ul>
<li><p>Builds shortest paths from one source- Complexity: <code>O(E log V)</code> with priority queue Used in:</p></li>
<li><p>OSPF (Open Shortest Path First)- IS-IS (Intermediate System to Intermediate System) #### Bellman-Ford Algorithm</p></li>
<li><p>Handles negative edges- Basis for Distance-Vector routing (RIP) #### Tiny Code: Dijkstra for Routing</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb400"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define INF </span><span class="fl">1e9</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dist<span class="op">[</span>MAX<span class="op">],</span> visited<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;</span> adj<span class="op">[</span>MAX<span class="op">];</span></span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dijkstra<span class="op">(</span><span class="dt">int</span> s<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> dist<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true" tabindex="-1"></a>    dist<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb400-8"><a href="#cb400-8" aria-hidden="true" tabindex="-1"></a>    priority_queue<span class="op">&lt;</span>pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span><span class="dt">int</span><span class="op">&gt;&gt;</span> pq<span class="op">;</span></span>
<span id="cb400-9"><a href="#cb400-9" aria-hidden="true" tabindex="-1"></a>    pq<span class="op">.</span>push<span class="op">({</span><span class="dv">0</span><span class="op">,</span> s<span class="op">});</span></span>
<span id="cb400-10"><a href="#cb400-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>pq<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb400-11"><a href="#cb400-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> u <span class="op">=</span> pq<span class="op">.</span>top<span class="op">().</span>second<span class="op">;</span> pq<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb400-12"><a href="#cb400-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>visited<span class="op">[</span>u<span class="op">])</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb400-13"><a href="#cb400-13" aria-hidden="true" tabindex="-1"></a>        visited<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb400-14"><a href="#cb400-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w<span class="op">]:</span> adj<span class="op">[</span>u<span class="op">])</span> <span class="op">{</span></span>
<span id="cb400-15"><a href="#cb400-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>dist<span class="op">[</span>v<span class="op">]</span> <span class="op">&gt;</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">)</span> <span class="op">{</span></span>
<span id="cb400-16"><a href="#cb400-16" aria-hidden="true" tabindex="-1"></a>                dist<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> dist<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> w<span class="op">;</span></span>
<span id="cb400-17"><a href="#cb400-17" aria-hidden="true" tabindex="-1"></a>                pq<span class="op">.</span>push<span class="op">({-</span>dist<span class="op">[</span>v<span class="op">],</span> v<span class="op">});</span></span>
<span id="cb400-18"><a href="#cb400-18" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb400-19"><a href="#cb400-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb400-20"><a href="#cb400-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb400-21"><a href="#cb400-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="distance-vector-vs-link-state" class="level4">
<h4 class="anchored" data-anchor-id="distance-vector-vs-link-state">4. Distance-Vector vs Link-State</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>Distance-Vector (RIP)</th>
<th>Link-State (OSPF)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Info Shared</td>
<td>Distance to neighbors</td>
<td>Full topology map</td>
</tr>
<tr class="even">
<td>Convergence</td>
<td>Slower (loops possible)</td>
<td>Fast (SPF computation)</td>
</tr>
<tr class="odd">
<td>Complexity</td>
<td>Lower</td>
<td>Higher</td>
</tr>
<tr class="even">
<td>Examples</td>
<td>RIP, BGP (conceptually)</td>
<td>OSPF, IS-IS</td>
</tr>
</tbody>
</table>
<p>RIP uses Bellman-Ford. OSPF floods link-state updates, runs Dijkstra at each node.</p>
</section>
<section id="hierarchical-routing" class="level4">
<h4 class="anchored" data-anchor-id="hierarchical-routing">5. Hierarchical Routing</h4>
<p>Large-scale networks (like the Internet) use hierarchical routing:</p>
<ul>
<li>Routers grouped into Autonomous Systems (AS)- Intra-AS routing: OSPF, IS-IS- Inter-AS routing: BGP (Border Gateway Protocol) BGP exchanges reachability info, not shortest paths, and prefers policy-based routing (e.g., cost, contracts, peering).</li>
</ul>
</section>
<section id="congestion-control" class="level4">
<h4 class="anchored" data-anchor-id="congestion-control">6. Congestion Control</h4>
<p>Even with good routes, we can’t flood links. Congestion control ensures fair and efficient use of bandwidth.</p>
<p>Implemented primarily at the transport layer (TCP).</p>
</section>
<section id="tcp-congestion-control" class="level4">
<h4 class="anchored" data-anchor-id="tcp-congestion-control">TCP Congestion Control</h4>
<p>Key components:</p>
<ul>
<li><p>Additive Increase, Multiplicative Decrease (AIMD)- Slow Start: probe capacity- Congestion Avoidance: grow cautiously- Fast Retransmit / Recovery Modern variants:</p></li>
<li><p>TCP Reno: classic AIMD- TCP Cubic: non-linear growth for high-speed networks- BBR (Bottleneck Bandwidth + RTT): model-based control #### Algorithm Sketch (AIMD)</p></li>
</ul>
<pre class="text"><code>On ACK: cwnd += 1/cwnd  // increase slowly
On loss: cwnd /= 2      // halve window</code></pre>
</section>
<section id="queue-management" class="level4">
<h4 class="anchored" data-anchor-id="queue-management">7. Queue Management</h4>
<p>Routers maintain queues. Too full? =&gt; Packet loss, latency spikes, tail drop.</p>
<p>Solutions:</p>
<ul>
<li>RED (Random Early Detection) - drop packets early- CoDel (Controlled Delay) - monitor queue delay, drop adaptively These prevent bufferbloat, improving latency for real-time traffic.</li>
</ul>
</section>
<section id="flow-control-vs-congestion-control" class="level4">
<h4 class="anchored" data-anchor-id="flow-control-vs-congestion-control">8. Flow Control vs Congestion Control</h4>
<ul>
<li>Flow Control: prevent sender from overwhelming receiver- Congestion Control: prevent sender from overwhelming network TCP uses both: receive window (rwnd) and congestion window (cwnd). Actual sending rate = <code>min(rwnd, cwnd)</code>.</li>
</ul>
</section>
<section id="data-plane-vs-control-plane" class="level4">
<h4 class="anchored" data-anchor-id="data-plane-vs-control-plane">9. Data Plane vs Control Plane</h4>
<ul>
<li><p>Control Plane: decides routes (OSPF, BGP)- Data Plane: forwards packets (fast path) Modern networking (e.g.&nbsp;SDN, Software Defined Networking) separates these:</p></li>
<li><p>Controller computes routes- Switches act on flow rules</p></li>
</ul>
</section>
<section id="why-it-matters-84" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-84">10. Why It Matters</h4>
<p>Routing and congestion control shape the performance of:</p>
<ul>
<li>The Internet backbone- Data center networks (with load balancing)- Cloud services and microservice meshes- Content delivery networks (CDNs) Every packet’s journey, from your laptop to a global data center, relies on these ideas.</li>
</ul>
<blockquote class="blockquote">
<p>“Networking is not magic. It’s algorithms moving data through time and space.”</p>
</blockquote>
</section>
<section id="try-it-yourself-84" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-84">Try It Yourself</h4>
<ol type="1">
<li>Implement Dijkstra’s algorithm for a small network graph.</li>
<li>Simulate RIP (Distance Vector): each node updates from neighbors.</li>
<li>Model TCP AIMD window growth; visualize with Python.</li>
<li>Try RED: drop packets when queue length &gt; threshold.</li>
<li>Compare TCP Reno, Cubic, BBR throughput in simulation.</li>
</ol>
</section>
</section>
<section id="distributed-consensus-paxos-raft-pbft" class="level3">
<h3 class="anchored" data-anchor-id="distributed-consensus-paxos-raft-pbft">86. Distributed Consensus (Paxos, Raft, PBFT)</h3>
<p>In a distributed system, multiple nodes must agree on a single value, for example, the state of a log, a database entry, or a blockchain block. This agreement process is called consensus.</p>
<p>Consensus algorithms let distributed systems act as one reliable system, even when some nodes fail, crash, or lie (Byzantine faults).</p>
<section id="why-consensus" class="level4">
<h4 class="anchored" data-anchor-id="why-consensus">1. Why Consensus?</h4>
<p>Imagine a cluster managing a shared log (like in databases or Raft). Each node might:</p>
<ul>
<li>See different requests,- Fail and recover,- Communicate over unreliable links. We need all non-faulty nodes to agree on the same order of operations.</li>
</ul>
<p>A valid consensus algorithm must satisfy:</p>
<ul>
<li>Agreement: all correct nodes choose the same value- Validity: the chosen value was proposed by a node- Termination: every correct node eventually decides- Fault Tolerance: works despite failures</li>
</ul>
</section>
<section id="the-flp-impossibility" class="level4">
<h4 class="anchored" data-anchor-id="the-flp-impossibility">2. The FLP Impossibility</h4>
<p>The FLP theorem (Fischer, Lynch, Paterson, 1985) says:</p>
<blockquote class="blockquote">
<p>In an asynchronous system with even one faulty process, no deterministic algorithm can guarantee consensus.</p>
</blockquote>
<p>So practical algorithms use:</p>
<ul>
<li>Randomization, or- Partial synchrony (timeouts, retries)</li>
</ul>
</section>
<section id="paxos-the-classical-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="paxos-the-classical-algorithm">3. Paxos: The Classical Algorithm</h4>
<p>Paxos, by Leslie Lamport, is the theoretical foundation for distributed consensus.</p>
<p>It revolves around three roles:</p>
<ul>
<li>Proposers: suggest values- Acceptors: vote on proposals- Learners: learn the final decision Consensus proceeds in two phases.</li>
</ul>
</section>
<section id="phase-1-prepare" class="level4">
<h4 class="anchored" data-anchor-id="phase-1-prepare">Phase 1 (Prepare)</h4>
<ol type="1">
<li>Proposer picks a proposal number <code>n</code> and sends <code>(Prepare, n)</code> to acceptors.</li>
<li>Acceptors respond with their highest accepted proposal (if any).</li>
</ol>
</section>
<section id="phase-2-accept" class="level4">
<h4 class="anchored" data-anchor-id="phase-2-accept">Phase 2 (Accept)</h4>
<ol type="1">
<li>If proposer receives a majority of responses, it sends <code>(Accept, n, v)</code> with value <code>v</code> (highest seen or new).</li>
<li>Acceptors accept if they haven’t promised higher <code>n</code>.</li>
</ol>
<p>When a majority accept, value <code>v</code> is chosen.</p>
</section>
<section id="guarantees" class="level4">
<h4 class="anchored" data-anchor-id="guarantees">Guarantees</h4>
<ul>
<li><p>Safety: no two different values chosen- Liveness: possible under stable leadership #### Drawbacks</p></li>
<li><p>Complex to implement correctly- High messaging overhead &gt; “Paxos is for theorists; Raft is for engineers.”</p></li>
</ul>
</section>
<section id="raft-understandable-consensus" class="level4">
<h4 class="anchored" data-anchor-id="raft-understandable-consensus">4. Raft: Understandable Consensus</h4>
<p>Raft was designed to be simpler and more practical than Paxos, focusing on replicated logs.</p>
</section>
<section id="roles" class="level4">
<h4 class="anchored" data-anchor-id="roles">Roles</h4>
<ul>
<li>Leader: coordinates all changes- Followers: replicate leader’s log- Candidates: during elections #### Workflow</li>
</ul>
<ol type="1">
<li><p>Leader Election</p>
<ul>
<li><p>Timeout triggers candidate election. - Each follower votes; majority wins.2. Log Replication</p></li>
<li><p>Leader appends entries, sends <code>AppendEntries</code> RPCs. - Followers acknowledge; leader commits when majority ack.3. Safety</p></li>
<li><p>Logs are consistent across majority. - Followers accept only valid prefixes. Raft ensures:</p></li>
</ul></li>
</ol>
<ul>
<li>At most one leader per term- Committed entries never lost- Logs stay consistent #### Pseudocode Sketch</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb402"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>on timeout <span class="op">-&gt;</span> become_candidate<span class="op">()</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>send RequestVote<span class="op">(</span>term<span class="op">,</span> id<span class="op">)</span></span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> majority_votes <span class="op">-&gt;</span> become_leader<span class="op">()</span></span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>on AppendEntries<span class="op">(</span>term<span class="op">,</span> entries<span class="op">):</span></span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term <span class="op">&gt;=</span> current_term<span class="op">:</span></span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true" tabindex="-1"></a>        append<span class="op">(</span>entries<span class="op">)</span></span>
<span id="cb402-8"><a href="#cb402-8" aria-hidden="true" tabindex="-1"></a>        reply success</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pbft-byzantine-fault-tolerance" class="level4">
<h4 class="anchored" data-anchor-id="pbft-byzantine-fault-tolerance">5. PBFT: Byzantine Fault Tolerance</h4>
<p>Paxos and Raft assume crash faults (nodes stop, not lie). For Byzantine faults (arbitrary behavior), we use PBFT (Practical Byzantine Fault Tolerance).</p>
<p>Tolerates up to <code>f</code> faulty nodes out of <code>3f + 1</code> total.</p>
</section>
<section id="phases-1" class="level4">
<h4 class="anchored" data-anchor-id="phases-1">Phases</h4>
<ol type="1">
<li>Pre-Prepare: Leader proposes value</li>
<li>Prepare: Nodes broadcast proposal hashes</li>
<li>Commit: Nodes confirm receipt by 2f+1 votes</li>
</ol>
<p>Used in blockchains and critical systems (space, finance).</p>
</section>
<section id="quorum-concept" class="level4">
<h4 class="anchored" data-anchor-id="quorum-concept">6. Quorum Concept</h4>
<p>Consensus often relies on quorums (majorities):</p>
<ul>
<li><p>Two quorums always intersect, ensuring consistency.- Write quorum + read quorum ≥ total nodes. In Raft/Paxos:</p></li>
<li><p>Majority = <code>N/2 + 1</code>- Guarantees overlap even if some nodes fail.</p></li>
</ul>
</section>
<section id="log-replication-and-state-machines" class="level4">
<h4 class="anchored" data-anchor-id="log-replication-and-state-machines">7. Log Replication and State Machines</h4>
<p>Consensus underlies Replicated State Machines (RSM):</p>
<ul>
<li><p>Every node applies the same commands in the same order.- Guarantees deterministic, identical states. This model powers:</p></li>
<li><p>Databases (etcd, Spanner, TiKV)- Coordination systems (ZooKeeper, Consul)- Kubernetes control planes</p></li>
</ul>
</section>
<section id="leader-election" class="level4">
<h4 class="anchored" data-anchor-id="leader-election">8. Leader Election</h4>
<p>All practical consensus systems need leaders:</p>
<ul>
<li><p>Simplifies coordination- Reduces conflicts- Heartbeats detect failures- New elections restore progress Algorithms:</p></li>
<li><p>Raft Election (random timeouts)- Bully Algorithm- Chang-Roberts Ring Election</p></li>
</ul>
</section>
<section id="performance-and-optimization" class="level4">
<h4 class="anchored" data-anchor-id="performance-and-optimization">9. Performance and Optimization</h4>
<ul>
<li><p>Batching: amortize RPC overhead- Pipeline: parallelize appends- Read-only optimizations: serve from followers (stale reads)- Witness nodes: participate in quorum without full data Advanced:</p></li>
<li><p>Multi-Paxos: reuse leader, fewer rounds- Fast Paxos: shortcut some phases- Viewstamped Replication: Paxos-like log replication</p></li>
</ul>
</section>
<section id="why-it-matters-85" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-85">10. Why It Matters</h4>
<p>Consensus is the backbone of reliability in modern distributed systems. Every consistent database, service registry, or blockchain depends on it.</p>
<p>Systems using consensus:</p>
<ul>
<li>etcd, Consul, ZooKeeper - cluster coordination- Raft in Kubernetes - leader election- PBFT in blockchains - fault-tolerant ledgers- Spanner, TiDB - consistent databases &gt; “Consensus is how machines learn to agree, and trust.”</li>
</ul>
</section>
<section id="try-it-yourself-85" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-85">Try It Yourself</h4>
<ol type="1">
<li>Implement Raft leader election in C or Python.</li>
<li>Simulate Paxos on 5 nodes with message drops.</li>
<li>Explore PBFT: try failing nodes and Byzantine behavior.</li>
<li>Compare performance of Raft vs Paxos under load.</li>
<li>Build a replicated key-value store with Raft.</li>
</ol>
</section>
</section>
<section id="load-balancing-and-rate-limiting" class="level3">
<h3 class="anchored" data-anchor-id="load-balancing-and-rate-limiting">87. Load Balancing and Rate Limiting</h3>
<p>When systems scale, no single server can handle all requests alone. Load balancing distributes incoming traffic across multiple servers to improve throughput, reduce latency, and prevent overload. Meanwhile, rate limiting protects systems by controlling how often requests are allowed, ensuring fairness, stability, and security.</p>
<p>These two ideas, spreading the load and controlling the flow, are cornerstones of modern distributed systems and APIs.</p>
<section id="why-load-balancing-matters" class="level4">
<h4 class="anchored" data-anchor-id="why-load-balancing-matters">1. Why Load Balancing Matters</h4>
<p>Imagine a web service receiving thousands of requests per second. If every request went to one machine, it would crash. A load balancer (LB) acts as a traffic director, spreading requests across many backends.</p>
<p>Goals:</p>
<ul>
<li>Efficiency - fully utilize servers- Reliability - no single point of failure- Scalability - handle growing workloads- Flexibility - add/remove servers dynamically</li>
</ul>
</section>
<section id="types-of-load-balancers" class="level4">
<h4 class="anchored" data-anchor-id="types-of-load-balancers">2. Types of Load Balancers</h4>
</section>
<section id="layer-4-transport-layer" class="level4">
<h4 class="anchored" data-anchor-id="layer-4-transport-layer">1. Layer 4 (Transport Layer)</h4>
<p>Balances based on IP and port. Fast and protocol-agnostic (works for TCP/UDP).</p>
<p>Example: Linux IPVS, Envoy, HAProxy</p>
</section>
<section id="layer-7-application-layer" class="level4">
<h4 class="anchored" data-anchor-id="layer-7-application-layer">2. Layer 7 (Application Layer)</h4>
<p>Understands protocols like HTTP. Can route by URL path, headers, cookies.</p>
<p>Example: Nginx, Envoy, AWS ALB</p>
</section>
<section id="load-balancing-algorithms" class="level4">
<h4 class="anchored" data-anchor-id="load-balancing-algorithms">3. Load Balancing Algorithms</h4>
</section>
<section id="round-robin" class="level4">
<h4 class="anchored" data-anchor-id="round-robin">Round Robin</h4>
<p>Cycles through backends in order.</p>
<pre class="text"><code>Req1 → ServerA  
Req2 → ServerB  
Req3 → ServerC</code></pre>
<p>Simple, fair (if all nodes equal).</p>
</section>
<section id="weighted-round-robin" class="level4">
<h4 class="anchored" data-anchor-id="weighted-round-robin">Weighted Round Robin</h4>
<p>Assigns weights to reflect capacity. Example: ServerA(2x), ServerB(1x)</p>
</section>
<section id="least-connections" class="level4">
<h4 class="anchored" data-anchor-id="least-connections">Least Connections</h4>
<p>Send request to server with fewest active connections.</p>
</section>
<section id="least-response-time" class="level4">
<h4 class="anchored" data-anchor-id="least-response-time">Least Response Time</h4>
<p>Select backend with lowest latency (monitored dynamically).</p>
</section>
<section id="hash-based-consistent-hashing" class="level4">
<h4 class="anchored" data-anchor-id="hash-based-consistent-hashing">Hash-Based (Consistent Hashing)</h4>
<p>Deterministically route based on request key (like user ID).</p>
<ul>
<li>Keeps cache locality- Used in CDNs, distributed caches (e.g.&nbsp;memcached) #### Random</li>
</ul>
<p>Pick a random backend, surprisingly effective under uniform load.</p>
</section>
<section id="consistent-hashing-in-depth" class="level4">
<h4 class="anchored" data-anchor-id="consistent-hashing-in-depth">4. Consistent Hashing (In Depth)</h4>
<p>Used for sharding and sticky sessions.</p>
<p>Key idea:</p>
<ul>
<li>Map servers to a hash ring- A request’s key is hashed onto the ring- Assigned to next clockwise server When servers join/leave, only small fraction of keys move.</li>
</ul>
<p>Used in:</p>
<ul>
<li>CDNs- Distributed caches (Redis Cluster, DynamoDB)- Load-aware systems</li>
</ul>
</section>
<section id="health-checks-and-failover" class="level4">
<h4 class="anchored" data-anchor-id="health-checks-and-failover">5. Health Checks and Failover</h4>
<p>A smart LB monitors health of each server:</p>
<ul>
<li>Heartbeat pings (HTTP/TCP)- Auto-remove unhealthy servers- Rebalance traffic instantly Example: If ServerB fails, remove from rotation:</li>
</ul>
<pre><code>Healthy: [ServerA, ServerC]</code></pre>
<p>Also supports active-passive failover: hot standby servers take over when active fails.</p>
</section>
<section id="global-load-balancing" class="level4">
<h4 class="anchored" data-anchor-id="global-load-balancing">6. Global Load Balancing</h4>
<p>Across regions or data centers:</p>
<ul>
<li>GeoDNS: route to nearest region- Anycast: advertise same IP globally; routing picks nearest- Latency-based routing: measure and pick lowest RTT Used by CDNs, cloud services, multi-region apps</li>
</ul>
</section>
<section id="rate-limiting-the-other-side" class="level4">
<h4 class="anchored" data-anchor-id="rate-limiting-the-other-side">7. Rate Limiting: The Other Side</h4>
<p>If load balancing spreads the work, rate limiting keeps total work reasonable.</p>
<p>It prevents:</p>
<ul>
<li><p>Abuse (bots, DDoS)- Overload (too many requests)- Fairness issues (no user dominates resources) Policies:</p></li>
<li><p>Per-user, per-IP, per-API-key- Global or per-endpoint</p></li>
</ul>
</section>
<section id="rate-limiting-algorithms" class="level4">
<h4 class="anchored" data-anchor-id="rate-limiting-algorithms">8. Rate Limiting Algorithms</h4>
</section>
<section id="token-bucket" class="level4">
<h4 class="anchored" data-anchor-id="token-bucket">Token Bucket</h4>
<ul>
<li>Bucket holds tokens (capacity = burst limit)- Each request consumes 1 token- Tokens refill at constant rate (rate limit)- If empty → reject or delay Good for bursty traffic.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb405"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>tokens <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>    tokens<span class="op">--;</span></span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>    allow<span class="op">();</span></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> reject<span class="op">();</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="leaky-bucket" class="level4">
<h4 class="anchored" data-anchor-id="leaky-bucket">Leaky Bucket</h4>
<ul>
<li>Requests flow into a bucket, drain at fixed rate- Excess = overflow = dropped Smooths bursts; used for shaping.</li>
</ul>
</section>
<section id="fixed-window-counter" class="level4">
<h4 class="anchored" data-anchor-id="fixed-window-counter">Fixed Window Counter</h4>
<ul>
<li><p>Count requests in fixed interval (e.g.&nbsp;1s)- Reset every window- Simple but unfair around boundaries #### Sliding Window Log / Sliding Window Counter</p></li>
<li><p>Maintain timestamps of requests- Remove old ones beyond time window- More accurate and fair</p></li>
</ul>
</section>
<section id="combining-both" class="level4">
<h4 class="anchored" data-anchor-id="combining-both">9. Combining Both</h4>
<p>A full system might:</p>
<ul>
<li>Use rate limiting per user or service- Use load balancing across nodes- Apply circuit breakers when overload persists Together, they form resilient architectures that stay online even under spikes.</li>
</ul>
</section>
<section id="why-it-matters-86" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-86">10. Why It Matters</h4>
<p>These techniques make large-scale systems:</p>
<ul>
<li><p>Scalable - handle millions of users- Stable - prevent cascading failures- Fair - each client gets a fair share- Resilient - recover gracefully from spikes or node loss Used in:</p></li>
<li><p>API Gateways (Kong, Envoy, Nginx)- Cloud Load Balancers (AWS ALB, GCP LB)- Kubernetes Ingress and Service Meshes- Distributed Caches and Databases &gt; “Balance keeps systems alive. Limits keep them sane.”</p></li>
</ul>
</section>
<section id="try-it-yourself-86" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-86">Try It Yourself</h4>
<ol type="1">
<li>Simulate Round Robin and Least Connections balancing across 3 servers.</li>
<li>Implement a Token Bucket rate limiter in C or Python.</li>
<li>Test burst traffic, observe drops or delays.</li>
<li>Combine Consistent Hashing with Token Bucket for user-level control.</li>
<li>Visualize how load balancing + rate limiting keep system latency low.</li>
</ol>
</section>
</section>
<section id="search-and-indexing-inverted-bm25-wand" class="level3">
<h3 class="anchored" data-anchor-id="search-and-indexing-inverted-bm25-wand">88. Search and Indexing (Inverted, BM25, WAND)</h3>
<p>Search engines, whether web-scale like Google or local like SQLite’s FTS, rely on efficient indexing and ranking to answer queries fast. Instead of scanning all documents, they use indexes (structured lookup tables) to quickly find relevant matches.</p>
<p>This section explores inverted indexes, ranking algorithms (TF-IDF, BM25), and efficient retrieval techniques like WAND.</p>
<section id="the-search-problem" class="level4">
<h4 class="anchored" data-anchor-id="the-search-problem">1. The Search Problem</h4>
<p>Given:</p>
<ul>
<li><p>A corpus of documents- A query (e.g., “machine learning algorithms”) We want to return:</p></li>
<li><p>Relevant documents- Ranked by importance and similarity Naive search → O(N × M) comparisons Inverted indexes → O(K log N), where K = terms in query</p></li>
</ul>
</section>
<section id="inverted-index-the-heart-of-search" class="level4">
<h4 class="anchored" data-anchor-id="inverted-index-the-heart-of-search">2. Inverted Index: The Heart of Search</h4>
<p>An inverted index maps terms → documents containing them.</p>
</section>
<section id="example-16" class="level4">
<h4 class="anchored" data-anchor-id="example-16">Example</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Term</th>
<th>Postings List</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“data”</td>
<td>[1, 4, 5]</td>
</tr>
<tr class="even">
<td>“algorithm”</td>
<td>[2, 3, 5]</td>
</tr>
<tr class="odd">
<td>“machine”</td>
<td>[1, 2]</td>
</tr>
</tbody>
</table>
<p>Each posting may include:</p>
<ul>
<li>docID- term frequency (tf)- positions (for phrase search) #### Construction Steps</li>
</ul>
<ol type="1">
<li>Tokenize documents → words</li>
<li>Normalize (lowercase, stemming, stopword removal)</li>
<li>Build postings: term → [docIDs, tf, positions]</li>
<li>Sort &amp; compress for storage efficiency</li>
</ol>
<p>Used by:</p>
<ul>
<li>Elasticsearch, Lucene, Whoosh, Solr</li>
</ul>
</section>
<section id="boolean-retrieval" class="level4">
<h4 class="anchored" data-anchor-id="boolean-retrieval">3. Boolean Retrieval</h4>
<p>Simplest model:</p>
<ul>
<li>Query = Boolean expression e.g.&nbsp;<code>(machine AND learning) OR AI</code></li>
</ul>
<p>Use set operations on postings:</p>
<ul>
<li>AND → intersection- OR → union- NOT → difference Fast intersection uses merge algorithm on sorted lists.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb406"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> intersect<span class="op">(</span><span class="dt">int</span> A<span class="op">[],</span> <span class="dt">int</span> B<span class="op">[],</span> <span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>i <span class="op">&lt;</span> n <span class="op">&amp;&amp;</span> j <span class="op">&lt;</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> B<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> print<span class="op">(</span>A<span class="op">[</span>i<span class="op">]);</span> i<span class="op">++;</span> j<span class="op">++;</span> <span class="op">}</span></span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;</span> B<span class="op">[</span>j<span class="op">])</span> i<span class="op">++;</span></span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> j<span class="op">++;</span></span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>But Boolean search doesn’t rank results, so we need scoring models.</p>
</section>
<section id="vector-space-model" class="level4">
<h4 class="anchored" data-anchor-id="vector-space-model">4. Vector Space Model</h4>
<p>Represent documents and queries as term vectors. Each dimension = term weight (tf-idf).</p>
<ul>
<li>tf: term frequency in document- idf: inverse document frequency <span class="math inline">\(idf = \log\frac{N}{df_t}\)</span></li>
</ul>
<p>Cosine similarity measures relevance: <span class="math display">\[
\text{score}(q, d) = \frac{q \cdot d}{|q| |d|}
\]</span></p>
<p>Simple, interpretable, forms basis of BM25 and modern embeddings.</p>
</section>
<section id="bm25-the-classic-ranking-function" class="level4">
<h4 class="anchored" data-anchor-id="bm25-the-classic-ranking-function">5. BM25: The Classic Ranking Function</h4>
<p>BM25 (Best Match 25) is the de facto standard in information retrieval.</p>
<p><span class="math display">\[
\text{score}(q, d) = \sum_{t \in q} IDF(t) \cdot \frac{f(t, d) \cdot (k_1 + 1)}{f(t, d) + k_1 \cdot (1 - b + b \cdot \frac{|d|}{avgdl})}
\]</span></p>
<p>Where:</p>
<ul>
<li><p>( f(t, d) ): term frequency- ( |d| ): doc length- ( avgdl ): average doc length- <span class="math inline">\(k_1, b\)</span>: tunable params (typ. 1.2-2.0, 0.75) #### Advantages</p></li>
<li><p>Balances term frequency, document length, and rarity- Fast and effective baseline- Still used in Elasticsearch, Lucene, OpenSearch</p></li>
</ul>
</section>
<section id="efficiency-tricks-wand-block-max-wand" class="level4">
<h4 class="anchored" data-anchor-id="efficiency-tricks-wand-block-max-wand">6. Efficiency Tricks: WAND, Block-Max WAND</h4>
<p>Ranking involves merging multiple postings. We can skip irrelevant documents early with WAND (Weak AND).</p>
</section>
<section id="wand-principle" class="level4">
<h4 class="anchored" data-anchor-id="wand-principle">WAND Principle</h4>
<ul>
<li>Each term has upper-bound score- Maintain pointers in each posting- Compute potential max score- If max &lt; current threshold, skip doc Improves latency for top-k retrieval.</li>
</ul>
<p>Variants:</p>
<ul>
<li>BMW (Block-Max WAND) - uses block-level score bounds- MaxScore - simpler thresholding- Dynamic pruning - skip unpromising candidates</li>
</ul>
</section>
<section id="index-compression" class="level4">
<h4 class="anchored" data-anchor-id="index-compression">7. Index Compression</h4>
<p>Postings lists are long, compression is crucial.</p>
<p>Common schemes:</p>
<ul>
<li>Delta encoding: store gaps between docIDs- Variable-byte (VB) or Gamma coding- Frame of Reference (FOR) and SIMD-BP128 for vectorized decoding Goal: smaller storage + faster decompression</li>
</ul>
</section>
<section id="advanced-retrieval" class="level4">
<h4 class="anchored" data-anchor-id="advanced-retrieval">8. Advanced Retrieval</h4>
</section>
<section id="proximity-search" class="level4">
<h4 class="anchored" data-anchor-id="proximity-search">Proximity Search</h4>
<p>Require words appear near each other. Use positional indexes.</p>
</section>
<section id="phrase-search" class="level4">
<h4 class="anchored" data-anchor-id="phrase-search">Phrase Search</h4>
<p>Match exact sequences using positions: “machine learning” ≠ “learning machine”</p>
</section>
<section id="fuzzy-approximate-search" class="level4">
<h4 class="anchored" data-anchor-id="fuzzy-approximate-search">Fuzzy / Approximate Search</h4>
<p>Allow typos: Use Levenshtein automata, n-grams, or k-approximate matching</p>
</section>
<section id="fielded-search" class="level4">
<h4 class="anchored" data-anchor-id="fielded-search">Fielded Search</h4>
<p>Score per field (title, body, tags) Weighted combination</p>
</section>
<section id="learning-to-rank-and-semantic-search" class="level4">
<h4 class="anchored" data-anchor-id="learning-to-rank-and-semantic-search">9. Learning-to-Rank and Semantic Search</h4>
<p>Modern search adds ML-based re-ranking:</p>
<ul>
<li>Learning to Rank (LTR): use features (tf, idf, BM25, clicks)- Neural re-ranking: BERT-style embeddings for semantic similarity- Hybrid retrieval: combine BM25 + dense vectors (e.g.&nbsp;ColBERT, RRF) Also: ANN (Approximate Nearest Neighbor) for vector-based search.</li>
</ul>
</section>
<section id="why-it-matters-87" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-87">10. Why It Matters</h4>
<p>Efficient search powers:</p>
<ul>
<li>Web search engines- IDE symbol lookup- Log search, code search- Database full-text search- AI retrieval pipelines (RAG) It’s where algorithms meet language and scale.</li>
</ul>
<blockquote class="blockquote">
<p>“Search is how we connect meaning to memory.”</p>
</blockquote>
</section>
<section id="try-it-yourself-87" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-87">Try It Yourself</h4>
<ol type="1">
<li>Build a tiny inverted index in C or Python.</li>
<li>Implement Boolean AND and OR queries.</li>
<li>Compute TF-IDF and BM25 scores for a toy dataset.</li>
<li>Add WAND pruning for top-k retrieval.</li>
<li>Compare BM25 vs semantic embeddings for relevance.</li>
</ol>
</section>
</section>
<section id="compression-and-encoding-in-systems" class="level3">
<h3 class="anchored" data-anchor-id="compression-and-encoding-in-systems">89. Compression and Encoding in Systems</h3>
<p>Compression and encoding algorithms are the quiet workhorses of computing, shrinking data to save space, bandwidth, and time. They allow systems to store more, transmit faster, and process efficiently. From files and databases to networks and logs, compression shapes nearly every layer of system design.</p>
<section id="why-compression-matters" class="level4">
<h4 class="anchored" data-anchor-id="why-compression-matters">1. Why Compression Matters</h4>
<p>Compression is everywhere:</p>
<ul>
<li><p>Databases - column stores, indexes, logs- Networks - HTTP, TCP, QUIC payloads- File systems - ZFS, NTFS, btrfs compression- Streaming - video/audio codecs- Logs &amp; telemetry - reduce I/O and storage cost Benefits:</p></li>
<li><p>Smaller data = faster I/O- Less storage = lower cost- Less transfer = higher throughput Trade-offs:</p></li>
<li><p>CPU overhead (compression/decompression)- Latency (especially for small data)- Suitability (depends on entropy and structure)</p></li>
</ul>
</section>
<section id="key-concepts" class="level4">
<h4 class="anchored" data-anchor-id="key-concepts">2. Key Concepts</h4>
</section>
<section id="entropy" class="level4">
<h4 class="anchored" data-anchor-id="entropy">Entropy</h4>
<p>Minimum bits needed to represent data (Shannon). High entropy → less compressible.</p>
</section>
<section id="redundancy" class="level4">
<h4 class="anchored" data-anchor-id="redundancy">Redundancy</h4>
<p>Compression exploits repetition and patterns.</p>
</section>
<section id="lossless-vs-lossy" class="level4">
<h4 class="anchored" data-anchor-id="lossless-vs-lossy">Lossless vs Lossy</h4>
<ul>
<li>Lossless: reversible (ZIP, PNG, LZ4)- Lossy: approximate (JPEG, MP3, H.264) In system contexts, lossless dominates.</li>
</ul>
</section>
<section id="common-lossless-compression-families" class="level4">
<h4 class="anchored" data-anchor-id="common-lossless-compression-families">3. Common Lossless Compression Families</h4>
</section>
<section id="huffman-coding-1" class="level4">
<h4 class="anchored" data-anchor-id="huffman-coding-1">Huffman Coding</h4>
<ul>
<li>Prefix-free variable-length codes- Frequent symbols = short codes- Optimal under symbol-level model Used in: DEFLATE, JPEG, MP3</li>
</ul>
</section>
<section id="arithmetic-coding-1" class="level4">
<h4 class="anchored" data-anchor-id="arithmetic-coding-1">Arithmetic Coding</h4>
<ul>
<li><p>Encodes sequence as fractional interval- More efficient than Huffman for skewed distributions- Used in: H.264, bzip2, AV1 #### Dictionary-Based (LZ77, LZ78)</p></li>
<li><p>Replace repeated substrings with references- Core of ZIP, gzip, zlib, LZMA, Snappy #### LZ77 Sketch</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb407"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>not EOF<span class="op">)</span> <span class="op">{</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>    find longest match in sliding window<span class="op">;</span></span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>    output <span class="op">(</span>offset<span class="op">,</span> length<span class="op">,</span> next_char<span class="op">);</span></span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Variants:</p>
<ul>
<li><p>LZ4 - fast, lower ratio- Snappy - optimized for speed- Zstandard (Zstd) - tunable speed/ratio, dictionary support #### Burrows-Wheeler Transform (BWT)</p></li>
<li><p>Reorders data to group similar symbols- Followed by Move-To-Front + Huffman- Used in bzip2, BWT-based compressors #### Run-Length Encoding (RLE)</p></li>
<li><p>Replace consecutive repeats with (symbol, count)- Great for structured or sparse data Example: <code>AAAAABBBCC</code> → <code>(A,5)(B,3)(C,2)</code></p></li>
</ul>
</section>
<section id="specialized-compression-in-systems" class="level4">
<h4 class="anchored" data-anchor-id="specialized-compression-in-systems">4. Specialized Compression in Systems</h4>
</section>
<section id="columnar-databases" class="level4">
<h4 class="anchored" data-anchor-id="columnar-databases">Columnar Databases</h4>
<p>Compress per column:</p>
<ul>
<li>Dictionary encoding - map strings → ints- Run-length encoding - good for sorted columns- Delta encoding - store differences (time series)- Bit-packing - fixed-width integers in minimal bits Combine multiple for optimal ratio.</li>
</ul>
<p>Example (time deltas):</p>
<pre><code>[100, 102, 103, 107] → [100, +2, +1, +4]</code></pre>
</section>
<section id="log-and-telemetry-compression" class="level4">
<h4 class="anchored" data-anchor-id="log-and-telemetry-compression">Log and Telemetry Compression</h4>
<ul>
<li><p>Structured formats → fieldwise encoding- Often Snappy or LZ4 for fast decode- Aggregators (Fluentd, Loki, Kafka) rely heavily on them #### Data Lakes and Files</p></li>
<li><p>Parquet, ORC, Arrow → columnar + compressed- Choose codec per column: LZ4 for speed, Zstd for ratio</p></li>
</ul>
</section>
<section id="streaming-and-chunked-compression" class="level4">
<h4 class="anchored" data-anchor-id="streaming-and-chunked-compression">5. Streaming and Chunked Compression</h4>
<p>Large data often processed in chunks:</p>
<ul>
<li>Enables random access and parallelism- Needed for network streams, distributed files Example: <code>zlib</code> block, <code>Zstd</code> frame, <code>gzip</code> chunk</li>
</ul>
<p>Used in:</p>
<ul>
<li>HTTP chunked encoding- Kafka log segments- MapReduce shuffle</li>
</ul>
</section>
<section id="encoding-schemes" class="level4">
<h4 class="anchored" data-anchor-id="encoding-schemes">6. Encoding Schemes</h4>
<p>Compression ≠ encoding. Encoding ensures safe transport.</p>
</section>
<section id="base64" class="level4">
<h4 class="anchored" data-anchor-id="base64">Base64</h4>
<ul>
<li><p>Maps 3 bytes → 4 chars- 33% overhead- Used for binary → text (emails, JSON APIs) #### URL Encoding</p></li>
<li><p>Escape unsafe chars with <code>%xx</code> #### Delta Encoding</p></li>
<li><p>Store differences, not full values #### Varint / Zigzag Encoding</p></li>
<li><p>Compact integers (e.g.&nbsp;protobufs)- Smaller numbers → fewer bytes Example:</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb409"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>x <span class="op">&gt;=</span> <span class="bn">0x80</span><span class="op">)</span> <span class="op">{</span> emit<span class="op">((</span>x <span class="op">&amp;</span> <span class="bn">0x7F</span><span class="op">)</span> <span class="op">|</span> <span class="bn">0x80</span><span class="op">);</span> x <span class="op">&gt;&gt;=</span> <span class="dv">7</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>emit<span class="op">(</span>x<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="adaptive-and-context-models" class="level4">
<h4 class="anchored" data-anchor-id="adaptive-and-context-models">7. Adaptive and Context Models</h4>
<p>Modern compressors adapt to local patterns:</p>
<ul>
<li>PPM (Prediction by Partial Matching)- Context mixing (PAQ)- Zstd uses FSE (Finite State Entropy) coding Balance between speed, memory, and compression ratio.</li>
</ul>
</section>
<section id="hardware-acceleration" class="level4">
<h4 class="anchored" data-anchor-id="hardware-acceleration">8. Hardware Acceleration</h4>
<p>Compression can be offloaded to:</p>
<ul>
<li>CPUs with SIMD (AVX2, SSE4.2)- GPUs (parallel encode/decode)- NICs / SmartNICs- ASICs (e.g., Intel QAT) Critical for high-throughput databases, network appliances, storage systems.</li>
</ul>
</section>
<section id="design-trade-offs" class="level4">
<h4 class="anchored" data-anchor-id="design-trade-offs">9. Design Trade-offs</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Goal</th>
<th>Best Choice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Max speed</td>
<td>LZ4, Snappy</td>
</tr>
<tr class="even">
<td>Max ratio</td>
<td>Zstd, LZMA</td>
</tr>
<tr class="odd">
<td>Balance</td>
<td>Zstd (tunable)</td>
</tr>
<tr class="even">
<td>Column store</td>
<td>RLE, Delta, Dict</td>
</tr>
<tr class="odd">
<td>Logs / telemetry</td>
<td>Snappy, LZ4</td>
</tr>
<tr class="even">
<td>Archival</td>
<td>bzip2, xz</td>
</tr>
<tr class="odd">
<td>Real-time</td>
<td>LZ4, Brotli (fast mode)</td>
</tr>
</tbody>
</table>
<p>Choose based on CPU budget, I/O cost, latency tolerance.</p>
</section>
<section id="why-it-matters-88" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-88">10. Why It Matters</h4>
<p>Compression is a first-class optimization:</p>
<ul>
<li>Saves petabytes in data centers- Boosts throughput across networks- Powers cloud storage (S3, BigQuery, Snowflake)- Enables efficient analytics and ML pipelines &gt; “Every byte saved is time earned.”</li>
</ul>
</section>
<section id="try-it-yourself-88" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-88">Try It Yourself</h4>
<ol type="1">
<li>Compress text using Huffman coding (build frequency table).</li>
<li>Compare gzip, Snappy, and Zstd on a 1GB dataset.</li>
<li>Implement delta encoding and RLE for numeric data.</li>
<li>Try dictionary encoding on repetitive strings.</li>
<li>Measure compression ratio, speed, and CPU usage trade-offs.</li>
</ol>
</section>
</section>
<section id="fault-tolerance-and-replication" class="level3">
<h3 class="anchored" data-anchor-id="fault-tolerance-and-replication">90. Fault Tolerance and Replication</h3>
<p>Modern systems must survive hardware crashes, network partitions, or data loss without stopping. Fault tolerance ensures that a system continues to function, even when parts fail. Replication underpins this resilience, duplicating data or computation across multiple nodes for redundancy, performance, and consistency.</p>
<p>Together, they form the backbone of reliability in distributed systems.</p>
<section id="why-fault-tolerance" class="level4">
<h4 class="anchored" data-anchor-id="why-fault-tolerance">1. Why Fault Tolerance?</h4>
<p>No system is perfect:</p>
<ul>
<li>Servers crash- Disks fail- Networks partition- Power goes out The question isn’t <em>if</em> failure happens, but <em>when</em>. Fault-tolerant systems detect, contain, and recover from failure automatically.</li>
</ul>
<p>Goals:</p>
<ul>
<li>Availability - keep serving requests- Durability - never lose data- Consistency - stay correct across replicas</li>
</ul>
</section>
<section id="failure-models" class="level4">
<h4 class="anchored" data-anchor-id="failure-models">2. Failure Models</h4>
</section>
<section id="crash-faults" class="level4">
<h4 class="anchored" data-anchor-id="crash-faults">Crash Faults</h4>
<p>Node stops responding but doesn’t misbehave. Handled by restarts or replication (Raft, Paxos).</p>
</section>
<section id="omission-faults" class="level4">
<h4 class="anchored" data-anchor-id="omission-faults">Omission Faults</h4>
<p>Lost messages or dropped updates. Handled with retries and acknowledgments.</p>
</section>
<section id="byzantine-faults" class="level4">
<h4 class="anchored" data-anchor-id="byzantine-faults">Byzantine Faults</h4>
<p>Arbitrary/malicious behavior. Handled by Byzantine Fault Tolerance (PBFT), expensive but robust.</p>
</section>
<section id="redundancy-the-core-strategy" class="level4">
<h4 class="anchored" data-anchor-id="redundancy-the-core-strategy">3. Redundancy: The Core Strategy</h4>
<p>Fault tolerance = redundancy + detection + recovery</p>
<p>Redundancy types:</p>
<ul>
<li>Hardware: multiple power supplies, disks (RAID)- Software: replicated services, retries- Data: multiple copies, erasure codes- Temporal: retry or checkpoint and replay</li>
</ul>
</section>
<section id="replication-models" class="level4">
<h4 class="anchored" data-anchor-id="replication-models">4. Replication Models</h4>
</section>
<section id="active-replication" class="level4">
<h4 class="anchored" data-anchor-id="active-replication">1. Active Replication</h4>
<p>All replicas process requests in parallel (lockstep). Results must match. Used in real-time and Byzantine systems.</p>
</section>
<section id="passive-primary-backup" class="level4">
<h4 class="anchored" data-anchor-id="passive-primary-backup">2. Passive (Primary-Backup)</h4>
<p>One leader (primary) handles requests. Backups replicate log, take over on failure. Used in Raft, ZooKeeper, PostgreSQL streaming.</p>
</section>
<section id="quorum-replication" class="level4">
<h4 class="anchored" data-anchor-id="quorum-replication">3. Quorum Replication</h4>
<p>Writes and reads contact majority of replicas. Ensures overlap → consistency. Used in Cassandra, DynamoDB, Etcd.</p>
</section>
<section id="consistency-models" class="level4">
<h4 class="anchored" data-anchor-id="consistency-models">5. Consistency Models</h4>
<p>Replication introduces a trade-off between consistency and availability (CAP theorem).</p>
</section>
<section id="strong-consistency" class="level4">
<h4 class="anchored" data-anchor-id="strong-consistency">Strong Consistency</h4>
<p>All clients see the same value immediately. Example: Raft, Etcd, Spanner.</p>
</section>
<section id="eventual-consistency" class="level4">
<h4 class="anchored" data-anchor-id="eventual-consistency">Eventual Consistency</h4>
<p>Replicas converge over time. Example: DynamoDB, Cassandra.</p>
</section>
<section id="causal-consistency" class="level4">
<h4 class="anchored" data-anchor-id="causal-consistency">Causal Consistency</h4>
<p>Preserves causal order of events. Example: Vector clocks, CRDTs.</p>
<p>Choice depends on workload:</p>
<ul>
<li>Banking → strong- Social feeds → eventual- Collaborative editing → causal</li>
</ul>
</section>
<section id="checkpointing-and-recovery" class="level4">
<h4 class="anchored" data-anchor-id="checkpointing-and-recovery">6. Checkpointing and Recovery</h4>
<p>To recover after crash:</p>
<ul>
<li>Periodically checkpoint state- On restart, replay log of missed events Example: Databases → Write-Ahead Log (WAL) Stream systems → Kafka checkpoints</li>
</ul>
<pre class="text"><code>1. Save state to disk
2. Record latest log position
3. On restart → reload + replay</code></pre>
</section>
<section id="erasure-coding" class="level4">
<h4 class="anchored" data-anchor-id="erasure-coding">7. Erasure Coding</h4>
<p>Instead of full copies, store encoded fragments. With ( k ) data blocks, ( m ) parity blocks → tolerate ( m ) failures.</p>
<p>Example: Reed-Solomon (used in HDFS, Ceph)</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>k</th>
<th>m</th>
<th>Total</th>
<th>Fault Tolerance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>4</td>
<td>2</td>
<td>6</td>
<td>2 failures</td>
</tr>
</tbody>
</table>
<p>Better storage efficiency than 3× replication.</p>
</section>
<section id="failure-detection" class="level4">
<h4 class="anchored" data-anchor-id="failure-detection">8. Failure Detection</h4>
<p>Detecting failure is tricky in distributed systems (because of latency). Common techniques:</p>
<ul>
<li>Heartbeats - periodic “I’m alive” messages- Timeouts - suspect node if no heartbeat- Gossip protocols - share failure info among peers Used in Consul, Cassandra, Kubernetes health checks.</li>
</ul>
</section>
<section id="self-healing-systems" class="level4">
<h4 class="anchored" data-anchor-id="self-healing-systems">9. Self-Healing Systems</h4>
<p>After failure:</p>
<ol type="1">
<li>Detect it</li>
<li>Isolate faulty component</li>
<li>Replace or restart</li>
<li>Rebalance load or re-replicate data</li>
</ol>
<p>Patterns:</p>
<ul>
<li>Supervisor trees (Erlang/Elixir)- Self-healing clusters (Kubernetes)- Rebalancing (Cassandra ring repair) “Never trust a single machine, trust the system.”</li>
</ul>
</section>
<section id="why-it-matters-89" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-89">10. Why It Matters</h4>
<p>Fault tolerance turns fragile infrastructure into reliable services.</p>
<p>Used in:</p>
<ul>
<li>Databases (replication + WAL)- Distributed storage (HDFS, Ceph, S3)- Orchestration (Kubernetes controllers)- Streaming systems (Kafka, Flink) Without replication and fault tolerance, large-scale systems would collapse under failure.</li>
</ul>
<blockquote class="blockquote">
<p>“Resilience is built, not assumed.”</p>
</blockquote>
</section>
<section id="try-it-yourself-89" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-89">Try It Yourself</h4>
<ol type="1">
<li>Build a primary-backup key-value store: leader writes, follower replicates.</li>
<li>Add heartbeat + timeout detection to trigger failover.</li>
<li>Simulate partition: explore behavior under strong vs eventual consistency.</li>
<li>Implement checkpoint + replay recovery for a small app.</li>
<li>Compare 3× replication vs Reed-Solomon (4+2) for space and reliability.</li>
</ol>
</section>
</section>
</section>
<section id="chapter-10.-ai-ml-and-optimization" class="level2">
<h2 class="anchored" data-anchor-id="chapter-10.-ai-ml-and-optimization">Chapter 10. AI, ML and Optimization</h2>
<section id="classical-ml-k-means-naive-bayes-svm-decision-trees" class="level3">
<h3 class="anchored" data-anchor-id="classical-ml-k-means-naive-bayes-svm-decision-trees">91. Classical ML (k-means, Naive Bayes, SVM, Decision Trees)</h3>
<p>Classical machine learning is built on interpretable mathematics and solid optimization foundations. Long before deep learning, these algorithms powered search engines, spam filters, and recommendation systems. They’re still used today, fast, explainable, and easy to deploy.</p>
<p>This section covers the four pillars of classical ML:</p>
<ul>
<li>k-means - unsupervised clustering- Naive Bayes - probabilistic classification- SVM - margin-based classification- Decision Trees - rule-based learning</li>
</ul>
<section id="the-essence-of-classical-ml" class="level4">
<h4 class="anchored" data-anchor-id="the-essence-of-classical-ml">1. The Essence of Classical ML</h4>
<p>Classical ML is about learning from data using statistical principles, often without huge compute. Given dataset ( D = {<span class="math inline">\(x_i, y_i\)</span>} ), the task is to:</p>
<ul>
<li>Predict ( y ) from ( x )- Generalize beyond seen data- Balance bias and variance</li>
</ul>
</section>
<section id="k-means-clustering" class="level4">
<h4 class="anchored" data-anchor-id="k-means-clustering">2. k-means Clustering</h4>
<p>Goal: partition data into ( k ) groups (clusters) such that intra-cluster distance is minimized.</p>
</section>
<section id="objective" class="level4">
<h4 class="anchored" data-anchor-id="objective">Objective</h4>
<p><span class="math display">\[
\min_{C} \sum_{i=1}^k \sum_{x \in C_i} |x - \mu_i|^2
\]</span> Where <span class="math inline">\(\mu_i\)</span> = centroid of cluster ( i ).</p>
</section>
<section id="algorithm" class="level4">
<h4 class="anchored" data-anchor-id="algorithm">Algorithm</h4>
<ol type="1">
<li>Choose ( k ) random centroids</li>
<li>Assign each point to nearest centroid</li>
<li>Recompute centroids</li>
<li>Repeat until stable</li>
</ol>
</section>
<section id="tiny-code-c-style" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-c-style">Tiny Code (C-style)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb411"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>iter <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> iter <span class="op">&lt;</span> max_iter<span class="op">;</span> iter<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>    assign_points_to_clusters<span class="op">();</span></span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a>    recompute_centroids<span class="op">();</span></span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pros-1" class="level4">
<h4 class="anchored" data-anchor-id="pros-1">Pros</h4>
<ul>
<li><p>Simple, fast (( O(nkd) ))- Works well for spherical clusters #### Cons</p></li>
<li><p>Requires ( k )- Sensitive to initialization, outliers Variants:</p></li>
<li><p>k-means++ (better initialization)- Mini-batch k-means (scalable)</p></li>
</ul>
</section>
<section id="naive-bayes-classifier" class="level4">
<h4 class="anchored" data-anchor-id="naive-bayes-classifier">3. Naive Bayes Classifier</h4>
<p>A probabilistic model using Bayes’ theorem under independence assumptions.</p>
<p><span class="math display">\[
P(y|x) \propto P(y) \prod_{i=1}^n P(x_i | y)
\]</span></p>
</section>
<section id="algorithm-1" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-1">Algorithm</h4>
<ol type="1">
<li>Compute prior ( P(y) )</li>
<li>Compute likelihood ( P<span class="math inline">\(x_i | y\)</span> )</li>
<li>Predict class with max posterior</li>
</ol>
</section>
<section id="types" class="level4">
<h4 class="anchored" data-anchor-id="types">Types</h4>
<ul>
<li>Multinomial NB - text (bag of words)- Gaussian NB - continuous features- Bernoulli NB - binary features #### Example (Spam Detection)</li>
</ul>
<pre><code>P(spam | "win money") ∝ P(spam) * P("win"|spam) * P("money"|spam)</code></pre>
</section>
<section id="pros-2" class="level4">
<h4 class="anchored" data-anchor-id="pros-2">Pros</h4>
<ul>
<li><p>Fast, works well for text- Needs little data- Probabilistic interpretation #### Cons</p></li>
<li><p>Assumes feature independence- Poor for correlated features</p></li>
</ul>
</section>
<section id="support-vector-machines-svm" class="level4">
<h4 class="anchored" data-anchor-id="support-vector-machines-svm">4. Support Vector Machines (SVM)</h4>
<p>SVM finds the max-margin hyperplane separating classes.</p>
</section>
<section id="objective-1" class="level4">
<h4 class="anchored" data-anchor-id="objective-1">Objective</h4>
<p>Maximize margin = distance between boundary and nearest points.</p>
<p><span class="math display">\[
\min_{w, b} \frac{1}{2} |w|^2 \quad \text{s.t.} \quad y_i(w \cdot x_i + b) \ge 1
\]</span></p>
<p>Can be solved via Quadratic Programming.</p>
</section>
<section id="intuition" class="level4">
<h4 class="anchored" data-anchor-id="intuition">Intuition</h4>
<ul>
<li>Each data point → vector- Hyperplane: <span class="math inline">\(w \cdot x + b = 0\)</span>- Support vectors = boundary points #### Kernel Trick</li>
</ul>
<p>Transform input via kernel ( K<span class="math inline">\(x_i, x_j\)</span> = <span class="math inline">\(x_i\)</span> <span class="math inline">\(x_j\)</span> ):</p>
<ul>
<li><p>Linear: dot product- Polynomial: ( <span class="math inline">\(x_i \cdot x_j + c\)</span>^d )- RBF: <span class="math inline">\(e^{-\gamma |x_i - x_j|^2}\)</span> #### Pros</p></li>
<li><p>Effective in high dimensions- Can model nonlinear boundaries- Few hyperparameters #### Cons</p></li>
<li><p>Slow on large data- Harder to tune kernel parameters</p></li>
</ul>
</section>
<section id="decision-trees" class="level4">
<h4 class="anchored" data-anchor-id="decision-trees">5. Decision Trees</h4>
<p>If-else structure for classification/regression.</p>
<p>At each node:</p>
<ul>
<li><p>Pick feature ( f ) and threshold ( t )- Split to maximize information gain #### Metrics</p></li>
<li><p>Entropy: <span class="math inline">\(H = -\sum p_i \log p_i\)</span>- Gini: <span class="math inline">\(G = 1 - \sum p_i^2\)</span> #### Pseudocode</p></li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb413"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>feature <span class="op">&lt;</span> threshold<span class="op">)</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>    go left<span class="op">;</span></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a>    go right<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Build recursively until:</p>
<ul>
<li><p>Max depth- Min samples per leaf- Pure nodes #### Pros</p></li>
<li><p>Interpretable- Handles mixed data- No scaling needed #### Cons</p></li>
<li><p>Prone to overfitting- Unstable (small data changes) Fixes:</p></li>
<li><p>Pruning (reduce depth)- Ensembles: Random Forests, Gradient Boosting</p></li>
</ul>
</section>
<section id="bias-variance-tradeoff" class="level4">
<h4 class="anchored" data-anchor-id="bias-variance-tradeoff">6. Bias-Variance Tradeoff</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Bias</th>
<th>Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>k-means</td>
<td>High</td>
<td>Low</td>
</tr>
<tr class="even">
<td>Naive Bayes</td>
<td>High</td>
<td>Low</td>
</tr>
<tr class="odd">
<td>SVM</td>
<td>Low</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>Decision Tree</td>
<td>Low</td>
<td>High</td>
</tr>
</tbody>
</table>
<p>Balancing both = good generalization.</p>
</section>
<section id="evaluation-metrics" class="level4">
<h4 class="anchored" data-anchor-id="evaluation-metrics">7. Evaluation Metrics</h4>
<p>For classification:</p>
<ul>
<li><p>Accuracy, Precision, Recall, F1-score- ROC-AUC, Confusion Matrix For clustering:</p></li>
<li><p>Inertia, Silhouette Score Always use train/test split or cross-validation.</p></li>
</ul>
</section>
<section id="scaling-to-large-data" class="level4">
<h4 class="anchored" data-anchor-id="scaling-to-large-data">8. Scaling to Large Data</h4>
<p>Techniques:</p>
<ul>
<li><p>Mini-batch training- Online updates (SGD)- Dimensionality reduction (PCA)- Approximation (Random Projections) Libraries:</p></li>
<li><p>scikit-learn (Python)- liblinear, libsvm (C/C++)- MLlib (Spark)</p></li>
</ul>
</section>
<section id="when-to-use-what" class="level4">
<h4 class="anchored" data-anchor-id="when-to-use-what">9. When to Use What</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Task</th>
<th>Recommended Algorithm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Text classification</td>
<td>Naive Bayes</td>
</tr>
<tr class="even">
<td>Clustering</td>
<td>k-means</td>
</tr>
<tr class="odd">
<td>Nonlinear classification</td>
<td>SVM (RBF)</td>
</tr>
<tr class="even">
<td>Tabular data</td>
<td>Decision Tree</td>
</tr>
<tr class="odd">
<td>Quick baseline</td>
<td>Logistic Regression / NB</td>
</tr>
</tbody>
</table>
</section>
<section id="why-it-matters-90" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-90">10. Why It Matters</h4>
<p>These algorithms are fast, interpretable, and theoretical foundations of modern ML. They remain the go-to choice for:</p>
<ul>
<li>Small to medium datasets- Real-time classification- Explainable AI &gt; “Classical ML is the art of solving problems with math you can still write on a whiteboard.”</li>
</ul>
</section>
<section id="try-it-yourself-90" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-90">Try It Yourself</h4>
<ol type="1">
<li>Cluster 2D points with k-means, plot centroids.</li>
<li>Train Naive Bayes on a spam/ham dataset.</li>
<li>Classify linearly separable data with SVM.</li>
<li>Build a Decision Tree from scratch (entropy, Gini).</li>
<li>Compare models’ accuracy and interpretability.</li>
</ol>
</section>
</section>
<section id="ensemble-methods-bagging-boosting-random-forests" class="level3">
<h3 class="anchored" data-anchor-id="ensemble-methods-bagging-boosting-random-forests">92. Ensemble Methods (Bagging, Boosting, Random Forests)</h3>
<p>Ensemble methods combine multiple weak learners to build a strong predictor. Instead of relying on one model, ensembles vote, average, or boost multiple models, improving stability and accuracy.</p>
<p>They are the bridge between classical and modern ML , simple models, combined smartly, become powerful.</p>
<section id="the-core-idea-4" class="level4">
<h4 class="anchored" data-anchor-id="the-core-idea-4">1. The Core Idea</h4>
<blockquote class="blockquote">
<p>“Many weak learners, when combined, can outperform a single strong one.”</p>
</blockquote>
<p>Mathematically, if <span class="math inline">\(f_1, f_2, \ldots, f_k\)</span> are weak learners, an ensemble predictor is:</p>
<p><span class="math display">\[
F(x) = \frac{1}{k}\sum_{i=1}^k f_i(x)
\]</span></p>
<p>For classification, combine via majority vote. For regression, combine via average.</p>
</section>
<section id="bagging-bootstrap-aggregating" class="level4">
<h4 class="anchored" data-anchor-id="bagging-bootstrap-aggregating">2. Bagging (Bootstrap Aggregating)</h4>
<p>Bagging reduces variance by training models on different samples.</p>
</section>
<section id="steps-4" class="level4">
<h4 class="anchored" data-anchor-id="steps-4">Steps</h4>
<ol type="1">
<li>Draw ( B ) bootstrap samples from dataset ( D ).</li>
<li>Train one model per sample.</li>
<li>Aggregate predictions by averaging or voting.</li>
</ol>
<p><span class="math display">\[
\hat{f}*{bag}(x) = \frac{1}{B} \sum*{b=1}^B f_b(x)
\]</span></p>
<p>Each <span class="math inline">\(f_b\)</span> is trained on a random subset (with replacement).</p>
</section>
<section id="example-17" class="level4">
<h4 class="anchored" data-anchor-id="example-17">Example</h4>
<ul>
<li>Base learner: Decision Tree- Ensemble: Bagged Trees- Famous instance: Random Forest #### Tiny Code (C-style Pseudocode)</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb414"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> b <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> b <span class="op">&lt;</span> B<span class="op">;</span> b<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>    D_b <span class="op">=</span> bootstrap_sample<span class="op">(</span>D<span class="op">);</span></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>    model<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> train_tree<span class="op">(</span>D_b<span class="op">);</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> average_predictions<span class="op">(</span>model<span class="op">,</span> x<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pros-3" class="level4">
<h4 class="anchored" data-anchor-id="pros-3">Pros</h4>
<ul>
<li><p>Reduces variance- Works well with high-variance learners- Parallelizable #### Cons</p></li>
<li><p>Increases computation- Doesn’t reduce bias</p></li>
</ul>
</section>
<section id="random-forest" class="level4">
<h4 class="anchored" data-anchor-id="random-forest">3. Random Forest</h4>
<p>A bagging-based ensemble of decision trees with feature randomness.</p>
</section>
<section id="key-ideas" class="level4">
<h4 class="anchored" data-anchor-id="key-ideas">Key Ideas</h4>
<ul>
<li>Each tree trained on bootstrap sample.- At each split, consider random subset of features.- Final prediction = majority vote or average. This decorrelates trees, improving generalization.</li>
</ul>
<p><span class="math display">\[
F(x) = \frac{1}{B} \sum_{b=1}^{B} T_b(x)
\]</span></p>
</section>
<section id="pros-4" class="level4">
<h4 class="anchored" data-anchor-id="pros-4">Pros</h4>
<ul>
<li><p>Handles large feature sets- Low overfitting- Good default for tabular data #### Cons</p></li>
<li><p>Less interpretable- Slower on huge datasets OOB (Out-of-Bag) error = internal validation from unused samples.</p></li>
</ul>
</section>
<section id="boosting" class="level4">
<h4 class="anchored" data-anchor-id="boosting">4. Boosting</h4>
<p>Boosting focuses on reducing bias by sequentially training models , each one corrects errors from the previous.</p>
</section>
<section id="steps-5" class="level4">
<h4 class="anchored" data-anchor-id="steps-5">Steps</h4>
<ol type="1">
<li>Start with weak learner ( f_1(x) )</li>
<li>Train next learner ( f_2(x) ) on residuals/errors</li>
<li>Combine with weighted sum</li>
</ol>
<p><span class="math display">\[
F_m(x) = F_{m-1}(x) + \alpha_m f_m(x)
\]</span></p>
<p>Weights <span class="math inline">\(\alpha_m\)</span> focus on difficult examples.</p>
</section>
<section id="tiny-code-conceptual-1" class="level4">
<h4 class="anchored" data-anchor-id="tiny-code-conceptual-1">Tiny Code (Conceptual)</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb415"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>F <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> m <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> m <span class="op">&lt;</span> M<span class="op">;</span> m<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a>    residual <span class="op">=</span> y <span class="op">-</span> predict<span class="op">(</span>F<span class="op">,</span> x<span class="op">);</span></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a>    f_m <span class="op">=</span> train_weak_learner<span class="op">(</span>x<span class="op">,</span> residual<span class="op">);</span></span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a>    F <span class="op">+=</span> alpha<span class="op">[</span>m<span class="op">]</span> <span class="op">*</span> f_m<span class="op">;</span></span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="adaboost-adaptive-boosting" class="level4">
<h4 class="anchored" data-anchor-id="adaboost-adaptive-boosting">5. AdaBoost (Adaptive Boosting)</h4>
<p>AdaBoost adapts weights on samples after each iteration.</p>
</section>
<section id="algorithm-2" class="level4">
<h4 class="anchored" data-anchor-id="algorithm-2">Algorithm</h4>
<ol type="1">
<li><p>Initialize weights: <span class="math inline">\(w_i = \frac{1}{n}\)</span></p></li>
<li><p>Train weak classifier <span class="math inline">\(f_t\)</span></p></li>
<li><p>Compute error: <span class="math inline">\(\epsilon_t\)</span></p></li>
<li><p>Update weights: <span class="math display">\[
w_i \leftarrow w_i \cdot e^{\alpha_t \cdot I(y_i \ne f_t(x_i))}
\]</span> where <span class="math inline">\(\alpha_t = \frac{1}{2} \ln\left(\frac{1 - \epsilon_t}{\epsilon_t}\right)\)</span></p></li>
<li><p>Normalize weights</p></li>
</ol>
<p>Final classifier: <span class="math display">\[
F(x) = \text{sign}\left( \sum_t \alpha_t f_t(x) \right)
\]</span></p>
</section>
<section id="pros-5" class="level4">
<h4 class="anchored" data-anchor-id="pros-5">Pros</h4>
<ul>
<li><p>High accuracy on clean data- Simple and interpretable weights #### Cons</p></li>
<li><p>Sensitive to outliers- Sequential → not easily parallelizable</p></li>
</ul>
</section>
<section id="gradient-boosting" class="level4">
<h4 class="anchored" data-anchor-id="gradient-boosting">6. Gradient Boosting</h4>
<p>A modern version of boosting using gradient descent on loss.</p>
<p>At each step, fit new model to negative gradient of loss function.</p>
</section>
<section id="objective-2" class="level4">
<h4 class="anchored" data-anchor-id="objective-2">Objective</h4>
<p><span class="math display">\[
F_m(x) = F_{m-1}(x) + \gamma_m h_m(x)
\]</span></p>
<p>where <span class="math inline">\(h_m(x) \approx -\frac{\partial L(y, F(x))}{\partial F(x)}\)</span></p>
</section>
<section id="common-libraries" class="level4">
<h4 class="anchored" data-anchor-id="common-libraries">Common Libraries</h4>
<ul>
<li><p>XGBoost</p></li>
<li><p>LightGBM</p></li>
<li><p>CatBoost #### Pros</p></li>
<li><p>High performance on tabular data- Flexible (custom loss)- Handles mixed feature types #### Cons</p></li>
<li><p>Slower to train- Sensitive to hyperparameters</p></li>
</ul>
</section>
<section id="stacking-stacked-generalization" class="level4">
<h4 class="anchored" data-anchor-id="stacking-stacked-generalization">7. Stacking (Stacked Generalization)</h4>
<p>Combine multiple models (base learners) via a meta-model.</p>
</section>
<section id="steps-6" class="level4">
<h4 class="anchored" data-anchor-id="steps-6">Steps</h4>
<ol type="1">
<li>Train base models (SVM, Tree, NB, etc.)</li>
<li>Collect their predictions</li>
<li>Train meta-model (e.g.&nbsp;Logistic Regression) on outputs</li>
</ol>
<p><span class="math display">\[
\hat{y} = f_{meta}(f_1(x), f_2(x), \ldots, f_k(x))
\]</span></p>
</section>
<section id="bagging-vs-boosting" class="level4">
<h4 class="anchored" data-anchor-id="bagging-vs-boosting">8. Bagging vs Boosting</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>Bagging</th>
<th>Boosting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Strategy</td>
<td>Parallel</td>
<td>Sequential</td>
</tr>
<tr class="even">
<td>Goal</td>
<td>Reduce variance</td>
<td>Reduce bias</td>
</tr>
<tr class="odd">
<td>Weighting</td>
<td>Uniform</td>
<td>Adaptive</td>
</tr>
<tr class="even">
<td>Example</td>
<td>Random Forest</td>
<td>AdaBoost, XGBoost</td>
</tr>
</tbody>
</table>
</section>
<section id="bias-variance-behavior" class="level4">
<h4 class="anchored" data-anchor-id="bias-variance-behavior">9. Bias-Variance Behavior</h4>
<ul>
<li>Bagging: ↓ variance- Boosting: ↓ bias- Random Forest: balanced- Stacking: flexible but complex</li>
</ul>
</section>
<section id="why-it-matters-91" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-91">10. Why It Matters</h4>
<p>Ensemble methods are the workhorses of classical ML competitions and real-world tabular problems. They blend interpretability, flexibility, and predictive power.</p>
<blockquote class="blockquote">
<p>“One tree may fall, but a forest stands strong.”</p>
</blockquote>
</section>
<section id="try-it-yourself-91" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-91">Try It Yourself</h4>
<ol type="1">
<li>Train a Random Forest on the Iris dataset.</li>
<li>Implement AdaBoost from scratch using decision stumps.</li>
<li>Compare Bagging vs Boosting accuracy.</li>
<li>Try XGBoost with different learning rates.</li>
<li>Visualize feature importance across models.</li>
</ol>
</section>
</section>
<section id="gradient-methods-sgd-adam-rmsprop" class="level3">
<h3 class="anchored" data-anchor-id="gradient-methods-sgd-adam-rmsprop">93. Gradient Methods (SGD, Adam, RMSProp)</h3>
<p>Gradient-based optimization is the heartbeat of machine learning. These methods update parameters iteratively by following the negative gradient of the loss function. They power everything from linear regression to deep neural networks.</p>
<section id="the-core-idea-5" class="level4">
<h4 class="anchored" data-anchor-id="the-core-idea-5">1. The Core Idea</h4>
<p>We want to minimize a loss function ( L<span class="math inline">\(\theta\)</span> ). Starting from some initial parameters <span class="math inline">\(\theta_0\)</span>, we move in the opposite direction of the gradient:</p>
<p><span class="math display">\[
\theta_{t+1} = \theta_t - \eta \cdot \nabla_\theta L(\theta_t)
\]</span></p>
<p>where <span class="math inline">\(\eta\)</span> is the learning rate (step size).</p>
<p>The gradient tells us which way the function increases fastest , we move the other way.</p>
</section>
<section id="batch-gradient-descent" class="level4">
<h4 class="anchored" data-anchor-id="batch-gradient-descent">2. Batch Gradient Descent</h4>
<p>Uses the entire dataset to compute the gradient.</p>
<p><span class="math display">\[
\nabla_\theta L(\theta) = \frac{1}{N} \sum_{i=1}^N \nabla_\theta \ell_i(\theta)
\]</span></p>
<ul>
<li>Accurate but slow for large ( N )- Each update is expensive Tiny Code</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb416"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">&lt;</span> T<span class="op">;</span> t<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>    grad <span class="op">=</span> compute_full_gradient<span class="op">(</span>data<span class="op">,</span> theta<span class="op">);</span></span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> theta <span class="op">-</span> eta <span class="op">*</span> grad<span class="op">;</span></span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Good for: small datasets or convex problems</p>
</section>
<section id="stochastic-gradient-descent-sgd" class="level4">
<h4 class="anchored" data-anchor-id="stochastic-gradient-descent-sgd">3. Stochastic Gradient Descent (SGD)</h4>
<p>Instead of full data, use one random sample per step.</p>
<p><span class="math display">\[
\theta_{t+1} = \theta_t - \eta \cdot \nabla_\theta \ell_i(\theta_t)
\]</span></p>
<ul>
<li>Noisy but faster updates- Can escape local minima- Great for online learning Tiny Code</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb417"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each sample <span class="op">(</span>x_i<span class="op">,</span> y_i<span class="op">):</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>    grad <span class="op">=</span> grad_loss<span class="op">(</span>theta<span class="op">,</span> x_i<span class="op">,</span> y_i<span class="op">);</span></span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">-=</span> eta <span class="op">*</span> grad<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Pros</p>
<ul>
<li><p>Fast convergence- Works on large datasets Cons</p></li>
<li><p>Noisy updates- Requires learning rate tuning</p></li>
</ul>
</section>
<section id="mini-batch-gradient-descent" class="level4">
<h4 class="anchored" data-anchor-id="mini-batch-gradient-descent">4. Mini-Batch Gradient Descent</h4>
<p>Compromise between batch and stochastic.</p>
<p>Use small subset (mini-batch) of samples:</p>
<p><span class="math display">\[
\theta_{t+1} = \theta_t - \eta \cdot \frac{1}{m} \sum_{i=1}^m \nabla_\theta \ell_i(\theta_t)
\]</span></p>
<p>Usually batch size = 32 or 64. Faster, more stable updates.</p>
</section>
<section id="momentum" class="level4">
<h4 class="anchored" data-anchor-id="momentum">5. Momentum</h4>
<p>Adds velocity to smooth oscillations.</p>
<p><span class="math display">\[
v_t = \beta v_{t-1} + (1 - \beta) \nabla_\theta L(\theta_t)
\]</span></p>
<p><span class="math display">\[
\theta_{t+1} = \theta_t - \eta v_t
\]</span></p>
<p>This accumulates past gradients to speed movement in consistent directions.</p>
<p>Think of it like a heavy ball rolling down a hill.</p>
</section>
<section id="nesterov-accelerated-gradient-nag" class="level4">
<h4 class="anchored" data-anchor-id="nesterov-accelerated-gradient-nag">6. Nesterov Accelerated Gradient (NAG)</h4>
<p>Improves momentum by looking ahead:</p>
<p><span class="math display">\[
v_t = \beta v_{t-1} + \eta \nabla_\theta L(\theta_t - \beta v_{t-1})
\]</span></p>
<p>It anticipates the future position before computing the gradient.</p>
<p>Faster convergence in convex settings.</p>
</section>
<section id="rmsprop" class="level4">
<h4 class="anchored" data-anchor-id="rmsprop">7. RMSProp</h4>
<p>Adjusts learning rate per parameter using exponential average of squared gradients:</p>
<p><span class="math display">\[
E[g^2]*t = \rho E[g^2]*{t-1} + (1 - \rho) g_t^2
\]</span></p>
<p><span class="math display">\[
\theta_{t+1} = \theta_t - \frac{\eta}{\sqrt{E[g^2]_t + \epsilon}} g_t
\]</span></p>
<p>This helps when gradients vary in magnitude.</p>
<p>Good for: non-stationary objectives, deep networks</p>
</section>
<section id="adam-adaptive-moment-estimation" class="level4">
<h4 class="anchored" data-anchor-id="adam-adaptive-moment-estimation">8. Adam (Adaptive Moment Estimation)</h4>
<p>Combines momentum + RMSProp:</p>
<p><span class="math display">\[
m_t = \beta_1 m_{t-1} + (1 - \beta_1) g_t
\]</span></p>
<p><span class="math display">\[
v_t = \beta_2 v_{t-1} + (1 - \beta_2) g_t^2
\]</span></p>
<p>Bias-corrected estimates:</p>
<p><span class="math display">\[
\hat{m}_t = \frac{m_t}{1 - \beta_1^t}, \quad \hat{v}_t = \frac{v_t}{1 - \beta_2^t}
\]</span></p>
<p>Update rule:</p>
<p><span class="math display">\[
\theta_{t+1} = \theta_t - \frac{\eta \cdot \hat{m}_t}{\sqrt{\hat{v}_t} + \epsilon}
\]</span></p>
<p>Tiny Code (Conceptual)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb418"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> t <span class="op">&lt;=</span> T<span class="op">;</span> t<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> grad<span class="op">(</span>theta<span class="op">);</span></span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> beta1 <span class="op">*</span> m <span class="op">+</span> <span class="op">(</span><span class="dv">1</span> <span class="op">-</span> beta1<span class="op">)</span> <span class="op">*</span> g<span class="op">;</span></span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> beta2 <span class="op">*</span> v <span class="op">+</span> <span class="op">(</span><span class="dv">1</span> <span class="op">-</span> beta2<span class="op">)</span> <span class="op">*</span> g <span class="op">*</span> g<span class="op">;</span></span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true" tabindex="-1"></a>    m_hat <span class="op">=</span> m <span class="op">/</span> <span class="op">(</span><span class="dv">1</span> <span class="op">-</span> pow<span class="op">(</span>beta1<span class="op">,</span> t<span class="op">));</span></span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true" tabindex="-1"></a>    v_hat <span class="op">=</span> v <span class="op">/</span> <span class="op">(</span><span class="dv">1</span> <span class="op">-</span> pow<span class="op">(</span>beta2<span class="op">,</span> t<span class="op">));</span></span>
<span id="cb418-8"><a href="#cb418-8" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">-=</span> eta <span class="op">*</span> m_hat <span class="op">/</span> <span class="op">(</span>sqrt<span class="op">(</span>v_hat<span class="op">)</span> <span class="op">+</span> eps<span class="op">);</span></span>
<span id="cb418-9"><a href="#cb418-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Pros</p>
<ul>
<li><p>Works well out of the box- Adapts learning rate- Great for deep learning Cons</p></li>
<li><p>May not converge exactly- Needs decay schedule for stability</p></li>
</ul>
</section>
<section id="learning-rate-schedules" class="level4">
<h4 class="anchored" data-anchor-id="learning-rate-schedules">9. Learning Rate Schedules</h4>
<p>Control <span class="math inline">\(\eta\)</span> over time:</p>
<ul>
<li>Step decay: <span class="math inline">\(\eta_t = \eta_0 \cdot \gamma^{\lfloor t/s \rfloor}\)</span>- Exponential decay: <span class="math inline">\(\eta_t = \eta_0 e^{-\lambda t}\)</span>- Cosine annealing: smooth periodic decay- Warm restarts: reset learning rate periodically</li>
</ul>
</section>
<section id="why-it-matters-92" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-92">10. Why It Matters</h4>
<p>All modern deep learning is built on gradients. Choosing the right optimizer can mean faster training and better accuracy.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Optimizer</th>
<th>Adaptive</th>
<th>Momentum</th>
<th>Common Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SGD</td>
<td>No</td>
<td>Optional</td>
<td>Simple tasks</td>
</tr>
<tr class="even">
<td>SGD + Momentum</td>
<td>No</td>
<td>Yes</td>
<td>ConvNets</td>
</tr>
<tr class="odd">
<td>RMSProp</td>
<td>Yes</td>
<td>No</td>
<td>RNNs</td>
</tr>
<tr class="even">
<td>Adam</td>
<td>Yes</td>
<td>Yes</td>
<td>Transformers, DNNs</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>“Optimization is the art of taking small steps in the right direction , many times over.”</p>
</blockquote>
</section>
<section id="try-it-yourself-92" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-92">Try It Yourself</h4>
<ol type="1">
<li>Implement SGD and Adam on a linear regression task.</li>
<li>Compare training curves for SGD, Momentum, RMSProp, and Adam.</li>
<li>Experiment with learning rate schedules.</li>
<li>Visualize optimization paths on a 2D contour plot.</li>
</ol>
</section>
</section>
<section id="deep-learning-backpropagation-dropout-normalization" class="level3">
<h3 class="anchored" data-anchor-id="deep-learning-backpropagation-dropout-normalization">94. Deep Learning (Backpropagation, Dropout, Normalization)</h3>
<p>Deep learning is about stacking layers of computation so that the network can learn hierarchical representations. From raw pixels to abstract features, deep nets build meaning through composition of functions.</p>
<p>At the core of this process are three ideas: backpropagation, regularization (dropout), and normalization.</p>
<section id="the-essence-of-deep-learning" class="level4">
<h4 class="anchored" data-anchor-id="the-essence-of-deep-learning">1. The Essence of Deep Learning</h4>
<p>A neural network is a chain of functions:</p>
<p><span class="math display">\[
f(x; \theta) = f_L(f_{L-1}(\cdots f_1(x)))
\]</span></p>
<p>Each layer transforms its input and passes it on.</p>
<p>Training involves finding parameters <span class="math inline">\(\theta\)</span> that minimize a loss ( L(f<span class="math inline">\(x; \theta\)</span>, y) ).</p>
</section>
<section id="backpropagation" class="level4">
<h4 class="anchored" data-anchor-id="backpropagation">2. Backpropagation</h4>
<p>Backpropagation is the algorithm that teaches neural networks.</p>
<p>It uses the chain rule of calculus to efficiently compute gradients layer by layer.</p>
<p>For each layer ( i ):</p>
<p><span class="math display">\[
\frac{\partial L}{\partial \theta_i} = \frac{\partial L}{\partial a_i} \cdot \frac{\partial a_i}{\partial \theta_i}
\]</span></p>
<p>and propagate backward:</p>
<p><span class="math display">\[
\frac{\partial L}{\partial a_{i-1}} = \frac{\partial L}{\partial a_i} \cdot \frac{\partial a_i}{\partial a_{i-1}}
\]</span></p>
<p>So every neuron learns how much it contributed to the error.</p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb419"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Pseudocode for 2-layer network</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>forward<span class="op">:</span></span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a>    z1 <span class="op">=</span> W1<span class="op">*</span>x <span class="op">+</span> b1<span class="op">;</span></span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a>    a1 <span class="op">=</span> relu<span class="op">(</span>z1<span class="op">);</span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a>    z2 <span class="op">=</span> W2<span class="op">*</span>a1 <span class="op">+</span> b2<span class="op">;</span></span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> softmax<span class="op">(</span>z2<span class="op">);</span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> cross_entropy<span class="op">(</span>y_hat<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a>backward<span class="op">:</span></span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true" tabindex="-1"></a>    dz2 <span class="op">=</span> y_hat <span class="op">-</span> y<span class="op">;</span></span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true" tabindex="-1"></a>    dW2 <span class="op">=</span> dz2 <span class="op">*</span> a1<span class="op">.</span>T<span class="op">;</span></span>
<span id="cb419-12"><a href="#cb419-12" aria-hidden="true" tabindex="-1"></a>    db2 <span class="op">=</span> sum<span class="op">(</span>dz2<span class="op">);</span></span>
<span id="cb419-13"><a href="#cb419-13" aria-hidden="true" tabindex="-1"></a>    da1 <span class="op">=</span> W2<span class="op">.</span>T <span class="op">*</span> dz2<span class="op">;</span></span>
<span id="cb419-14"><a href="#cb419-14" aria-hidden="true" tabindex="-1"></a>    dz1 <span class="op">=</span> da1 <span class="op">*</span> relu_grad<span class="op">(</span>z1<span class="op">);</span></span>
<span id="cb419-15"><a href="#cb419-15" aria-hidden="true" tabindex="-1"></a>    dW1 <span class="op">=</span> dz1 <span class="op">*</span> x<span class="op">.</span>T<span class="op">;</span></span>
<span id="cb419-16"><a href="#cb419-16" aria-hidden="true" tabindex="-1"></a>    db1 <span class="op">=</span> sum<span class="op">(</span>dz1<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Each gradient is computed by local differentiation and multiplied back.</p>
</section>
<section id="activation-functions" class="level4">
<h4 class="anchored" data-anchor-id="activation-functions">3. Activation Functions</h4>
<p>Nonlinear activations let networks approximate nonlinear functions.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Function</th>
<th>Formula</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ReLU</td>
<td><span class="math inline">\(\max(0, x)\)</span></td>
<td>Default, fast</td>
</tr>
<tr class="even">
<td>Sigmoid</td>
<td><span class="math inline">\(\frac{1}{1 + e^{-x}}\)</span></td>
<td>Probabilities</td>
</tr>
<tr class="odd">
<td>Tanh</td>
<td><span class="math inline">\(\tanh(x)\)</span></td>
<td>Centered activations</td>
</tr>
<tr class="even">
<td>GELU</td>
<td><span class="math inline">\(x \, \Phi(x)\)</span></td>
<td>Modern transformers</td>
</tr>
</tbody>
</table>
<p>Without nonlinearity, stacking layers is just one big linear transformation.</p>
</section>
<section id="dropout" class="level4">
<h4 class="anchored" data-anchor-id="dropout">4. Dropout</h4>
<p>Dropout is a regularization technique that prevents overfitting. During training, randomly turn off neurons:</p>
<p><span class="math display">\[
\tilde{a}_i = a_i \cdot m_i, \quad m_i \sim \text{Bernoulli}(p)
\]</span></p>
<p>At inference, scale activations by ( p ) (keep probability).</p>
<p>It forces the network to not rely on any single path.</p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb420"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>rand_uniform<span class="op">()</span> <span class="op">&lt;</span> p<span class="op">)</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">/=</span> p<span class="op">;</span> <span class="co">// scaling</span></span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="normalization" class="level4">
<h4 class="anchored" data-anchor-id="normalization">5. Normalization</h4>
<p>Normalization stabilizes and speeds up training by reducing internal covariate shift.</p>
</section>
<section id="batch-normalization" class="level4">
<h4 class="anchored" data-anchor-id="batch-normalization">Batch Normalization</h4>
<p>Normalize activations per batch:</p>
<p><span class="math display">\[
\hat{x} = \frac{x - \mu_B}{\sqrt{\sigma_B^2 + \epsilon}}
\]</span></p>
<p><span class="math display">\[
y = \gamma \hat{x} + \beta
\]</span></p>
<p>Learnable parameters <span class="math inline">\(\gamma, \beta\)</span> restore flexibility.</p>
<p>Benefits:</p>
<ul>
<li>Smooth gradients- Allows higher learning rates- Acts as regularizer #### Layer Normalization</li>
</ul>
<p>Used in transformers (normalizes across features, not batch).</p>
</section>
<section id="initialization" class="level4">
<h4 class="anchored" data-anchor-id="initialization">6. Initialization</h4>
<p>Proper initialization helps gradients flow.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Scheme</th>
<th>Formula</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Xavier</td>
<td><span class="math inline">\(\text{Var}(W) = \frac{1}{n_{in}}\)</span></td>
<td>Tanh</td>
</tr>
<tr class="even">
<td>He</td>
<td><span class="math inline">\(\text{Var}(W) = \frac{2}{n_{in}}\)</span></td>
<td>ReLU</td>
</tr>
</tbody>
</table>
<p>Poor initialization can lead to vanishing or exploding gradients.</p>
</section>
<section id="training-pipeline" class="level4">
<h4 class="anchored" data-anchor-id="training-pipeline">7. Training Pipeline</h4>
<ol type="1">
<li>Initialize weights</li>
<li>Forward pass</li>
<li>Compute loss</li>
<li>Backward pass (backprop)</li>
<li>Update weights (e.g.&nbsp;with Adam)</li>
</ol>
<p>Repeat until convergence.</p>
</section>
<section id="deep-architectures" class="level4">
<h4 class="anchored" data-anchor-id="deep-architectures">8. Deep Architectures</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th>Key Idea</th>
<th>Typical Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MLP</td>
<td>Fully connected</td>
<td>Tabular data</td>
</tr>
<tr class="even">
<td>CNN</td>
<td>Convolutions</td>
<td>Images</td>
</tr>
<tr class="odd">
<td>RNN</td>
<td>Sequential recurrence</td>
<td>Time series, text</td>
</tr>
<tr class="even">
<td>Transformer</td>
<td>Self-attention</td>
<td>Language, vision</td>
</tr>
</tbody>
</table>
<p>Each architecture stacks linear operations and nonlinearities in different ways.</p>
</section>
<section id="overfitting-and-regularization" class="level4">
<h4 class="anchored" data-anchor-id="overfitting-and-regularization">9. Overfitting and Regularization</h4>
<p>Common fixes:</p>
<ul>
<li>Dropout- Weight decay (<span class="math inline">\(L_2\)</span> regularization)- Data augmentation- Early stopping The key is to improve generalization, not just minimize training loss.</li>
</ul>
</section>
<section id="why-it-matters-93" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-93">10. Why It Matters</h4>
<p>Backpropagation turned neural networks from theory to practice. Normalization made them train faster. Dropout made them generalize better.</p>
<p>Together, they unlocked the deep learning revolution.</p>
<blockquote class="blockquote">
<p>“Depth gives power, but gradients give life.”</p>
</blockquote>
</section>
<section id="try-it-yourself-93" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-93">Try It Yourself</h4>
<ol type="1">
<li>Implement a 2-layer network with ReLU and softmax.</li>
<li>Add dropout and batch normalization.</li>
<li>Visualize training with and without dropout.</li>
<li>Compare performance on MNIST with and without normalization.</li>
</ol>
</section>
</section>
<section id="sequence-models-viterbi-beam-search-ctc" class="level3">
<h3 class="anchored" data-anchor-id="sequence-models-viterbi-beam-search-ctc">95. Sequence Models (Viterbi, Beam Search, CTC)</h3>
<p>Sequence models process data where order matters, text, speech, DNA, time series. They capture dependencies across positions, predicting the next step from context.</p>
<p>This section explores three fundamental tools: Viterbi, Beam Search, and CTC (Connectionist Temporal Classification).</p>
<section id="the-nature-of-sequential-data" class="level4">
<h4 class="anchored" data-anchor-id="the-nature-of-sequential-data">1. The Nature of Sequential Data</h4>
<p>Sequential data has temporal or structural order. Each element <span class="math inline">\(x_t\)</span> depends on past inputs <span class="math inline">\(x_{1:t-1}\)</span>.</p>
<p>Common sequence tasks:</p>
<ul>
<li>Tagging (POS tagging, named entity recognition)- Transcription (speech → text)- Decoding (translation, path reconstruction) To handle such problems, we need models that remember.</li>
</ul>
</section>
<section id="hidden-markov-models-hmms" class="level4">
<h4 class="anchored" data-anchor-id="hidden-markov-models-hmms">2. Hidden Markov Models (HMMs)</h4>
<p>A Hidden Markov Model assumes:</p>
<ul>
<li>A sequence of hidden states <span class="math inline">\(z_1, z_2, \ldots, z_T\)</span>- Each state emits an observation <span class="math inline">\(x_t\)</span>- Transition and emission probabilities govern the process <span class="math display">\[
P(z_t | z_{t-1}) = A_{z_{t-1}, z_t}, \quad P(x_t | z_t) = B_{z_t}(x_t)
\]</span></li>
</ul>
<p>Goal: find the most likely sequence of hidden states given observations.</p>
</section>
<section id="the-viterbi-algorithm" class="level4">
<h4 class="anchored" data-anchor-id="the-viterbi-algorithm">3. The Viterbi Algorithm</h4>
<p>Viterbi is a dynamic programming algorithm to decode the most probable path:</p>
<p><span class="math display">\[
\delta_t(i) = \max_{z_{1:t-1}} P(z_{1:t-1}, z_t = i, x_{1:t})
\]</span></p>
<p>Recurrence:</p>
<p><span class="math display">\[
\delta_t(i) = \max_j \big( \delta_{t-1}(j) \cdot A_{j,i} \big) \cdot B_i(x_t)
\]</span></p>
<p>Track backpointers to reconstruct the best sequence.</p>
<p>Time complexity: <span class="math inline">\(O(T \cdot N^2)\)</span>,<br>
where <span class="math inline">\(N\)</span> = number of states, <span class="math inline">\(T\)</span> = sequence length.</p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb421"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> t <span class="op">&lt;</span> T<span class="op">;</span> t<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">double</span> best <span class="op">=</span> <span class="op">-</span>INF<span class="op">;</span></span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> argmax <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">double</span> score <span class="op">=</span> delta<span class="op">[</span>t<span class="op">-</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">*</span> A<span class="op">[</span>j<span class="op">][</span>i<span class="op">];</span></span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>score <span class="op">&gt;</span> best<span class="op">)</span> <span class="op">{</span> best <span class="op">=</span> score<span class="op">;</span> argmax <span class="op">=</span> j<span class="op">;</span> <span class="op">}</span></span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb421-9"><a href="#cb421-9" aria-hidden="true" tabindex="-1"></a>        delta<span class="op">[</span>t<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> best <span class="op">*</span> B<span class="op">[</span>i<span class="op">][</span>x<span class="op">[</span>t<span class="op">]];</span></span>
<span id="cb421-10"><a href="#cb421-10" aria-hidden="true" tabindex="-1"></a>        backptr<span class="op">[</span>t<span class="op">][</span>i<span class="op">]</span> <span class="op">=</span> argmax<span class="op">;</span></span>
<span id="cb421-11"><a href="#cb421-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb421-12"><a href="#cb421-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Use <code>backptr</code> to trace back the optimal path.</p>
</section>
<section id="beam-search" class="level4">
<h4 class="anchored" data-anchor-id="beam-search">4. Beam Search</h4>
<p>For many sequence models (e.g.&nbsp;neural machine translation), exhaustive search is impossible. Beam search keeps only the top-k best hypotheses at each step.</p>
<p>Algorithm:</p>
<ol type="1">
<li>Start with an empty sequence and score 0</li>
<li>At each step, expand each candidate with all possible next tokens</li>
<li>Keep only k best sequences (beam size)</li>
<li>Stop when all sequences end or reach max length</li>
</ol>
<p>Beam size controls trade-off:</p>
<ul>
<li>Larger beam → better accuracy, slower- Smaller beam → faster, riskier</li>
</ul>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb422"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>step <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> step <span class="op">&lt;</span> max_len<span class="op">;</span> step<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a>    vector<span class="op">&lt;</span>Candidate<span class="op">&gt;</span> new_beam<span class="op">;</span></span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>c in beam<span class="op">)</span> <span class="op">{</span></span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a>        probs <span class="op">=</span> model_next<span class="op">(</span>c<span class="op">.</span>seq<span class="op">);</span></span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>token<span class="op">,</span> p in probs<span class="op">)</span></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a>            new_beam<span class="op">.</span>push<span class="op">({</span>c<span class="op">.</span>seq <span class="op">+</span> token<span class="op">,</span> c<span class="op">.</span>score <span class="op">+</span> log<span class="op">(</span>p<span class="op">)});</span></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a>    beam <span class="op">=</span> top_k<span class="op">(</span>new_beam<span class="op">,</span> k<span class="op">);</span></span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Use log probabilities to avoid underflow.</p>
</section>
<section id="connectionist-temporal-classification-ctc" class="level4">
<h4 class="anchored" data-anchor-id="connectionist-temporal-classification-ctc">5. Connectionist Temporal Classification (CTC)</h4>
<p>Used in speech recognition and handwriting recognition where input and output lengths differ.</p>
<p>CTC learns to align input frames with output symbols without explicit alignment.</p>
<p>Add a special blank symbol (∅) to allow flexible alignment.</p>
<p>Example (CTC decoding):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Frame</th>
<th>Output</th>
<th>After Collapse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A ∅ A A</td>
<td>A ∅ A</td>
<td>A A</td>
</tr>
<tr class="even">
<td>H ∅ ∅ H</td>
<td>H H</td>
<td>H</td>
</tr>
</tbody>
</table>
<p>Loss: <span class="math display">\[
P(y | x) = \sum_{\pi \in \text{Align}(x, y)} P(\pi | x)
\]</span> where <span class="math inline">\(\pi\)</span> are all alignments that reduce to ( y ).</p>
<p>CTC uses dynamic programming to compute forward-backward probabilities.</p>
</section>
<section id="comparing-methods" class="level4">
<h4 class="anchored" data-anchor-id="comparing-methods">6. Comparing Methods</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 34%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Used In</th>
<th>Key Idea</th>
<th>Handles Alignment?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Viterbi</td>
<td>HMMs</td>
<td>Most probable state path</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Beam Search</td>
<td>Neural decoders</td>
<td>Approximate search</td>
<td>Implicit</td>
</tr>
<tr class="odd">
<td>CTC</td>
<td>Speech / seq2seq</td>
<td>Sum over alignments</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</section>
<section id="use-cases" class="level4">
<h4 class="anchored" data-anchor-id="use-cases">7. Use Cases</h4>
<ul>
<li>Viterbi: POS tagging, speech decoding- Beam Search: translation, text generation- CTC: ASR, OCR, gesture recognition</li>
</ul>
</section>
<section id="implementation-tips" class="level4">
<h4 class="anchored" data-anchor-id="implementation-tips">8. Implementation Tips</h4>
<ul>
<li>Use log-space for probabilities- In beam search, apply length normalization- In CTC, use dynamic programming tables- Combine CTC + beam search for speech decoding</li>
</ul>
</section>
<section id="common-pitfalls" class="level4">
<h4 class="anchored" data-anchor-id="common-pitfalls">9. Common Pitfalls</h4>
<ul>
<li>Viterbi assumes Markov property (limited memory)- Beam Search can miss global optimum- CTC can confuse repeated characters without blanks</li>
</ul>
</section>
<section id="why-it-matters-94" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-94">10. Why It Matters</h4>
<p>Sequence models are the bridge between structure and time. They show how to decode hidden meaning in ordered data.</p>
<p>From decoding Morse code to transcribing speech, these algorithms give machines the gift of sequence understanding.</p>
</section>
<section id="try-it-yourself-94" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-94">Try It Yourself</h4>
<ol type="1">
<li>Implement Viterbi for a 3-state HMM.</li>
<li>Compare greedy decoding vs beam search on a toy language model.</li>
<li>Build a CTC loss table for a short sequence (like “HELLO”).</li>
</ol>
</section>
</section>
<section id="metaheuristics-ga-sa-pso-aco" class="level3">
<h3 class="anchored" data-anchor-id="metaheuristics-ga-sa-pso-aco">96. Metaheuristics (GA, SA, PSO, ACO)</h3>
<p>Metaheuristics are general-purpose optimization strategies that search through vast, complex spaces when exact methods are too slow or infeasible. They don’t guarantee the perfect answer but often find good-enough solutions fast.</p>
<p>This section covers four classics:</p>
<ul>
<li>GA (Genetic Algorithm)- SA (Simulated Annealing)- PSO (Particle Swarm Optimization)- ACO (Ant Colony Optimization)</li>
</ul>
<section id="the-metaheuristic-philosophy" class="level4">
<h4 class="anchored" data-anchor-id="the-metaheuristic-philosophy">1. The Metaheuristic Philosophy</h4>
<p>Metaheuristics draw inspiration from nature and physics. They combine exploration (searching widely) and exploitation (refining promising spots).</p>
<p>They’re ideal for:</p>
<ul>
<li>NP-hard problems (TSP, scheduling)- Continuous optimization (parameter tuning)- Black-box functions (no gradients) They trade mathematical guarantees for practical power.</li>
</ul>
</section>
<section id="genetic-algorithm-ga" class="level4">
<h4 class="anchored" data-anchor-id="genetic-algorithm-ga">2. Genetic Algorithm (GA)</h4>
<p>Inspired by natural selection, GAs evolve a population of solutions.</p>
</section>
<section id="core-steps" class="level4">
<h4 class="anchored" data-anchor-id="core-steps">Core Steps</h4>
<ol type="1">
<li>Initialize population randomly</li>
<li>Evaluate fitness of each</li>
<li>Select parents</li>
<li>Crossover to produce offspring</li>
<li>Mutate to add variation</li>
<li>Replace worst with new candidates</li>
</ol>
<p>Repeat until convergence.</p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb423"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>gen <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> gen <span class="op">&lt;</span> max_gen<span class="op">;</span> gen<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>    evaluate<span class="op">(</span>pop<span class="op">);</span></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>    parents <span class="op">=</span> select_best<span class="op">(</span>pop<span class="op">);</span></span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a>    offspring <span class="op">=</span> crossover<span class="op">(</span>parents<span class="op">);</span></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a>    mutate<span class="op">(</span>offspring<span class="op">);</span></span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a>    pop <span class="op">=</span> select_survivors<span class="op">(</span>pop<span class="op">,</span> offspring<span class="op">);</span></span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Operators</p>
<ul>
<li>Selection: tournament, roulette-wheel- Crossover: one-point, uniform- Mutation: bit-flip, Gaussian Strengths: global search, diverse exploration Weakness: may converge slowly</li>
</ul>
</section>
<section id="simulated-annealing-sa" class="level4">
<h4 class="anchored" data-anchor-id="simulated-annealing-sa">3. Simulated Annealing (SA)</h4>
<p>Mimics cooling of metals, start hot (high randomness), slowly cool.</p>
<p>At each step:</p>
<ol type="1">
<li>Propose random neighbor</li>
<li>Accept if better</li>
<li>If worse, accept with probability <span class="math display">\[
P = e^{-\frac{\Delta E}{T}}
\]</span></li>
<li>Gradually lower ( T )</li>
</ol>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb424"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> T_init<span class="op">;</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> random_state<span class="op">();</span></span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>T <span class="op">&gt;</span> T_min<span class="op">)</span> <span class="op">{</span></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a>    next <span class="op">=</span> neighbor<span class="op">(</span>state<span class="op">);</span></span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a>    dE <span class="op">=</span> cost<span class="op">(</span>next<span class="op">)</span> <span class="op">-</span> cost<span class="op">(</span>state<span class="op">);</span></span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>dE <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">||</span> exp<span class="op">(-</span>dE<span class="op">/</span>T<span class="op">)</span> <span class="op">&gt;</span> rand_uniform<span class="op">())</span></span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true" tabindex="-1"></a>        state <span class="op">=</span> next<span class="op">;</span></span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true" tabindex="-1"></a>    T <span class="op">*=</span> alpha<span class="op">;</span> <span class="co">// cooling rate</span></span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Strengths: escapes local minima Weakness: sensitive to cooling schedule</p>
</section>
<section id="particle-swarm-optimization-pso" class="level4">
<h4 class="anchored" data-anchor-id="particle-swarm-optimization-pso">4. Particle Swarm Optimization (PSO)</h4>
<p>Inspired by bird flocking. Each particle adjusts velocity based on:</p>
<ul>
<li>Its own best position- The global best found <span class="math display">\[
v_i \leftarrow w v_i + c_1 r_1 (p_i - x_i) + c_2 r_2 (g - x_i)
\]</span></li>
</ul>
<p><span class="math display">\[
x_i \leftarrow x_i + v_i
\]</span></p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb425"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each particle i<span class="op">:</span></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a>    v<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> w<span class="op">*</span>v<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> c1<span class="op">*</span>r1<span class="op">*(</span>pbest<span class="op">[</span>i<span class="op">]-</span>x<span class="op">[</span>i<span class="op">])</span> <span class="op">+</span> c2<span class="op">*</span>r2<span class="op">*(</span>gbest<span class="op">-</span>x<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> v<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>    update_best<span class="op">(</span>i<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Strengths: continuous domains, easy Weakness: premature convergence</p>
</section>
<section id="ant-colony-optimization-aco" class="level4">
<h4 class="anchored" data-anchor-id="ant-colony-optimization-aco">5. Ant Colony Optimization (ACO)</h4>
<p>Inspired by ant foraging, ants deposit pheromones on paths. The stronger the trail, the more likely others follow.</p>
<p>Steps:</p>
<ol type="1">
<li>Initialize pheromone on all edges</li>
<li>Each ant builds a solution (prob. ∝ pheromone)</li>
<li>Evaluate paths</li>
<li>Evaporate pheromone</li>
<li>Reinforce good paths</li>
</ol>
<p><span class="math display">\[
\tau_{ij} \leftarrow (1 - \rho)\tau_{ij} + \sum_k \Delta\tau_{ij}^k
\]</span></p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb426"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each iteration<span class="op">:</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> each ant<span class="op">:</span></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> build_solution<span class="op">(</span>pheromone<span class="op">);</span></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a>        score <span class="op">=</span> evaluate<span class="op">(</span>path<span class="op">);</span></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a>    evaporate<span class="op">(</span>pheromone<span class="op">);</span></span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true" tabindex="-1"></a>    deposit<span class="op">(</span>pheromone<span class="op">,</span> best_paths<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Strengths: combinatorial problems (TSP) Weakness: parameter tuning, slower convergence</p>
</section>
<section id="comparing-the-four" class="level4">
<h4 class="anchored" data-anchor-id="comparing-the-four">6. Comparing the Four</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 20%">
<col style="width: 27%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Inspiration</th>
<th>Best For</th>
<th>Key Idea</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GA</td>
<td>Evolution</td>
<td>Discrete search</td>
<td>Selection, crossover, mutation</td>
</tr>
<tr class="even">
<td>SA</td>
<td>Thermodynamics</td>
<td>Local optima escape</td>
<td>Cooling + randomness</td>
</tr>
<tr class="odd">
<td>PSO</td>
<td>Swarm behavior</td>
<td>Continuous search</td>
<td>Local + global attraction</td>
</tr>
<tr class="even">
<td>ACO</td>
<td>Ant foraging</td>
<td>Graph paths</td>
<td>Pheromone reinforcement</td>
</tr>
</tbody>
</table>
</section>
<section id="design-patterns" class="level4">
<h4 class="anchored" data-anchor-id="design-patterns">7. Design Patterns</h4>
<p>Common metaheuristic pattern:</p>
<ul>
<li>Represent solution- Define fitness / cost function- Define neighbor / mutation operators- Balance randomness and greediness Tuning parameters often matters more than equations.</li>
</ul>
</section>
<section id="hybrid-metaheuristics" class="level4">
<h4 class="anchored" data-anchor-id="hybrid-metaheuristics">8. Hybrid Metaheuristics</h4>
<p>Combine strengths:</p>
<ul>
<li>GA + SA: evolve population, fine-tune locally- PSO + DE: use swarm + differential evolution- ACO + Local Search: reinforce with hill-climbing These hybrids often outperform single methods.</li>
</ul>
</section>
<section id="common-pitfalls-1" class="level4">
<h4 class="anchored" data-anchor-id="common-pitfalls-1">9. Common Pitfalls</h4>
<ul>
<li>Poor representation → weak search- Over-exploitation → stuck in local optima- Bad parameters → chaotic or stagnant behavior Always visualize progress (fitness over time).</li>
</ul>
</section>
<section id="why-it-matters-95" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-95">10. Why It Matters</h4>
<p>Metaheuristics give us adaptive intelligence, searching without gradients, equations, or complete knowledge. They reflect nature’s way of solving complex puzzles: iterate, adapt, survive.</p>
<blockquote class="blockquote">
<p>“Optimization is not about perfection. It’s about progress guided by curiosity.”</p>
</blockquote>
</section>
<section id="try-it-yourself-95" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-95">Try It Yourself</h4>
<ol type="1">
<li>Implement Simulated Annealing for the Traveling Salesman Problem.</li>
<li>Create a Genetic Algorithm for knapsack optimization.</li>
<li>Tune PSO parameters to fit a function <span class="math inline">\(f(x) = x^2 + 10\sin x\)</span>.</li>
<li>Compare ACO paths for TSP at different evaporation rates.</li>
</ol>
</section>
</section>
<section id="reinforcement-learning-q-learning-policy-gradients" class="level3">
<h3 class="anchored" data-anchor-id="reinforcement-learning-q-learning-policy-gradients">97. Reinforcement Learning (Q-learning, Policy Gradients)</h3>
<p>Reinforcement Learning (RL) is about learning through interaction , an agent explores an environment, takes actions, and learns from rewards. Unlike supervised learning (where correct labels are given), RL learns what to do by trial and error.</p>
<p>This section introduces two core approaches:</p>
<ul>
<li>Q-learning (value-based)- Policy Gradient (policy-based)</li>
</ul>
<section id="the-reinforcement-learning-setting" class="level4">
<h4 class="anchored" data-anchor-id="the-reinforcement-learning-setting">1. The Reinforcement Learning Setting</h4>
<p>An RL problem is modeled as a Markov Decision Process (MDP):</p>
<ul>
<li>States <span class="math inline">\(S\)</span></li>
<li>Actions <span class="math inline">\(A\)</span></li>
<li>Transition <span class="math inline">\(P(s' \mid s, a)\)</span></li>
<li>Reward <span class="math inline">\(R(s, a)\)</span></li>
<li>Discount factor <span class="math inline">\(\gamma\)</span></li>
</ul>
<p>The agent’s goal is to find a policy <span class="math inline">\(\pi(a \mid s)\)</span> that maximizes expected return:</p>
<p><span class="math display">\[
G_t = \sum_{k=0}^\infty \gamma^k R_{t+k+1}
\]</span></p>
</section>
<section id="value-functions" class="level4">
<h4 class="anchored" data-anchor-id="value-functions">2. Value Functions</h4>
<p>The value function measures how good a state (or state-action pair) is.</p>
<ul>
<li><p>State-value: <span class="math display">\[
V^\pi(s) = \mathbb{E}_\pi[G_t | S_t = s]
\]</span></p></li>
<li><p>Action-value (Q-function): <span class="math display">\[
Q^\pi(s, a) = \mathbb{E}_\pi[G_t | S_t = s, A_t = a]
\]</span></p></li>
</ul>
</section>
<section id="bellman-equation" class="level4">
<h4 class="anchored" data-anchor-id="bellman-equation">3. Bellman Equation</h4>
<p>The Bellman equation relates a state’s value to its neighbors:</p>
<p><span class="math display">\[
Q^*(s,a) = R(s,a) + \gamma \max_{a'} Q^*(s',a')
\]</span></p>
<p>This recursive definition drives value iteration and Q-learning.</p>
</section>
<section id="q-learning" class="level4">
<h4 class="anchored" data-anchor-id="q-learning">4. Q-Learning</h4>
<p>Q-learning learns the optimal action-value function off-policy (independent of behavior policy):</p>
<p>Update Rule: <span class="math display">\[
Q(s,a) \leftarrow Q(s,a) + \alpha \big[ r + \gamma \max_{a'} Q(s',a') - Q(s,a) \big]
\]</span></p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb427"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>Q<span class="op">[</span>s<span class="op">][</span>a<span class="op">]</span> <span class="op">+=</span> alpha <span class="op">*</span> <span class="op">(</span>r <span class="op">+</span> gamma <span class="op">*</span> max<span class="op">(</span>Q<span class="op">[</span>s_next<span class="op">])</span> <span class="op">-</span> Q<span class="op">[</span>s<span class="op">][</span>a<span class="op">]);</span></span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> s_next<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Repeat while exploring (e.g., <span class="math inline">\(\varepsilon\)</span>-greedy):</p>
<ul>
<li>With probability <span class="math inline">\(\varepsilon\)</span>, choose a random action</li>
<li>With probability <span class="math inline">\(1 - \varepsilon\)</span>, choose the best action</li>
</ul>
<p>Over time, <span class="math inline">\(Q\)</span> converges to <span class="math inline">\(Q^*\)</span>.</p>
</section>
<section id="exploration-vs-exploitation" class="level4">
<h4 class="anchored" data-anchor-id="exploration-vs-exploitation">5. Exploration vs Exploitation</h4>
<p>RL is a balancing act:</p>
<ul>
<li><p>Exploration: try new actions to gather knowledge- Exploitation: use current best knowledge to maximize reward Strategies:</p></li>
<li><p>ε-greedy- Softmax action selection- Upper Confidence Bound (UCB)</p></li>
</ul>
</section>
<section id="policy-gradient-methods" class="level4">
<h4 class="anchored" data-anchor-id="policy-gradient-methods">6. Policy Gradient Methods</h4>
<p>Instead of learning Q-values, learn the policy directly. Represent policy with parameters <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[
\pi_\theta(a|s) = P(a | s; \theta)
\]</span></p>
<p>Goal: maximize expected return <span class="math display">\[
J(\theta) = \mathbb{E}*{\pi*\theta}[G_t]
\]</span></p>
<p>Gradient ascent update: <span class="math display">\[
\theta \leftarrow \theta + \alpha \nabla_\theta J(\theta)
\]</span></p>
<p>REINFORCE Algorithm: <span class="math display">\[
\nabla_\theta J(\theta) = \mathbb{E}\big[ G_t \nabla_\theta \log \pi_\theta(a_t|s_t) \big]
\]</span></p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb428"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a>theta <span class="op">+=</span> alpha <span class="op">*</span> G_t <span class="op">*</span> grad_logpi<span class="op">(</span>a_t<span class="op">,</span> s_t<span class="op">);</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="actor-critic-architecture" class="level4">
<h4 class="anchored" data-anchor-id="actor-critic-architecture">7. Actor-Critic Architecture</h4>
<p>Combines policy gradient (actor) + value estimation (critic).</p>
<ul>
<li>Actor: updates policy- Critic: estimates value (baseline) Update: <span class="math display">\[
\theta \leftarrow \theta + \alpha_\theta \delta_t \nabla_\theta \log \pi_\theta(a_t|s_t)
\]</span></li>
</ul>
<p><span class="math display">\[
w \leftarrow w + \alpha_w \delta_t \nabla_w V_w(s_t)
\]</span></p>
<p>with TD error: <span class="math display">\[
\delta_t = r + \gamma V(s') - V(s)
\]</span></p>
</section>
<section id="comparing-methods-1" class="level4">
<h4 class="anchored" data-anchor-id="comparing-methods-1">8. Comparing Methods</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 19%">
<col style="width: 11%">
<col style="width: 21%">
<col style="width: 18%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Type</th>
<th>Learns</th>
<th>On/Off Policy</th>
<th>Continuous?</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Q-learning</td>
<td>Value-based</td>
<td>Q(s, a)</td>
<td>Off-policy</td>
<td>No</td>
<td></td>
</tr>
<tr class="even">
<td>Policy Gradient</td>
<td>Policy-based</td>
<td>π(a</td>
<td>s)</td>
<td>On-policy</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Actor-Critic</td>
<td>Hybrid</td>
<td>Both</td>
<td>On-policy</td>
<td>Yes</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="extensions" class="level4">
<h4 class="anchored" data-anchor-id="extensions">9. Extensions</h4>
<ul>
<li>Deep Q-Networks (DQN): use neural nets for Q(s, a)- PPO / A3C: advanced actor-critic methods- TD(λ): tradeoff between MC and TD learning- Double Q-learning: reduce overestimation- Entropy regularization: encourage exploration</li>
</ul>
</section>
<section id="why-it-matters-96" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-96">10. Why It Matters</h4>
<p>Reinforcement learning powers autonomous agents, game AIs, and control systems. It’s the foundation of AlphaGo, robotics control, and adaptive decision systems.</p>
<blockquote class="blockquote">
<p>“An agent learns not from instruction but from experience.”</p>
</blockquote>
</section>
<section id="try-it-yourself-96" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-96">Try It Yourself</h4>
<ol type="1">
<li>Implement Q-learning for a grid-world maze.</li>
<li>Add ε-greedy exploration.</li>
<li>Visualize the learned policy.</li>
<li>Try REINFORCE with a simple policy (e.g.&nbsp;softmax over actions).</li>
<li>Compare convergence of Q-learning vs Policy Gradient.</li>
</ol>
</section>
</section>
<section id="approximation-and-online-algorithms" class="level3">
<h3 class="anchored" data-anchor-id="approximation-and-online-algorithms">98. Approximation and Online Algorithms</h3>
<p>In the real world, we often can’t wait for a perfect solution , data arrives on the fly, or the problem is too hard to solve exactly. That’s where approximation and online algorithms shine. They aim for good-enough results, fast and adaptively, under uncertainty.</p>
<section id="the-big-picture-1" class="level4">
<h4 class="anchored" data-anchor-id="the-big-picture-1">1. The Big Picture</h4>
<ul>
<li>Approximation algorithms: Solve NP-hard problems with provable bounds.- Online algorithms: Make immediate decisions without knowing the future. Both trade optimality for efficiency or adaptability.</li>
</ul>
</section>
<section id="approximation-algorithms" class="level4">
<h4 class="anchored" data-anchor-id="approximation-algorithms">2. Approximation Algorithms</h4>
<p>An approximation algorithm finds a solution within a factor <span class="math inline">\(\rho\)</span> of the optimal.</p>
<p>If ( C ) is cost of the algorithm, and <span class="math inline">\(C^*\)</span> is optimal cost:</p>
<p><span class="math display">\[
\rho = \max\left(\frac{C}{C^*}, \frac{C^*}{C}\right)
\]</span></p>
<p>Example: <span class="math inline">\(\rho = 2\)</span> → solution at most twice worse than optimal.</p>
</section>
<section id="example-vertex-cover" class="level4">
<h4 class="anchored" data-anchor-id="example-vertex-cover">3. Example: Vertex Cover</h4>
<p>Problem: Given graph ( G(V,E) ), choose smallest set of vertices covering all edges.</p>
<p>Algorithm (2-approximation):</p>
<ol type="1">
<li><p>Initialize cover = ∅</p></li>
<li><p>While edges remain:</p>
<ul>
<li>Pick any edge (u, v) - Add both u, v to cover - Remove all edges incident on u or v Guarantee: At most 2× optimal size.</li>
</ul></li>
</ol>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb429"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>cover <span class="op">=</span> <span class="op">{};</span></span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(!</span>edges<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span>u<span class="op">,</span> v<span class="op">)</span> <span class="op">=</span> edges<span class="op">.</span>pop<span class="op">();</span></span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a>    cover<span class="op">.</span>add<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb429-5"><a href="#cb429-5" aria-hidden="true" tabindex="-1"></a>    cover<span class="op">.</span>add<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb429-6"><a href="#cb429-6" aria-hidden="true" tabindex="-1"></a>    remove_incident_edges<span class="op">(</span>u<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb429-7"><a href="#cb429-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-metric-tsp-triangle-inequality" class="level4">
<h4 class="anchored" data-anchor-id="example-metric-tsp-triangle-inequality">4. Example: Metric TSP (Triangle Inequality)</h4>
<p>Algorithm (Christofides):</p>
<ol type="1">
<li>Find MST</li>
<li>Find odd-degree vertices</li>
<li>Find min perfect matching</li>
<li>Combine + shortcut to get tour</li>
</ol>
<p>Guarantee: ≤ 1.5 × optimal.</p>
</section>
<section id="greedy-approximation-set-cover" class="level4">
<h4 class="anchored" data-anchor-id="greedy-approximation-set-cover">5. Greedy Approximation: Set Cover</h4>
<p>Goal: Cover universe ( U ) with minimum sets <span class="math inline">\(S_i\)</span>.</p>
<p>Greedy Algorithm: Pick set covering most uncovered elements each time. Guarantee: <span class="math inline">\(H_n \approx \ln n\)</span> factor approximation.</p>
</section>
<section id="online-algorithms" class="level4">
<h4 class="anchored" data-anchor-id="online-algorithms">6. Online Algorithms</h4>
<p>Online algorithms must decide now, before future input is known.</p>
<p>Goal: Minimize competitive ratio:</p>
<p><span class="math display">\[
\text{CR} = \max_{\text{input}} \frac{\text{Cost}*{\text{online}}}{\text{Cost}*{\text{optimal offline}}}
\]</span></p>
<p>Lower CR → better adaptability.</p>
</section>
<section id="classic-example-online-paging" class="level4">
<h4 class="anchored" data-anchor-id="classic-example-online-paging">7. Classic Example: Online Paging</h4>
<p>You have k pages in cache, sequence of page requests.</p>
<ul>
<li><p>If page in cache → hit- Else → miss, must evict one page Strategies:</p></li>
<li><p>LRU (Least Recently Used): evict oldest- FIFO: evict first loaded- Random: pick randomly Competitive Ratio:</p></li>
<li><p>LRU: ≤ ( k )- Random: ≤ ( 2k-1 )</p></li>
</ul>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb430"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>cache <span class="op">=</span> LRUCache<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>page in requests<span class="op">)</span> <span class="op">{</span></span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>cache<span class="op">.</span>contains<span class="op">(</span>page<span class="op">))</span></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a>        cache<span class="op">.</span>evict_oldest<span class="op">();</span></span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a>    cache<span class="op">.</span>add<span class="op">(</span>page<span class="op">);</span></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="online-bipartite-matching-karp-vazirani-vazirani" class="level4">
<h4 class="anchored" data-anchor-id="online-bipartite-matching-karp-vazirani-vazirani">8. Online Bipartite Matching (Karp-Vazirani-Vazirani)</h4>
<p>Given offline set U and online set V (arrives one by one), match greedily. Competitive ratio: <span class="math inline">\(1 - \frac{1}{e}\)</span></p>
<p>Used in ad allocation and resource assignment.</p>
</section>
<section id="approximation-online-together" class="level4">
<h4 class="anchored" data-anchor-id="approximation-online-together">9. Approximation + Online Together</h4>
<p>Modern algorithms blend both:</p>
<ul>
<li>Streaming algorithms: One pass, small memory (Count-Min, reservoir sampling)- Online learning: Update models incrementally (SGD, perceptron)- Approximate dynamic programming: RL and heuristic search These are approximate online solvers , both quick and adaptive.</li>
</ul>
</section>
<section id="why-it-matters-97" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-97">10. Why It Matters</h4>
<p>Approximation algorithms give us provable near-optimal answers. Online algorithms give us real-time adaptivity. Together, they model intelligence under limits , when time and information are scarce.</p>
<blockquote class="blockquote">
<p>“Sometimes, good and on time beats perfect and late.”</p>
</blockquote>
</section>
<section id="try-it-yourself-97" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-97">Try It Yourself</h4>
<ol type="1">
<li>Implement 2-approx vertex cover on a small graph.</li>
<li>Simulate online paging with LRU vs Random.</li>
<li>Build a greedy set cover solver.</li>
<li>Measure competitive ratio on test sequences.</li>
<li>Combine ideas: streaming + approximation for big data filtering.</li>
</ol>
</section>
</section>
<section id="fairness-causal-inference-and-robust-optimization" class="level3">
<h3 class="anchored" data-anchor-id="fairness-causal-inference-and-robust-optimization">99. Fairness, Causal Inference, and Robust Optimization</h3>
<p>As algorithms increasingly shape decisions , from hiring to lending to healthcare , we must ensure they’re fair, causally sound, and robust to uncertainty. This section blends ideas from ethics, statistics, and optimization to make algorithms not just efficient, but responsible and reliable.</p>
<section id="why-fairness-matters" class="level4">
<h4 class="anchored" data-anchor-id="why-fairness-matters">1. Why Fairness Matters</h4>
<p>Machine learning systems often inherit biases from data. Without intervention, they can amplify inequality or discrimination.</p>
<p>Fairness-aware algorithms explicitly measure and correct these effects.</p>
<p>Common sources of bias:</p>
<ul>
<li>Historical bias (biased data)- Measurement bias (imprecise features)- Selection bias (skewed samples) The goal: equitable treatment across sensitive groups (gender, race, region, etc.)</li>
</ul>
</section>
<section id="formal-fairness-criteria" class="level4">
<h4 class="anchored" data-anchor-id="formal-fairness-criteria">2. Formal Fairness Criteria</h4>
<p>Several fairness notions exist, often conflicting:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 26%">
<col style="width: 37%">
<col style="width: 4%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Criterion</th>
<th>Description</th>
<th>Example</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Demographic Parity</td>
<td>( P<span class="math inline">\(\hat{Y}=1                      | A=a\)</span> = P<span class="math inline">\(\hat{Y}=1                               | A=b\)</span> )</td>
<td>Equal positive rate</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Equal Opportunity</td>
<td>Equal true positive rates</td>
<td>Same recall for all groups</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Equalized Odds</td>
<td>Equal TPR &amp; FPR</td>
<td>Balanced errors</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Calibration</td>
<td>Same predicted probability meaning</td>
<td>If model says 70%, all groups should achieve 70%</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>No single measure fits all , fairness depends on context and trade-offs.</p>
</section>
<section id="algorithmic-fairness-techniques" class="level4">
<h4 class="anchored" data-anchor-id="algorithmic-fairness-techniques">3. Algorithmic Fairness Techniques</h4>
<ol type="1">
<li><p>Pre-processing Rebalance or reweight data before training. Example: reweighing, sampling.</p></li>
<li><p>In-processing Add fairness constraints to loss function. Example: adversarial debiasing.</p></li>
<li><p>Post-processing Adjust predictions after training. Example: threshold shifting.</p></li>
</ol>
<p>Tiny Code (Adversarial Debiasing Skeleton)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb431"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, a, y <span class="kw">in</span> data:</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model(x)</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a>    loss_main <span class="op">=</span> loss_fn(y_pred, y)</span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a>    loss_adv <span class="op">=</span> adv_fn(y_pred, a)</span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a>    loss_total <span class="op">=</span> loss_main <span class="op">-</span> λ <span class="op">*</span> loss_adv</span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a>    update(loss_total)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Here, the adversary tries to predict sensitive attribute, encouraging invariance.</p>
</section>
<section id="causal-inference-basics" class="level4">
<h4 class="anchored" data-anchor-id="causal-inference-basics">4. Causal Inference Basics</h4>
<p>Correlation ≠ causation. To reason about fairness and robustness, we need causal understanding , what <em>would</em> happen if we changed something.</p>
<p>Causal inference models relationships via Directed Acyclic Graphs (DAGs):</p>
<ul>
<li>Nodes: variables- Edges: causal influence</li>
</ul>
</section>
<section id="counterfactual-reasoning" class="level4">
<h4 class="anchored" data-anchor-id="counterfactual-reasoning">5. Counterfactual Reasoning</h4>
<p>A counterfactual asks:</p>
<blockquote class="blockquote">
<p>“What would the outcome be if we intervened differently?”</p>
</blockquote>
<p>Formally: <span class="math display">\[
P(Y_{do(X=x)})
\]</span></p>
<p>Used in:</p>
<ul>
<li>Fairness (counterfactual fairness)- Policy evaluation- Robust decision making</li>
</ul>
</section>
<section id="counterfactual-fairness" class="level4">
<h4 class="anchored" data-anchor-id="counterfactual-fairness">6. Counterfactual Fairness</h4>
<p>An algorithm is counterfactually fair if prediction stays the same under hypothetical changes to sensitive attributes.</p>
<p><span class="math display">\[
\hat{Y}*{A \leftarrow a}(U) = \hat{Y}*{A \leftarrow a'}(U)
\]</span></p>
<p>This requires causal models , not just data.</p>
</section>
<section id="robust-optimization" class="level4">
<h4 class="anchored" data-anchor-id="robust-optimization">7. Robust Optimization</h4>
<p>In uncertain environments, we want solutions that hold up under worst-case conditions.</p>
<p>Formulation: <span class="math display">\[
\min_x \max_{\xi \in \Xi} f(x, \xi)
\]</span></p>
<p>where <span class="math inline">\(\Xi\)</span> is the uncertainty set.</p>
<p>Example: Design a portfolio that performs well under varying market conditions.</p>
<p>Tiny Code</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb432"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> robust_objective<span class="op">(</span><span class="dt">double</span> x<span class="op">[],</span> Scenario Xi<span class="op">[],</span> <span class="dt">int</span> N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> worst <span class="op">=</span> <span class="op">-</span>INF<span class="op">;</span></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span>N<span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a>        worst <span class="op">=</span> max<span class="op">(</span>worst<span class="op">,</span> f<span class="op">(</span>x<span class="op">,</span> Xi<span class="op">[</span>i<span class="op">]));</span></span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> worst<span class="op">;</span></span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This searches for a solution minimizing worst-case loss.</p>
</section>
<section id="distributional-robustness" class="level4">
<h4 class="anchored" data-anchor-id="distributional-robustness">8. Distributional Robustness</h4>
<p>Instead of worst-case instances, protect against worst-case distributions:</p>
<p><span class="math display">\[
\min_\theta \sup_{Q \in \mathcal{B}(P)} \mathbb{E}_{x \sim Q}[L(\theta, x)]
\]</span></p>
<p>Used in adversarial training and domain adaptation.</p>
<p>Example: Add noise or perturbations to improve resilience:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb433"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>x_adv <span class="op">=</span> x <span class="op">+</span> ε <span class="op">*</span> sign(grad(loss, x))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="balancing-fairness-causality-and-robustness" class="level4">
<h4 class="anchored" data-anchor-id="balancing-fairness-causality-and-robustness">9. Balancing Fairness, Causality, and Robustness</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 49%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Goal</th>
<th>Method</th>
<th>Challenge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fairness</td>
<td>Parity, Adversarial, Counterfactual</td>
<td>Competing definitions</td>
</tr>
<tr class="even">
<td>Causality</td>
<td>DAGs, do-calculus, SCMs</td>
<td>Identifying true structure</td>
</tr>
<tr class="odd">
<td>Robustness</td>
<td>Min-max, DRO, Adversarial Training</td>
<td>Trade-off with accuracy</td>
</tr>
</tbody>
</table>
<p>Real-world design involves balancing trade-offs.</p>
<p>Sometimes improving fairness reduces accuracy, or robustness increases conservatism.</p>
</section>
<section id="why-it-matters-98" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-98">10. Why It Matters</h4>
<p>Algorithms don’t exist in isolation , they affect people. Embedding fairness, causality, and robustness ensures systems are trustworthy, interpretable, and just.</p>
<blockquote class="blockquote">
<p>“The goal is not just intelligent algorithms , but responsible ones.”</p>
</blockquote>
</section>
<section id="try-it-yourself-98" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-98">Try It Yourself</h4>
<ol type="1">
<li>Train a simple classifier on biased data.</li>
<li>Apply reweighing or adversarial debiasing.</li>
<li>Draw a causal DAG of your data features.</li>
<li>Compute counterfactual fairness for a sample.</li>
<li>Implement a robust loss using adversarial perturbations.</li>
</ol>
</section>
</section>
<section id="ai-planning-search-and-learning-systems" class="level3">
<h3 class="anchored" data-anchor-id="ai-planning-search-and-learning-systems">100. AI Planning, Search, and Learning Systems</h3>
<p>AI systems are not just pattern recognizers , they are decision makers. They plan, search, and learn in structured environments, choosing actions that lead to long-term goals. This section explores how modern AI combines planning, search, and learning to solve complex tasks.</p>
<section id="what-is-ai-planning" class="level4">
<h4 class="anchored" data-anchor-id="what-is-ai-planning">1. What Is AI Planning?</h4>
<p>AI planning is about finding a sequence of actions that transforms an initial state into a goal state.</p>
<p>Formally, a planning problem consists of:</p>
<ul>
<li>States ( S )- Actions ( A )- Transition function ( T(s, a) s’ )- Goal condition <span class="math inline">\(G \subseteq S\)</span>- Cost function ( c(a) ) The objective: Find a plan <span class="math inline">\(\pi = [a_1, a_2, \ldots, a_n]\)</span> minimizing total cost or maximizing reward.</li>
</ul>
</section>
<section id="search-based-planning" class="level4">
<h4 class="anchored" data-anchor-id="search-based-planning">2. Search-Based Planning</h4>
<p>At the heart of planning lies search. Search explores possible action sequences, guided by heuristics.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DFS</td>
<td>Uninformed</td>
<td>Deep exploration, no guarantee</td>
</tr>
<tr class="even">
<td>BFS</td>
<td>Uninformed</td>
<td>Finds shortest path</td>
</tr>
<tr class="odd">
<td>Dijkstra</td>
<td>Weighted</td>
<td>Optimal if costs ≥ 0</td>
</tr>
<tr class="even">
<td>A*</td>
<td>Heuristic</td>
<td>Combines cost + heuristic</td>
</tr>
</tbody>
</table>
<p>A* Search Formula: <span class="math display">\[
f(n) = g(n) + h(n)
\]</span> where:</p>
<ul>
<li>( g(n) ): cost so far- ( h(n) ): heuristic estimate to goal If ( h ) is admissible, A* is optimal.</li>
</ul>
<p>Tiny Code (A* Skeleton)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb434"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a>priority_queue<span class="op">&lt;</span>Node<span class="op">&gt;</span> open<span class="op">;</span></span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a>g<span class="op">[</span>start<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a>open<span class="op">.</span>push<span class="op">({</span>start<span class="op">,</span> h<span class="op">(</span>start<span class="op">)});</span></span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(!</span>open<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb434-6"><a href="#cb434-6" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> open<span class="op">.</span>pop_min<span class="op">();</span></span>
<span id="cb434-7"><a href="#cb434-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>goal<span class="op">(</span>n<span class="op">))</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb434-8"><a href="#cb434-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>a in actions<span class="op">(</span>n<span class="op">))</span> <span class="op">{</span></span>
<span id="cb434-9"><a href="#cb434-9" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> step<span class="op">(</span>n<span class="op">,</span> a<span class="op">);</span></span>
<span id="cb434-10"><a href="#cb434-10" aria-hidden="true" tabindex="-1"></a>        cost <span class="op">=</span> g<span class="op">[</span>n<span class="op">]</span> <span class="op">+</span> c<span class="op">(</span>n<span class="op">,</span> a<span class="op">);</span></span>
<span id="cb434-11"><a href="#cb434-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>cost <span class="op">&lt;</span> g<span class="op">[</span>s<span class="op">])</span> <span class="op">{</span></span>
<span id="cb434-12"><a href="#cb434-12" aria-hidden="true" tabindex="-1"></a>            g<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> cost<span class="op">;</span></span>
<span id="cb434-13"><a href="#cb434-13" aria-hidden="true" tabindex="-1"></a>            f<span class="op">[</span>s<span class="op">]</span> <span class="op">=</span> g<span class="op">[</span>s<span class="op">]</span> <span class="op">+</span> h<span class="op">(</span>s<span class="op">);</span></span>
<span id="cb434-14"><a href="#cb434-14" aria-hidden="true" tabindex="-1"></a>            open<span class="op">.</span>push<span class="op">({</span>s<span class="op">,</span> f<span class="op">[</span>s<span class="op">]});</span></span>
<span id="cb434-15"><a href="#cb434-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb434-16"><a href="#cb434-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb434-17"><a href="#cb434-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="heuristics-and-admissibility" class="level4">
<h4 class="anchored" data-anchor-id="heuristics-and-admissibility">3. Heuristics and Admissibility</h4>
<p>A heuristic ( h(s) ) estimates distance to the goal.</p>
<ul>
<li><p>Admissible: never overestimates- Consistent: satisfies triangle inequality Examples:</p></li>
<li><p>Manhattan distance (grids)- Euclidean distance (geometry)- Pattern databases (puzzles) Good heuristics = faster convergence.</p></li>
</ul>
</section>
<section id="classical-planning-strips" class="level4">
<h4 class="anchored" data-anchor-id="classical-planning-strips">4. Classical Planning (STRIPS)</h4>
<p>In symbolic AI, states are represented by facts (predicates), and actions have preconditions and effects.</p>
<p>Example:</p>
<pre><code>Action: Move(x, y)
Precondition: At(x), Clear(y)
Effect: ¬At(x), At(y)</code></pre>
<p>Search happens in logical state space.</p>
<p>Planners:</p>
<ul>
<li>Forward search (progression)- Backward search (regression)- Heuristic planners (FF, HSP)</li>
</ul>
</section>
<section id="hierarchical-planning" class="level4">
<h4 class="anchored" data-anchor-id="hierarchical-planning">5. Hierarchical Planning</h4>
<p>Break complex goals into subgoals.</p>
<ul>
<li>HTN (Hierarchical Task Networks): Define high-level tasks broken into subtasks.</li>
</ul>
<p>Example: “Make dinner” → [Cook rice, Stir-fry vegetables, Set table]</p>
<p>Hierarchy makes planning modular and interpretable.</p>
</section>
<section id="probabilistic-planning" class="level4">
<h4 class="anchored" data-anchor-id="probabilistic-planning">6. Probabilistic Planning</h4>
<p>When actions are uncertain:</p>
<ul>
<li>MDPs: full observability, stochastic transitions- POMDPs: partial observability Use value iteration, policy iteration, or Monte Carlo planning.</li>
</ul>
</section>
<section id="learning-to-plan" class="level4">
<h4 class="anchored" data-anchor-id="learning-to-plan">7. Learning to Plan</h4>
<p>Combine learning with search:</p>
<ul>
<li>Learned heuristics: neural networks approximate ( h(s) )- AlphaZero-style planning: learn value + policy, guide tree search- Imitation learning: mimic expert demonstrations This bridges classical AI and modern ML.</li>
</ul>
<p>Tiny Code (Learning-Guided A*)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb436"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> g <span class="op">+</span> alpha <span class="op">*</span> learned_heuristic(s)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Neural net learns ( h_(s) ) from solved examples.</p>
</section>
<section id="integrated-systems" class="level4">
<h4 class="anchored" data-anchor-id="integrated-systems">8. Integrated Systems</h4>
<p>Modern AI stacks combine:</p>
<ul>
<li><p>Search (planning backbone)- Learning (policy, heuristic, model)- Simulation (data generation) Examples:</p></li>
<li><p>AlphaZero: self-play + MCTS + neural nets- MuZero: learns model + value + policy jointly- Large Language Agents: use reasoning + memory + search</p></li>
</ul>
</section>
<section id="real-world-applications" class="level4">
<h4 class="anchored" data-anchor-id="real-world-applications">9. Real-World Applications</h4>
<ul>
<li>Robotics: motion planning, pathfinding- Games: Go, Chess, strategy games- Logistics: route optimization- Autonomy: drones, vehicles, AI assistants- Synthesis: program and query generation Each blends symbolic reasoning and statistical learning.</li>
</ul>
</section>
<section id="why-it-matters-99" class="level4">
<h4 class="anchored" data-anchor-id="why-it-matters-99">10. Why It Matters</h4>
<p>Planning, search, and learning form the triad of intelligence:</p>
<ul>
<li>Search explores possibilities- Planning sequences actions toward goals- Learning adapts heuristics from experience Together, they power systems that think, adapt, and act.</li>
</ul>
<blockquote class="blockquote">
<p>“Intelligence is not just knowing , it is choosing wisely under constraints.”</p>
</blockquote>
</section>
<section id="try-it-yourself-99" class="level4">
<h4 class="anchored" data-anchor-id="try-it-yourself-99">Try It Yourself</h4>
<ol type="1">
<li>Implement A* search on a grid maze.</li>
<li>Add a Manhattan heuristic.</li>
<li>Extend to probabilistic transitions (simulate noise).</li>
<li>Build a simple planner with preconditions and effects.</li>
<li>Train a neural heuristic to guide search on puzzles.</li>
</ol>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../index.html" class="pagination-link" aria-label="Content">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Content</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../books/en-us/plan.html" class="pagination-link" aria-label="The Plan">
        <span class="nav-page-text"><span class="chapter-title">The Plan</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>